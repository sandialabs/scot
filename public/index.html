<!DOCTYPE HTML>
<html lang="en" style="overflow: hidden;" >
    <head>
<!--        <meta name="viewport"       content="width=device-width, initial-scale=1.0"> -->
        <meta name="viewport"    content="minimal-ui">
        <meta name="description"    content="">
        <meta name="author"         content="">
        <title>SCOT3</title>
        <link href="/favicon.png"   rel="icon" type="image/png"></link>
        <link rel="stylesheet"      href="/bootstrap/css/bootstrap.css"></link>
        <link rel="stylesheet/less" type="text/css" href="styles.less">
        <link rel="stylesheet"      href="/libs/jquery.datepick.css"></link>
        <link rel="stylesheet"      href="/select2.css"></link>
        <link rel="stylesheet"      href="/libs/jquery-ui-1.10.3.custom/css/ui-darkness/jquery-ui-1.10.3.custom.min.css"></link>
        <link rel="stylesheet"      href="/libs/jquery.qtip.min.css"></link>
        <link rel="stylesheet"      href="/libs/colorbox/colorbox.css"></link>
        <link rel="stylesheet"      href="/libs/finderSelect.css"></link>

        <script src="/libs/less-1.3.1.min.js"></script>
        <script> </script>

        <style>
            body {
                padding-top: 40px; /* 60px to make the container go all the way to the bottom of the topbar */
                padding-bottom: 40px;
                overflow-y:hidden;/*probably get rid */
            }
            .sidebar-nav {
                padding: 9px 0;
            }
        </style>
        <link rel="stylesheet"  href="/bootstrap/css/bootstrap-responsive.css" media="screen"></link>
        <link rel="stylesheet"  href="/libs/jquery.dataTables.css"></link>
        <link rel="stylesheet"  href="/libs/jquery.dataTables_themeroller.css"></link>

        <script src="/libs/jquery.min.js"></script>
        <script type="text/javascript" src="custom.js"></script>
        <script type="text/javascript" src="/libs/colorbox/jquery.colorbox-min.js"></script>
        <script type="text/javascript" src="activemq.js"></script>
        <script src="event.js"></script>
        <script src="libs.js"></script>
        <script src="search.js"></script>
        <script src="/bootstrap/js/bootstrap.js"></script>
        <script src="/libs/jquery.cookie.js"></script>
        <script src="/libs/bootstrapx-clickover.js"></script>
        <script src="/bootstrap/js/spin.min.js"></script>
        <script src="/libs/select2.min.js"></script>
        <script src="/libs/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.min.js"></script>
        <script src="/libs/jquery.ba-urlinternal.min.js"></script>
        <script src="/libs/jquery.ba-resize.min.js"></script>
        <script src="/libs/jquery.ba-throttle-debounce.min.js"></script>
        <script src="/libs/jquery-ui-timepicker-addon.js"></script>
        <script src="/libs/jquery.timeago.js"></script>
        <script src="/libs/jquery.datepick.js"></script>
        <script src="/libs/jquery.base64.min.js"></script>
        <script src="/libs/np.js"></script>
        <script src="/libs/jquery.qtip.min.js"></script>
        <script src="/libs/jquery.scrollTo-1.4.3.1-min.js"></script>
        <script src="/libs/jquery.finderSelect.js"></script>
        <script src="/libs/jquery.tablesorter.min.js"></script>
        <script src="/libs/jquery.dataTables.js"></script>
        <script src="/libs/jquery.dataTables.columnFilter.js"></script>
        <![if lt IE 10]>
             <!-- when will we be able to give up adding hacks to make things work with IE *sigh* -->
             <script src="/libs/polyfill/classList.js"></script>
             <script src="/libs/polyfill/console.js"></script>
        <![endif]>
    </head>


    <body style="padding-bottom:0px">
        <div id="admin_notices"></div>

        <span style="visibility:hidden; position:absolute; s-index: -5; top:0px; left:0px;" id="invisible"></span>

        <!--NavBar-->
        <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target="#nav1">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
		    <a class="brand" href="#" style="margin-left:-10px; margin-top:6px; margin-right:0px; margin-bottom:0px; padding:0px;"><img src="/images/chilli.png" class="logo"></img></a>
                    <a class="brand" href="#">SCOT3</a>
                    <div class="nav-collapse collapse" id="nav1">
                        <ul class="nav">
                            <li><a href="#/intel">Intel</a></li>
                            <li><a href="#/alert">Alerts</a></li>
                            <li><a href='#/event'>Events</a></li>
                            <li><a href="#/task">Tasks</a></li>
                            <!-- <li><a target="_blank" href="/scot/chat/irt">Chat</a></li> -->
                            <li><a style="display:none;" href="/admin/">Admin</a></li>
                        </ul>
                        <span id="search" class="popover-link navbar-search pull-right">
                            <input type="text" class="input-large search-query" placeholder="Search" name="query" id="2search" >
                        </span>
                        <span class="pull-right">
                            <div id="uploadProgress" style="display:hidden"></div>
                            Incident Handler: <span id="incident_handler" onclick="window.open('incident_handler.html')" style="cursor: pointer; text-decoration: underline; color:inherit; width:30px; margin-top:5px; margin-right:5px;" data-placement="bottom" id="incident_handler" class="popover-link"></span>
                            <img src="/images/notebook.png" onclick="window.open('scratchpad.html')" style="width: 30px; margin-top:5px; margin-right:5px; cursor: pointer;"></img>
                            <span class="popover-link" style="display:none; cursor:pointer; width:30px; height:25px; background-color:#333; float:left; margin-top:10px; border-radius:5px; box-shadow: 0px 0px 5px #888; margin-right:10px; text-align:center;" data-placement="bottom" id="notifications" >0</span>
                            <a href="/admin" target=_blank><img title="Admin Pannel" alt="Admin Pannel"  src="/images/gear.png" style="opacity:0.8; width:30px; margin-top:5px; margin-right:10px;" id="settings">
                            <a href="plugin.html" target=_blank><img src="/images/puzzle.png" style="opacity:0.8; width:30px; margin-top:5px; margin-right:10px;" id="plugins"><input style="display:none;" id="amq_test"></input></img></a>
                        </span>
                    </div><!--/.nav-collapse -->
                            <span id="live_results"></span>
                </div>
            </div>
        </div>
        <!-- //Navbar -->

        <!--Event Grid-->
        <div id="file_upload_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">File Upload</h3>
            </div>
            <div class="modal-body">
                <iframe style="border:0px solid transparent; height:15px; width: 100px;" src="about:blank" id="legacy_upload_iframe" name="legacy_upload_iframe" onload="parse_legacy_upload_results()"></iframe>
                <form target="legacy_upload_iframe" action="/scot/file/upload" method="POST" enctype="multipart/form-data">
                    Select file to upload <input type="file" name="upload"></input><br>
                    <input type="hidden" name="target_type" id="legacy_upload_target_type"></input>
                    <input type="hidden" name="target_id" id="legacy_upload_target_id"></input>
                    Notes:<input type="text" name="notes" id="legacy_upload_notes"></input>
                    <input type="hidden" name="modifygroups" id="legacy_upload_modify_groups"></input>
                    <input type="hidden" name="readgroups" id="legacy_upload_read_groups"></input>
                    <br><input type="submit" value="Upload"></input>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true" id="done_legacy_upload">Cancel</button>
            </div>
        </div>

        <div id="alert_parsing_modal" style="width:80%; top:20px; margin-top:0px; height:calc(100% - 40px); left:10%; margin-left:0px;" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Define Alert Parsing</h3>
            </div>
            <div class="modal-body" style="max-height:initial; height:calc(100% - 125px);" >
	      Apply this parsing when: <select id="alert_parsing_type" onchange="change_alert_parsing_type(this)"> <option value="source">Alert Source</option><option value="subject">Alert Subject</option></select><select id="alert_parsing_comparator"><option value="equals">equals</option><option value="contains">contains</option><option>starts w/</option></select><input type="text" name="apply_parsing_to" id="alert_parsing_to"></input><br>
	      <small>Note: When an imcoming alert matches more than one parser, the most recently saved parser is run</small>
	      <button onclick="toggle_alert_dom()" class="btn"><b>Show Alert DOM Tree</b></button><br>
              <div id="alert_parsed" style="resize:vertical; height:200px; display:none;  overflow:auto;" class="well" >
</div>
              <div id="alert_parsing_html" style="display:none;"></div>
<br>
	      Parser:<br><select onchange="parser_type_change(this)">
		<option value="custom">Custom</option>
		<option value="table">Table</option>
	      </select><br>
   	      Note: DOM can be accessed via the local variable 'dom'.  The results window below is accessed via local variable 'results'.<br>
	      <b>Javascript</b><br><textarea id="alert_parsing_js" style="width:calc(100% - 10px); height:150px;"></textarea>
		<br><button class="btn" onclick="test_parsing()">Test Javascript</button>
<br><br>	      <b>Debug Console</b><br><pre><div id="debugDiv" style="overflow:auto;" class=""></div></pre>
<br><br>
             <b> Results Preview:</b><br>
	      <pre><div  id="alert_parsing_preview" class="" style="overflow-x:auto;"></div></pre>
	     <b> Results JSON:</b><br>
	      <pre><div  id="alert_parsing_results"></div></pre>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Clancel</button>
                <button class="btn btn-primary" onclick="save_parsing()" >Save</button>
            </div>
        </div>

        <div id="history_modal" style="width:80%; left:10%; margin-left:0px;" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Current History</h3>
            </div>
            <div class="modal-body">
              Loading History... Please Wait....
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true" id="done_legacy_upload">Close</button>
            </div>
        </div>

       <div id="list_entities_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">List of Entities</h3>
            </div>
            <div class="modal-body">
                <p id="list_entities_text">
	        </p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Done</button>
            </div>
        </div>

        <div id="external_site_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Browse to external site?</h3>
            </div>
            <div class="modal-body">
                <p>The link you clicked will take you to a site outside SCOT.  If this is a link an attacker controls you may be tipping your hand.</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-primary" data-dismiss="modal" onclick="visit_site_confirmed()" >Proceed</button>
            </div>
        </div>

        <div id="take_ownership_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Take Ownership?</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to take ownership of this event?</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-primary" data-dismiss="modal" onclick="take_ownership_confirmed()" >Take Ownership</button>
            </div>
        </div>



        <div id="login_modal" class="modal hide fade" onkeydown="default_button(this)" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Login</h3>
            </div>
            <div class="modal-body">
		<div style="float:right; height:100px; overflow:hidden; display:block;" id="login_status"></div>
                <div class="control-group">
                      <label class="control-label" for="username">Username:</label>
                      <div class="controls">
                         <input type="text" name="username" id="username" ></input>
                      </div>
                   </div>
		 <div class="control-group">
                      <label class="control-label" for="password">Password:</label>
                      <div class="controls">
                         <input type="password" name="password" id="password" ></input>
                      </div>
                   </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-primary"  onclick="login(this)" >Login</button>
            </div>
        </div>

       <div id="close_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Disposition</h3>
            </div>
            <div class="modal-body">
                <p>
                <label value="Was this a false positive? (false_positive)"><input type="checkbox" name="false_positive"></input></label>
                <label value="Did we get a notification from an external entity about this? (external)">
                    <input type="checkbox" name="external"></input>
                </label>
                <label value="Was this authorized activity? (authorized)"></label>
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn" data-dismiss="modal" aria-hidden="true" onclick="close_confirmed(true)">Skip Disposition</button>
                <button class="btn btn-primary" data-dismiss="modal" onclick="close_confirmed(false)" >Save Disposition</button>
            </div>
        </div>

        <div id="delete_incident_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Confirm incident deletion</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this INCIDENT?  This action can not be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-danger" data-dismiss="modal" onclick="delete_incident_confirmed(this)" >Delete incident</button>
            </div>
        </div>

        <div id="delete_alert_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Confirm alert deletion</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this ALERT?  This action can not be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-danger" data-dismiss="modal" onclick="delete_alert_confirmed(this)" >Delete alert</button>
            </div>
        </div>

        <div id="delete_event_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Confirm event deletion</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this EVENT?  This action can not be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-danger" data-dismiss="modal" onclick="delete_event_confirmed(this)" >Delete event</button>
            </div>
        </div>

        <div id="delete_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                <h3 id="myModalLabel">Confirm entry deletion</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this entry?  This action can not be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-danger" data-dismiss="modal" onclick="delete_entry_confirmed(this)" >Delete entry</button>
            </div>
        </div>

        <div id="MySplitter" style="overflow:hidden">
        <!--    <div><button class="btn">Add Event</button></div>-->
            <div class="btn-group second-menu" id="TopMenu">
                <button class="btn btn-mini intel" onclick="create_intel()">
                    <img src="/images/edit_add.png"></img>&nbsp;Create Intel
                </button>
                <button class="btn btn-mini events" onclick="create_event()">
                    <img src="/images/edit_add.png"></img>&nbsp;Create Event
                </button>
                <button class="btn btn-mini alerts events incidents tasks" onclick="export_grid()">
                    <img src="/images/csv_text.png"></img>&nbsp;Export to CSV
                </button>
                <button class="btn btn-mini alerts events incidents tasks init" id="clear_filters" onclick="clear_filters()">
                    <img src="/images/edit_clear.png"></img>&nbsp;Clear Filters
                </button>
<!--                <button class="btn btn-mini alerts events incidents tasks " id="show_hide_filters" onclick="show_hide_filters()">
                    <img src="/images/show.png"></img>&nbsp;<span>Show/Hide Filters</span>
                </button> -->
            </div>
            <table id="filters">
                <tr id="filters-inner">
                </tr>
            </table>
            <div id="TopPane" style="height:300px; overflow-x:hidden; overflow-y:auto;" tabindex=0>
                <div id="table_div">
                    <table id="event_grid" class="grid-table table table-scot-striped table-bordered table-condensed" style="margin-bottom:3px;">
                        <tr>
                            <td ><h1 style="margin-left:150px" class="clickTabs">&#x21D6;&nbsp;&nbsp;&#x21D1;&nbsp;&nbsp;&#x21D7;<br><h5 style="margin-left:125px" class="clickTabs">Click a tab above to begin</h5></h1>
                                <center>
                                    <h1>Sandia Cyber Omni Tracker, v. 3.4</h1>
                                </center>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <div id="paging" style="display:none; height:20px; width:100%; color: #eee; padding-bottom:3px; background-color:#3a3a3a;">
                <center>
                    <button  style="background-image: url('/images/paging.png'); background-position: -81px -161px; display:inline-block; height:16px; width:16px; margin:0px; padding:0px;" class="btn btn-mini" id="first" onclick="goto_page('first')"></button>
                    <button style="background-image: url('/images/paging.png'); background-position: -49px -161px; display:inline-block; height:16px; width:16px; margin:0px; padding:0px;" class="btn btn-mini" id="previous"onclick="goto_page('previous')"></button>

                    Page
                    <input type="text" style="margin:0px; padding:0px; width:20px; height:20px; color: #CCC; background-color:#515151;" value="0" id="current_page"></input>
                    of
                    <span id="num_pages">5</span>
                        <button style="background-image: url('/images/paging.png'); background-position: -33px -161px; display:inline-block; height:16px; width:16px; margin:0px; padding:0px;" class="btn btn-mini" id="next" onclick="goto_page('next')"></button>
                        <button style="background-image: url('/images/paging.png'); background-position: -65px -161px; display:inline-block; height:16px; width:16px; margin:0px; padding:0px;" class="btn btn-mini" id="last" onclick="goto_page('last')"></button>
                        <select id="num_per_page" style="margin:0px; padding:0px; height:20px; background-color:#515151; color:#ccc;" onchange="grid_filter_updated(false)">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="30" selected>30</option>
                            <option value="50">50</option>
                            <option value="70">70</option>
                            <option value="100">100</option>
                            <option value="100000">ALL</option>
                        </select>
                </center>
            </div>

            <div id="splitterH" style="display:block; height:3px; width:100%; background-color:black; border-top:1px solid #AAA;  border-bottom:1px solid #AAA; cursor:row-resize; overflow:hidden;"  onmousedown="start_drag_splitter(event)" >
                <center>
                    <span style="color:white; position:relative; top:-10px;"></span>
                </center>
            </div>

        <!--Event details-->

        <!-- Event Info-->
        <div id="event_info" style="color:#ECECEC; background-color: #292929; padding-right:5px; padding-bottom:2px; box-shadow: 0px 5px 5px -5px #333;">
            <div>
                <span class="pull-right btn-group" style="margin-top:17px; box-shadow: 0px 0px 50px 5px #8A8A8A;" id="high_level_dropdown">
                    <button class="btn btn-inverse intel events incidents tasks"   onclick="addEntry()"  >
                        Add <b>Entry</b>
                    </button>
                    <button class="btn btn-inverse dropdown-toggle intel events incidents tasks" data-toggle="dropdown">
                        <span class="caret" style="margin-top:8px"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a  onclick="openFileUploadDialog()">Upload <b>File</b></a></li>
                        <li><a  onclick="openHistory()">View <b>History</b></a></li>
<!--                        <li><a  onclick="openChecklistToolbar()" class="events">Add <b>Checklist</b></a></li> -->
                        <li><a  onclick="toggleFlairGlobal()">Toggle <b>Flair</b></a></li>
                        <li><a  onclick="openPermissionsToolbar()"><b>Permissions</b></a></li>
                        <li><a  class="alerts events incidents" onclick="list_entities()">List <b>Entities</b></a></li>
                        <li><a  class="alerts" onclick="delete_alert()"><b>Delete </b>Alert</a></li>
                        <li><a  class="events" onclick="delete_event()"><b>Delete </b>Event</a></li>
                        <li><a  class="alerts" onclick="promote()"><b>Promote</b></a></li>
                        <li><a  class="alerts" onclick="export_alert_data()"><b>Export</b> Alert Grid</a></li>
                    </ul>
                </span>
            </div>

            <table class="details-table" >
                <tr>

                    <th class="intel">Intel&nbsp;#</th>
                    <th class="alerts">Alert&nbsp;#</th>
                    <th class="events">Event&nbsp;#</th>
                    <th>Subject</th>
                    <th class="events">Owner</th>
                    <th class="alerts events">Status</th>
                    <th class="alerts">Viewed By</th>
                    <th class="intel events alerts">Tags</th>
                    <th class="intel events alerts">Source</th>
                    <th class="events" id="linked_alerts_title">Alert(s)</th>
                </tr>
                <tr>
                    <td style="font-size:15pt" id="event_id"><span style="display:none;" id="preview_type"></span></td>
<!--                    <td><span class="editable" style="font-size:15pt" contenteditable="true" onpaste="return paste_subject(event)"  id="subjectEditor" ></span></td>-->
                    <td><input id="subjectEditor" class="editable" type="text" ></input></td>
                    <td class="events"><span class="editable"  ><button id="event_owner" onclick="take_ownership()" style="line-height:12pt; font-size: inherit;" class="btn btn-mini"></button></span>
                    </td>
                    <td class="alerts events"><span class="editable" ><button id="event_status" onclick="open_close_event()" style="line-height:12pt; font-size: inherit;" class="btn btn-mini"></button></span></td>
                    <td class="alerts"><span class="editable" id="viewed_by"></span></td>
                    <td class="intel alerts events"><input class="editable multi_tag" id="event_tags2"></input></td>
                    <td class="intel events alerts"><input class="editable multi_tag" id="event_source2"></input></td>
                    <!--<td class="alerts"><span class="editable" contenteditable="true" id="source" onKeyUp="update_source()"></span></td>-->
                    <td class="events"><span class="editable" id="linked_alerts"></span></td>
                    <td class="events"><span onclick="linked_incident(this)" style="cursor:pointer;" class="editable" id="linked_incidents"></span></td>
                    </td>
                    <td>
                    </td>
                </tr>
            </table>


            <div id="entity_toolbar" class="toolbar" >
                <img src="/images/close_toolbar.png" class="close_toolbar" onclick="close_toolbar(this)"></img>
                <span id="entity_info">Alerts:<span id="alerts_refs"></span><br>Events:<span id="events_refs"></span></span>
            </div>

            <div id="permissions_toolbar"  class="toolbar hideOnSwitch">
                <img src="/images/close_toolbar.png" class="close_toolbar" onclick="close_toolbar(this)"></img>
                <center>
                    Event Permissions:
                    &nbsp;&nbsp;&nbsp;
                Read Groups:&nbsp;<input class="entry_select2" id="read_permissions"></input>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write Groups:&nbsp;<input class="entry_select2" id="write_permissions"></input>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                </center>
            </div>

            <div id="move_entry_toolbar"  class="toolbar">
                <img src="/images/close_toolbar.png" class="close_toolbar" onclick="close_toolbar(this)"></img>
                <center><b>Select new destination for entry <span id="entryToMove">###</span>:</b>
                    <select style="width:400px;" onchange="checkValidDestinationEvent()" id="destinationPicker"></select>
                    <input type="button" class="btn" disabled value="Move Entry" id="move_entry_button" onclick="moveEntryConfirmed()"></input>
                </center>
            </div>

            <div id="checklist_toolbar" class="toolbar" style="display:none;">
                <img src="/images/close_toolbar.png" class="close_toolbar" onclick="close_toolbar(this)"></img>
                <center><b>Select checklist to add:</b>
                <select id="checklist_toolbar_options" onchange="checklist_selection_changed()"></select>
                <input type="button" class="btn" id="add_checklist_button" disabled value="Add Checklist" onclick="confirm_add_checklist()"></input>
		</center>
            </div>

            <div id="edit_toolbar" style="display:none;">
                <center>
                    <div class="btn-toolbar">
                        <div class="btn-group">
                            <a class="btn"  title="bold" alt="bold" onclick="edit_text('bold')"><i class="icon-bold" ></i></a>
                            <a class="btn"  title="italic" alt="italic" onclick="edit_text('italic')"><i class="icon-italic" ></i></a>
                        </div>
                        <div class="btn-group">
                            <span class="dropdown">
                                <a class="btn dropdown-toggle" title="Font Size" alt="Font Size" style="border-top-right-radius:0px; border-bottom-right-radius:0px; border-right:0px;" data-toggle="dropdown" >Font Size<span class="caret"></span></a>
                                <ul class="dropdown-menu" style="min-width:40px; font-size:10pt">
                                    <li>
                                        <a  onclick="edit_text('fontSize',1)">1</a>
                                        <a  onclick="edit_text('fontSize',2)">2</a>
                                        <a  onclick="edit_text('fontSize',3)">3</a>
                                        <a  onclick="edit_text('fontSize',4)">4</a>
                                        <a  onclick="edit_text('fontSize',5)">5</a>
                                        <a  onclick="edit_text('fontSize',6)">6</a>
                                        <a  onclick="edit_text('fontSize',7)">7</a>
                                    </li>
                                </ul>
                            </span>
                            <span class="dropdown">
                                <a class="btn dropdown-toggle" title="Font" alt="Font" style="border-radius:0px; border-right:0px;" data-toggle="dropdown">
                                    Font<span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu" style="min-width:40px; font-size:10pt;">
                                    <li>
                                        <a  onclick="edit_text('fontName', 'Arial')">Arial</a>
                                        <a  onclick="edit_text('fontName', 'Helvetica')">Helvetica</a>
                                        <a  onclick="edit_text('fontName', 'Times New Roman')">Times New Roman</a>
                                        <a  onclick="edit_text('fontName', 'Times')">Times</a>
                                        <a  onclick="edit_text('fontName', 'Courier New')">Courier New</a>
                                        <a  onclick="edit_text('fontName', 'Courier')">Courier</a>
                                        <a  onclick="edit_text('fontName', 'Lucida Console')">Lucida Console</a>
                                    </li>
                                </ul>
                            </span>
                            <a class="btn"  title="code" alt="code" onclick="add_code()"><i class="icon-comment" ></i></a>
                            <a class="btn"  title="remove_font" alt="remove_font" onclick="remove_format()"><i class="icon-remove" ></i></a>
                            <a style="color:black" class="btn" alt="change foreground font color" title="change foreground font color" id="font_foreground_color_btn" onclick="font_color('foreground')"><span class="tinymce_icons" style="background-position:-720px 0px;"</span></a>
                            <a class="btn"  style="color:black;" alt="change background font color" title="change background font color" id="font_background_color_btn" onclick="font_color('background')"><span class="tinymce_icons" style="background-position:-760px 0px;"></span></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn" onclick="edit_text('justifyLeft')"><i class="icon-align-left" ></i></a>
                            <a class="btn" onclick="edit_text('justifyCenter')"><i class="icon-align-center" ></i></a>
                            <a class="btn" onclick="edit_text('justifyRight')"><i class="icon-align-right" ></i></a>
                            <a class="btn" onclick="edit_text('justifyFull')"><i class="icon-align-justify" ></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn"  title="underline" alt="underline" onclick="edit_text('underline')">__</a>
                            <a class="btn"  title="strikethrough" alt="strikethrough"onclick="edit_text('strikeThrough')"><del>S</del></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn"  title="indent" alt="indent" onclick="edit_text('indent')"><i class="icon-indent-left"></i></a>
                            <a class="btn"  title="outdent" alt="outdent"  onclick="edit_text('outdent')"><i class="icon-indent-right"></i></a>

                            <a class="btn" title="unordered list" alt="unordered list"  onclick="edit_text('insertUnorderedList')"><span class="tinymce_icons" style="background-position:-20px 0px;"></span></a>
                            <a class="btn" title="ordered list" alt="ordered list"  onclick="edit_text('insertorderedList')"><span class="tinymce_icons" style="background-position:-80px 0px;"></span></a>

                        </div>
                        <div class="btn-group">
                            <a class="btn" title="link" alt="link"  onclick="add_link()"><span class="tinymce_icons" style="background-position:-500px 0px;"></span></a>
                            <a class="btn" title="unlink" alt="unlink"  onclick="edit_text('unlink')"><span class="tinymce_icons" style="background-position:-640px 0px;"></span></a>
                        </div>
                        <div class="btn-group popover-link" id="tableEditor">
                            <a class="btn" title="table" alt="table"  html="true" >
                                <span class="popover-link tinymce_icons" style="background-position:-580px -20px;"></span>
                            </a>
                        </div>
                        <div class="btn-group popover-link" id="findAndReplace">
                                <a class="btn" title="find & replace" alt="find & replace" html="true"><span class="popover-link">F&R</span></a>"
                        </div>
                        <a class="btn" onclick="html_edit()"><span class="tinymce_icons" style="background-position:-260px 0px;"  ></span></a>
                    </div>
                </center>
            </div>
        </div> <!-- //Event Info-->

        <input type="file" id="uploadFile" onchange="uploadFile()" name="upload" style="display:none;"></input>
        <div class="btn-group alerts  second-menu" id="second_menu">
            <button class="btn btn-mini alerts viewing" id="alert_parsing" onclick="alert_parsing()"><img src="/images/workflow.png"></img>&nbsp;Alert Parsing</button>
            <button class="btn btn-mini alerts viewing flair-off hideOnSwitch" onclick="toggleFlairGlobal()"><i class="btn-icon icon-eye-open"></i>&nbsp; Flair On</button>
            <button class="btn btn-mini alerts viewing extras" onclick="toggleFlairGlobal()"><i class="btn-icon icon-eye-close"></i>&nbsp; Flair Off</button>
            <button class="btn btn-mini alerts viewing" onclick="showAlertGuide(this)"><img src="/images/guide.png"></img>&nbsp;Guide</button>
<!--            <button class="btn btn-mini alerts viewing alert_parsed" id="viewSource" onclick="viewSource(this)"><img src="/images/code.png"></img>&nbsp;View Source</button>-->
            <button class="btn btn-mini alerts viewing" id="openHist" onclick="openHistory()"><img src="/images/clock.png"></img>&nbsp;View History</button>

            <button class="btn btn-mini alerts viewing hideOnSwitch alert_checked alert_parsed" onclick="addEntry()"><i class="btn-icon icon-plus-sign"></i>&nbsp;Add Entry</button>
            <button class="btn btn-mini alert_checked viewing hideOnSwitch alerts" onclick="multiple_alerts('open', this)"><img src="/images/open.png"></img>&nbsp; Open</button>
            <button class="btn btn-mini alert_checked viewing hideOnSwitch alerts" onclick="multiple_alerts('close', this)"><i  class="icon-flag"></i>&nbsp; Close</button>
            <button class="btn btn-mini alert_checked viewing hideOnSwitch alerts" onclick="promote_alerts(undefined, this)"><img src="/images/megaphone.png"></img>&nbsp; Promote</button>
            <button class="btn btn-mini alert_checked viewing hideOnSwitch alerts" onclick="promote_to_existing(this)"><img src="/images/megaphone_plus.png"></img>&nbsp; Add to existing event</button>
            <button class="btn btn-mini alerts hideOnSwitch alert_checked alert_parsed viewing" onclick="export_alert_data()"><img src="/images/csv_text.png"></img>&nbsp;Export to CSV</button>
            <button class="btn btn-mini alert_checked viewing hideOnSwitch alerts" onclick="delete_alerts(this)" id="delete_alerts"><i class="btn-icon icon-trash"></i>&nbsp; Delete</button>
        </div>
        <div id="BottomPane" class="alerts events tasks" style="height:50%; overflow-y:auto; overflow-x:auto">
        <!--Entries-->
        </div>
        <div id="intro_info" class="intro">
            <center>
            <a href="/license.html">License and Open Source Copyright Info</a>
            </center>
        </div>
         <div style='display:none'>
            <div id='inline_content' style='padding:10px; background:#fff;'>
            <p><strong>This content comes from a hidden element on this page.</strong></p>
            <p>The inline option preserves bound JavaScript events and changes, and it puts the content back where it came from when it is closed.</p>
            <p><a id="click" href="#" style='padding:5px; background:#ccc;'>Click me, it will be preserved!</a></p>

            <p><strong>If you try to open a new Colorbox while it is already open, it will update itself with the new content.</strong></p>
            <p>Updating Content Example:<br />
            <a class="ajax" href="../content/ajax.html">Click here to load new content</a></p>
            </div>
        </div>

    </body>
</html>
