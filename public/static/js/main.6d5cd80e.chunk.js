(this.webpackJsonpscotui=this.webpackJsonpscotui||[]).push([[0],{273:function(e,t,a){},429:function(e,t,a){e.exports=a.p+"static/media/scot_logo_473x473.981c5c79.png"},525:function(e,t,a){e.exports=a(905)},905:function(e,t,a){"use strict";a.r(t);var s=a(0),i=a.n(s),r=a(13),n=a.n(r),l=a(131),o=a.n(l),c=a(267),d=a.n(c),h=a(108),p=a.n(h),u=a(442),m=a.n(u),g=a(30),y=a.n(g),f=a(65),b=a(17),v=a(32),E=a(952),w=a(981),S=a(953),T=a(954),k=a(955),x=a(1),C=a.n(x),D=a(424),N=a(269);const _={key:C.a.string.isRequired,default:C.a.any.isRequired},M={getUserConfig:C.a.func,setUserConfig:C.a.func};class A extends s.PureComponent{constructor(e){super(e),this.state={userConfig:{loading:!0}},this.update=this.update.bind(this),this.setUserConfig=this.setUserConfig.bind(this)}getChildContext(){return{getUserConfig:this.getUserConfig,setUserConfig:this.setUserConfig}}getUserConfig(){return new Promise((e,t)=>{let a=localStorage["userConfig"];e(a?JSON.parse(a):{})})}setUserConfig(e){return new Promise((t,a)=>{var s,i;s="userConfig",i=JSON.stringify(e),localStorage.setItem(s,i),t()}).then(()=>{this.update()})}update(){this.getUserConfig().then(e=>{this.setState({userConfig:e})})}componentDidMount(){this.update()}render(){return i.a.createElement(N.a,{value:this.state.userConfig,channel:"userConfig"},i.a.createElement("div",null,this.props.children))}}A.childContextTypes=M;C.a.shape({config:C.a.any.isRequired,setUserConfig:C.a.func.isRequired,getUserConfig:C.a.func.isRequired,loading:C.a.bool}).isRequired;var j=a(270),O=a.n(j),L=a(944),P=a(427),I=a(976);const F=(e,t)=>i.a.createElement("div",{style:{position:"relative"}},e,i.a.createElement("span",{className:"panel-button right"},i.a.createElement(P.a,{onClick:t,bsSize:"small"},i.a.createElement("i",{className:"fa fa-close"}))));var R=({children:e,onRemove:t,editable:a,title:s})=>i.a.createElement("div",{className:"widget ".concat(a&&"editable")},!a&&e,a&&i.a.createElement(I.a,{header:F(s,t)},i.a.cloneElement(e,{editMode:a}))),U=a(978);var H=({widgets:e,layout:t,isOpen:a,onClose:s,onSelect:r})=>{let n=new Set;t.rows.forEach(e=>{e.columns.forEach(e=>{e.widgets.forEach(e=>{n.add(e.key)})})});let l=Object.keys(e).filter(e=>!n.has(e)).map((t,a)=>{const s=e[t];return i.a.createElement("div",{key:a,className:"picker-item",onClick:()=>{r(t)}},i.a.createElement("h3",null,s.title),i.a.createElement("p",null,s.description))});return l.length||(l=i.a.createElement("h2",null,"No available widgets")),i.a.createElement(U.a,{show:a,onHide:s,className:"WidgetPicker"},i.a.createElement(U.a.Header,{closeButton:!0},i.a.createElement(U.a.Title,null,"Pick a Widget")),i.a.createElement(U.a.Body,{className:"picker-grid"},l),i.a.createElement(U.a.Footer,null,i.a.createElement(P.a,{onClick:s},"Cancel")))};const W={rows:[{columns:[{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]}]}]};class B extends s.PureComponent{constructor(e){super(e),this.state={editable:null!=e.saveDashboard,editMode:e.isNew,layout:e.layout,title:e.title,widgetPicker:!1,newWidgetOptions:{}},this.onAdd=this.onAdd.bind(this),this.updateLayout=this.updateLayout.bind(this),this.updateTitle=this.updateTitle.bind(this),this.reset=this.reset.bind(this),this.saveDashboard=this.saveDashboard.bind(this),this.toggleEdit=this.toggleEdit.bind(this),this.togglePicker=this.togglePicker.bind(this),this.selectWidget=this.selectWidget.bind(this)}onAdd(e,t,a){this.setState({widgetPicker:!0,newWidgetOptions:{row:t,col:a}})}updateLayout(e){this.setState({layout:e})}updateTitle(e){this.setState({title:e.target.value})}toggleEdit(){this.setState({editMode:!this.state.editMode})}saveDashboard(){this.state.title?(this.props.saveDashboard(this.state.title,this.state.layout),this.toggleEdit()):this.props.errorToggle("Please enter a dashboard title")}reset(){this.setState({layout:this.props.layout,title:this.props.title,editMode:!1,widgetPicker:!1,newWidgetOptions:{}})}togglePicker(){this.setState({widgetPicker:!this.state.widgetPicker})}selectWidget(e){let t=this.state.newWidgetOptions,a=t.row,s=t.col;this.updateLayout(Object(j.addWidget)(this.state.layout,a,s,e)),this.togglePicker()}render(){return i.a.createElement("div",{className:"dashboard"},i.a.createElement(H,{widgets:this.props.widgets,layout:this.state.layout,isOpen:this.state.widgetPicker,onClose:this.togglePicker,onSelect:this.selectWidget}),i.a.createElement(V,{title:this.state.title,editable:this.state.editable,editMode:this.state.editMode,onEdit:this.toggleEdit,onSave:this.saveDashboard,onCancel:this.reset,handleTitleChange:this.updateTitle,isNew:this.props.isNew}),i.a.createElement(L.a,{fluid:!0},i.a.createElement(O.a,{onRemove:this.updateLayout,onMove:this.updateLayout,onAdd:this.onAdd,editable:this.state.editMode,layout:this.state.layout,widgets:this.props.widgets,frameComponent:R})))}}B.defaultProps={title:"",layout:W,isNew:!1};const V=({title:e,editMode:t,onEdit:a,onSave:s,onCancel:r,handleTitleChange:n,isNew:l,editable:o})=>o?i.a.createElement("div",{className:"titleBar clearfix"},t&&i.a.createElement("form",{onSubmit:s},i.a.createElement("input",{type:"text",className:"title",value:e,placeholder:"Dashboard Title",onChange:n}),i.a.createElement(P.a,{bsStyle:"primary",bsSize:"small",onClick:s},"Save"),i.a.createElement(P.a,{bsStyle:"warning",bsSize:"small",disabled:l,onClick:r},"Cancel")),!t&&i.a.createElement("div",{className:"edit"},i.a.createElement(P.a,{bsSize:"xsmall",onClick:a},i.a.createElement("i",{className:"fa fa-edit"})))):null;var z=a(2),q=a.n(z);class K extends s.PureComponent{constructor(e){super(e),this.state={statusData:{},error:null},this.updateData=this.updateData.bind(this),this.fetchError=this.fetchError.bind(this)}componentDidMount(){q.a.ajax({type:"get",url:"scot/api/v2/status",success:this.updateData,error:this.fetchError}),this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}updateData(e){this._isMounted&&this.setState({statusData:e})}fetchError(e){this._isMounted&&this.setState({error:e})}render(){let e=this.props.className,t=void 0===e?"":e,a=[];if(Array.isArray(this.state.statusData)){var s,r=Object(b.a)(this.state.statusData);try{for(r.s();!(s=r.n()).done;){let e=s.value,t=e.name,r=e.status;r||(r="unknown"),a.push(i.a.createElement(G,{key:t,name:t,status:r}))}}catch(l){r.e(l)}finally{r.f()}}let n=["Status",t];return a.length>4&&n.push("cols-2"),i.a.createElement("div",{className:n.join(" ")},this.state.error&&i.a.createElement(I.a,{bsStyle:"danger",header:"Error"},this.state.error),a)}}const G=({name:e,status:t})=>i.a.createElement("div",{className:"service status-".concat(t),title:"Status: ".concat(t)},e);var J=K,Y=a(945),Q=a(946);var X=e=>i.a.createElement("span",{className:"emoji",role:"img","aria-label":e.label?e.label:"","aria-hidden":e.label?"false":"true"},e.symbol);const $=e=>e.charAt(0).toUpperCase()+e.slice(1);class Z extends s.PureComponent{constructor(e){super(e),this.updateCategory=()=>{let e=(this.state.categoryIndex+1)%this.state.gameCategories.length;this._isMounted&&this.setState({categoryIndex:e})},this.updateData=e=>{let t=[];for(let a in e)null!==a&&(console.log("".concat($(a))),t.push(i.a.createElement(ee,{category:a,data:e[a]})));this._isMounted&&this.setState({gameData:e,gameCategories:t})},this.fetchError=e=>{this._isMounted&&this.setState({error:e})},this.state={gameData:[],gameCategories:[],categoryIndex:0,error:null}}componentDidMount(){this._isMounted=!0,q.a.ajax({type:"get",url:"/scot/api/v2/game",success:this.updateData,error:this.fetchError}),this.categoryInterval=setInterval(this.updateCategory,5e3)}componentWillUnmount(){this._isMounted=!1,this.categoryInterval&&clearInterval(this.categoryInterval),this._isMounted=!1}render(){return i.a.createElement(Y.a,{className:"Gamification"},i.a.createElement("h3",null,"Leaders"),this.state.error&&i.a.createElement(I.a,{bsStyle:"danger",header:"Error"},this.state.error),this.state.gameCategories[this.state.categoryIndex])}}const ee=({category:e,data:t})=>i.a.createElement(I.a,{className:"category"},i.a.createElement(I.a.Title,null,i.a.createElement("b",null,"".concat($(e)," - ").concat(t[0].tooltip))),i.a.createElement(I.a.Body,null,i.a.createElement("div",null,""!==t[0].username&&null!==t[0].username&&null!=t[0].count&&""!==t[0].count?i.a.createElement("div",null,i.a.createElement(X,{symbol:"\ud83e\udd47"})," ",t[0].username," ",i.a.createElement(Q.a,null,t[0].count)):null,""!==t[1].username&&null!=t[1].username&&null!=t[1].count&&""!==t[1].count?i.a.createElement("div",null,i.a.createElement(X,{symbol:"\ud83e\udd48"})," ",t[1].username," ",i.a.createElement(Q.a,null,t[1].count)):null,""!==t[2].username&&null!=t[2].username&&null!=t[2].count&&""!==t[2].count?i.a.createElement("div",null,i.a.createElement(X,{symbol:"\ud83e\udd49"})," ",t[2].username," ",i.a.createElement(Q.a,null,t[2].count)):null)));var te=Z;const ae=(e,t)=>{localStorage.setItem(e,t)},se=e=>localStorage[e],ie=e=>localStorage[e];var re=a(947);var ne=a(103),le=a.n(ne),oe=a(265);const ce=Object(oe.extendMoment)(le.a),de=864e5,he=(e,t)=>!e||Date.now()-e>1e3*t,pe=()=>({start:Math.floor(new Date(Date.now()-de).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+de).setHours(23,59,59,999)/1e3)}),ue=()=>({start:Math.floor(new Date(Date.now()-7*de).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+de).setHours(23,59,59,999)/1e3)}),me=e=>[e.start,e.end],ge=e=>e.start+", "+e.end,ye={wall:"warning",create:"info",delete:"danger"},fe=["create","delete"],be={create:120,delete:60,wall:3600},ve=0,Ee=1;class we extends s.Component{constructor(e){super(e),this.state={users:[],notifications:this.loadWall()},this.updateActivity=this.updateActivity.bind(this),this.updateUsers=this.updateUsers.bind(this),this.wallMessage=this.wallMessage.bind(this),this.notification=this.notification.bind(this),this.fetchError=this.fetchError.bind(this)}componentDidMount(){this.refreshTimer=setInterval(this.updateActivity,3e4),this.updateActivity(),this.props.createCallback("wall",this.wallMessage)}componentWillUnmount(){this.refreshTimer&&clearInterval(this.refreshTimer)}updateActivity(){this.updateUsers();let e=this.state.notifications.filter(e=>!he(1e3*e.time,be[e.action]));this.setState({notifications:e},this.persistWall)}updateUsers(){q.a.ajax({type:"get",url:"/scot/api/v2/who",success:e=>{this.setState({users:e.records.map(e=>{return{type:ve,who:e.username,time:(t=e.last_activity,(Date.now()-1e3*t)/1e3)};var t})})},error:this.fetchError})}persistWall(){let e=this.state.notifications.filter(e=>"wall"===e.action);ae("walls",JSON.stringify(e))}loadWall(){let e=se("walls");return e?JSON.parse(e):[]}wallMessage(e){let t=this.state.notifications;t.push({type:Ee,time:e.activemqwhen,who:e.activemqwho,message:e.activemqmessage,level:ye.wall,action:"wall"}),this.setState({notifications:t},this.persistWall)}notification(e){if(["scot-flair","scot-alerts","scot-admin","","api"].includes(e.activemqwho))return;if(!0===e.activemqwall)return;if("entity"===e.activemqtype)return;if(!["create","delete"].includes(e.activemqstate))return;let t=this.state.notifications;t.push({type:Ee,time:Date.now()/1e3,who:e.activemqwho,message:e.activemqmessage+e.activemqid,level:ye[e.activemqstate],action:e.activemqstate}),this.setState({notifications:t})}addDebugItems(e=10){let t=this.state.notifications;for(let a=0;a<e;a++)t.push({type:Ee,time:Date.now()/1e3,who:"fred",message:"blah",level:ye.create,action:"create"});this.setState({notifications:t})}fetchError(e){}buildActivityItem(e,t){let a=function(e){var t=Math.floor(e/31536e3);return t>1?t+" years":(t=Math.floor(e/2592e3))>1?t+" months":(t=Math.floor(e/86400))>1?t+" days":(t=Math.floor(e/3600))>1?t+" hours":(t=Math.floor(e/60))>1?t+" minutes":Math.floor(e)+" seconds"}((s=e.time,(Date.now()-1e3*s)/1e3));var s;let r="";switch(e.type){default:case ve:r=e.who;break;case Ee:r="".concat(e.who,": ").concat(e.message)}return i.a.createElement(Se,{key:t,badge:a,style:e.level},r)}render(){let e=this.props.className,t=["Activity",void 0===e?"":e],a=this.state.users.concat(this.state.notifications).sort((e,t)=>t.time-e.time).map(this.buildActivityItem),s=!0;if(this.marquee&&this.well){let e=window.getComputedStyle(this.marquee);parseInt(e.width,10)-parseInt(e.paddingLeft,10)>this.well.offsetWidth&&(s=!1)}return i.a.createElement(Y.a,{bsSize:"small",className:t.join(" "),ref:e=>this.well=n.a.findDOMNode(e)},i.a.createElement("div",{className:"marquee ".concat(s?"stopped":""),ref:e=>this.marquee=e},a))}}const Se=({children:e,badge:t=null,style:a="default"})=>i.a.createElement("div",{className:"activity-item"},i.a.createElement(re.a,{bsStyle:a},e,null!==t&&i.a.createElement(Q.a,null,t)));var Te=we,ke=a(31),xe=a(19),Ce=a(33),De=a.n(Ce);class Ne extends s.PureComponent{constructor(e){super(e),this.getData=()=>{var e="/scot/api/v2/graph/dhheatmap?collection="+this.state.collection+"&type="+this.state.type+"&year="+this.state.year;De.a.get(e).then(e=>{this.setState({data:e.data})})},this.loadHeatMap=()=>{if(this.props.editMode)return;let e=30,t=30,a=1e3-(t-0),s=300-(e-30),i=Math.floor(a/24),r=1.5*i,n=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],l=xe.n("#report_heatmap"),o=l.select("g");o.empty()&&(o=l.append("g").attr("transform","translate( "+t+", "+e+" )")),o.selectAll(".dayLabel").data(["Mo","Tu","We","Th","Fr","Sa","Su"]).enter().append("text").text(e=>e).attr("x",0).attr("y",(e,t)=>t*i).style("text-anchor","end").attr("transform","translate( -6, "+i/1.5+" )").attr("class",(e,t)=>t>=0&&t<=4?"dayLabel axis axis-worktime":"dayLabel axis"),o.selectAll(".timeLabel").data(["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"]).enter().append("text").text(e=>e).attr("x",(e,t)=>t*i).attr("y",0).style("text-anchor","middle").attr("transform","translate( "+i/2+", -6 )").attr("class",(e,t)=>t>=7&&t<=16?"timeLabel axis axis-worktime":"timeLabel axis"),l.selectAll(".legend").remove(),l.selectAll(".legend-text").remove();let c=xe.k().domain([0,8,xe.g(this.state.data,e=>e.value)]).range(n),d=o.selectAll(".hour").data(this.state.data,e=>e.day+":"+e.hour);d.append("title"),d.enter().append("rect").style("fill",n[0]).merge(d).attr("x",e=>(e.hour-1)*i).attr("y",e=>(e.day-1)*i).attr("rx",4).attr("ry",4).attr("class","hour").attr("width",i).attr("height",i).transition().duration(1e3).style("fill",e=>c(e.value)),d.select("title").text(e=>e.value),d.exit().remove();var h=o.selectAll(".legend").data([0].concat(c.quantiles()),e=>e);h.enter().append("rect").attr("class","legend").attr("x",(e,t)=>r*t).attr("y",s).attr("width",r).attr("height",i/2).style("fill",(e,t)=>n[t]),h.enter().append("text").text(e=>"\u2265 "+Math.round(e)).attr("class","legend-text").attr("x",(e,t)=>r*t).attr("y",s+i)},this.collectionChange=e=>{this.setState({collection:e.target.value})},this.yearChange=e=>{this.setState({year:e.target.value})},this.exportToPNG=()=>{var e=(new XMLSerializer).serializeToString(document.querySelector("#report_heatmap")),t=document.createElement("canvas"),a=t.getContext("2d"),s=window.self.URL||window.self.webkitURL||window.self,i=new Image,r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=s.createObjectURL(r);i.onload=function(){a.drawImage(i,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',s.revokeObjectURL(e);var r=q()("<a>").attr("href",e).attr("download","img.png").appendTo("body");r[0].click(),r.remove()},i.src=n},this.state={collection:"event",type:"created",year:"2017",data:[]}}componentDidMount(){this.getData(),this.loadHeatMap()}componentDidUpdate(){this.loadHeatMap()}render(){let e=this.props.editMode;return i.a.createElement("div",{className:"dashboard"},!this.props.editMode&&i.a.createElement("h1",null,"Day of Week, Hour of Day Heatmap"),i.a.createElement("label",{htmlFor:"year",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Year = ",i.a.createElement("span",{id:"year-value"}),i.a.createElement("input",{className:"report_input",type:"number",min:"2013",step:"1",value:this.state.year,id:"year",onChange:this.yearChange,disabled:e})),i.a.createElement("label",{htmlFor:"collection",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Collection = ",i.a.createElement("span",{id:"year-value"}),i.a.createElement("select",{id:"collection",value:this.state.collection,onChange:this.collectionChange,disabled:e},i.a.createElement("option",{value:"event"},"event"),i.a.createElement("option",{value:"alert"},"alert"),i.a.createElement("option",{value:"incident"},"incident"))),i.a.createElement(P.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),i.a.createElement("div",{id:"chart"},i.a.createElement("svg",{id:"report_heatmap",viewBox:"0 0 1000 380"})),i.a.createElement("div",{id:"png-container",hidden:!0}))}}var _e=Ne;function Me(e,t=200,a=!1){let s;return function(...i){clearTimeout(s),s=setTimeout(()=>{s=null,a||e.apply(this,i)},t),a&&!s&&e.apply(this,[...i])}}const Ae=e=>{let t=Math.floor(e/86400),a=Math.floor(e%86400/3600),s=Math.floor(e%3600/60),i=Math.floor(e%60)+"s";return s&&(i=s+"m "+i),a&&(i=a+"h "+i),t&&(i=t+"d "+i),i};let je=20,Oe=60,Le=50,Pe=1e3-Le-20,Ie=500-je-Oe,Fe={All:"#3b35a6",Promoted:"#eebd31",Incident:"#e63041"};class Re extends s.PureComponent{constructor(e){super(e),this.initChart=()=>{this.svg=xe.n("#report_art").append("g").attr("transform","translate( "+Le+","+je+" )"),this.xAxisEl=this.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(Ie," )")),this.yAxisEl=this.svg.append("g").attr("class","y axis"),this.yAxisEl.append("text").attr("transform","rotate(-90)").attr("x",0-Ie/2).attr("y",0).attr("dy","1em").style("text-anchor","start").style("fill","black").text("Response Time"),this.chartInit=!0},this.updateChart=()=>{let e=new Set;this.state.chartData.dates.forEach(t=>{t.values.forEach(t=>{e.add(t.name)})});let t=new Set;this.state.chartData.lines.forEach(e=>{t.add(e.name)});let a=xe.g(this.state.chartData.dates,e=>xe.g(e.values,e=>e.value)),s=xe.h().padding(.1).rangeRound([0,Pe]).domain(this.state.chartData.dates.map(e=>e.date)),i=xe.h().domain(Array.from(e)).rangeRound([0,s.bandwidth()]),r=xe.i().clamp(!0).range([Ie,0]).domain([0,a]).nice();var n=xe.a().scale(s),l=xe.b().scale(r).ticks(20).tickFormat(((e,t=10)=>{let a=e[0],s=e[e.length-1],i=xe.o(a,s,t);return e=>{let t=Math.floor(e/86400),a=Math.floor(e%86400/3600),s=Math.floor(e%3600/60),r=Math.floor(e%60);return t?i<86400?"".concat(t,"d ").concat(a,"h"):t+"d":a?i<3600?"".concat(a,"h ").concat(s,"m"):a+"h":s?i<60?"".concat(s,"m ").concat(r,"s"):s+"m":r+"s"}})(r.domain(),20));this.xAxisEl.transition().call(n),this.yAxisEl.transition().call(l);let o=this.svg.selectAll(".date").data(this.state.chartData.dates,e=>e.date);o.exit().transition().style("opacity",0).attr("height",0).attr("y",Ie).remove(),o.enter().append("g").attr("class","date").attr("transform",e=>"translate( ".concat(s(e.date),", 0 )")).selectAll(".bar").data(e=>e.values).enter().append("rect").attr("class","bar").style("fill",e=>Fe[e.name]).attr("width",i.bandwidth()).attr("x",e=>i(e.name)).attr("y",Ie).attr("height",0).append("title").text(e=>Ae(e.value)),o.transition().attr("transform",e=>"translate( ".concat(s(e.date),", 0 )")),this.svg.selectAll(".date").selectAll(".bar").transition().attr("width",i.bandwidth()).attr("x",e=>i(e.name)).attr("y",e=>r(e.value)).attr("height",e=>Ie-r(e.value)),this.svg.select(".avg-holder").remove(),this.svg.select(".avg-holder-border").remove();let c=this.svg.append("g").attr("class","avg-holder"),d=c.selectAll(".avg").data(this.state.chartData.lines).enter().append("text").attr("class","avg").attr("transform",(e,t)=>"translate( 0, ".concat(15*t," )"));d.append("tspan").attr("x",0).attr("font-weight","bold").text(e=>"".concat(e.name,":")),d.append("tspan").attr("x",100).text(e=>Ae(e.value));let h=c.node().getBBox();c.attr("transform","translate( ".concat(Pe-h.width,", 0 )"));this.svg.append("rect").attr("fill","none").attr("stroke","black").attr("class","avg-holder-border").attr("x",h.x-2).attr("y",h.y-2).attr("width",h.width+4).attr("height",h.height+4).node().transform.baseVal.initialize(c.node().transform.baseVal.getItem(0));this.svg.select(".legend-holder").remove();let p=this.svg.append("g").attr("class","legend-holder"),u=p.selectAll(".legend").data(Array.from(e)).enter().append("g").attr("class","legend");u.append("rect").attr("width",20).attr("x",0).attr("y",0).attr("height",20).style("fill",e=>Fe[e]),u.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").text(e=>e);let m=0;p.selectAll(".legend").attr("transform",(function(e,t){let a=m;return m+=this.getBBox().width+15,"translate( ".concat(a,", 0 )")}));let g=p.node().getBBox().width;p.attr("transform","translate( ".concat(Pe/2-g/2,", ").concat(Ie+Oe/2," )"))},this.loadArt=()=>{if(!this.state.date||!this.state.length||this.props.editMode)return;let e="?days=".concat(this.state.length,"&targetdate=").concat(this.state.date,"&unit=").concat(this.state.unit);De.a.get("/scot/api/v2/metric/response_avg_last_x_days"+e).then(e=>{this.setState({chartData:e.data})})},this.unitChange=e=>{this.setState({unit:e.target.value},()=>this.loadArt())},this.lengthChange=e=>{this.setState({length:e.target.value},()=>this.loadArt())},this.dateChange=e=>{this.setState({date:e.target.value},()=>this.loadArt())},this.exportToPNG=()=>{var e=(new XMLSerializer).serializeToString(document.querySelector("#report_art")),t=document.createElement("canvas"),a=t.getContext("2d"),s=window.self.URL||window.self.webkitURL||window.self,i=new Image,r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=s.createObjectURL(r);i.onload=function(){a.drawImage(i,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',s.revokeObjectURL(e);var r=q()("<a>").attr("href",e).attr("download","img.png").appendTo("body");r[0].click(),r.remove()},i.src=n};let t=(new Date).toISOString().slice(0,10);this.state={length:7,date:t,unit:"day",chartData:{dates:[],lines:[]}},this.loadArt=Me(this.loadArt)}componentDidMount(){this.initChart(),this.loadArt()}componentDidUpdate(){}render(){this.chartInit&&this.updateChart();let e=this.props.editMode;return i.a.createElement("div",{className:"dashboard"},!this.props.editMode&&i.a.createElement("h1",null,"Alert Response Time"),i.a.createElement("label",{htmlFor:"date",style:{display:"inline-block",textAlign:"right"}},"Initial Date =\xa0",i.a.createElement("input",{className:"report_input",type:"date",value:this.state.date,onChange:this.dateChange,placeholder:"yyyy-mm-dd",pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}",disabled:e})),i.a.createElement("label",{htmlFor:"length",style:{display:"inline-block",textAlign:"right"}},"Length =\xa0",i.a.createElement("input",{className:"report_name",type:"number",min:"1",step:"1",value:this.state.length,id:"length",onChange:this.lengthChange,disabled:e})),i.a.createElement("label",{htmlFor:"unit",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Unit =\xa0",i.a.createElement("select",{id:"unit",value:this.state.unit,onChange:this.unitChange,disabled:!0},i.a.createElement("option",{value:"hour"},"hourly"),i.a.createElement("option",{value:"day"},"daily"),i.a.createElement("option",{value:"month"},"monthly"),i.a.createElement("option",{value:"year"},"yearly"))),i.a.createElement(P.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),i.a.createElement("div",{id:"chart"},i.a.createElement("svg",{id:"report_art",viewBox:"0 0 1000 500"})),i.a.createElement("div",{id:"png-container",hidden:!0}))}}var Ue=Re;const He=(e,t)=>{e.each((function(e,a){if(this.getComputedTextLength()<t)return;let s=xe.n(this),i=s.text().split(/\s+/).reverse(),r=null,n=[],l=1,o=s.attr("x"),c=s.attr("y"),d=parseFloat(s.attr("dy")),h=s.text(null).append("tspan").attr("x",o).attr("y",c).attr("dy",d+"em");for(;r=i.pop();)n.push(r),h.text(n.join(" ")),h.node().getComputedTextLength()>t&&(l++,n.pop(),h.text(n.join(" ")),n=[r],h=s.append("tspan").attr("x",o).attr("y",c).attr("dy",.8+d+"em").text(r));let p=this.getBBox().height/(2*l)*(l-1);s.attr("transform","translate( 0, -".concat(p," )"))}))},We=5,Be=200,Ve=60,ze=1e3-Be-30;class qe extends s.PureComponent{constructor(e){super(e),this.initChart=()=>{this.height=0,this.xScale=xe.i().rangeRound([0,ze]),this.yScale=xe.h().rangeRound([0,this.height]).padding(.3),this.colors=xe.j(xe.m),this.xAxis=xe.a().scale(this.xScale),this.yAxis=xe.b().scale(this.yScale),this.svg=xe.n("#report_alertpower").attr("viewBox","0 0 1000 ".concat(this.height+We+Ve)).append("g").attr("transform","translate( ".concat(Be,", ").concat(We," )")),this.yAxisEl=this.svg.append("g").attr("class","y axis"),this.xAxisEl=this.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(this.height," )")),this.xAxisEl.append("text").attr("text-anchor","middle").attr("x",ze/2).attr("y",30).style("fill","black").style("font-size","12px").text("Alert Count"),this.LegendHolder=this.svg.append("g").attr("class","legend-holder"),this.chartInit=!0},this.updateChart=()=>{let e=this.state.chartData;this.height=32*e.length,xe.n("#report_alertpower").transition().attr("viewBox","0 0 1000 ".concat(this.height+We+Ve)),this.dataTypes=xe.e(e[0]).filter(e=>!["name","values","total","score","max"].includes(e)),this.colors.domain(this.dataTypes),e.forEach(e=>{e.name=e.name.replace(/ \([0-9]+\)/,""),"number"===typeof e.score&&(e.score=""+e.score);let t=0;e.values=this.dataTypes.map(a=>{let s=t,i=t+e[a];return t+=e[a],{name:a,count:e[a],start:s,end:i}}),e.total=e.values[e.values.length-1].end,e.max=xe.g(this.dataTypes,t=>e[t])}),this.stackedMax=xe.g(e,e=>e.total),this.groupedMax=xe.g(e,e=>xe.g(this.dataTypes,t=>e[t])),this.yScale.rangeRound([0,this.height]).domain(e.map(e=>e.name)),this.yAxisEl.call(this.yAxis),this.svg.selectAll(".y.axis .tick text").call(He,Be-20);let t=this.svg.selectAll(".alert").data(e,e=>e.name);t.exit().transition().attr("height",0).style("opacity",0).remove(),t.enter().append("g").attr("class","alert").attr("transform",e=>"translate( 1, ".concat(this.yScale(e.name)," )")).append("text").attr("dy","1.2em"),t.transition().attr("transform",e=>"translate( 1, ".concat(this.yScale(e.name)," )"));let a=this.svg.selectAll(".alert").selectAll("rect").data(e=>e.values),s=a.enter().append("rect").attr("x",0).attr("y",0).attr("width",0).attr("height",this.yScale.bandwidth());s.merge(a).style("fill",e=>this.colors(e.name)),s.append("title").merge(a.select("title")).text(e=>"".concat(e.name,": ").concat(e.count));let i=this.LegendHolder.selectAll(".legend").data(this.dataTypes);i.exit().remove(),i=i.enter().append("g").attr("class","legend"),i.append("rect").attr("width",20).attr("x",0).attr("y",0).attr("height",20).style("fill",e=>this.colors(e)),i.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text(e=>e);let r=0;this.LegendHolder.selectAll(".legend").attr("transform",(function(e,t){let a=r;return r+=this.getBBox().width+15,"translate( ".concat(a,", 0 )")}));let n=this.LegendHolder.node().getBBox().width;this.LegendHolder.transition().attr("transform","translate( ".concat(ze/2-n/2,", ").concat(this.height+Ve-20," )")),"grouped"===this.state.displayMode?this.transitionGrouped():this.transitionStacked()},this.transitionStacked=()=>{this.xScale.domain([0,this.stackedMax]).nice(),this.xAxisEl.transition().call(this.xAxis).attr("transform","translate( 0, ".concat(this.height," )")),this.svg.selectAll(".alert rect").transition().delay((e,t)=>5*t).duration(500).attr("width",e=>this.xScale(e.end)-this.xScale(e.start)).attr("x",e=>this.xScale(e.start)).transition().attr("height",this.yScale.bandwidth()).attr("y",0),this.svg.selectAll(".alert text").transition().delay((e,t)=>t*this.dataTypes.length*5+t).duration(500).attr("transform",e=>"translate( ".concat(this.xScale(e.total)+10,", 0 )")).tween("text",(function(e){let t=xe.n(this),a=xe.d(t.text(),e.score),s=e.score.split("."),i=s.length>1?Math.pow(10,s[0].length):1;return e=>t.text(Math.round(a(e)*i)/i)}))},this.transitionGrouped=()=>{this.xScale.domain([0,this.groupedMax]).nice(),this.xAxisEl.transition().call(this.xAxis).attr("transform","translate( 0, ".concat(this.height," )"));let e=this.displayModeChanged?500:0;this.svg.selectAll(".alert").selectAll("rect").transition().delay((e,t)=>5*t).duration(e).attr("height",this.yScale.bandwidth()/this.dataTypes.length).attr("y",(e,t)=>this.yScale.bandwidth()/this.dataTypes.length*t).transition().duration(500).attr("x",0).attr("width",e=>this.xScale(e.end)-this.xScale(e.start)),this.svg.selectAll(".alert text").transition().delay((t,a)=>5*a+e).attr("transform",e=>"translate( ".concat(this.xScale(e.max)+10,", 0 )")).tween("text",(function(e){let t=xe.n(this),a=xe.d(t.text(),e.score),s=e.score.split("."),i=s.length>1?Math.pow(10,s[0].length):1;return e=>t.text(Math.round(a(e)*i)/i)})),this.displayModeChanged=!1},this.loadData=()=>{if(!this.state.chartResults||this.props.editMode)return;let e="?sort=".concat(this.state.chartSort,"&dir=").concat(this.state.chartSortDir,"&count=").concat(this.state.chartResults,"&filter=").concat(encodeURIComponent(this.state.chartFilter));De.a.get("/scot/api/v2/metric/alert_power"+e).then(e=>{this.setState({chartData:e.data})})},this.dataChange=e=>{let t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),this.setState({[t.name]:t.value},this.loadData)},this.displayModeChang=e=>{this.displayModeChanged=!0,this.setState({displayMode:e.target.value})},this.preventSubmit=e=>{e.preventDefault(),e.stopPropagation()},this.exportToPNG=()=>{var e=(new XMLSerializer).serializeToString(document.querySelector("#report_alertpower")),t=document.createElement("canvas"),a=t.getContext("2d"),s=window.self.URL||window.self.webkitURL||window.self,i=new Image,r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=s.createObjectURL(r);i.onload=function(){a.drawImage(i,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),s.revokeObjectURL(e);var r=q()("<a>").attr("href",e).attr("download","img.png").appendTo("body");r[0].click(),r.remove()},i.src=n},this.state={displayMode:"stacked",chartData:[],chartResults:20,chartSort:"power",chartSortDir:"desc",chartFilter:""},this.loadData=Me(this.loadData)}componentDidMount(){this.initChart(),this.updateChart(),this.loadData()}render(){this.chartInit&&this.updateChart();let e=this.props.editMode;return i.a.createElement("div",{className:"dashboard"},!this.props.editMode&&i.a.createElement("h1",null,"Alert Power"),i.a.createElement("form",{onSubmit:this.preventSubmit},i.a.createElement("label",null,"Filter =\xa0",i.a.createElement("input",{className:"report_input",type:"text",style:{background:"initial",border:"1px solid #ccc"},name:"chartFilter",value:this.state.chartFilter,onChange:this.dataChange,placeholder:"All",disabled:e}))),i.a.createElement("form",{onSubmit:this.preventSubmit},i.a.createElement("label",null,"Sort by =\xa0",i.a.createElement("select",{name:"chartSort",value:this.state.chartSort,onChange:this.dataChange,disabled:e},i.a.createElement("option",{value:"power"},"Power Score"),i.a.createElement("option",{value:"count"},"Alert Count"),i.a.createElement("option",{value:"promoted"},"Promoted Count"),i.a.createElement("option",{value:"incident"},"Incident Count")),i.a.createElement("select",{name:"chartSortDir",value:this.state.chartSortDir,onChange:this.dataChange,disabled:e},i.a.createElement("option",{value:"desc"},"Desc"),i.a.createElement("option",{value:"asc"},"Asc"))),i.a.createElement("label",null,"Results =\xa0",i.a.createElement("input",{className:"report_input",type:"number",min:1,max:50,name:"chartResults",value:this.state.chartResults,onChange:this.dataChange,disabled:e}))),i.a.createElement("form",null,i.a.createElement("label",null,i.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"grouped",checked:"grouped"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Grouped"),"\xa0",i.a.createElement("label",null,i.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"stacked",checked:"stacked"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Stacked"),i.a.createElement(P.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),i.a.createElement("div",{id:"chart"},i.a.createElement("svg",{id:"report_alertpower",viewBox:"0 0 1000 100"})),i.a.createElement("div",{id:"png-container",hidden:!0}))}}var Ke=qe;const Ge=5,Je=40,Ye=60,Qe=1e3-Je-20,Xe=600-Ge-Ye;class $e extends s.Component{constructor(e){super(e),this.initChart=()=>{let e=new Date;this.xScale=xe.l().rangeRound([0,Qe]).domain([e-6048e5,e]),this.yScale=xe.i().rangeRound([Xe,0]).domain([0,0]),this.xAxis=xe.a().scale(this.xScale),this.yAxis=xe.b().scale(this.yScale),this.svg=xe.n("#report_created").attr("viewBox","0 0 1000 ".concat(Xe+Ge+Ye)).append("g").attr("transform","translate( ".concat(Je,", ").concat(Ge," )")),this.yAxisEl=this.svg.append("g").attr("class","y axis"),this.yAxisEl.call(this.yAxis),this.xAxisEl=this.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(Xe," )")),this.xAxisEl.append("text").attr("text-anchor","middle").attr("x",Qe/2).attr("y",Ye-10).style("font-size","10px").style("fill","black").text("Toggle Trendlines"),this.xAxisEl.call(this.xAxis),this.statusLine=xe.f().curve(xe.c).x(e=>this.xScale(new Date(1e3*e.time))).y(e=>this.yScale(e.value)),this.lineHolder=this.svg.append("g").attr("class","lines").attr("clip-path","url(#bounds)"),this.LegendHolder=this.svg.append("g").attr("class","legend-holder").style("font-family","sans-serif"),this.chartInit=!0},this.updateChart=()=>{this.yScale.domain([0,Math.max(xe.g(this.state.chartData,e=>e.shown&&e.data.length?xe.g(e.data,e=>e.value):0),10)]).nice(),this.colors=xe.j(xe.m).domain(this.state.chartData.map(e=>e.name));let e=this.lineHolder.selectAll(".line").data(this.state.chartData,e=>e.name);e.exit().transition().style("opacity",0).remove(),e.enter().append("path").attr("class",e=>"line ".concat(e.name)).style("stroke",e=>this.colors(e.name)).style("stroke-width",2).style("fill","none").attr("d",e=>this.statusLine(e.data)),this.LegendHolder.selectAll(".legend").remove();let t=this.LegendHolder.selectAll(".legend").data(this.state.chartData,e=>e.name);t=t.enter().append("g").attr("class","legend").style("cursor","pointer").on("click",e=>{let t=this.state.chartData.map(t=>(t.name===e.name&&(t.shown=!e.shown),t));console.log("newData = ".concat(t)),this.setState({chartData:t})}),t.append("rect").attr("width",20).attr("x",0).attr("y",7.5).attr("height",5).style("fill",e=>e.shown?this.colors(e.name):"transparent").style("stroke",e=>this.colors(e.name)).style("stroke-width",1),t.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text(e=>e.name).append("title").text(e=>"Toggle ".concat(e.name," line"));let a=0;this.LegendHolder.selectAll(".legend").attr("transform",(function(e,t){let s=a;return a+=this.getBBox().width+15,"translate( ".concat(s,", 0 )")}));let s=this.LegendHolder.node().getBBox().width;this.LegendHolder.attr("transform","translate( ".concat(Qe/2-s/2,", ").concat(Xe+Ye-40," )")),this.yAxisEl.transition().call(this.yAxis),e.transition().attr("d",e=>this.statusLine(e.data)).style("stroke",e=>e.shown?this.colors(e.name):"transparent")},this.loadData=()=>{if(this.props.editMode){let e=this.genData();return e=e.map(e=>(e.shown=this.state.chartData.reduce((t,a)=>t&&(a.name!==e.name||a.shown),!0),e)),void this.setState({chartData:e})}De.a.get("/scot/api/v2/metric/create_histo?range=7").then(e=>{try{console.log(e),e=e.data.map(e=>(e.shown=this.state.chartData.reduce((t,a)=>t&&(a.name!==e.name||a.shown),!0),e)),this.setState({chartData:e})}catch(t){console.log("Malformed data"),console.log(e),console.error(t)}})},this.genData=()=>{let e={alerts:5e3,alertgroups:500,entries:100,events:15,intel:5,incidents:5},t=new Date,a=new Date(Date.now()-6048e5),s=[];for(["alerts","alertgroups","events","incidents","entries","intel"].forEach(e=>{s.push({name:e,data:[]})});a<=t;a=new Date(a.getTime()+216e5))s.forEach(t=>{t.data.push({time:a.getTime()/1e3,value:Math.random()*e[t.name]})});return s},this.exportToPNG=()=>{var e=(new XMLSerializer).serializeToString(document.querySelector("#report_created")),t=document.createElement("canvas"),a=t.getContext("2d"),s=window.self.URL||window.self.webkitURL||window.self,i=new Image,r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=s.createObjectURL(r);i.onload=function(){a.drawImage(i,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),s.revokeObjectURL(e);var r=q()("<a>").attr("href",e).attr("download","img.png").appendTo("body");r[0].click(),r.remove()},i.src=n},this.state={chartData:[]},this.loadData=Me(this.loadData)}componentDidMount(){this.initChart(),this.loadData()}dataChange(e){let t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),this.setState({[t.name]:t.value},this.loadData)}render(){this.chartInit&&this.updateChart();let e=this.props.editMode;return i.a.createElement("div",{className:"dashboard"},!this.props.editMode&&i.a.createElement("h1",null,"Items Created"),i.a.createElement("form",null,i.a.createElement(P.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),i.a.createElement("div",{id:"chart"},i.a.createElement("svg",{id:"report_created",viewBox:"0 0 1000 600"})),i.a.createElement("div",{id:"png-container",hidden:!0}))}}var Ze=$e;const et=e=>{switch(e){default:case"heatmap":return _e;case"alertpower":return Ke;case"art":return Ue;case"created":return Ze}},tt=e=>{switch(e){default:case"heatmap":return"Heatmap";case"alertpower":return"Alert Power";case"art":return"Alert Response Time";case"created":return"Items Created"}},at=e=>{switch(e){default:case"heatmap":return"Heatmap of incoming alerts, event, and incidents";case"alertpower":return"Chart of alerts in terms of how frequently they're promoted or become incidents";case"art":return"Chart of average alert, event, and incident response time";case"created":return"Chart of newly created items"}},st=(e,t=!1,a=!1)=>i.a.createElement("div",{style:{position:"relative"}},tt(e),t&&i.a.createElement(ke.Link,{to:"/reports/".concat(e),className:"panel-button right"},i.a.createElement(P.a,{bsSize:"small"},i.a.createElement("i",{className:"fa fa-external-link","aria-hidden":!0}))),a&&i.a.createElement(ke.Link,{to:"/reports",className:"panel-button left"},i.a.createElement(P.a,{bsSize:"small"},i.a.createElement("i",{className:"fa fa-arrow-left","aria-hidden":!0})))),it=()=>i.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("h2",null,"Reports")),i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"col-md-6"},i.a.createElement(I.a,{header:st("heatmap",!0)},i.a.createElement(_e,null)),i.a.createElement(I.a,{header:st("alertpower",!0)},i.a.createElement(Ke,null))),i.a.createElement("div",{className:"col-md-6"},i.a.createElement(I.a,{header:st("art",!0)},i.a.createElement(Ue,null)),i.a.createElement(I.a,{header:st("created",!0)},i.a.createElement(Ze,null))))),rt=({reportType:e="heatmap"})=>i.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},i.a.createElement("div",{className:"container"},i.a.createElement(I.a,{header:st(e,!1,!0)},(e=>{switch(e){default:case"heatmap":return i.a.createElement(_e,null);case"alertpower":return i.a.createElement(Ke,null);case"art":return i.a.createElement(Ue,null);case"created":return i.a.createElement(Ze,null)}})(e))));var nt=a(985),lt=a(948),ot=a(11);var ct=Object(ot.a)(e=>({progress:{margin:2*e.spacing.unit}}))((function(e){const t=e.classes,a=e.loading;return i.a.createElement("div",{className:"LoadingContainer"},a&&i.a.createElement(lt.a,{className:t.progress}))}));class dt extends s.PureComponent{constructor(e){super(e),this.state={data:[],loading:!1}}fetchData(){this.setState({loading:!0});let e=q.a.extend(!0,{},this.props.queryOptions);e.sort&&(e.sort=JSON.stringify(e.sort)),e.filter&&(e=Object(v.a)(Object(v.a)({},e),e.filter),delete e.filter),this.props.newBadge&&e.columns.push("created"),q.a.ajaxSetup({traditional:!0}),q.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.thingType,data:e}).then(e=>{this.setState({data:this.props.processData(e.records),loading:!1})},e=>{this.props.errorToggle("Failed to fetch data: "+e),this.setState({loading:!1})})}componentDidMount(){this.props.editMode||this.fetchData()}genThingItem(e,t){return i.a.createElement(ke.Link,{key:t,to:this.props.getLink(this.props.thingType,e),className:"list-group-item"},this.props.getSummary(e),this.props.newBadge&&(a=e.created,!he(1e3*a,86400))&&i.a.createElement(re.a,{bsStyle:"primary"},"New!"),i.a.createElement("i",{className:"fa fa-angle-right"}));var a}render(){let e=this.state.data.map((e,t)=>this.genThingItem(e,t));return this.props.editMode?e=[1,2,3,4,5].map(e=>i.a.createElement("div",{className:"list-group-item"},this.props.thingType," - ",e)):0===e.length&&(e=i.a.createElement("div",{className:"list-group-item list-group-item-".concat(this.props.emptyStyle)},this.props.emptyString)),i.a.createElement("div",{className:"ThingList"},!this.props.editMode&&i.a.createElement("h1",null,this.props.title),this.state.loading?i.a.createElement(ct,{loading:!0}):i.a.createElement(nt.a,null,e))}}dt.defaultProps={queryOptions:{limit:5,offset:0,sort:{id:-1},columns:["id","subject"]},processData:e=>e,getSummary:e=>e.subject,getLink:(e,t)=>"".concat(e,"/").concat(t.id),emptyString:"No Data",emptyStyle:"warning",newBadge:!0};const ht={intel:{type:dt,title:"Recent Intel",description:"List of the 5 most recent Intel entries",props:{thingType:"intel",title:"Recent Intel"}}},pt={events:{type:dt,title:"Recent Events",description:"List of the 5 most recent events",props:{thingType:"event",title:"Recent Events"}}},ut={incidents:{type:dt,title:"Recent Incidents",description:"List of the 5 most recent Incidents",props:{thingType:"incident",title:"Recent Incidents"}}},mt={tasks:{type:dt,title:"Open Tasks",description:"List of recent open tasks",props:{thingType:"task",title:"Open Tasks",queryOptions:{limit:5,offset:0,sort:{updated:-1},filter:{"metadata.task.status":"open"},columns:["id","body_plain","target"]},getSummary:e=>e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain,getLink:(e,t)=>{let a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None",emptyStyle:"info"}}},gt={yourTasks:{type:dt,title:"Your Tasks",description:"List of open tasks that you own",props:{thingType:"task",title:"Your Tasks",queryOptions:{limit:5,offset:0,sort:{updated:1},filter:{"metadata.task.status":"open",owner:se("whoami")},columns:["id","body_plain","target"]},getSummary:e=>e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain,getLink:(e,t)=>{let a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None!",emptyStyle:"success"}}},yt={unviewedAlerts:{type:dt,title:"Unviewed Alerts",description:"Recent alerts with zero views",props:{thingType:"alertgroup",title:"Unviewed Alerts",queryOptions:{limit:5,offset:0,sort:{id:-1},filter:{created:JSON.stringify(me(pe())),views:0},columns:["id","subject"]},newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},ft={topEvents:{type:dt,title:"Important Events",description:"Recent Events with open tasks",props:{thingType:"event",title:"Important Events",queryOptions:{limit:5,offset:0,sort:{has_tasks:1},filter:{created:JSON.stringify(me(pe()))},columns:["id","subject","has_tasks"]},processData:e=>e.filter(e=>e.has_tasks),getSummary:e=>"".concat(e.subject," (").concat(e.has_tasks," open task").concat(e.has_tasks>1?"s":"",")"),newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},bt={viewedEvents:{type:dt,title:"Most Viewed Events",description:"Events with the most views over the last week",props:{thingType:"event",title:"Most Viewed Events",queryOptions:{limit:5,offset:0,sort:{views:-1},filter:{created:JSON.stringify(me(ue()))},columns:["id","subject","views"]},processData:e=>e.filter(e=>e.views>0),getSummary:e=>"".concat(e.subject," (").concat(e.views," view").concat(e.views>1?"s":"",")")}}},vt={entryEvents:{type:dt,title:"Events with Entries",description:"Events with the most entries over the last week",props:{thingType:"event",title:"Events with Entries",queryOptions:{limit:5,offset:0,sort:{entry_count:-1},filter:{created:JSON.stringify(me(ue()))},columns:["id","subject","entry_count"]},processData:e=>e.filter(e=>e.entry_count>0),getSummary:e=>"".concat(e.subject," (").concat(e.entry_count," ").concat(e.entry_count>1?"entries":"entry",")")}}},Et=Object(v.a)(Object(v.a)({},Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)({},ht),pt),ut),mt),gt),yt),ft),bt),vt)),(()=>{let e={};for(var t=0,a=["heatmap","art","alertpower","created"];t<a.length;t++){let s=a[t];e[s]={type:et(s),title:tt(s),description:at(s)}}return e})());class wt extends s.PureComponent{constructor(e){super(e),this.state={_isMounted:!1},this.switchTab=this.switchTab.bind(this),this.closeTab=this.closeTab.bind(this),this.saveTab=this.saveTab.bind(this)}defaultTab(){const e=q.a.extend(!0,{},W);return e.rows[0].columns[0].widgets.push({key:"heatmap"}),e.rows[0].columns[1].widgets.push({key:"art"}),e.rows[0].columns[2].widgets.push({key:"created"}),{title:"Default",layout:i.a.createElement(B,{widgets:Et,title:"Default",layout:e,errorToggle:this.props.errorToggle})}}newTab(){let e=[...this.props.userConfig.config.tabs];e.push({}),this.updateDashboardConfig({curTab:e.length,tabs:e})}buildTab(e,t){let a=i.a.createElement(B,{widgets:Et,title:e.title,layout:e.layout,saveDashboard:(e,a)=>{this.saveTab(t,e,a)},isNew:null==e.layout,errorToggle:this.props.errorToggle});return{title:e.title,layout:a}}saveTab(e,t,a){let s=[...this.props.userConfig.config.tabs],i={title:t,layout:a};s[e]=i,this.updateDashboardConfig({tabs:s})}closeTab(e){if(e<1)return;let t=[...this.props.userConfig.config.tabs];t.splice(e-1,1),this.updateDashboardConfig({curTab:e-1,tabs:t})}switchTab(e){e!==this.props.userConfig.config.curTab&&("new"!==e?this.updateDashboardConfig({curTab:e}):this.newTab())}updateDashboardConfig(e){const t=this.props.userConfig.config;this.props.userConfig.setUserConfig(Object(v.a)(Object(v.a)({},t),e))}render(){if(!this.props.loggedIn||this.props.userConfig.loading)return i.a.createElement("div",{className:"homePageDisplay"},i.a.createElement("div",{className:"home-grid loggedOut"},i.a.createElement("div",{className:"title-area"},i.a.createElement("h1",null,"Sandia Cyber Omni Tracker",i.a.createElement("br",null),"3.5"))));const e=i.a.createElement("div",{className:"home-grid"},i.a.createElement("div",{className:"title-area"}),i.a.createElement(J,{className:"status-area"}),i.a.createElement("div",{className:"game-area"},i.a.createElement(te,null)),i.a.createElement(Te,{createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,className:"activity-area"})),t=this.props.userConfig.config,a=t.tabs;let s=[];s.push(this.defaultTab());let r=0;var n,l=Object(b.a)(a);try{for(l.s();!(n=l.n()).done;){let e=n.value;s.push(this.buildTab(e,r++))}}catch(d){l.e(d)}finally{l.f()}let o=s.map((e,a)=>{let s=e.title,r=void 0===s?"New Dashboard":s;e.layout,Object(f.a)(e,["title","layout"]);return i.a.createElement(E.a,{eventKey:a,key:a},r,a===t.curTab&&0!==a&&i.a.createElement("span",{onClick:()=>this.closeTab(a)},"\xa0",i.a.createElement("i",{className:"fa fa-times",style:{cursor:"pointer"}})))});o.push(i.a.createElement(E.a,{eventKey:"new",key:"new"},"+"));const c=s.map((e,t)=>{e.title;let a=e.layout,s=Object(f.a)(e,["title","layout"]);return i.a.createElement(w.a.Pane,Object.assign({eventKey:t,key:t},s),a)});return i.a.createElement("div",{className:"homePageDisplay"},i.a.createElement(w.a.Container,{id:"DashboardTabs",activeKey:t.curTab,onSelect:this.switchTab},i.a.createElement(S.a,null,i.a.createElement(T.a,{sm:12},i.a.createElement(k.a,{bsStyle:"tabs"},o)),i.a.createElement(T.a,{sm:12},i.a.createElement(w.a.Content,{mountOnEnter:!0,unmountOnExit:!0},e,c)))))}}var St,Tt=(St={key:"dashboard",default:{curTab:0,tabs:[]}},C.a.checkPropTypes(_,St,"argument","withUserConfig"),e=>{class t extends s.PureComponent{constructor(e){super(e),this.state={},this.setUserSubConfig=this.setUserSubConfig.bind(this)}setUserSubConfig(e){let t=Object(v.a)({},this.props.userConfig);t[St.key]=e,this.context.setUserConfig(t)}render(){let t=this.props,a=t.userConfig,s=Object(f.a)(t,["userConfig"]),r=a[St.key]||St.default;const n={userConfig:{loading:!0===a.loading,config:r,setUserConfig:this.setUserSubConfig,getUserConfig:this.context.getUserConfig}};return i.a.createElement(e,Object.assign({},s,n))}}return t.contextTypes=M,t.displayName="withUserConfig(".concat(Object(D.a)(e),")"),e=>i.a.createElement(N.b,{channel:"userConfig"},a=>i.a.createElement(t,Object.assign({userConfig:a},e)))})(wt);const kt=e=>{let t=xt(e);if(""!==t)return t},xt=e=>{let t=e+"=",a=document.cookie.split(";");for(let s=0;s<a.length;s++){let e=a[s];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t))return e.substring(t.length,e.length)}return""},Ct=e=>{document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"},Dt=(e,t,a)=>{let s=new Date;s.setTime(s.getTime()+24*a*60*60*1e3);let i="expires="+s.toUTCString();document.cookie=e+"="+t+"; "+i};var Nt=a(428),_t=a.n(Nt),Mt=a(273),At=a.n(Mt);class jt extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{q()(document).keyup(function(e){void 0!==q()("#main-search-results")[0]&&27===e.keyCode&&(this.closeSearch(),e.preventDefault())}.bind(this))},this.closeSearch=()=>{this.setState({showSearchToolbar:!1,searchString:""})},this.doSearch=e=>{q.a.ajax({type:"get",url:"/scot/api/v2/esearch",data:{qstring:e},success:function(t){e===q()("#main-search")[0].value&&this.setState({results:t.records,showSearchToolbar:!0,searching:!1,searchString:e})}.bind(this),error:function(){this.setState({searching:!1})}.bind(this)}),this.setState({searching:!0})},this.handleEnterKey=e=>{"Enter"===e.key&&this.doSearch(e.target.value)},this.onChange=e=>{this.doSearch(e.target.value)},this.componentDidUpdate=()=>{this.state.searchString},this.render=()=>{let e=[];if(void 0!==this.state.results)if(void 0!==this.state.results[0])for(let t=0;t<this.state.results.length;t++)e.push(i.a.createElement(Lt,{dataOne:this.state.results[t],key:t,index:t,searchString:this.state.searchString}));else e.push(i.a.createElement("div",{style:{display:"inline-flex"}},i.a.createElement("div",{style:{display:"flex"}},"No results returned")));return i.a.createElement("div",{className:"esearch",style:{zIndex:"100"}},i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("input",{id:"main-search",className:"esearch-query",style:{marginTop:"3px",padding:"10px 10px",float:"right",position:"relative",color:"black"},placeholder:"\uf002 Search",charSet:"utf-8",onKeyPress:this.handleEnterKey,onChange:this.onChange}),this.state.searching?i.a.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw",style:{color:"white"}}):null),this.state.showSearchToolbar?i.a.createElement("div",{id:"main-search-results",style:{display:"flex",flexFlow:"row",position:"absolute",right:"10px",top:"53px",background:"#f3f3f3",border:"black",borderStyle:"solid"}},i.a.createElement("div",null,i.a.createElement(Ot,{closeSearch:this.closeSearch}),i.a.createElement("div",{style:{overflowY:"auto",maxHeight:"600px",display:"table-caption"}},e))):null)},this.componentWillUnmount=()=>{q()(document).off("keypress")},this.state={showSearchToolbar:!1,searchResults:null,entityHeight:"60vh",searching:!1,searchString:""}}}class Ot extends i.a.Component{constructor(...e){super(...e),this.render=()=>i.a.createElement("div",{className:"table-row header",style:{color:"black",display:"flex"}},i.a.createElement("div",{style:{flexGrow:1,display:"flex"}},i.a.createElement("div",{style:{width:"100%",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},"Search Results - Score Displayed",i.a.createElement("i",{className:"fa fa-times pull-right",style:{color:"red",margin:"2px",cursor:"pointer"},onClick:this.props.closeSearch}))))}}class Lt extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=this.props.dataOne.type,t=this.props.dataOne.id,a=this.props.dataOne.entryid,s=this.props.dataOne.score,r=[],n="even";this.props.index%2!==0&&(n="odd");let l="search_result_row list-view-row"+n,o="/"+e+"/"+t;if(void 0!==a&&(o="/"+e+"/"+t+"/"+a),void 0!==this.props.dataOne.highlight)if("string"===typeof this.props.dataOne.highlight)r.push(i.a.createElement("span",{className:"search_snippet_container panel col"},i.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),i.a.createElement("span",{className:"search_snippet_result"},this.props.dataOne.highlight)));else if(q.a.isArray(this.props.dataOne.highlight))r.push(i.a.createElement("span",{className:"search_snippet_container panel col"},i.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),i.a.createElement("span",{className:"search_snippet_result"},this.props.dataOne.highlight[0])));else for(let c in this.props.dataOne.highlight){let e=this.props.searchString.split(" ");r.push(i.a.createElement(_t.a,{activeClassName:At.a.Active,highlightClassName:"search_snippet_result",className:"search_snippet_result",searchWords:e,autoEscape:!0,textToHighlight:this.props.dataOne.highlight[c][0],highlightClassName:At.a.Highlight,highlightStyle:{backgroundColor:"yellow"}}))}return i.a.createElement("div",{key:Date.now(),className:l},i.a.createElement(ke.Link,{to:o,style:{display:"flex"}},i.a.createElement("span",{className:"panel panel-default",style:{display:"flex",flexFlow:"column",borderColor:"black",borderWidth:"thin",margin:"0px"}},i.a.createElement("div",{className:"panel-heading h4 search-heading"},e," ",t," - ",s),i.a.createElement("div",{className:"search-snippet",style:{display:"flex",overflowX:"hidden",wordWrap:"break-word"}},i.a.createElement("span",{className:"container-fluid",style:{textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",width:"600px"}},r)))))}}}let Pt=a(9);class It extends i.a.Component{constructor(e){super(e),this.sendWallMessage=()=>{if(""===this.state.wallMessage)alert("Please enter text"),this.setState({buttonStatus:"warning"});else{this.setState({buttonText:"Loading",buttonLoading:!0});let e={msg:this.state.wallMessage};q.a.ajax({type:"post",url:"scot/api/v2/wall",data:e,traditional:!0,success:function(){this.setState({buttonStatus:"success",buttonText:"Sent",buttonLoading:!1})}.bind(this),error:function(e){this.setState({buttonStatus:"danger",buttonText:"Failed - Try Again?",buttonLoading:!1}),this.props.errorToggle("Failed to send message",e)}.bind(this)})}},this.inputChange=e=>{this.setState({wallMessage:e.target.value})},this.render=()=>i.a.createElement("div",{className:"allComponents",style:{"margin-left":"17px"}},i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("div",{className:"main-header-info-child"},i.a.createElement("h2",{htmlFor:"message"},"Message to all SCOT users:"),i.a.createElement("input",{id:"message",style:{width:"700px"},placeholder:"Enter message to be displayed to everyone using SCOT",value:this.state.wallMessage,onChange:this.inputChange}),i.a.createElement(Pt,{onClick:this.sendWallMessage,bsStyle:this.state.buttonStatus,disabled:this.state.buttonLoading},this.state.buttonText))))),this.state={wallMessage:"",buttonStatus:"primary",buttonText:"Send",buttonLoading:!1}}}var Ft=a(429),Rt=a.n(Ft);class Ut extends s.Component{constructor(e){super(e),this.state={user:"",pass:""},this.SSO=this.SSO.bind(this),this.NormalAuth=this.NormalAuth.bind(this),this.isEnterPressed=this.isEnterPressed.bind(this)}componentWillMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){let e="/sso?orig_url=/#"+this.props.origurl;return i.a.createElement(U.a,{dialogClassName:"login-modal",show:this.props.modalActive},i.a.createElement(U.a.Header,null,i.a.createElement(U.a.Title,{style:{textAlign:"center"}},"SCOT Login")),i.a.createElement(U.a.Body,{style:{textAlign:"center"}},i.a.createElement("img",{src:Rt.a,alt:"SCOT Logo"}),i.a.createElement(P.a,{type:"submit",href:e},"Sign in using SSO"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},i.a.createElement("span",{className:"input-group-addon"},i.a.createElement("i",{className:"fa fa-user"})),i.a.createElement("input",{id:"user",type:"user",ref:"user",defaultValue:"",className:"form-control",placeholder:"Username or Email"})),i.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},i.a.createElement("span",{className:"input-group-addon"},i.a.createElement("i",{className:"fa fa-lock"})),i.a.createElement("input",{id:"pass",type:"password",ref:"pass",defaultValue:"",placeholder:"Password",className:"form-control",onKeyPress:this.isEnterPressed})),i.a.createElement(P.a,{type:"submit",className:"btn btn-primary",onClick:this.NormalAuth,style:{marginBottom:"25px",width:"140px"}},"Submit"),i.a.createElement("br",null)))}isEnterPressed(e){"Enter"===e.key&&this.NormalAuth()}SSO(){let e={orig_url:"%2f"};q.a.ajax({type:"get",url:"sso",crossDomain:!0,data:e,success:function(e){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){this.props.errorToggle("Failed to log in using SSO")}.bind(this)})}NormalAuth(){let e={};e.user=this.refs.user.value,e.pass=this.refs.pass.value,e.csrf_token=this.props.csrf,q.a.ajax({type:"post",url:"auth",data:e,success:function(){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){"Failed CSRF check"===e.responseText?this.props.errorToggle("Failed to log in due to bad CSRF token. Please reload the page and then log in. Error: "+e.responseText):this.props.errorToggle("Failed to log in using normal auth: "+e.responseText)}.bind(this)})}}Ut.defaultProps={modalActive:!0};var Ht=Ut,Wt=a(35),Bt=a(46),Vt=a(207),zt=a(984),qt=a(956),Kt=a(957),Gt=a(430),Jt=a.n(Gt),Yt=a(275),Qt=a.n(Yt);var Xt=a(431),$t=a.n(Xt);class Zt extends s.Component{constructor(e){super(e),this.handleDelete=e=>{const t=this.state.tags;if(t.splice(e,1),0===t.length)return this.props.onChange(""),void this.setState({tags:t,placeholder:""});this.props.onChange(t),this.setState({tags:t,placeholder:""})},this.handleAdd=e=>{const t=this.state.tags;this.state.maxTags&&t.length>=this.state.maxTags?this.setState({placeholder:"Only "+this.state.maxTags+" allowed. Please delete a tag to add another one"}):(t.push(e),this.props.onChange(t),this.setState({tags:t,placeholder:""}))},this.handleInputChange=e=>{if(e&&e.length>=2){let t=[];q.a.ajax({type:"get",url:"/scot/api/v2/ac/"+this.props.type+"/"+e,success:function(e){e=e.records;for(let a=0;a<e.length;a++){let s={};s.id=a+1,s.name=e[a],t.push(s)}this.setState({suggestions:t})}.bind(this),error:function(e){console.log("failed to get autocomplete data")}})}},this.showHideInput=()=>{"userdef"===this.props.type&&this.props.maxTags&&this.state.tags.length>=this.props.maxTags?q()(".react-tags__search").hide():q()(".react-tags__search").show()};let t=[];this.props.value&&(t=this.props.value);let a=void 0;this.props.maxTags&&(a=this.props.maxTags),this.state={suggestions:[],tags:t,maxTags:a,placeholder:""}}componentDidUpdate(){this.showHideInput()}render(){return i.a.createElement("div",{className:"TagInput"},i.a.createElement($t.a,{tags:this.state.tags,suggestions:this.state.suggestions,handleAddition:this.handleAdd,handleDelete:this.handleDelete,handleInputChange:this.handleInputChange,autoresize:!1,autofocus:!1,allowBackspace:!1,allowNew:!0,placeholder:this.state.placeholder,tagComponent:ea}))}}const ea=({classNames:e,onDelete:t,tag:a})=>i.a.createElement("div",{className:e.selectedTag},i.a.createElement("span",{className:e.selectedTagName},a.name),i.a.createElement("i",{className:"fa fa-remove","aria-hidden":"true",onClick:t}));var ta=Zt,aa=a(958),sa=a(82),ia=a.n(sa),ra=a(156);function na(e,t){return la.apply(this,arguments)}function la(){return(la=Object(ra.a)(ia.a.mark((function e(t,a){return ia.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==a){e.next=6;break}return e.next=3,De.a.get(t);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,De.a.get(t,{params:a});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oa(){return(oa=Object(ra.a)(ia.a.mark((function e(t,a){return ia.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a){e.next=6;break}return e.next=3,De.a.post(t,a);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,De.a.post(t);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ca(e,t){return da.apply(this,arguments)}function da(){return(da=Object(ra.a)(ia.a.mark((function e(t,a){return ia.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De.a.put(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ha(){return(ha=Object(ra.a)(ia.a.mark((function e(t){return ia.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De.a.delete(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pa=a(153),ua=a.n(pa),ma=a(432),ga=a.n(ma);const ya={numberFilter:({filter:e,onChange:t})=>i.a.createElement(Qt.a,{debounceTimeout:200,type:"number",minLength:1,min:0,value:e?e.value:"",onChange:e=>t(e.target.value),style:{width:"100%"}}),stringFilter:({filter:e,onChange:t})=>i.a.createElement(Qt.a,{debounceTimeout:200,minLength:1,value:e?e.value:"",onChange:e=>t(e.target.value),style:{width:"100%"}}),dropdownFilter:(e=["open","closed","promoted"],t)=>({filter:a,onChange:s})=>i.a.createElement(zt.a,{trigger:"focus",placement:"bottom",overlay:i.a.createElement(qt.a,{id:"status_popover",style:{maxWidth:"400px"}},i.a.createElement(Kt.a,{vertical:!0,style:{maxHeight:"50vh",overflowY:"auto",position:"relative"}},e.map(e=>i.a.createElement(P.a,{key:e,onClick:()=>s(e),active:a&&a.value===e,style:{textTransform:"capitalize",textAlign:t||null}},e))),a&&i.a.createElement(P.a,{block:!0,onClick:()=>s(""),bsStyle:"primary",style:{marginTop:"3px"}},"Clear"))},i.a.createElement("input",{type:"text",value:a?a.value:"",readOnly:!0,style:{width:"100%",cursor:"pointer"}})),dateRange:({filter:e,onChange:t})=>{return i.a.createElement(zt.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:i.a.createElement(qt.a,{id:"daterange_popover",style:{maxWidth:"350px"}},i.a.createElement(Jt.a,{numberOfCalendars:2,selectionType:"range",showLegend:!1,singleDateRange:!0,onSelect:(e,a)=>{t((e=>({start:Math.round(e.start)/1e3,end:Math.round(e.end)/1e3}))(e))},value:e?(a=e.value,ce.range(1e3*a.start,1e3*a.end)):null}),e&&i.a.createElement(P.a,{block:!0,onClick:()=>{t(""),document.dispatchEvent(new MouseEvent("click"))},bsStyle:"primary"},"Clear"))},i.a.createElement("input",{type:"text",value:e?ge(e.value):"",readOnly:!0,style:{width:"100%",cursor:"pointer"}}));var a},tagFilter:(e="tag")=>({filter:t,onChange:a})=>i.a.createElement(ta,{type:e,onChange:a,value:t?t.value:[]})},fa={dateFormater:e=>{let t=new Date(1e3*e.value);return i.a.createElement("span",null,t.toLocaleString())},alertStatus:e=>{let t=e.value.split("/").map(e=>parseInt(e.trim(),10)),a=Object(Vt.a)(t,3),s=a[0],r=a[1],n="open btn-danger";return a[2]?n="promoted btn-warning":r&&(s||(n="closed btn-success")),i.a.createElement("div",{className:"alertStatusCell ".concat(n)},e.value)},textStatus:e=>{let t="green";return"open"===e.value||"disabled"===e.value||"assigned"===e.value?t="red":"promoted"===e.value&&(t="orange"),i.a.createElement("span",{style:{color:t}},e.value)},alertStatusAlerts:e=>i.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.a.createElement(ka,{row:e})),flairCell:e=>void 0!==e?i.a.createElement(Sa,{value:e.value}):null,appliesTo:e=>{if(void 0!==e){if(Array.isArray(e.original.data.applies_to)){let t=e.original.data.applies_to.map(e=>e);return i.a.createElement("span",null,t.join(", "))}return i.a.createElement("span",null,e.original.data.applies_to)}}},ba={Id:{Header:"ID",accessor:"id",width:80,Filter:ya.numberFilter},AlertStatus:{Header:"Status",accessor:e=>e.open_count+" / "+e.closed_count+" / "+e.promoted_count,column:["open_count","closed_count","promoted_count"],id:"status",width:150,Filter:ya.dropdownFilter(),Cell:fa.alertStatus,style:{padding:0}},EventStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:fa.textStatus,Filter:ya.dropdownFilter()},IncidentStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:fa.textStatus,Filter:ya.dropdownFilter(["open","closed"])},SigStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:fa.textStatus,Filter:ya.dropdownFilter(["enabled","disabled"])},TaskStatus:{Header:"Task Status",accessor:e=>e.metadata.task.status,id:"metadata.task.status",column:"metadata",Cell:fa.textStatus,Filter:ya.dropdownFilter(["open","assigned","closed"])},TaskSummary:{Header:"Task Summary",accessor:e=>e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain,id:"summary",minWidth:400,maxWidth:5e3,Filter:ya.stringFilter},Subject:{Header:"Subject",accessor:"subject",minWidth:400,maxWidth:5e3,Filter:ya.stringFilter},Location:{Header:"Location",accessor:"location",minWidth:80,maxWidth:180,Filter:ya.stringFilter},Created:{Header:"Created",accessor:"created",minWidth:100,maxWidth:180,Filter:ya.dateRange,Cell:fa.dateFormater},Updated:{Header:"Updated",accessor:"updated",minWidth:100,maxWidth:180,Filter:ya.dateRange,Cell:fa.dateFormater},Occurred:{Header:"When",accessor:"when",minWidth:100,maxWidth:180,Filter:ya.dateRange,Cell:fa.dateFormater},Sources:{Header:"Sources",accessor:"source",column:"source",id:"source",minWidth:120,Filter:ya.tagFilter("source")},Tags:{Header:"Tags",accessor:"tag",column:"tag",id:"tag",minWidth:120,Filter:ya.tagFilter("tag")},TaskOwner:{Header:"Task Owner",accessor:"owner",maxWidth:80,Filter:ya.stringFilter},Owner:{Header:"Owner",accessor:"owner",maxWidth:80,Filter:ya.stringFilter},Entries:{Header:"Entries",accessor:"entry_count",maxWidth:70,Filter:ya.numberFilter},Views:{Header:"Views",accessor:"views",maxWidth:70,Filter:ya.numberFilter},DOE:{Header:"DOE",accessor:"doe_report_id",maxWidth:100,Filter:ya.stringFilter},IncidentType:{Header:"Type",accessor:"type",minWidth:200,maxWidth:250,Filter:ya.dropdownFilter(["Type 1 : Root Compromise","Type 1 : User Compromise","Type 1 : Loss/Theft/Missing Desktop","Type 1 : Loss/Theft/Missing Laptop","Type 1 : Loss/Theft/Missing Media","Type 1 : Loss/Theft/Missing Other","Type 1 : Malicious Code Trojan","Type 1 : Malicious Code Virus","Type 1 : Malicious Code Worm","Type 1 : Malicious Code Other","Type 1 : Web Site Defacement","Type 1 : Denial of Service","Type 1 : Critical Infrastructure Protection","Type 1 : Unauthorized Use","Type 1 : Information Compromise","Type 2 : Attempted Intrusion","Type 2 : Reconnaissance Activity"],"left")},AppliesTo:{Header:"Applies To",id:"data.applies_to",accessor:e=>e.data.applies_to,Cell:fa.appliesTo,Filter:ya.tagFilter,minWidth:400,maxWidth:5e3},Value:{Header:"Value",accessor:"value",Filter:ya.stringFilter,minWidth:400,maxWidth:5e3},Name:{Header:"Name",accessor:"name",Filter:ya.stringFilter,minWidth:200,maxWidth:300},Group:{Header:"Group",accessor:e=>e.data.signature_group?e.data.signature_group.join(", "):"",column:"signature_group",id:"data.signature_group",Filter:ya.stringFilter},Type:{Header:"Type",accessor:e=>e.data.type,id:"data.type",Filter:ya.stringFilter,minWidth:100,maxWidth:150},EntityType:{Header:"Type",accessor:"type",Filter:ya.stringFilter,minWidth:100,maxWidth:150},Description:{Header:"Description",accessor:e=>e.data.description,Filter:ya.stringFilter,minWidth:400,id:"data.description",maxWidth:5e3},TargetType:{Header:"Type",accessor:e=>e.target.type,column:"target",id:"target_type",Filter:ya.stringFilter},TargetId:{Header:"Target Id",accessor:e=>e.target.id,column:"target",id:"target_id",Filter:ya.numberFilter},OpenTasks:{Header:"Open Tasks",accessor:"has_tasks",Filter:ya.numberFilter,maxWidth:90,filterable:!1},Status:{accessor:"status",Header:"Status",width:100,Cell:fa.alertStatusAlerts},EntryCountColumn:{width:50,resizable:!0,expander:!0,filter:!1,accessor:"entry_count",Header:"Entries",Expander:e=>{let t=e.isExpanded,a=Object(f.a)(e,["isExpanded"]);return i.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},t?i.a.createElement(aa.a,{variant:"contained",style:{backgroundColor:"orange",color:"white"}},"Close entries"):i.a.createElement("div",null,0==a.original.entry_count?i.a.createElement(ua.a,null):i.a.createElement(aa.a,{variant:"contained",size:"small",style:{backgroundColor:"#5bc0de",color:"white"}},a.original.entry_count," entries")))},getProps:(e,t,a)=>({className:"show-pointer"})}},va={style:{padding:"5px 5px"}},Ea={alert:["Id","Status","EntryCountColumn"],alertgroup:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views","OpenTasks"],event:["Id","Location","EventStatus","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","OpenTasks"],incident:["Id","Location","DOE","IncidentStatus","Owner","Subject","Occurred","IncidentType",{title:"Tags",options:{minWidth:100,maxWidth:150}},{title:"Sources",options:{minWidth:100,maxWidth:150}}],intel:["Id","Location","Subject","Created","Updated","Sources",{title:"Tags",options:{minWidth:200,maxWidth:250}},"Owner","Entries","Views"],task:["Id","Location","Subject","TargetType","TargetId",{title:"TaskOwner",options:{minWidth:150,maxWidth:500}},"TaskStatus","TaskSummary",{title:"Updated",options:{minWidth:150,maxWidth:500}}],signature:["Id","Location","Name","Type","SigStatus","Group","Description","Owner","Tags","Sources","Updated"],guide:["Id","Location","Subject","AppliesTo"],entity:["Id","Location","Value","EntityType","Entries"],default:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views"]},wa=(e,t,a,s)=>{function i(e){return e.reduce((function(e,t){return void 0!==e.width?e.width+t.width:e+t.width}))}Ea.hasOwnProperty(e)||(e="default"),!1===s&&"alert"===e&&(e="alertgroup");let r=[];var n,l=Object(b.a)(Ea[e]);try{for(l.s();!(n=l.n()).done;){let e=n.value,t={};"object"===typeof e?t=Object(v.a)(Object(v.a)({},ba[e.title]),e.options):"string"===typeof e&&(t=ba[e]),r.push(Object(v.a)(Object(v.a)({},va),t))}}catch(o){l.e(o)}finally{l.f()}if("alert"===e){a.length>0&&(a[0].data.columns&&a[0].data.columns.forEach(function(e,a){if("status"!==e){let a={accessor:e,Header:e,filter:!0,Cell:e=>fa.flairCell(e),width:Ta(t,e,e)};r.push(a)}else{let t={accessor:"status ",Header:e,filter:!0,Cell:e=>fa.flairCell(e),width:80};r.push(t)}}.bind(void 0)),r.forEach((function(e,t){e.getProps=function(e,a){return{style:{backgroundColor:t%2===0?"#bababa45":""}}}})));let e=3;r.forEach((function(t){90===t.width&&e++,t.accessor.includes("time")&&e++}));let s=window.innerWidth-32,n=i(r);if(n<s){let t=s-n,a=t/(r.length-e);r.forEach(function(e){n=i(r),n<s&&"id"!==e.accessor&&"entry_count"!==e.accessor&&"status"!==e.accessor&&90!==e.width&&!0!==e.accessor.includes("time")&&(e.width+a<t?(e.width=e.width+a,n=i(r)):e.width=e.width+t)}.bind(void 0))}}return r};class Sa extends i.a.Component{constructor(e){super(e)}render(){const e=this.props.value;return i.a.createElement("div",{style:{wordBreak:"break-word"},className:"alertTableHorizontal",dangerouslySetInnerHTML:{__html:e}})}}const Ta=(e,t,a)=>{("string"===typeof t||t instanceof String)&&(t=e=>e[t]);const s=Math.max(...e.map((function(e){let t=e[a];return void 0!==t?function(e){try{return ga()(e).length}catch(t){return e.length}}(t):0})),a.length);return s<13&&"status"!==a?90:Math.min(400,9*s)};class ka extends i.a.Component{constructor(e){super(e),this.getPromotionInfo=e=>na("/scot/api/v2/alert/".concat(e,"/event"),{}),this.state={element:null,loading:!0}}componentDidUpdate(e){e.row.value!==this.props.row.value&&this.getPromotionInfo(this.props.row.original.id).then(e=>{e&&this.setState({element:e})})}componentDidMount(){this.getPromotionInfo(this.props.row.original.id).then(e=>{e&&this.setState({element:e})})}render(){return"closed"===this.props.row.value?i.a.createElement("p",{style:{color:"green"}},this.props.row.value):"open"===this.props.row.value?i.a.createElement("p",{style:{color:"red"}},this.props.row.value):"promoted"===this.props.row.value?this.state.element?i.a.createElement(aa.a,{variant:"contained",onMouseDown:()=>{return e=this.state.element.data.records[0].id,void window.open("#/event/"+e);var e},style:{backgroundColor:"orange",color:"white"}},this.props.row.value):i.a.createElement("span",null,"Loading..."):void 0}}var xa={columnsDisplay:{alertgroup:["ID","Status","Subject","Created","Sources","Tags","Views","Open Tasks"],alert:["ID","Status","Subject","Created","Sources","Tags","Views"],event:["ID","Status","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","Open Tasks"],incident:["ID","DOE","Status","Owner","Subject","Occurred","Type","Tags","Sources"],task:["Entry Id","Body","Type","ID","Status","Owner","Updated"],guide:["ID","Subject","Applies To"],intel:["ID","Subject","Created","Updated","Source","Tags","Owner","Entries","Views"],signature:["ID","Name","Type","Status","Group","Description","Owner","Tag","Source","Updated"],entity:["ID","Value","Type","Entries"]},columns:{alertgroup:["id","status","subject","created","source","tag","views","has_tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has_tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target.type","target.id","metadata.status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]},columnsClassName:{alertgroup:["id","status","subject","created","source","tag","views","has-tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has-tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target_type","target_id","task_status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]}};let Ca=a(638),Da=a(234),Na=a(30),_a=a(95),Ma=a(363),Aa=a(31).Link;class ja extends i.a.Component{constructor(...e){super(...e),this.componentDidMount=()=>{"alertgroup"===this.props.type&&q()("#list-view").keydown(function(e){q()("input").is(":focus")||"promoted"!==this.props.status&&(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey?this.statusAjax("open"):67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.statusAjax("closed"))}.bind(this))},this.componentWillUnmount=()=>{q()("#list-view").unbind("keydown")},this.trackAll=()=>{this.statusAjax("tracked")},this.untrackAll=()=>{this.statusAjax("untracked")},this.closeAll=()=>{this.statusAjax("closed")},this.openAll=()=>{this.statusAjax("open")},this.enableAll=()=>{this.statusAjax("enabled")},this.disableAll=()=>{this.statusAjax("disabled")},this.statusAjax=e=>{console.log(e);let t={status:e};q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success status change to: "+e)},error:function(e){this.props.errorToggle("Failed to change status",e)}.bind(this)})},this.render=()=>{let e,t="",a="",s="",r="",n="",l="";return"open"===this.props.status||"disabled"===this.props.status||"untracked"===this.props.status?(t="danger",l="alertgroup_open"):"closed"===this.props.status||"enabled"===this.props.status||"tracked"===this.props.status?(t="success",l="alertgroup_closed"):"promoted"===this.props.status&&(t="default",l="alertgroup_promoted"),"alertgroup"===this.props.type&&(a=this.props.data.open_count,s=this.props.data.closed_count,r=this.props.data.promoted_count,n=a+" / "+s+" / "+r),"event"===this.props.type?e="/incident/"+this.props.data.promotion_id:"intel"===this.props.type&&(e="/event/"+this.props.data.promotion_id),"guide"===this.props.type||"intel"===this.props.type?i.a.createElement("div",null):"alertgroup"===this.props.type?i.a.createElement(Ca,null,i.a.createElement(Da,{placement:"top",overlay:i.a.createElement(Ma,{id:this.props.id},"open/closed/promoted alerts")},i.a.createElement(_a,{bsSize:"xsmall",bsStyle:t,title:n,id:"dropdown",className:l},i.a.createElement(Na,{eventKey:"1",onClick:this.openAll,bsSize:"xsmall"},i.a.createElement("b",null,"Open")," All Alerts"),i.a.createElement(Na,{eventKey:"2",onClick:this.closeAll},i.a.createElement("b",null,"Close")," All Alerts")))):"incident"===this.props.type?i.a.createElement(_a,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:l,style:{fontSize:"14px"},title:this.props.status},i.a.createElement(Na,{eventKey:"1",onClick:this.openAll},"Open Incident"),i.a.createElement(Na,{eventKey:"2",onClick:this.closeAll},"Close Incident")):"signature"===this.props.type?i.a.createElement(_a,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:l,style:{fontSize:"14px"},title:this.props.status},i.a.createElement(Na,{eventKey:"1",onClick:this.enableAll},"Enable Signature"),i.a.createElement(Na,{eventKey:"2",onClick:this.disableAll},"Disable Signature")):"entity"===this.props.type?i.a.createElement(_a,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:l,style:{fontSize:"14px"},title:this.props.status},i.a.createElement(Na,{eventKey:"1",onClick:this.trackAll},"Track"),i.a.createElement(Na,{eventKey:"2",onClick:this.untrackAll},"Untracked")):i.a.createElement("div",null,"promoted"===this.props.status?i.a.createElement(Aa,{to:e,role:"button",className:"btn btn-warning"},this.props.status):i.a.createElement(_a,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:l,style:{fontSize:"14px"},title:this.props.status},i.a.createElement(Na,{eventKey:"1",onClick:this.openAll},"Open"),i.a.createElement(Na,{eventKey:"2",onClick:this.closeAll},"Close")))}}}var Oa=a(81),La=a.n(Oa),Pa=a(148),Ia=a.n(Pa),Fa=a(9),Ra=a.n(Fa);let Ua=a(9);class Ha extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{"alert"===this.props.type?(this.setState({newType:"Event"}),this.setState({newURL:"event"})):"event"===this.props.type&&(this.setState({newType:"Incident"}),this.setState({newURL:"incident"}))},this.promote=()=>{let e=JSON.stringify({promote:"new"});q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:e,contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully promoted"),window.location.assign("#/"+this.state.newURL+"/"+e.pid)}.bind(this),error:function(e){this.props.errorToggle("error","Failed to promote",e)}.bind(this)})},this.render=()=>i.a.createElement(Ua,{bsStyle:"warning",eventkey:"1",bsSize:"xsmall",onClick:this.promote},i.a.createElement("img",{src:"/images/megaphone.png",alt:""}),i.a.createElement("span",null,"Promote to ",this.state.newType)),this.state={newURL:null,newType:null}}}var Wa=a(959),Ba=a(960);class Va extends i.a.Component{constructor(e){super(e),this.state={isMarked:!1},this.removeMarkedItemsHandler=this.removeMarkedItemsHandler.bind(this),this.getMarkedItemsHandler=this.getMarkedItemsHandler.bind(this),this.setMarkedItemsHandler=this.setMarkedItemsHandler.bind(this),this.getSelectedAlerts=this.getSelectedAlerts.bind(this)}componentWillMount(){this.getMarkedItemsHandler()}componentWillReceiveProps(e){this.getMarkedItemsHandler(),e.isAlert&&this.setState({isMarked:!1})}render(){return"entry"===this.props.type?i.a.createElement(Wa.a,{onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},i.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.state.isMarked?i.a.createElement("span",null,"Marked"):i.a.createElement("span",null,"Mark")):i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:"mark_tooltip"},"Mark selected"," ",this.props.isAlert?i.a.createElement("span",null,"alerts"):this.props.type)},i.a.createElement(P.a,{bsSize:"xsmall",onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},i.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.props.isAlert?i.a.createElement("span",null,"Mark selected"):null))}getMarkedItemsHandler(){let e=qa(),t=!1;if(e){var a,s=Object(b.a)(e);try{for(s.s();!(a=s.n()).done;){let e=a.value;if(e.id===this.props.id&&e.type===this.props.type){t=!0;break}}}catch(i){s.e(i)}finally{s.f()}}this.setState({isMarked:t})}removeMarkedItemsHandler(){if(this.props.isAlert){let e=this.getSelectedAlerts();for(let t=0;t<e.length;t++)za("alert",e[t])}else za(this.props.type,this.props.id);this.setState({isMarked:!1})}setMarkedItemsHandler(){if(this.props.isAlert){let e=this.getSelectedAlerts();for(let t=0;t<e.length;t++)Ka("alert",e[t],this.props.string)}else Ka(this.props.type,this.props.id,this.props.string);this.setState({isMarked:!0})}getSelectedAlerts(){return this.props.alertsSelected.map(e=>e.id)}}const za=(e,t)=>{let a=qa();if(a){for(let s=0;s<a.length;s++)if(a[s].type===e&&a[s].id===t){a.splice(s,1);break}ae("marked",JSON.stringify(a))}},qa=()=>{let e=se("marked");if(e)return e=JSON.parse(e),e},Ka=(e,t,a)=>{let s=[],i=qa();if(i){var r,n=Object(b.a)(i);try{for(n.s();!(r=n.n()).done;){let a=r.value;a.type===e&&a.id===t||s.push(a)}}catch(l){n.e(l)}finally{n.f()}}s.push({id:t,type:e,subject:a.substring(0,120)}),ae("marked",JSON.stringify(s))};Va.defaultProps={isMarked:!1};var Ga=a(147),Ja=a.n(Ga);let Ya=a(30),Qa=a(242),Xa=a(362),$a=a(234),Za=a(682);class es extends i.a.Component{constructor(...e){super(...e),this.selectColor=e=>{let t={tlp:e};this.serverRequest=q.a.ajax({type:"put",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id+"/",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(){console.log("set tlp")},error:function(e){this.props.errorToggle("Failed to set TLP",e)}})},this.render=()=>i.a.createElement("span",{style:{padding:"entry"===this.props.type?"3px 20px":null}},i.a.createElement($a,{placement:"top",overlay:i.a.createElement(Za,{id:"tlp-tooltip"},this.props.tlp)},i.a.createElement(Ja.a,{bsSize:"xsmall",bsStyle:{padding:"entry"===this.props.type?"3px 20px":null}},i.a.createElement(Qa,null,i.a.createElement("svg",{id:"trafficlight1",style:{width:"12px",height:"12px"}},i.a.createElement("circle",{id:"circle1",r:"5",cx:"6",cy:"6",style:{fill:"red"===this.props.tlp||"white"===this.props.tlp?this.props.tlp:"gray",stroke:"black",strokeWidth:"2"}})),i.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},i.a.createElement("circle",{id:"circle2",r:"5",cx:"6",cy:"6",style:{fill:"amber"===this.props.tlp&&"white"!==this.props.tlp?"orange":"white"===this.props.tlp?"white":"gray",stroke:"black",strokeWidth:"2"}})),i.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},i.a.createElement("circle",{id:"circle3",r:"5",cx:"6",cy:"6",style:{fill:"green"===this.props.tlp||"white"===this.props.tlp?this.props.tlp:"gray",stroke:"black",strokeWidth:"2"}}))),i.a.createElement(Xa,null,i.a.createElement(Ya,{header:!0},"Traffic Light Protocol (TLP) Color"),i.a.createElement(Ya,{eventKey:"unset",onSelect:this.selectColor},"Unset"),i.a.createElement(Ya,{eventKey:"red",onSelect:this.selectColor},"Red"),i.a.createElement(Ya,{eventKey:"amber",onSelect:this.selectColor},"Amber"),i.a.createElement(Ya,{eventKey:"green",onSelect:this.selectColor},"Green"),i.a.createElement(Ya,{eventKey:"white",onSelect:this.selectColor},"White"),i.a.createElement(Ya,{divider:!0}),i.a.createElement(Ya,{href:"https://www.us-cert.gov/tlp"},"What is TLP?")))))}}var ts=a(433);class as extends i.a.Component{constructor(e){super(e),this.toggleFlair=()=>{let e=!this.state.globalFlairState;this.props.toggleFlair(),q()("iframe").each(function(e,t){if(null!=t.contentDocument){let e=q()(t).contents(),a=e.find(".entity-off"),s=e.find(".entity");!1===this.state.globalFlairState?(e.find(".extras").show(),e.find(".flair-off").hide(),a.each((function(e,t){q()(t).addClass("entity"),q()(t).removeClass("entity-off")}))):(e.find(".extras").hide(),e.find(".flair-off").show(),s.each((function(e,t){q()(t).addClass("entity-off"),q()(t).removeClass("entity")})))}}.bind(this)),this.setState({globalFlairState:e})},this.alertOpenOrCloseSelected=e=>{let t=[];this.props.alertsSelected.length>0?t=this.props.alertsSelected:this.props.entryData.length>0&&(t=this.props.entryData);let a={alerts:t.map((function(t){let a={id:t.id,status:e};return"closed"===e&&(a.closed=Math.round((new Date).getTime()/1e3)),a}))};this.props.ToggleProcessingMessage(!0),ca("/scot/api/v2/".concat(this.props.type,"/").concat(this.props.id),a).then(function(){console.log("success"),this.props.ToggleProcessingMessage(!1)}.bind(this)).catch(function(t){this.props.errorToggle("failed to ".concat(e," selected alerts"),t),this.props.ToggleProcessingMessage(!1)}.bind(this))},this.alertPromoteSelected=()=>{let e=JSON.stringify({promote:"new"}),t=this.props.alertsSelected.map(e=>e.id);this.props.ToggleProcessingMessage(!0),ca("/scot/api/v2/alert/".concat(t[0]),e).then(function(e){let a={promote:e.data.pid};1===t.length&&this.props.ToggleProcessingMessage(!1),t.forEach(function(e,s){if(0===s)console.log("promoting rest of alerts");else{ca("/scot/api/v2/alert/".concat(e),a).then(function(){s+1===t.length&&this.props.ToggleProcessingMessage(!1)}.bind(this)).catch(function(e){this.props.errorToggle("failed to promoted selected alerts",e)}.bind(this))}}.bind(this))}.bind(this))},this.alertSelectExisting=()=>{let e=prompt("Please Enter Event ID to promote into");""!==e&&null!==e&&(this.props.alertsSelected.forEach(function(t){let a={promote:parseInt(e,10)};ca("/scot/api/v2/alert/".concat(t.id),a).then((function(){console.log("Successfully promoted to event ".concat(e))})).catch(function(){prompt("Please use numbers only"),this.selectExisting()}.bind(this))}.bind(this)),window.open("#/event/"+e))},this.alertExportCSV=()=>{const e=this.props.alertsSelected;var t=[];e.forEach(function(e){Object.keys(e).forEach((function(t){if("string"===typeof e[t]){let a=/(<([^>]+)>)/gi,s=e[t];e[t]=s.replace(a,"")}})),t.push(e)}.bind(this)),this.setState({dataToDownload:t},()=>{this.csvLink.link.click()})},this.PrintPrepare=()=>{q()("iframe").contents().each((function(e,t){q()(t).find("blockquote").each((function(e,t){q()(t).css({"max-height":"5000px"})})),q()(t).find("pre").each((function(e,t){q()(t).css({"max-height":"5000px","word-wrap":"break-word"})}))})),setTimeout(function(){this.forceUpdate()}.bind(this),500),setTimeout((function(){q()("#print-button").click()}),1e3)},this.Print=()=>{window.print()},this.componentDidMount=()=>{"alertgroup"!==this.props.type&&"alert"!==this.props.type||q()("#main-detail-container").keydown(function(e){q()("input").is(":focus")||(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("open"),67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("closed"))}.bind(this)),q()("#main-detail-container").keydown(function(e){q()("input").is(":focus")||84===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleFlair()}.bind(this))},this.componentWillUnmount=()=>{q()("#main-detail-container").unbind("keydown")},this.guideToggle=()=>{this.props.flairToolbarToggle(this.props.guideID,null,"guide",{top:0,left:0},null)},this.sourceToggle=()=>{this.props.flairToolbarToggle(this.props.id,null,"source",{top:0,left:0},null)},this.createGuide=()=>{let e=JSON.stringify({subject:"ENTER A GUIDE NAME",data:{applies_to:[this.props.subjectName]}});q.a.ajax({type:"POST",url:"/scot/api/v2/guide",data:e,contentType:"application/json; charset=UTF-8",success:function(e){window.open("/#/guide/"+e.id)},error:function(e){this.props.errorToggle("failed to create a new guide",e)}.bind(this)})},this.reparseFlair=()=>{q.a.ajax({type:"put",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8",success:function(){console.log("reparsing started")},error:function(e){this.props.errorToggle("failed to reparse flair",e)}.bind(this)})},this.createLinkSignature=()=>{q.a.ajax({type:"POST",url:"/scot/api/v2/signature",data:JSON.stringify({target:{id:this.props.id,type:this.props.type},name:"Name your Signature",status:"disabled"}),contentType:"application/json; charset=UTF-8",success:function(e){const t="/#/signature/"+e.id;window.open(t,"_blank")},error:function(e){this.props.errorToggle("failed to create a signature",e)}.bind(this)})},this.manualUpdate=()=>{this.props.updated(null,null)},this.render=()=>{let e=this.props.subjectType,t=this.props.type,a=this.props.id,s=this.props.status,r="";if(this.props.headerData.subject?r=this.props.headerData.subject:this.props.headerData.value?r=this.props.headerData.value:this.props.headerData.name?r=this.props.headerData.name:this.props.headerData.body&&(r=this.props.headerData.body),"alertgroup"!==t){let n,l=!0;return"promoted"!==s?"alert"===t?n="Event":"event"===t?n="Incident":"incident"!==t&&"guide"!==t&&"intel"!==t&&"signature"!==t&&"entity"!==t||(l=!1):l=!1,i.a.createElement("div",{className:"entry-header detail-buttons"},"entity"!==t?i.a.createElement(Ra.a,{eventkey:"1",bsStyle:"success",onClick:this.props.entryToggle,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-plus-circle","aria-hidden":"true"})," Add Entry"):null,"entity"!==t?i.a.createElement(Ra.a,{eventkey:"2",onClick:this.props.fileUploadToggle,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-upload","aria-hidden":"true"})," Upload File"):null,i.a.createElement(Ra.a,{eventkey:"3",onClick:this.toggleFlair,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),"alertgroup"===t||"event"===t||"intel"===t?i.a.createElement(Ra.a,{eventkey:"4",onClick:this.props.viewedByHistoryToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,i.a.createElement(Ra.a,{eventkey:"5",onClick:this.props.changeHistoryToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),"entity"!==t?i.a.createElement(Ra.a,{eventkey:"6",onClick:this.props.permissionsToggle,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-users","aria-hidden":"true"})," Permissions"):null,i.a.createElement(es,{type:t,id:a,tlp:this.props.headerData.tlp}),i.a.createElement(Ra.a,{eventkey:"7",onClick:this.props.entitiesToggle,bsSize:"xsmall"},i.a.createElement("span",{className:"entity"},"__")," View Entities"),"guide"===t?i.a.createElement(Ra.a,{eventkey:"8",onClick:this.props.guideRedirectToAlertListWithFilter,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-table","aria-hidden":"true"})," View Related Alerts"):null,i.a.createElement(Ra.a,{onClick:this.props.linksModalToggle,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),l?i.a.createElement(Ha,{type:t,id:a,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,"signature"!==t?i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.createLinkSignature},i.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"):null,"signature"===t?i.a.createElement(Ra.a,{eventkey:"11",onClick:this.props.showSignatureOptionsToggle,bsSize:"xsmall",bsStyle:"warning"},"View Custom Options"):null,i.a.createElement(Ra.a,{onClick:this.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},i.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),i.a.createElement(Ra.a,{onClick:this.Print,style:{display:"none"},id:"print-button"}),i.a.createElement(Ra.a,{onClick:this.props.exportToggle,bsSize:"xsmall",id:"export-button"},i.a.createElement("i",{className:"fa fa-share","aria-hidden":"true"})," Export"," ",e," "),i.a.createElement(Ra.a,{bsStyle:"danger",eventkey:"9",onClick:()=>this.props.deleteToggle(t),bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e),i.a.createElement(Ia.a,{style:{float:"right"}},i.a.createElement(Va,{type:t,id:a,string:r}),i.a.createElement(Ra.a,{onClick:this.props.markModalToggle,bsSize:"xsmall"},"Marked Objects"),i.a.createElement(Ra.a,{id:"refresh-detail",bsStyle:"info",eventkey:"10",onClick:this.manualUpdate,bsSize:"xsmall",style:{float:"right"}},i.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))))}return i.a.createElement("div",{className:"entry-header second-menu detail-buttons"},i.a.createElement(Ia.a,{style:{float:"right"}},i.a.createElement(Va,{type:t,id:a,string:r}),i.a.createElement(Ra.a,{onClick:this.props.markModalToggle,bsSize:"xsmall"},"Marked Actions"),i.a.createElement(Ra.a,{bsStyle:"info",eventkey:"16",onClick:this.manualUpdate,bsSize:"xsmall",style:{float:"right"}},i.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))),i.a.createElement("span",{className:"entry-header detail-buttons"},i.a.createElement(Ra.a,{eventkey:"1",onClick:this.toggleFlair,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),i.a.createElement(Ra.a,{eventkey:"2",onClick:this.reparseFlair,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"})," Reparse Flair"),i.a.createElement("span",null,null!==this.props.guideID?i.a.createElement(Ra.a,{eventkey:"3",onClick:this.guideToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/guide.png",alt:""})," Guide"):i.a.createElement(Ra.a,{eventkey:"3",onClick:this.createGuide,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/guide.png",alt:""})," Create Guide")),null==this.props.headerData?null:i.a.createElement(Ra.a,{eventkey:"4",onClick:this.sourceToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/code.png",alt:""})," View Source"),i.a.createElement(Ra.a,{eventkey:"5",onClick:this.props.entitiesToggle,bsSize:"xsmall"},i.a.createElement("span",{className:"entity"},"__")," View Entities"),"alertgroup"===t||"event"===t||"intel"===t?i.a.createElement(Ra.a,{eventkey:"6",onClick:this.props.viewedByHistoryToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,i.a.createElement(Ra.a,{eventkey:"7",onClick:this.props.changeHistoryToggle,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),i.a.createElement(es,{type:t,id:a,tlp:this.props.headerData.tlp}),i.a.createElement(Ra.a,{onClick:this.props.linksModalToggle,bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.createLinkSignature},i.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"),i.a.createElement(Ra.a,{onClick:this.Print,style:{display:"none"},id:"print-button"}),i.a.createElement(Ra.a,{bsStyle:"danger",eventkey:"8",onClick:()=>this.props.deleteToggle(t),bsSize:"xsmall"},i.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e)),this.props.alertsSelected.length>0?i.a.createElement("span",null,i.a.createElement(Ra.a,{eventkey:"8",onClick:()=>this.alertOpenOrCloseSelected("open"),bsSize:"xsmall",bsStyle:"danger"},i.a.createElement("img",{src:"/images/open.png",alt:""})," Open Selected"),i.a.createElement(Ra.a,{eventkey:"9",onClick:()=>this.alertOpenOrCloseSelected("closed"),bsSize:"xsmall",bsStyle:"success"},i.a.createElement("i",{className:"fa fa-flag-checkered","aria-hidden":"true"})," Close Selected"),i.a.createElement(Ra.a,{eventkey:"10",onClick:this.alertPromoteSelected,bsSize:"xsmall",bsStyle:"warning"},i.a.createElement("img",{src:"/images/megaphone.png",alt:""})," Promote Selected"),i.a.createElement(Ra.a,{eventkey:"11",onClick:this.alertSelectExisting,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/megaphone_plus.png",alt:""})," Add Selected to"," ",i.a.createElement("b",null,"Existing Event")),i.a.createElement(ts.CSVLink,{data:this.state.dataToDownload,filename:"data.csv",className:"hidden",ref:e=>this.csvLink=e,target:"_blank"}),i.a.createElement(Ra.a,{eventkey:"14",onClick:this.alertExportCSV,bsSize:"xsmall"},i.a.createElement("img",{src:"/images/csv_text.png",alt:""})," Export to CSV"),i.a.createElement(Va,{type:t,id:a,string:r,isAlert:!0,getSelectedAlerts:this.getSelectedAlerts,alertsSelected:this.props.alertsSelected}),i.a.createElement(Ra.a,{onClick:this.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},i.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),i.a.createElement(Ra.a,{onClick:this.Print,style:{display:"none"},id:"print-button"}),i.a.createElement(Ra.a,{eventkey:"15",onClick:()=>this.props.deleteToggle("alert"),bsSize:"xsmall",bsStyle:"danger"},i.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete Selected")):null)},this.state={globalFlairState:!0,promoteRemaining:null,dataToDownload:[]}}}var ss=a(45),is=a.n(ss),rs=a(58);const ns={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"},overlay:{zIndex:"1101"}},ls={READY:{style:"danger"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"warning"}};class os extends i.a.Component{constructor(e){super(e),this.deleteItems=()=>{const e=this.props.deleteType;let t=[];t="alert"!==e?[parseInt(this.props.id,10)]:this.props.alertsSelected.map(e=>e.id),t.forEach(function(a,s){const i=this.props.enqueueSnackbar;const r=function(e){return ha.apply(this,arguments)}("/scot/api/v2/".concat(e,"/").concat(a));this.props.removeCallback(parseInt(this.props.id,10)),r.then(function(){s===t.length-1&&"alert"===e&&this.props.updated(),"alert"!==e?(this.props.history.push("/"+e),i("Successfully deleted ".concat(this.props.id,"."),{variant:"success"})):"alert"===e&&i("Successfully deleted ".concat(a,"."),{variant:"success"})}.bind(this)).catch((function(e){i("Failed deleting exception.",{variant:"error"})}))}.bind(this)),this.props.deleteToggle(e)},this.state={key:e.id}}render(){const e=this.props.deleteType;let t="";if("alert"!==e)t=" ".concat(e,": ").concat(this.props.id);else if("alert"===e){let a=this.props.alertsSelected.map((function(e){return i.a.createElement("span",{style:{paddingRight:10}},e.id)}));t=i.a.createElement("span",null,e,"(s) : ",a)}return i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:ns},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),i.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(P.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),i.a.createElement(P.a,{bsStyle:"danger",id:"delete",onClick:this.deleteItems},"Delete")))}}class cs extends s.PureComponent{constructor(e){super(e),this.state={key:e.id},this.toggle=this.toggle.bind(this)}toggle(){q.a.ajax({type:"delete",url:"scot/api/v2/entry/"+this.props.entryid,success:function(e){console.log("success: "+e);this.state.key}.bind(this),error:function(e){this.props.errorToggle("Failed to delete entry",e)}.bind(this)}),this.props.deleteToggle()}render(){return i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:ns},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),i.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete Entry: ",this.props.entryid,"?")),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(P.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),i.a.createElement(P.a,{bsStyle:"danger",id:"delete",onClick:this.toggle},"Delete")))}}class ds extends s.PureComponent{constructor(e){super(e),this.state={deleteButton:ls.READY},this.deleteAll=this.deleteAll.bind(this)}deleteAll(){this.setState({deleteButton:ls.LOADING});let e=!0,t=this.props.things;Array.isArray(t)||(t=[t]),q.a.when(...t.map(e=>this.deleteAjax(e))).then(()=>{this.setState({deleteButton:ls.SUCCESS})},t=>{console.error(t),this.setState({deleteButton:ls.ERROR}),this.props.errorToggle("error deleting",t),e=!1}).always(()=>{setTimeout(()=>{this.setState({deleteButton:ls.READY}),this.props.callback(e)},2e3)})}deleteAjax(e){return q.a.ajax({type:"delete",url:"/scot/api/v2/"+e.type+"/"+e.id,contentType:"application/json; charset=UTF-8"})}render(){let e=this.props.things,t="";t=Array.isArray(e)?e.map(e=>"".concat(e.type,": ").concat(e.id)).join(", "):"".concat(e.type,": ").concat(e.id);const a=this.state.deleteButton;return i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.callback,style:ns},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.callback}),i.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(P.a,{id:"cancel-delete",onClick:this.props.callback},"Cancel"),i.a.createElement(P.a,{bsStyle:a.style,id:"delete",onClick:this.deleteAll,disabled:a.disabled},a.text?a.text:"Delete")))}}const hs=Object(rs.b)(os);var ps=a(276),us=a.n(ps),ms=a(95),gs=a.n(ms);const ys={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class fs extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{let e=ie("whoami");e&&this.setState({whoami:e})},this.componentWillReceiveProps=()=>{this.setState({currentOwner:this.props.data})},this.toggle=()=>{if(void 0!==this.state.whoami){let e={owner:this.state.whoami};q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){},error:function(e){this.props.errorToggle("Failed to change owner",e)}.bind(this)})}else this.props.errorToggle("Failed to detect current user");this.ownerToggle()},this.ownerToggle=()=>{!1===this.state.ownerToolbar?this.setState({ownerToolbar:!0}):this.setState({ownerToolbar:!1})},this.render=()=>i.a.createElement("div",null,i.a.createElement(gs.a,{bsSize:"xsmall",id:"event_owner",title:this.state.currentOwner},i.a.createElement(y.a,{eventKey:"1",onClick:this.ownerToggle},"Take Ownership")),this.state.ownerToolbar?i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.ownerToggle,style:ys},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{src:"images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:this.ownerToggle}),i.a.createElement("h3",{id:"myModalLabel"},"Take Ownership")),i.a.createElement("div",{className:"modal-body"},"Are you sure you want to take ownership of this event?"),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(us.a,{id:"cancel-ownership",onClick:this.ownerToggle},"Cancel"),i.a.createElement(us.a,{bsStyle:"info",id:"take-ownership",onClick:this.toggle},"Take Ownership"))):null),this.state={currentOwner:this.props.data,whoami:void 0,ownerToolbar:!1}}}let bs=a(45),vs=a(9);const Es={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class ws extends i.a.Component{constructor(e){super(e),this.render=()=>i.a.createElement("div",null,i.a.createElement(bs,{isOpen:!0,onRequestClose:this.props.entitiesToggle,style:Es},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:this.props.entitiesToggle}),i.a.createElement("h3",{id:"myModalLabel"},"List of Entities")),i.a.createElement("div",{className:"modal-body",style:{maxHeight:"50vh",overflowY:"auto"}},this.state.entitiesBody?i.a.createElement(Ss,{data:this.props.entityData,flairToolbarToggle:this.props.flairToolbarToggle}):null),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(vs,{onClick:this.props.entitiesToggle},"Done")))),this.state={entitiesBody:!0}}}class Ss extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=[],t=this.props.data,a={entities:{}},s=a.entities;for(let i in t){let e={},a=t[i].type,r=i;if(e[t[i].id]=r,s.hasOwnProperty(a))s[a].push(e);else{let t=[];t.push(e),s[a]=t}}for(let r in s){let t=r,a=s[r];e.push(i.a.createElement(Ts,{type:t,value:a,flairToolbarToggle:this.props.flairToolbarToggle}))}return i.a.createElement("div",null,e)}}}class Ts extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=[],t=this.props.type,a=this.props.value;for(let s=0;s<a.length;s++){let t=a[s],r=null,n=null;for(let e in t)r=e,n=t[e];e.push(i.a.createElement(ks,{entityValue:n,entityId:r,flairToolbarToggle:this.props.flairToolbarToggle}))}return i.a.createElement("div",{style:{border:"1px solid black",width:"500px"}},i.a.createElement("h3",null,t),i.a.createElement("div",{style:{fontWeight:"normal",maxHeight:"300px",overflowY:"auto"}},e))}}}class ks extends i.a.Component{constructor(...e){super(...e),this.toggle=()=>{this.props.flairToolbarToggle(this.props.entityId,this.props.entityValue,"entity")},this.render=()=>{let e=this.props.entityValue;return i.a.createElement("a",{href:"javascript: void(0)",onClick:this.toggle},e,i.a.createElement("br",null))}}}const xs={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class Cs extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{q.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id+"/history",success:function(e){this.setState({historyBody:!0,data:e.records})}.bind(this),error:function(e){this.props.errorToggle("Failed to get change history",e)}.bind(this)})},this.render=()=>i.a.createElement("div",null,i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.changeHistoryToggle,style:xs},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:this.props.changeHistoryToggle}),i.a.createElement("h3",{id:"myModalLabel"},this.props.subjectType," Change History")),i.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",width:"700px",overflowY:"auto"}},this.state.historyBody?i.a.createElement(Ds,{data:this.state.data}):null),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(Ra.a,{onClick:this.props.changeHistoryToggle},"Done")))),this.state={historyBody:!1,data:""}}}class Ds extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=[],t=this.props.data;for(let a in t)e.push(i.a.createElement(Ns,{data:t[a]}));return i.a.createElement("div",null,e)}}}class Ns extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=this.props.data;return i.a.createElement("div",null,"ID: ",e.id," -"," ",i.a.createElement(La.a,{value:1e3*e.when,format:"MM/DD/YYYY hh:mm:ss a"})," -"," ",e.who," - ",e.what)}}}const _s={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class Ms extends i.a.Component{constructor(e){super(e),this.state={historyBody:!1,data:""}}componentDidMount(){q.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){this.setState({historyBody:!0,data:e})}.bind(this),error:function(e){this.props.errorToggle("failed to get user change history",e)}.bind(this)})}render(){return i.a.createElement("div",null,i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.viewedByHistoryToggle,style:_s},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:this.props.viewedByHistoryToggle}),i.a.createElement("h3",{id:"myModalLabel"},this.props.subjectType," Viewed By")),i.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",overflowY:"auto"}},this.state.historyBody?i.a.createElement(As,{data:this.state.data}):null),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(Ra.a,{onClick:this.props.viewedByHistoryToggle},"Done"))))}}class As extends i.a.Component{render(){let e=[],t=this.props.data;for(let a in t.view_history)e.push(i.a.createElement(js,{data:t.view_history[a],prop:a}));return i.a.createElement("div",null,e)}}class js extends i.a.Component{render(){let e=this.props.data,t=this.props.prop;return i.a.createElement("div",null,i.a.createElement("b",null,t)," at"," ",i.a.createElement(La.a,{value:1e3*e.when,format:"MM/DD/YYYY hh:mm:ss a"})," ","from IP: ",e.where)}}const Os=a(149).WithContext;class Ls extends i.a.Component{constructor(e){super(e),this.toggleNewReadPermission=()=>{!1===this.state.readPermissionEntry?this.setState({readPermissionEntry:!0}):!0===this.state.readPermissionEntry&&this.setState({readPermissionEntry:!1})},this.toggleNewModifyPermission=()=>{!1===this.state.modifyPermissionEntry?this.setState({modifyPermissionEntry:!0}):!0===this.state.modifyPermissionEntry&&this.setState({modifyPermissionEntry:!1})},this.permissionsfunc=e=>{console.log(e.groups);let t=[],a=[],s=[];for(let i in e.groups){e.groups[i];"read"===i?e.groups[i].forEach((function(e){a.push(e)})):"modify"===i&&e.groups[i].forEach((function(e){t.push(e)}))}return s.push(a),s.push(t),s},this.render=()=>{let e=[],t=[],a=this.props.permissionData,s=this.permissionsfunc(a),r=this.props.id,n=this.props.type;if(void 0!==s[0])for(let l=0;l<s[0].length;l++){let e="read";t.push(i.a.createElement(Ps,{data:s[0][l],dataRead:s[0],dataModify:s[1],updateid:this.props.updateid,id:r,type:n,read_modify:e,updated:this.props.updated}))}if(void 0!==s[1])for(let l=0;l<s[1].length;l++){let t="modify";e.push(i.a.createElement(Ps,{data:s[1][l],dataRead:s[0],dataModify:s[1],updateid:this.props.updateid,id:r,type:n,read_modify:t,updated:this.props.updated}))}return"entry"===n?i.a.createElement("div",{id:"",className:""},i.a.createElement("span",{style:{display:"inline-flex"}},"Read Groups: ",t,this.state.readPermissionEntry?i.a.createElement("span",{style:{display:"inherit",color:"white"}},i.a.createElement(Is,{readUpdate:1,modifyUpdate:0,dataRead:s[0],dataModify:s[1],type:n,updateid:this.props.updateid,id:r,toggleNewReadPermission:this.toggleNewReadPermission,updated:this.props.updated,permissionsToggle:this.props.permissionsToggle})):null,this.state.readPermissionEntry?i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:this.toggleNewReadPermission},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.toggleNewReadPermission},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),i.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,this.state.modifyPermissionEntry?i.a.createElement("span",{style:{display:"inherit",color:"white"}},i.a.createElement(Is,{readUpdate:0,modifyUpdate:1,dataRead:s[0],dataModify:s[1],type:n,updateid:this.props.updateid,id:r,toggleNewModifyPermission:this.toggleNewModifyPermission,updated:this.props.updated,permissionsToggle:this.props.permissionsToggle})):null,this.state.modifyPermissionEntry?i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:this.toggleNewModifyPermission},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.toggleNewModifyPermission},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})))):i.a.createElement("div",{id:"",className:"toolbar entry-header-info-null",style:{paddingTop:"0px"}},i.a.createElement("span",{style:{display:"inline-flex",paddingRight:"10px",paddingLeft:"5px"}},i.a.createElement("h4",null,"Permissions:")),"Read Groups: ",t,this.state.readPermissionEntry?i.a.createElement(Is,{readUpdate:1,modifyUpdate:0,dataRead:s[0],dataModify:s[1],type:n,updateid:this.props.updateid,id:r,toggleNewReadPermission:this.toggleNewReadPermission,updated:this.props.updated,permissionsToggle:this.props.permissionsToggle}):null,this.state.readPermissionEntry?i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:this.toggleNewReadPermission},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.toggleNewReadPermission},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),i.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,this.state.modifyPermissionEntry?i.a.createElement(Is,{readUpdate:0,modifyUpdate:1,dataRead:s[0],dataModify:s[1],type:n,updateid:this.props.updateid,id:r,toggleNewModifyPermission:this.toggleNewModifyPermission,updated:this.props.updated,permissionsToggle:this.props.permissionsToggle}):null,this.state.modifyPermissionEntry?i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:this.toggleNewModifyPermission},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.toggleNewModifyPermission},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),i.a.createElement("img",{src:"/images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:this.props.permissionsToggle}))},this.state={readPermissionEntry:!1,modifyPermissionEntry:!1}}}class Ps extends i.a.Component{constructor(...e){super(...e),this.permissionDelete=()=>{let e={},t=[],a=this.props.data,s=this.props.dataRead,i=this.props.dataModify;if("read"===this.props.read_modify){for(let e=0;e<s.length;e++)s[e]!==a&&t.push(s[e]);e.read=t,e.modify=i}else if("modify"===this.props.read_modify){for(let e=0;e<i.length;e++)i[e]!==a&&t.push(i[e]);e.read=s,e.modify=t}q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify({groups:e}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success")},error:function(e){this.props.errorToggle("error Failed to delete group",e)}.bind(this)})},this.render=()=>{let e=this.props.data;this.props.type;return i.a.createElement("span",{id:"permission_source",className:"permissionButton"},e,i.a.createElement("span",{className:"fa fa-times permissionButtonClose","aria-hidden":"true",onClick:this.permissionDelete}))}}}class Is extends i.a.Component{constructor(e){super(e),this.handleAddition=e=>{let t={},a=this.props.dataRead,s=this.props.dataModify,i=this.props.permissionsToggle;1===this.props.readUpdate?a.push(e.text):1===this.props.modifyUpdate&&s.push(e.text),void 0!==this.props.toggleNewModifyPermission?i=this.props.toggleNewModifyPermission:void 0!==this.props.toggleNewReadPermission&&(i=this.props.toggleNewReadPermission),t.read=a,t.modify=s,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: permission added"),i()},error:function(e){i(),this.props.errorToggle("error Failed to add group",e)}.bind(this)})},this.handleInputChange=e=>{},this.handleDelete=()=>{},this.handleDrag=()=>{},this.state={suggestions:this.props.options,key:this.props.updateid}}render(){let e=this.state.suggestions;return i.a.createElement("span",{className:"tag-new"},i.a.createElement(Os,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,handleDelete:this.handleDelete,handleDrag:this.handleDrag,minQueryLength:1,customCSS:1}))}}var Fs=a(434),Rs=a(130),Us=a.n(Rs),Hs=a(96),Ws=a.n(Hs),Bs=a(155),Vs=a(906),zs=a(962),qs=a(963);class Ks extends i.a.Component{constructor(e){super(e),this.handlePUT=()=>{const e=this.props,t=e.enqueueSnackbar,a=e.id;let s={body:this.state.editedtext,target_id:this.props.targetid,parent:this.props.parent,target_type:this.props.type,parsed:0},i="/scot/api/v2/entry/".concat(a);De.a.put(i,s).then(function(){t("Successfully updated entry",{variant:"success"}),this.props.handleClose(),this.props.addedEntry()}.bind(this)).catch((function(e){console.log(e),t("Failed updated entry.",{variant:"error"}),this.props.handleClose()}))},this.handleEditorChange=e=>{this.setState({editedtext:e}),console.log("State is now: ".concat(this.state.editedtext))},this.state={editedtext:""}}componentDidMount(){this.setState({editedtext:this.props.localconflict})}render(){const e=this.props.classes;return i.a.createElement("div",null,i.a.createElement(zs.a,{className:e.card},i.a.createElement(qs.a,null,i.a.createElement(Vs.a,{variant:"h5",component:"h2"},"Uh-oh! It looks like there was a conflict between your ",this.props.type," and the one cached saved on server."),i.a.createElement("br",null),i.a.createElement("div",null,i.a.createElement("div",{id:"remote",className:"remote"},i.a.createElement("b",null,"Changes on server: "),i.a.createElement(Bs.a,{className:"remote",initialValue:this.props.remoteconflict,disabled:!0})),i.a.createElement("br",null),i.a.createElement("div",{id:"local",className:"local"},i.a.createElement("b",null,"Your changes: "),i.a.createElement(Bs.a,{initialValue:this.state.editedtext,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",onEditorChange:this.handleEditorChange,value:this.state.editedtext,init:{selector:"textarea",plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen spellchecker | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote",theme:"modern",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.addButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",onclick:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}))),i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(aa.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:this.handlePUT,variant:"contained"},"Send Update to Server"),i.a.createElement(aa.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}var Gs=Object(rs.b)(Object(ot.a)(e=>({card:{minWidth:700,marginBottom:20}}))(Ks)),Js=a(982);let Ys=a(9),Qs=a(31).Prompt,Xs=a(31).Link;class $s extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{let e=ie("whoami");e&&this.setState({whoami:e}),"Edit"===this.props.entryAction&&q.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+this.props.id,success:function(e){this.setState({content:e.body,asyncContentLoaded:!0,recentlyUpdated:e.updated}),this.forceUpdate()}.bind(this),error:function(e){this.props.errorToggle("Error getting original data from source. Copy/Paste original",e),this.setState({content:"Error getting original data from source. Copy/Paste original",asyncContentLoaded:!0}),this.forceUpdate()}.bind(this)}),q()("#not_saved_entry_"+this.state.key).position()&&q()(".entry-wrapper").scrollTop(q()(".entry-wrapper").scrollTop()+q()("#not_saved_entry_"+this.state.key).position().top)},this.onCancel=()=>{this.setState({leaveCatch:!1}),this.props.addedentry(),this.setState({change:!1})},this.submit=()=>{if(""===q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").text()&&0===q()("#"+this.state.key+"_ifr").contents().find("#tinymce").find("img").length)alert("Please Add Some Text");else if("Reply"===this.props.entryAction){var e={};q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){q()(t).find("img").each((function(e,t){if(q()(t)[0].src.startsWith("blob")){let e=document.createElement("canvas"),a=new Image;a=q()(t),e.width=a[0].width,e.height=a[0].height,e.getContext("2d").drawImage(a[0],0,0);let s=e.toDataURL("image/png");q()(t).attr("src",s)}}))})),e=JSON.stringify({parent:Number(this.props.id),body:q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(this.props.targetid),target_type:this.props.type,tlp:"unset"}),q.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(this),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(this)})}else"Edit"===this.props.entryAction?q.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+this.props.id,success:function(e){this.state.recentlyUpdated!==e.updated?(this.forEdit(!1),this.setState({showConflict:!0,remoteconflict:e.body})):this.forEdit(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to get data for edit",e)}.bind(this)}):"alert"===this.props.type?(q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){q()(t).find("img").each((function(e,t){if(q()(t)[0].src.startsWith("blob")){let e=document.createElement("canvas"),a=new Image;a=q()(t),e.width=a[0].width,e.height=a[0].height,e.getContext("2d").drawImage(a[0],0,0);let s=e.toDataURL("image/png");q()(t).attr("src",s)}}))})),e=JSON.stringify({body:q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(this.props.targetid),target_type:"alert",tlp:"unset",parent:0}),q.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry(),this.props.toggleVisibility()}.bind(this),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(this)})):(q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){q()(t).find("img").each((function(e,t){if(q()(t)[0].src.startsWith("blob")){let e=document.createElement("canvas"),a=new Image;a=q()(t),e.width=a[0].width,e.height=a[0].height,e.getContext("2d").drawImage(a[0],0,0);let s=e.toDataURL("image/png");q()(t).attr("src",s)}}))})),e={parent:0,body:q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(this.props.targetid),target_type:this.props.type,tlp:"unset"},q.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(this),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(this)}))},this.exportContent=()=>{if(this.props.recipients.length>0){var e;q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){q()(t).find("img").each((function(e,t){if(q()(t)[0].src.startsWith("blob")){let e=document.createElement("canvas"),a=new Image;a=q()(t),e.width=a[0].width,e.height=a[0].height,e.getContext("2d").drawImage(a[0],0,0);let s=e.toDataURL("image/png");q()(t).attr("src",s)}}))})),e=JSON.stringify({body:q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").html(),to:this.props.recipients,thing:this.props.type}),q.a.ajax({type:"post",url:"/scot/api/v2/sendexport",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(){this.setState({leaveCatch:!1}),this.props.exportResponse("success")}.bind(this),error:function(e){this.props.errorToggle("Failed to export "+this.props.type,e),this.props.exportResponse("error")}.bind(this)})}else this.props.errorToggle("Please enter a valid email address")},this.handleClose=()=>{this.setState({showConflict:!1})},this.forEdit=e=>{if(e){q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){q()(t).find("img").each((function(e,t){if(q()(t)[0].src.startsWith("blob")){let e=document.createElement("canvas"),a=new Image;a=q()(t),e.width=a[0].width,e.height=a[0].height,e.getContext("2d").drawImage(a[0],0,0);let s=e.toDataURL("image/png");q()(t).attr("src",s)}}))}));let e={parent:Number(this.props.parent),body:q()("#tiny_"+this.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(this.props.targetid),target_type:this.props.type,parsed:0};q.a.ajax({type:"put",url:"/scot/api/v2/entry/"+this.props.id,data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(this),error:function(e){this.props.errorToggle("Failed to edit entry.",e)}.bind(this)})}},this.handleEditorChange=e=>{this.setState({localcontent:e})},this.render=()=>{let e="not_saved_entry_"+this.state.key;return i.a.createElement("div",{id:e,className:"not_saved_entry"},this.state.showConflict?i.a.createElement(Js.a,{fullWidth:!0,maxWidth:"md",open:this.state.showConflict,onClose:this.handleClose,"aria-labelledby":"simple-dialog-title"},i.a.createElement(Gs,{targetid:this.props.targetid,type:this.props.type,parent:this.props.parent,addedEntry:this.props.addedentry,id:this.props.id,localconflict:this.state.localcontent,handleClose:this.handleClose,remoteconflict:this.state.remoteconflict})):null,i.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},i.a.createElement("div",{className:"row-fluid entry-header"},i.a.createElement("div",{className:"entry-header-inner"},"[",i.a.createElement(Xs,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",this.state.whoami,i.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Export"===this.props.entryAction?i.a.createElement(Ys,{bsSize:"xsmall",onClick:this.exportContent,bsStyle:"success"},"Export"):i.a.createElement(Ys,{bsSize:"xsmall",onClick:this.submit,bsStyle:"success"},"Submit"),i.a.createElement(Ys,{bsSize:"xsmall",onClick:this.onCancel},"Cancel")))),this.state.asyncContentLoaded?i.a.createElement(Bs.a,{id:this.state.tinyID,className:"inputtext",initialValue:this.state.content,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools",onEditorChange:this.handleEditorChange,init:{table_default_attributes:{border:"5",borderStyle:"solid",borderColor:"blue"},auto_focus:this.state.tinyID,browser_spellcheck:!0,contextmenu:!1,codesample_languages:[{text:"C",value:"c"},{text:"C#",value:"csharp"},{text:"C++",value:"cpp"},{text:"Docker",value:"docker"},{text:"HTTP",value:"http"},{text:"JavaScript",value:"javascript"},{text:"Java",value:"java"},{text:"JSON",value:"json"},{text:"Markdown",value:"md"},{text:"Perl",value:"perl"},{text:"PHP",value:"php"},{text:"Powershell",value:"powershell"},{text:"Python",value:"python"},{text:"Ruby",value:"ruby"},{text:"Bash / Shell",value:"bash"},{text:"Splunk SPL ",value:"splunk-spl"},{text:"Visual Basic",value:"visual-basic"},{text:"HTML/XML",value:"markup"}],plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools codesample",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},paste_postprocess:(e,t)=>{t.node.querySelectorAll("table").forEach(e=>{e.setAttribute("border","1"),e.setAttribute("cellpadding","1"),e.setAttribute("cellspacing","0")})},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen  | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote | codesample",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.ui.registry.addMenuButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",fetch:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}):i.a.createElement("div",null,"Loading Editor...")),i.a.createElement(Qs,{when:this.state.leaveCatch,message:"Unsubmitted entry detected. You may want to submit or copy the contents of the entry before navigating elsewhere. Click CANCEL to prevent navigation elsewhere."}))};let t=new Date;t=t.getTime();let a,s,r="tiny_"+t;switch(this.props.entryAction){case"Add":case"Reply":a="",s=!0;break;case"Copy To Entry":a=this.props.content,s=!0;break;case"Edit":a="",s=!1;break;case"Export":a=this.props.content,s=!0;break;default:a="",s=!0}this.state={tinyID:r,key:t,content:a,asyncContentLoaded:s,leaveCatch:!0,whoami:void 0,recentlyUpdated:0,showConflict:!1,localcontent:""}}}var Zs=a(436),ei=a.n(Zs),ti=a(154),ai=a.n(ti),si=a(450);let ii,ri,ni,li;class oi extends i.a.Component{constructor(e){super(e),this.componentWillMount=()=>{},this.onLoad=()=>{if(void 0!==document.getElementById("iframe_"+this.props.id)&&null!==document.getElementById("iframe_"+this.props.id))if("complete"===document.getElementById("iframe_"+this.props.id).contentDocument.readyState){let e=q()("#iframe_"+this.props.id),t=q()(e).contents(),a=q()(t).find("head");a&&(q()(a).find("link")||a.append(q()("<link/>",{rel:"stylesheet",href:"css/sandbox.css",type:"text/css"}))),setTimeout(function(){void 0!==document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){let e;e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight,e+="px",this.state.height!==e&&this.setState({height:e})}.bind(this))}.bind(this),250)}else setTimeout(this.onLoad,0)},this.componentDidMount=()=>{this.setState({isMounted:!0});let e=this.state.tabs,t=this.props.entityvalue;if("source"!==this.props.entitytype)if(void 0===this.state.entityid||isNaN(this.state.entityid))q.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/byname",data:{name:t},success:function(t){let a=t.id;this.state.isMounted&&(this.setState({entityid:a}),q.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/"+a,success:function(t){let s={data:t,entityid:a,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(s),this.state.isMounted){let t=[];t.push(a),this.setState({tabs:e,currentKey:a,initialLoad:!0,processedIds:t}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail id information ",e)}.bind(this)});else{let t=this.state.entityid;Array.isArray(t)||(t=[parseInt(t,10)]);for(let a=0;a<t.length;a++)q.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/"+t[a],success:function(t){let a={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(a),this.state.isMounted){let a=[];a.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:a}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)})}else{let t={data:this.props.data,entityid:this.props.entityid,entitytype:this.props.entitytype,valueClicked:this.props.entitytype};e.push(t);let a=[];a.push(this.props.entityid),this.setState({tabs:e,currentKey:parseInt(this.props.entityid,10),initialLoad:!0,processedIds:a}),this.props.createCallback(this.props.entityid,this.updated)}q()(document).keydown(function(e){q()("input").is(":focus")||void 0===q()("#main-search-results")[0]&&27===e.keyCode&&(this.props.flairToolbarOff(),e.preventDefault())}.bind(this)),this.containerHeightAdjust(),window.addEventListener("resize",this.containerHeightAdjust),this.onLoad(),q()("iframe").each((function(e,t){t.contentWindow.requestAnimationFrame((function(){if(null!=t.contentDocument){let e=q()(t).contents();q()(t.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each((function(e,t){let a=q()(t).attr("href");q()(t).attr("url",a)}))}}))}))},this.componentWillUnmount=()=>{this.setState({isMounted:!1}),q()(document).off("keydown")},this.componentWillReceiveProps=e=>{this.onLoad();let t={checkForInitialLoadComplete:function(){let a={addNewEntity:function(){let t=this.state.tabs;if("source"!==e.entitytype)void 0===e.entityid||isNaN(e.entityid)?q.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/byname",data:{name:e.entityvalue},success:function(a){let s=a.id;this.state.isMounted&&(this.setState({entityid:s}),q.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+s,success:function(a){let i={data:a,entityid:s,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(i),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity id detail information",e)}.bind(this)}):q.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+e.entityid,success:function(a){let s={data:a,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(s),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)});else{let a={data:e.data,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entitytype};t.push(a);let s=[];s.push(e.entityid),this.setState({tabs:t,currentKey:parseInt(e.entityid,10),initialLoad:!0,processedIds:s}),this.props.createCallback(e.entityid,this.updated),this.props.watcher()}}.bind(this)};if(!1===this.state.initialLoad)setTimeout(t.checkForInitialLoadComplete,50);else if(void 0!==e&&null!=e.entitytype&&void 0!==e.entityid){let t=parseInt(e.entityid,10);for(let s=0;s<this.state.tabs.length;s++){if(t===this.state.tabs[s].entityid||"guide"===this.state.tabs[s].entitytype&&"guide"===e.entitytype)return void(this.state.isMounted&&this.setState({currentKey:t}));{let e=this.state.processedIds,s=!0;for(let a=0;a<e.length;a++)e[a]===t&&(s=!1);s&&(a.addNewEntity(),e.push(t),this.setState({processedIds:e}))}}}}.bind(this)};t.checkForInitialLoadComplete(),this.containerHeightAdjust()},this.updated=()=>{let e=this.state.tabs;this.props.entityvalue;for(let t=0;t<e.length;t++){let a=t;q.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/"+e[t].entityid,success:function(t){let s={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e[a]=s,this.state.isMounted){let a=[];a.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:a})}}.bind(this),error:function(e){this.props.errorToggle("failed to get updated entity detail information",e)}.bind(this)})}},this.checkFlairHover=e=>{null!=e.contentDocument&&q()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"===q()(t).css("color"))q()(t).data("state","down");else if("down"===q()(t).data("state")){q()(t).data("state","up");let e=q()(t).attr("url");this.props.linkWarningToggle(e)}}.bind(this))},this.initDrag=e=>{if(q()("#dragme").hasClass("entityPopUpMaxSizeDefault")){let e=q()("#dragme").height()+"px";q()("#dragme").css("height",e),q()("#dragme").removeClass("entityPopUpMaxSizeDefault")}let t=document.getElementById("dragme");ii=e.clientX,ri=e.clientY,ni=parseInt(document.defaultView.getComputedStyle(t).width,10),li=parseInt(document.defaultView.getComputedStyle(t).height,10),document.documentElement.addEventListener("mousemove",this.doDrag,!1),document.documentElement.addEventListener("mouseup",this.stopDrag,!1),this.blockiFrameMouseEvent()},this.doDrag=e=>{let t=document.getElementById("dragme");console.log("elem.style.width before: ".concat(t.style.width)),console.log("e.clientX before: ".concat(e.clientX)),console.log("startX before: ".concat(ii)),console.log("startwidth before: ".concat(ni)),ni+e.clientX-ii>586&&(t.style.width=ni+e.clientX-ii+"px"),li+e.clientY-ri>386&&(t.style.height=li+e.clientY-ri+"px")},this.stopDrag=e=>{document.documentElement.removeEventListener("mousemove",this.doDrag,!1),document.documentElement.removeEventListener("mouseup",this.stopDrag,!1),this.allowiFrameMouseEvent()},this.moveDivInit=e=>{document.documentElement.addEventListener("mouseup",this.moveDivStop,!1),this.blockiFrameMouseEvent()},this.moveDivStop=e=>{document.documentElement.removeEventListener("mouseup",this.moveDivStop,!1),this.allowiFrameMouseEvent()},this.blockiFrameMouseEvent=()=>{q()("iframe").each((function(e,t){q()(t).addClass("pointerEventsOff")}))},this.allowiFrameMouseEvent=()=>{q()("iframe").each((function(e,t){q()(t).removeClass("pointerEventsOff")}))},this.handleSelectTab=e=>{this.setState({currentKey:e})},this.positionRightBoundsCheck=e=>e?q()(document).width()-(this.state.defaultEntityOffset.left+e)-this.state.entityWidthint:q()(document).width()-this.state.defaultEntityOffset.left-this.state.entityWidthint,this.containerHeightAdjust=()=>{if(!0===this.props.fullScreen){let e;q()("#list-view-container")[0]?(e=q()(window).height()-q()("#list-view-container").height()-q()("#header").height()-70,e+="px"):(e=q()(window).height()-q()("#header").height()-70,e+="px"),this.state.isMounted&&this.setState({height:e})}},this.render=()=>{let e,t,a=[],s="box react-draggable entityPopUp entityPopUpMaxSizeDefault";(!0===this.props.fullScreen||q()("react-draggable-dragged"))&&(s="box react-draggable entityPopUp"),!0===this.props.fullScreen&&(s+=" height100percent");for(let r=0;r<this.state.tabs.length;r++){let e=r+1,t="tab";t="guide"===this.state.tabs[r].entitytype?"guide":"source"===this.state.tabs[r].entitytype?"source":void 0!==this.state.tabs[r].valueClicked?this.state.tabs[r].valueClicked.slice(0,15):"",a.push(i.a.createElement(Ws.a,{className:"tab-content",eventKey:this.state.tabs[r].entityid,title:t},i.a.createElement(ci,{addFlair:this.props.addFlair,data:this.state.tabs[r].data,form:this.props.form,type:this.props.type,id:this.props.id,entityid:this.state.tabs[r].entityid,entitytype:this.state.tabs[r].entitytype,valueClicked:this.state.tabs[r].valueClicked,i:e,key:e,errorToggle:this.props.errorToggle,linkWarningToggle:this.props.linkWarningToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback})))}if(this.state.defaultEntityOffset&&this.state.entityobj){this.positionRightBoundsCheck();t=this.positionRightBoundsCheck(q()(this.state.entityobj).width())<0?this.state.defaultEntityOffset.left-this.state.entityWidthint:this.state.defaultEntityOffset.left+q()(this.state.entityobj).width()}else e=50,t=0;return!0===this.props.fullScreen?i.a.createElement("div",{id:"popup-flex-container",style:{height:this.state.height},className:"entity-full-screen"},i.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},i.a.createElement(Us.a,{className:"tab-content",defaultActiveKey:this.props.entityid,activeKey:this.state.currentKey,onSelect:this.handleSelectTab,bsStyle:"pills",animation:!1},a))):i.a.createElement(ei.a,{handle:"#handle",onMouseDown:this.moveDivInit},i.a.createElement("div",{id:"dragme",className:s,style:{width:this.state.entityWidth,left:t,maxHeight:"90vh"}},i.a.createElement("div",{id:"popup-flex-container",style:{height:"100%",display:"flex",flexFlow:"row"}},i.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},i.a.createElement("div",{id:"handle",style:{width:"100%",background:"#292929",color:"white",fontWeight:"900",fontSize:"large",textAlign:"center",cursor:"move",flex:"0 1 auto"}},i.a.createElement("div",null,i.a.createElement("span",{className:"pull-left",style:{paddingLeft:"5px"}},i.a.createElement("i",{className:"fa fa-arrows","aria-hidden":"true"})),i.a.createElement("span",{className:"pull-right",style:{cursor:"pointer",paddingRight:"5px"}},i.a.createElement("i",{className:"fa fa-times",style:{color:"red"},onClick:this.props.flairToolbarOff})))),i.a.createElement(Us.a,{className:"tab-content",defaultActiveKey:this.props.entityid,activeKey:this.state.currentKey,onSelect:this.handleSelectTab,bsStyle:"pills",animation:!1},a)),i.a.createElement("div",{id:"sidebar",onMouseDown:this.initDrag,style:{flex:"0 1 auto",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden",width:"5px"}})),i.a.createElement("div",{id:"footer",onMouseDown:this.initDrag,style:{display:"block",height:"5px",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden"}})))};let t="100%",a="700px",s="70vh";!0===this.props.fullScreen&&(t="95vh",a="95%",s="95vh"),this.state={entityData:null,entityid:this.props.entityid,entityHeight:t,entityWidth:a,entityWidthint:700,entityMaxHeight:s,tabs:[],initialLoad:!1,processedIds:[],valueClicked:"",defaultEntityOffset:this.props.entityoffset,entityobj:this.props.entityobj,height:null,isMounted:!1}}}class ci extends i.a.Component{constructor(...e){super(...e),this.render=()=>{if("entity"===this.props.entitytype)return i.a.createElement("div",{className:"tab-content"},i.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},i.a.createElement("h4",{id:"myModalLabel"},null!=this.props.data?i.a.createElement(di,{value:this.props.valueClicked,data:this.props.data,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair}):i.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading..."))),i.a.createElement("div",{style:{height:"100%",display:"flex",flex:"1 1 auto",marginLeft:"10px",flexFlow:"inherit",minHeight:"1px"}},null!=this.props.data?i.a.createElement(hi,{data:this.props.data,entityid:this.props.entityid,type:this.props.type,id:this.props.id,errorToggle:this.props.errorToggle,linkWarningToggle:this.props.linkWarningToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair}):i.a.createElement("div",null,"Loading...")));if("guide"===this.props.entitytype){let e="/guide/"+this.props.entityid;return i.a.createElement("div",{className:"tab-content"},i.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},i.a.createElement(ke.Link,{to:e,target:"_blank"},i.a.createElement("h4",{id:"myModalLabel"},null!=this.props.data?i.a.createElement("span",null,i.a.createElement("span",null,i.a.createElement(di,{value:this.props.entityid,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair})),i.a.createElement("div",null,i.a.createElement(di,{value:this.props.data.applies_to,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair}))):i.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading...")))),i.a.createElement("div",{style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=this.props.data?i.a.createElement(gi,{entityid:this.props.entityid,form:this.props.form,data:this.props.data,entitytype:this.props.entitytype,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair}):i.a.createElement("div",null,"Loading...")))}return"source"===this.props.entitytype?i.a.createElement("div",{className:"tab-content"},i.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),i.a.createElement("div",{id:"source-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=this.props.entitytype?i.a.createElement(yi,{data:this.props.data,entityid:this.props.entityid,entitytype:this.props.entitytype,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback}):i.a.createElement("div",null,"Loading..."))):"entry"===this.props.entitytype?i.a.createElement("div",{className:"tab-content"},i.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),i.a.createElement("div",{id:"entry-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=this.props.entitytype?i.a.createElement("div",null,i.a.createElement($s,{entryAction:"Add",type:"alert",targetid:this.props.entityid,id:"add_entry",addedentry:this.entryToggle,errorToggle:this.props.errorToggle}),i.a.createElement(Qi,{type:"alert",id:this.props.entityid,isPopUp:1,headerData:this.props.data,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair})):i.a.createElement("div",null,"Loading..."))):void 0}}}class di extends i.a.Component{constructor(...e){super(...e),this.render=()=>{if(void 0!==this.props.data){let e="/entity/"+this.props.data.id;return i.a.createElement("div",{className:"flair_header"},i.a.createElement("div",null,i.a.createElement(ke.Link,{to:e,target:"_blank"},"Entity ",this.props.data.id),i.a.createElement("span",null,"\xa0"),i.a.createElement(ja,{status:this.props.data.status,id:this.props.data.id,type:"entity",errorToggle:this.props.errorToggle}),i.a.createElement("span",null,"\xa0"),i.a.createElement(Va,{type:"entity",id:this.props.data.id,string:this.props.value}),i.a.createElement("span",null,"\xa0"),this.props.data.data&&this.props.data.data.scanner&&"true"==this.props.data.data.scanner.active?i.a.createElement("img",{class:"extras",title:"scanner",src:"/images/flair/scanner.png"}):null),i.a.createElement("div",null,i.a.createElement("span",null,this.props.data.type,":"),"\xa0",i.a.createElement("span",null,this.props.value)))}return i.a.createElement("div",{className:"flair_header"},this.props.value)}}}class hi extends i.a.Component{constructor(e){super(e),this.updateAppearances=e=>{if(null!==e&&0!==e){let t=this.state.appearances+e;this.state.isMounted&&this.setState({appearances:t})}},this.entryToggle=()=>{!1===this.state.entryToolbar?this.setState({entryToolbar:!0}):this.setState({entryToolbar:!1})},this.showFullEntityButton=()=>{"entity"!==this.props.type&&this.setState({showFullEntityButton:!0})},this.linkOnClickIntercept=e=>{this.props.linkWarningToggle(e.target.id,e.target.dataset.nopop)},this.render=()=>{let e=[],t=[],a=[],s=4;if(void 0!==this.props.data){let r=this.props.data.data;for(let n in r)if(void 0!==r[n])if("geoip"===n)a.push(i.a.createElement(Ws.a,{eventKey:s,className:"entityPopUpButtons",style:{overflow:"auto"},title:n},i.a.createElement(pi,{data:r[n].data,type:this.props.type,id:this.props.id,entityData:this.props.data,errorToggle:this.props.errorToggle}))),s++;else if("data"===r[n].type)e.push(i.a.createElement(Ws.a,{eventKey:s,className:"entityPopUpButtons",style:{overflow:"auto"},title:n},i.a.createElement(ui,{dataSource:r[n],type:this.props.type,id:this.props.id,errorToggle:this.props.errorToggle}))),s++;else if("link"===r[n].type&&"Lookup in Likaboss"!==r[n].data.title){const e=!!r[n].data.nopopup;console.log(r[n].data),t.push(i.a.createElement(Ra.a,{bsSize:"xsmall",id:r[n].data.url,"data-nopop":e,onMouseDown:this.linkOnClickIntercept,target:"_blank"},r[n].data.title)),s++}}let r="/entity/"+this.props.entityid;return i.a.createElement(Us.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},i.a.createElement(Ws.a,{eventKey:1,className:"entityPopUpButtons",title:this.state.appearances,style:{height:"100%"}},i.a.createElement("div",null,t),i.a.createElement("div",{style:{maxHeight:"30vh",overflowY:"auto"}},i.a.createElement("span",null,i.a.createElement("b",null,"Appears: ",this.state.appearances," times")),!0===this.state.showFullEntityButton?i.a.createElement("span",{style:{paddingLeft:"5px"}},i.a.createElement(ke.Link,{to:r,style:{color:"#c400ff"},target:"_blank"},"List truncated due to large amount of references. Click to view the whole entity")):null,i.a.createElement("br",null),i.a.createElement(mi,{entityid:this.props.entityid,updateAppearances:this.updateAppearances,type:this.props.type,showFullEntityButton:this.showFullEntityButton,errorToggle:this.props.errorToggle}),i.a.createElement("br",null)),i.a.createElement("hr",{style:{marginTop:".5em",marginBottom:".5em"}}),i.a.createElement("div",{style:{maxHeight:"50vh",overflowY:"auto"}},i.a.createElement("div",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.entryToggle},"Add Entry"),i.a.createElement("br",null)),this.state.entryToolbar?i.a.createElement($s,{entryAction:"Add",type:"entity",targetid:this.props.entityid,id:"add_entry",addedentry:this.entryToggle,errorToggle:this.props.errorToggle}):null,i.a.createElement(Qi,{type:"entity",addFlair:this.props.addFlair,id:this.props.entityid,isPopUp:1,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback}))),a,e)},this.state={loading:"Loading Entries",entryToolbar:!1,appearances:0,showFullEntityButton:!1,isMounted:!1}}componentDidMount(){this.setState({isMounted:!0})}componentWillUnmount(){this.setState({isMounted:!1})}}class pi extends i.a.Component{constructor(e){super(e),this.copyToEntry=()=>{!1===this.state.copyToEntryToolbar?this.setState({copyToEntryToolbar:!0}):this.setState({copyToEntryToolbar:!1})},this.copyToEntity=()=>{!1===this.state.copyToEntityToolbar?this.setState({copyToEntityToolbar:!0}):this.setState({copyToEntityToolbar:!1})},this.state={copyToEntryToolbar:!1,copyToEntityToolbar:!1}}render(){let e=[],t=[];t.push("<table>");for(let s in this.props.data){let a=this.props.data[s];e.push(i.a.createElement("tr",null,i.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},i.a.createElement("b",null,s)),i.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},this.props.data[s]))),t.push('<tr><td style={{paddingRight:"4px", paddingLeft:"4px"}}><b>'+s+'</b></td><td style={{paddingRight:"4px", paddingLeft:"4px"}}>'+a+"</td></tr>")}t.push("</table>");let a=t.join("");return i.a.createElement("div",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.copyToEntity},"Copy to ",i.a.createElement("b",null,"entity")," entry"),"alertgroup"!==this.props.type?i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.copyToEntry},"Copy to"," ",i.a.createElement("b",null,this.props.type," ",this.props.id)," ","entry"):null,this.state.copyToEntryToolbar?i.a.createElement($s,{entryAction:"Copy To Entry",type:this.props.type,targetid:this.props.id,id:this.props.id,addedentry:this.copyToEntry,content:a,errorToggle:this.props.errorToggle}):null,this.state.copyToEntityToolbar?i.a.createElement($s,{entryAction:"Copy To Entry",type:"entity",targetid:this.props.entityData.id,id:this.props.entityData.id,addedentry:this.copyToEntity,content:a,errorToggle:this.props.errorToggle}):null,i.a.createElement("div",{className:"entityTableWrapper"},i.a.createElement("table",{className:"tablesorter entityTableHorizontal",id:"sortableentitytable",width:"100%"},e)))}}class ui extends i.a.Component{render(){let e=this.props.dataSource;return i.a.createElement("div",{style:{overflowY:"auto",maxHeight:"70vh"}},i.a.createElement("div",null,i.a.createElement(Fs.a,{data:e,expandLevel:4})))}}class mi extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{this.setState({isMounted:!0});["incident","event","intel","guide","signature","alert"].forEach(function(e){let t=[],a=[],s=[],i=[];na("scot/api/v2/entity/".concat(this.props.entityid,"/").concat(e)).then(function(r){const n=r.data.records;this.props.updateAppearances(n.length),n.forEach(function(r){r.type=e,"open"===r.status?t.push(r):"closed"===r.status?a.push(r):"promoted"===r.status?s.push(r):i.push(r)}.bind(this)),t.sort(this.compareUpdatedDate),a.sort(this.compareUpdatedDate),s.sort(this.compareUpdatedDate),i.sort(this.compareUpdatedDate);let l=this.state.loadingType;l[e]=!1,this.setState({entityReferencesData:[...this.state.entityReferencesData,...s,...t,...a,...i],loadingType:l})}.bind(this))}.bind(this)),this.state.entityReferencesData.length>0&&this.props.showFullEntityButton()},this.componentDidUpdate=()=>{},this.componentWillUnmount=()=>{this.setState({isMounted:!1})},this.compareUpdatedDate=(e,t)=>e.updated>t.updated?-1:1,this.render=()=>{let e=this.state.loading;this.state.loadingSignature||this.state.loadingEvents||this.state.loadingAlerts||this.state.loadingIncidents||this.state.loadingIncidents||(e=!1);this.props.entityid;let t=5;return this.state.entityReferencesData.length>0&&(console.log("got data"),console.log(this.state.entityReferencesData),t=this.state.entityReferencesData.length),i.a.createElement("div",null,e?i.a.createElement("span",null,"Loading: ",this.state.loadingAlerts?i.a.createElement("span",null,"Alerts "):null,this.state.loadingEvents?i.a.createElement("span",null,"Events "):null,this.state.loadingIncidents?i.a.createElement("span",null,"Incidents "):null,this.state.loadingIntel?i.a.createElement("span",null,"Intel "):null,this.state.loadingSignature?i.a.createElement("span",null,"Signature "):null):null,i.a.createElement(si.a,null,i.a.createElement(Bt.a,{className:"-striped -highlight",data:this.state.entityReferencesData,columns:[{Header:"Status",accessor:"status",width:79,Cell:e=>{let t="";return void 0===e.original.status?i.a.createElement("div",null,"N/A"):"closed"===e.original.status?i.a.createElement("span",{style:{color:"green"}},e.original.status):"open"===e.original.status?i.a.createElement("span",{style:{color:"red"}},e.original.status):"promoted"===e.original.status?("alert"===e.original.type?t="/#/event/".concat(e.original.promotion_id):"event"===e.original.type&&(t="/#/incident/".concat(e.original.promotion_id)),i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement(P.a,{bsSize:"xsmall",bsStyle:"warning",href:t,target:"_blank",style:{lineHeight:"12pt",fontSize:"10pt",marginLeft:"auto"}},e.original.status))):void 0}},{Header:"ID",accessor:"id",width:85,Cell:e=>{if(e.original.id)return i.a.createElement(ke.Link,{to:"/".concat(e.original.type,"/").concat(e.original.id),target:"_blank"},e.original.id)}},{Header:"type",accessor:"type",width:50},{Header:"Entries",accessor:"entry_count",width:66},{Header:"subject",accessor:"subject"},{Header:"updated",accessor:"updated",width:121,Cell:e=>{let t="Unknown";return void 0!==e.original.updated&&(t=Math.floor((Math.round((new Date).getTime()/1e3)-e.original.updated)/86400)),i.a.createElement("span",null,t," days ago")}}],minRows:0,sortable:!0})))};let t=100;"entity"===this.props.type&&(t=void 0),this.state={entityReferencesData:[],maxRecords:t,loadingType:{alert:!0,event:!0,intel:!0,incident:!0,signature:!0,guide:!0},loading:!0,isMounted:!1,order:"asc",orderBy:"id"}}}class gi extends i.a.Component{constructor(e){super(e),this.entryToggle=()=>{!1===this.state.entryToolbar?this.setState({entryToolbar:!0}):this.setState({entryToolbar:!1})},this.state={entryToolbar:!1}}render(){return i.a.createElement(Us.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"pills"},i.a.createElement(Ws.a,{eventKey:1,style:{overflow:"auto",maxHeight:"70vh"}},i.a.createElement("div",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.entryToggle},"Add Entry"),i.a.createElement("br",null)),this.state.entryToolbar?i.a.createElement($s,{entryAction:"Add",type:"guide",targetid:this.props.entityid,id:"add_entry",addedentry:this.entryToggle,errorToggle:this.props.errorToggle}):null,i.a.createElement(Qi,{addFlair:this.props.addFlair,type:"guide",form:this.props.form,id:this.props.entityid,isPopUp:1,headerData:this.props.data,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback})))}}class yi extends i.a.Component{render(){return i.a.createElement("div",null,i.a.createElement("h2",null,"Source"),i.a.createElement(Us.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},i.a.createElement(Ws.a,{eventKey:1,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Rendered"},i.a.createElement(ai.a,{style:{width:"100%"},head:i.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",height:"500px"},i.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body}}))),i.a.createElement(Ws.a,{eventKey:2,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Raw Text"},i.a.createElement(ai.a,{head:i.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),style:{width:"100%"},frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",styleSheets:["/css/sandbox.css"],height:"500px"},">",i.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body_plain}})))))}}var fi=a(440),bi=a.n(fi),vi=a(446);let Ei=a(9),wi=a(31).Link,Si=[];class Ti extends i.a.Component{constructor(e){super(e),this.onCancel=()=>{Si=[],this.props.fileUploadToggle()},this.Close=e=>{for(let t=0;t<Si.length;t++)e.target.id===Si[t].name&&Si.splice(t,1);this.setState({files:Si})},this.onDrop=e=>{for(let t=0;t<e.length;t++)Si.push(e[t]);console.log(e),this.setState({files:Si})},this.submit=()=>{if(Si.length>0)for(let e=0;e<Si.length;e++){let t=new FormData;t.append("upload",Si[e]),t.append("target_type",this.props.type),t.append("target_id",Number(this.props.targetid)),null!=this.props.entryid&&t.append("entry_id",this.props.entryid);let a=new XMLHttpRequest;a.addEventListener("progress",this.uploadProgress),a.addEventListener("load",this.uploadComplete),a.addEventListener("error",this.uploadFailed),a.addEventListener("abord",this.uploadCancelled),a.open("POST","/scot/api/v2/file"),console.log(t),a.send(t)}else alert("Select a file to upload before submitting.")},this.uploadComplete=()=>{this.onCancel()},this.uploadFailed=()=>{this.props.errorToggle("An error occured. Upload failed.")},this.state={files:[],edit:!1,stagecolor:"#000",enable:!0,addentry:!0,saved:!0,enablesave:!0,whoami:void 0}}componentDidMount(){let e=ie("whoami");e&&this.setState({whoami:e}),q()(".entry-wrapper").scrollTop(q()(".entry-wrapper").scrollTop()+q()("#not_saved_entry_"+this.props.id).position().top)}render(){let e="not_saved_entry_"+this.props.id;return i.a.createElement("div",{id:e},i.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},i.a.createElement("div",{className:"row-fluid entry-header"},i.a.createElement("div",{className:"entry-header-inner"},"[",i.a.createElement(wi,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",this.state.whoami,i.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},i.a.createElement(Ei,{bsSize:"xsmall",onClick:this.submit},"Submit"),i.a.createElement(Ei,{bsSize:"xsmall",onClick:this.onCancel},"Cancel")))),i.a.createElement(vi.a,{onDrop:this.onDrop},({getRootProps:e,getInputProps:t})=>i.a.createElement("section",null,i.a.createElement("div",Object.assign({style:{"border-width":"2px","border-color":"#000","border-radius":"4px","border-style":"dashed","text-align":"center","background-color":"azure"}},e()),i.a.createElement("input",t()),i.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")))),this.state.files?i.a.createElement("div",null," ",this.state.files.map(function(e){return i.a.createElement("ul",{style:{"list-style-type":"none",margin:"0",padding:"0"}},i.a.createElement("li",null,i.a.createElement("p",{style:{display:"inline"}},e.name),i.a.createElement("button",{style:{"line-height":"1px"},className:"btn btn-info",id:e.name,onClick:this.Close},"x")))}.bind(this))):null))}}class ki extends i.a.Component{constructor(e){super(e),this.toggle=()=>{let e;1===this.props.summary?e="entry":0===this.props.summary&&(e="summary");let t={class:e};q.a.ajax({type:"put",url:"scot/api/v2/entry/"+this.props.entryid,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make summary",e)}.bind(this)})},this.render=()=>{let e,t="Summary Loading...";return 0===this.props.summary?(t="Make Summary",e=this.toggle):1===this.props.summary&&(t="Remove Summary",e=this.toggle),i.a.createElement("span",{style:{display:"block"},onClick:e},t)},this.state={key:this.props.id}}}class xi extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{let e=ie("whoami");this.setState({whoami:e})},this.makeTask=()=>{q.a.ajax({type:"put",url:"scot/api/v2/entry/"+this.props.entryid,data:JSON.stringify({make_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(this)})},this.closeTask=()=>{q.a.ajax({type:"put",url:"scot/api/v2/entry/"+this.props.entryid,data:JSON.stringify({close_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(this)})},this.takeTask=()=>{q.a.ajax({type:"put",url:"scot/api/v2/entry/"+this.props.entryid,data:JSON.stringify({take_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make Task owner",e)}.bind(this)})},this.render=()=>{let e,t="Task Loading...";return"task"===this.props.taskData.class?void 0===this.props.taskData.metadata.task.status||null===this.props.taskData.metadata.task.status||"task"!==this.props.taskData.class?(t="Make Task",e=this.makeTask):this.state.whoami!==this.props.taskData.metadata.task.who&&"open"===this.props.taskData.metadata.task.status?(t="Assign task to me",e=this.takeTask):this.state.whoami===this.props.taskData.metadata.task.who&&"open"===this.props.taskData.metadata.task.status?(t="Close Task",e=this.closeTask):"closed"===this.props.taskData.metadata.task.status||"completed"===this.props.taskData.metadata.task.status?(t="Reopen Task",e=this.makeTask):this.state.whoami===this.props.taskData.metadata.task.who&&"assigned"===this.props.taskData.metadata.task.status?(t="Close Task",e=this.closeTask):this.state.whoami!==this.props.taskData.metadata.task.who&&"assigned"===this.props.taskData.metadata.task.status&&(t="Assign task to me",e=this.takeTask):(t="Make Task",e=this.makeTask),i.a.createElement("span",{style:{display:"block"},onClick:e},t)},this.state={whoami:void 0}}}const Ci={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class Di extends i.a.Component{constructor(...e){super(...e),this.proceed=()=>{window.open(this.props.link,"_blank").opener=null,this.props.linkWarningToggle()},this.apiOnly=()=>{this.props.linkWarningToggle(),fetch(this.props.link),alert("Request Submitted. Refresh entity display to see results")},this.componentWillMount=()=>{if("true"===this.props.nopop)return void this.apiOnly();let e=window.location.href,t=new RegExp(/((https?|ftp):\/\/[a-zA-Z0-9\-_\.]+\.)?([a-zA-Z0-9\-_\.]+\.([a-zA-Z]{1,63}))/,"i"),a=this.props.link.match(t),s=e.match(t);if(void 0!=a&&void 0!=s){a[3]===s[3]&&this.proceed()}else void 0==a&&this.proceed()},this.render=()=>i.a.createElement("div",null,i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.props.linkWarningToggle,style:Ci},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:this.props.linkWarningToggle}),i.a.createElement("h3",{id:"myModalLabel"},"Browse to site?")),i.a.createElement("div",{className:"modal-body"},"The link you clicked may take you to a site outside SCOT. If this is a link an attacker controls you may be tipping your hand.",i.a.createElement("br",null),i.a.createElement("b",null,this.props.link)),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(Ra.a,{id:"cancel-delete",onClick:this.props.linkWarningToggle},"Cancel"),i.a.createElement(Ra.a,{bsStyle:"info",id:"proceed",onClick:this.proceed},"Proceed"))))}}a(261);var Ni=a(278),_i=a.n(Ni);a(845),a(846),a(847),a(848),a(849),a(850),a(851),a(852),a(853),a(854),a(856),a(857),a(858),a(859),a(860),a(861),a(862),a(863),a(864),a(865),a(866),a(867),a(868),a(869),a(870),a(871),a(872),a(873);class Mi extends i.a.Component{constructor(e){super(e),this.onChange=e=>{this.setState({value:e})},this.submitSigBody=e=>{let t="scot/api/v2/sigbody/",a=this.state.viewVersionid;"put"==this.state.ajaxType&&(a=this.state.viewSigBodyid,t="scot/api/v2/sigbody/"+a),q.a.ajax({type:this.state.ajaxType,url:t,data:JSON.stringify({signature_id:parseInt(this.props.id),body:this.state.value}),contentType:"application/json; charset=UTF-8",success:function(e){let t;console.log("successfully changed signature data"),t=void 0==e.revision?this.state.viewVersionid:e.revision,this.setState({readOnly:!0,cursorEnabledDisabled:"cursorDisabled",ajaxType:null,viewVersionid:t,viewSigBodyid:e.id})}.bind(this),error:function(e){this.props.errorToggle("Failed to create/update sigbody",e)}.bind(this)})},this.componentWillReceiveProps=e=>{this.setState({signatureData:e.headerData})},this.editSigBody=e=>{this.setState({readOnly:!1,lastViewVersionid:this.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"put"})},this.createNewSigBody=()=>{this.setState({readOnly:!1,viewVersionid:null,lastViewVersionid:this.state.viewVersionid,value:"",cursorEnabledDisabled:"cursorEnabled",ajaxType:"post"})},this.createNewSigBodyFromSig=()=>{this.setState({readOnly:!1,lastViewVersionid:this.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"post",viewVersionid:null})},this.Cancel=()=>{let e="";0!==Object.keys(this.state.signatureData.version).length&&void 0!=this.state.signatureData.version[this.state.signatureData.prod_sigbody_id]&&(e=this.state.signatureData.version[this.state.lastViewVersionid].body),this.setState({readOnly:!0,value:e,viewVersionid:this.state.lastViewVersionid,cursorEnabledDisabled:"cursorDisabled",ajaxType:null})},this.viewSigBody=e=>{!0===this.state.readOnly&&this.setState({value:this.state.signatureData.version[e.target.id].body,viewVersionid:e.target.id,viewSigBodyid:e.target.viewSigBodyid})},this.keyboardHandlerUpdate=e=>{Dt("signatureKeyboardHandler",e.target.text,1e3),this.setState({currentKeyboardHandler:e.target.text})},this.languageModeUpdate=e=>{Dt("signatureLanguageMode",e.target.text,1e3),this.setState({currentLanguageMode:e.target.text})},this.editorThemeUpdate=e=>{Dt("signatureEditorTheme",e.target.text,1e3),this.setState({currentEditorTheme:e.target.text})};let t=new Date;t=t.getTime();let a,s="",i="none",r="java",n="github",l=this.props.headerData.prod_sigbody_id;if(void 0!=kt("signatureKeyboardHandler")&&(i=kt("signatureKeyboardHandler")),void 0!=kt("signatureLanguageMode")&&(r=kt("signatureLanguageMode")),void 0!=kt("signatureEditorTheme")&&(n=kt("signatureEditorTheme")),0!==Object.keys(this.props.headerData.version).length)if(void 0!=this.props.headerData.version[this.props.headerData.prod_sigbody_id]||0==this.props.headerData.version[this.props.headerData.prod_sigbody_id])s=this.props.headerData.version[this.props.headerData.prod_sigbody_id].body,a=this.props.headerData.version[this.props.headerData.prod_sigbody_id].id;else for(let o in this.props.headerData.version)o<l||(l=o,s=this.props.headerData.version[o].body,a=this.props.headerData.version[o].id);this.state={readOnly:!0,value:s,signatureData:this.props.headerData,loaded:!0,viewSigBodyid:a,viewVersionid:l,lastViewVersionid:null,key:t,cursorEnabledDisabled:"cursorDisabled",keyboardHandlers:["none","vim","emacs"],currentKeyboardHandler:i,languageModes:["bro","csharp","c_cpp","html","javascript","java","json","markdown","mysql","perl","powershell","python","ruby","sass","xml","yaml"],currentLanguageMode:r,editorThemes:["github","monokai","kuroir","solarized_dark","solarized_light","terminal","textmate","tomorrow","twilight","xcode"],currentEditorTheme:n,ajaxType:null}}render(){let e=[],t=[],a=[],s=[],r="not_saved_signature_entry_"+this.state.key,n=this.state.currentKeyboardHandler,l=[],o=0;if(0!==Object.keys(this.state.signatureData).length&&0!==Object.keys(this.state.signatureData.version).length)for(let c in this.state.signatureData.version){let t,a=this.state.signatureData.version[c].revision,s=this.state.signatureData.version[c].revision,r=this.state.signatureData.version[c].id;this.state.signatureData.prod_sigbody_id==a?s=a+" - Production":this.state.signatureData.qual_sigbody_id==a&&(s=a+" - Quality"),t=1!=this.state.readOnly,e.push(i.a.createElement(y.a,{id:a,key:a,onClick:this.viewSigBody,eventKey:a,viewSigBodyid:r,bsSize:"xsmall",disabled:t},s)),a>o&&(o=a)}if(void 0!=this.state.keyboardHandlers)for(let c=0;c<this.state.keyboardHandlers.length;c++)t.push(i.a.createElement(y.a,{id:c,key:c,onClick:this.keyboardHandlerUpdate,eventKey:c,bsSize:"xsmall"},this.state.keyboardHandlers[c]));if("none"==this.state.currentKeyboardHandler&&(n=null),void 0!=this.state.languageModes)for(let c=0;c<this.state.languageModes.length;c++)a.push(i.a.createElement(y.a,{id:c,key:c,onClick:this.languageModeUpdate,eventKey:c,bsSize:"xsmall"},this.state.languageModes[c]));if(void 0!=this.state.editorThemes)for(let c=0;c<this.state.editorThemes.length;c++)s.push(i.a.createElement(y.a,{id:c,key:c,onClick:this.editorThemeUpdate,eventKey:c,bsSize:"xsmall"},this.state.editorThemes[c]));return this.state.signatureData.prod_sigbody_id==this.state.viewVersionid?l.push(i.a.createElement("span",{className:"signature_production_color"},this.state.viewVersionid," - Production")):this.state.signatureData.qual_sigbody_id==this.state.viewVersionid?l.push(i.a.createElement("span",{className:"signature_quality_color"},this.state.viewVersionid," - Quality")):l.push(i.a.createElement("span",null,this.state.viewVersionid)),i.a.createElement("div",{id:"signatureDetail",className:"signatureDetail"},this.state.loaded?i.a.createElement("div",null,i.a.createElement(Ai,{signatureData:this.state.signatureData,type:this.props.type,id:this.props.id,currentLanguageMode:this.state.currentLanguageMode,currentEditorTheme:this.state.currentEditorTheme,currentKeyboardHandlerApplied:n,errorToggle:this.props.errorToggle,showSignatureOptions:this.props.showSignatureOptions}),i.a.createElement("div",{id:r,className:"not_saved_signature_entry"},i.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},i.a.createElement("div",{className:"row-fluid signature-entry-header"},i.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Body: ",l,i.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Editor Theme:",i.a.createElement(gs.a,{bsSize:"xsmall",title:this.state.currentEditorTheme,id:"bg-nested-dropdown",style:{marginRight:"10px"}},s),"Language Handler:",i.a.createElement(gs.a,{bsSize:"xsmall",title:this.state.currentLanguageMode,id:"bg-nested-dropdown",style:{marginRight:"10px"}},a),"Keyboard Handler:",i.a.createElement(gs.a,{bsSize:"xsmall",title:this.state.currentKeyboardHandler,id:"bg-nested-dropdown",style:{marginRight:"10px"}},t),"Signature Body Version:",i.a.createElement(gs.a,{bsSize:"xsmall",title:l,id:"bg-nested-dropdown",style:{marginRight:"10px"}},e),this.state.readOnly?i.a.createElement("span",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.createNewSigBody,bsStyle:"success"},"Create new version"),0!=this.state.viewVersionid?i.a.createElement("span",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.createNewSigBodyFromSig},"Create new version using this base"),i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.editSigBody},"Update displayed version")):null):i.a.createElement("span",null,i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.submitSigBody},"Submit"),i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.Cancel},"Cancel"))))),i.a.createElement(_i.a,{mode:this.state.currentLanguageMode,theme:this.state.currentEditorTheme,onChange:this.onChange,name:"signatureEditor",editorProps:{$blockScrolling:!0},keyboardHandler:n,value:this.state.value,width:"100%",maxLines:50,minLines:10,readOnly:this.state.readOnly,className:this.state.cursorEnabledDisabled,showPrintMargin:!1})))):i.a.createElement("div",null,"Loading Signature Data..."))}}class Ai extends i.a.Component{constructor(e){super(e),this.submitMetaData=e=>{let t=e.target.id,a=e.target.value;if("options"==t||"target"==t){try{a=JSON.parse(a)}catch(i){return void this.props.errorToggle("Failed to convert string to object. Try adding quotation marks around the key and values")}let e=typeof a;if("object"!==e)return void this.props.errorToggle("options need to be an object but were detected as: "+e)}let s={};s[t]=a,q.a.ajax({type:"put",url:"scot/api/v2/signature/"+this.props.id,data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully changed signature data")}.bind(this),error:function(e){this.props.errorToggle("Failed to update signature metadata",e)}.bind(this)})},this.onOptionsChange=e=>{this.setState({optionsValue:e})},this.state={optionsValue:JSON.stringify(this.props.signatureData.options)}}render(){return i.a.createElement("div",null,this.props.showSignatureOptions?i.a.createElement("div",{id:"signatureTable2",className:"signatureTableOptions"},i.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},i.a.createElement("div",{className:"row-fluid signature-entry-header"},i.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Options",i.a.createElement(Ra.a,{type:"submit",bsSize:"xsmall",bsStyle:"success",onClick:this.submitMetaData,id:"options",value:this.state.optionsValue},"Apply"))),i.a.createElement(_i.a,{mode:"json",theme:this.props.currentEditorTheme,onChange:this.onOptionsChange,name:"signatureEditorOptions",editorProps:{$blockScrolling:!0},keyboardHandler:this.props.currentKeyboardHandlerApplied,value:this.state.optionsValue,minLines:10,maxLines:25,width:"100%",readOnly:!1,showPrintMargin:!1}))):null)}}i.a.Component;var ji=a(438),Oi=a.n(ji);class Li extends s.Component{constructor(e){super(e),this.state={suggestions:[],value:""},this.HandleAdd=this.HandleAdd.bind(this),this.HandleInputChange=this.HandleInputChange.bind(this)}componentWillMount(){this.props.value&&this.setState({value:this.props.value})}HandleAdd(e){this.setState({value:e}),this.props.OnChange(e)}HandleInputChange(e){if(this.props.OnChange(e.target.value),this.setState({value:e.target.value}),e.target&&e.target.value.length>=1){let t=[];q.a.ajax({type:"get",url:"/scot/api/v2/ac/"+this.props.type+"/"+e.target.value,success:function(e){e=e.records;for(let a=0;a<e.length;a++)if("string"===typeof e[a]){let s={};s.label=e[a],t.push(s)}this.setState({suggestions:t})}.bind(this),error:function(){console.log("failed to get autocomplete data")}})}}render(){return i.a.createElement("div",{className:"AutoCompleteInput"},i.a.createElement(Oi.a,{getItemValue:e=>e.label,items:this.state.suggestions,renderItem:(e,t)=>i.a.createElement("div",{style:{background:t?"lightgray":"white"}},e.label),value:this.state.value,onChange:this.HandleInputChange,onSelect:this.HandleAdd,menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",overflow:"auto",maxHeight:"200px",top:"unset",left:"unset",position:"absolute"},inputProps:{style:{width:"100%"}},wrapperProps:{style:{width:"300px"}}}))}}var Pi=Li;class Ii extends s.Component{constructor(e){super(e),this.HasSpacesCheck=e=>{!0===/\s/g.test(e)?this.setState({multiword:"yes"}):this.setState({multiword:"no"})},this.GetCount=()=>{this.setState({countLoading:!0});let e=encodeURIComponent(this.state.match);q.a.ajax({type:"get",url:"/scot/api/v2/hitsearch?match="+e,success:function(e){this.setState({count:e.count,countLoading:!1})}.bind(this),error:function(e){this.setState({count:"unable to get count",countLoading:!1})}.bind(this)})},this.Confirmation=()=>{!1===this.state.confirmation?(this.GetCount(),this.setState({confirmation:!0})):this.setState({confirmation:!1,value:""})},this.Submit=()=>{let e={value:this.state.value,match:this.state.match,status:"active",options:{multiword:this.state.multiword}};q.a.ajax({type:"POST",url:"/scot/api/v2/entitytype",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.props.ToggleCreateEntity()}.bind(this),error:function(e){e.responseJSON.error_msg?this.props.errorToggle("failed to create user defined entity: error_message: "+e.responseJSON.error_msg,e):this.props.errorToggle("failed to create user defined entity",e)}.bind(this)})},this.OnChangeMatch=e=>{this.setState({match:e.target.value}),this.HasSpacesCheck(e.target.value)},this.OnChangeValue=e=>{this.setState({value:e})},this.state={value:"",match:"",userdef:!0,status:"tracked",multiword:"yes",confirmation:!1,countLoading:!1}}componentWillMount(){this.props.match&&this.setState({match:this.props.match}),this.mounted=!0}componentDidMount(){this.HasSpacesCheck(this.props.match)}componentWillUnmount(){q()(document).unbind("keypress"),this.mounted=!1}render(){return i.a.createElement(U.a,{dialogClassName:"entity-create-modal",show:this.props.modalActive,onHide:this.props.ToggleCreateEntity},i.a.createElement(U.a.Header,{closeButton:!0},i.a.createElement(U.a.Title,null,this.state.confirmation?i.a.createElement("span",null,"Confirm and submit user defined entity"):i.a.createElement("span",null,"Create a user defined entity"))),i.a.createElement(U.a.Body,null,this.state.confirmation?i.a.createElement("span",null,i.a.createElement("div",null,"Entity Name: ",i.a.createElement("b",null,this.state.match)),i.a.createElement("div",null,"Entity Type: ",i.a.createElement("b",null,this.state.value)),i.a.createElement("div",null,"Multiword: ",i.a.createElement("b",null,this.state.multiword))):i.a.createElement("span",null,i.a.createElement("span",{style:{display:"flex"}},i.a.createElement("span",{style:{width:"150px"}},i.a.createElement("b",null,"New Entity Name:")),i.a.createElement("span",{style:{width:"300px"}},i.a.createElement("input",{type:"tag",onChange:this.OnChangeMatch,value:this.state.match,style:{width:"100%"}}))),i.a.createElement("span",{style:{display:"flex"}},i.a.createElement("span",{style:{width:"150px"}},i.a.createElement("b",null,"Entity Type:")),i.a.createElement("span",null,i.a.createElement(Pi,{type:"entitytype",OnChange:this.OnChangeValue,value:this.state.value}))))),i.a.createElement(U.a.Footer,null,this.state.confirmation?i.a.createElement("span",null,i.a.createElement("span",{style:{color:"red",float:"left"}},this.state.countLoading?i.a.createElement("span",null,"Count: is loading..."):i.a.createElement("span",null,"Count: ",this.state.count)),i.a.createElement("span",null,i.a.createElement(P.a,{onClick:this.Submit,bsStyle:"success"},"Submit"),i.a.createElement(P.a,{onClick:this.Confirmation},"Go Back"))):i.a.createElement("span",null,this.state.value.length>=1&&this.state.match.length>=1?i.a.createElement(P.a,{onClick:this.Confirmation,bsStyle:"primary",type:"submit",active:!0},"Continue"):null,i.a.createElement(P.a,{onClick:this.props.ToggleCreateEntity},"Cancel"))))}}var Fi=Ii,Ri=a(439),Ui=a.n(Ri),Hi=a(980);class Wi extends i.a.Component{constructor(...e){super(...e),this.onChange=e=>{let t=e.target.id,a=e.target.value,s={};s["data."+t]=a,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data"),this.forceUpdate()}.bind(this),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(this)})}}shouldComponentUpdate(e,t){return this.props.headerData!==e.headerData}render(){let e=[],t=[],a=[],s=[],r=[],n=[],l=[],o=this.props.form[this.props.headerData.data_fmt_ver];if(o)for(let c=0;c<o.length;c++){let d=o[c].value,h=o[c].value_type.url;switch(h&&(h=h.replace("%s",this.props.id)),o[c].value_type.key.split(".").reduce((e,t)=>e[t],this.props.headerData.data)&&(d=o[c].value_type.key.split(".").reduce((e,t)=>e[t],this.props.headerData.data)),o[c].type){case"dropdown":"static"==o[c].value_type.type?t.push(i.a.createElement(Bi,{onChange:this.onChange,label:o[c].label,id:o[c].key,referenceKey:o[c].value_type.key,value:d,dropdownValues:o[c].value,help:o[c].help})):t.push(i.a.createElement(Bi,{onChange:this.onChange,label:o[c].label,id:o[c].key,referenceKey:o[c].value_type.key,fetchURL:h,dynamic:!0,help:o[c].help}));break;case"input":"static"==o[c].value_type.type?s.push(i.a.createElement(Vi,{onBlur:this.onChange,value:d,id:o[c].key,label:o[c].label,help:o[c].help})):s.push(i.a.createElement(Vi,{onBlur:this.onChange,id:o[c].key,label:o[c].label,referenceKey:o[c].value_type.key,fetchURL:h,dynamic:!0,help:o[c].help}));break;case"calendar":if("static"==o[c].value_type.type){let e=1e3*d;a.push(i.a.createElement(zi,{typeTitle:o[c].label,value:e,typeLower:o[c].key,type:this.props.type,id:this.props.id,help:o[c].help}))}else a.push(i.a.createElement(zi,{typeTitle:o[c].label,typeLower:o[c].key,type:this.props.type,id:this.props.id,fetchURL:h,dynamic:!0,referenceKey:o[c].value_type.key,help:o[c].help}));break;case"textarea":"static"==o[c].value_type.type?r.push(i.a.createElement(qi,{id:o[c].key,value:d,onBlur:this.onChange,label:o[c].label,help:o[c].help})):r.push(i.a.createElement(qi,{id:o[c].key,onBlur:this.onChange,label:o[c].label,fetchURL:h,dynamic:!0,referenceKey:o[c].value_type.key,help:o[c].help}));break;case"input_multi":"static"==o[c].value_type.type?n.push(i.a.createElement(Ki,{id:o[c].key,value:d,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:o[c].label,help:o[c].help})):n.push(i.a.createElement(Ki,{id:o[c].key,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:o[c].label,fetchURL:h,dynamic:!0,referenceKey:o[c].value_type.key,help:o[c].help}));break;case"boolean":"static"==o[c].value_type.type?l.push(i.a.createElement(Gi,{id:o[c].key,value:d,onChange:this.onChange,label:o[c].label,help:o[c].help})):l.push(i.a.createElement(Gi,{id:o[c].key,onChange:this.onChange,label:o[c].label,fetchURL:h,dynamic:!0,referenceKey:o[c].value_type.key,help:o[c].help}));break;case"multi_select":"static"==o[c].value_type.type?e.push(i.a.createElement(Ji,{onChange:this.onChange,label:o[c].label,id:o[c].key,referenceKey:o[c].value_type.key,value:d,dropdownValues:o[c].value,help:o[c].help,mainType:this.props.type,mainId:this.props.id})):e.push(i.a.createElement(Ji,{onChange:this.onChange,label:o[c].label,id:o[c].key,referenceKey:o[c].value_type.key,fetchURL:h,dynamic:!0,help:o[c].help,mainType:this.props.type,mainId:this.props.id}))}}return i.a.createElement("div",null,o?i.a.createElement("div",{className:"custom-metadata-table container"},i.a.createElement("div",{className:"row"},t,a,s,r,n,l,e)):null)}}class Bi extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=[],a="",s=this.props.referenceKey;if("qual_sigbody_id"==s||"prod_sigbody_id"==s){t.push(i.a.createElement("option",null,"0"));for(let r in e.version)e.version[r].revision==e.data[s]&&(a=e.data[s]),t.push(i.a.createElement("option",null,e.version[r].revision))}else for(let r=0;r<e[this.props.referenceKey].length;r++)1==e[this.props.referenceKey][r].selected&&(a=e[this.props.referenceKey][r].value),t.push(i.a.createElement("option",null,e[this.props.referenceKey][r].value));this.setState({selected:a,options:t})}.bind(this)})},this.onChange=e=>{this.props.onChange(e),this.setState({selected:e.target.value})},this.state={selected:null,options:[]}}componentWillMount(){if(this.props.dynamic)this.getDynamic();else{let e=[],t="";for(let a=0;a<this.props.dropdownValues.length;a++)this.props.value==this.props.dropdownValues[a].value&&(t=this.props.value),e.push(i.a.createElement("option",null,this.props.dropdownValues[a].value));this.setState({selected:t,options:e})}}componentWillReceiveProps(e){e.dynamic?this.getDynamic():this.setState({selected:e.value})}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),i.a.createElement("span",null,i.a.createElement("select",{id:this.props.id,value:this.state.selected,onChange:this.onChange},this.state.options)),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id},i.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}class Vi extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t="";t=e[this.props.referenceKey],this.setState({value:t})}.bind(this)})},this.inputOnChange=e=>{this.setState({value:e.target.value})},this.state={value:""}}componentWillMount(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}componentWillReceiveProps(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),i.a.createElement("span",null,i.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value})),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id},i.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}class zi extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=1e3*e[this.props.referenceKey];this.setState({value:t,loading:!1})}.bind(this)})},this.onChange=e=>{let t="data."+this.props.typeLower,a=e._d.getTime()/1e3,s={};s[t]=a,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data")}.bind(this),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(this)})},this.showCalendar=()=>{0==this.state.showCalendar?this.setState({showCalendar:!0}):this.setState({showCalendar:!1})};let t=!1;this.props.dynamic&&(t=!0),this.state={showCalendar:!1,loading:t,value:""}}componentWillMount(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}componentWillReceiveProps(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div",style:{display:"flex",flexFlow:"row"}},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.typeTitle),this.state.loading?i.a.createElement("span",null,"Loading..."):i.a.createElement(Ui.a,{className:"custom-metadata-input-width",value:this.state.value,onChange:this.onChange}),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id},i.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}class qi extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=e[this.props.referenceKey];this.setState({value:t})}.bind(this)})},this.inputOnChange=e=>{this.setState({value:e.target.value})},this.state={value:""}}componentWillMount(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}componentWillReceiveProps(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id}," ",this.props.help)},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))),i.a.createElement("span",null,i.a.createElement("textarea",{id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value,className:"custom-metadata-textarea-width"})))}}class Ki extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=e[this.props.referenceKey];this.setState({value:t})}.bind(this)})},this.handleAddition=e=>{if(void 0!==this.state.value){let t=[],a=this.state.value;for(let e=0;e<a.length;e++)void 0!=a[e]&&("string"==typeof a[e]?t.push(a[e]):t.push(a[e].value));t.push(e.target.value);let s={},i="data."+this.props.id;s[i]=t,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.mainType+"/"+this.props.mainId,data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: group added"),this.setState({inputValue:"",value:s[this.props.id]})}.bind(this),error:function(e){this.props.errorToggle("Failed to add group",e)}.bind(this)})}},this.InputChange=e=>{this.setState({inputValue:e.target.value})},this.handleDelete=e=>{let t=this.state.value,a=e.target.id,s=[];for(let r=0;r<t.length;r++)void 0!=t[r]&&("string"==typeof t[r]?t[r]!=a&&s.push(t[r]):t[r].value!=a&&s.push(t[r].value));let i={data:{[this.props.id]:s}};q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.mainType+"/"+this.props.mainId,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(e){this.setState({value:i[this.props.id]}),console.log("deleted group success: "+e)}.bind(this),error:function(e){this.props.errorToggle("Failed to delete group",e)}.bind(this)})},this.state={inputValue:"",value:[]}}componentWillMount(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}componentWillReceiveProps(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}render(){let e,t=this.state.value,a=[];if(void 0!==t)for(let s=0;s<t.length;s++)"string"==typeof t[s]?e=t[s]:"object"==typeof t[s]&&void 0!=t[s]&&(e=t[s].value),a.push(i.a.createElement("span",{id:"event_signature",className:"tagButton"},e," ",i.a.createElement("i",{id:e,onClick:this.handleDelete,className:"fa fa-times tagButtonClose"})));return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),i.a.createElement("span",null,i.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onChange:this.InputChange,value:this.state.inputValue}),""!=this.state.inputValue?i.a.createElement(P.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.handleAddition,value:this.state.inputValue},"Submit"):i.a.createElement(P.a,{bsSize:"xsmall",bsType:"submit",disabled:!0},"Submit")),i.a.createElement("span",{className:"custom-metadata-multi-input-tags"},a),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id}," ",this.props.help)},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}class Gi extends i.a.Component{constructor(e){super(e),this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=e[this.props.referenceKey];this.setState({value:t})}.bind(this)})},this.componentWillReceiveProps=e=>{e.dynamic?this.getDynamic():this.setState({value:e.value})},this.onChange=e=>{let t;t="true"==e.target.value?1:0;let a={target:{}};a.target.id=this.props.id,a.target.value=t,this.props.onChange(a)},this.state={value:!1}}componentWillMount(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),i.a.createElement("span",null,i.a.createElement("input",{type:"checkbox",className:"custom-metadata-input-width",id:this.props.id,name:this.props.id,value:this.state.value,onClick:this.onChange})),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id}," ",this.props.help)},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}class Ji extends i.a.Component{constructor(e){super(e),this.makeForm=e=>{let t=this.props;e&&(t=e);let a=[];for(let s=0;s<t.dropdownValues.length;s++)t.value.includes(t.dropdownValues[s].value)?a.push(i.a.createElement("option",{selected:!0},t.dropdownValues[s].value)):a.push(i.a.createElement("option",null,t.dropdownValues[s].value));this.setState({options:a})},this.getDynamic=()=>{q.a.ajax({type:"get",url:this.props.fetchURL,success:function(e){let t=[];for(let a=0;a<e[this.props.referenceKey].length;a++)1==e[this.props.referenceKey][a].selected?t.push(i.a.createElement("option",{selected:!0},e[this.props.referenceKey][a].value)):t.push(i.a.createElement("option",null,e[this.props.referenceKey][a].value));this.setState({options:t})}.bind(this)})},this.componentWillReceiveProps=e=>{e.dynamic?this.getDynamic():this.makeForm(e)},this.onChange=e=>{let t=[];for(let s=0;s<e.target.options.length;s++)if(void 0!=e.target.options[s]){if(1!=e.target.options[s].selected)continue;t.push(e.target.options[s].value)}let a={};a["data."+this.props.id]=t,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.mainType+"/"+this.props.mainId,data:JSON.stringify(a),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: multi select added")}.bind(this),error:function(e){this.props.errorToggle("Failed to add multi select",e)}.bind(this)}),this.setState({selected:e.target.value})},this.state={options:[]}}componentWillMount(){this.props.dynamic?this.getDynamic():this.makeForm()}render(){return i.a.createElement("div",{className:"custom-metadata-table-component-div"},i.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),i.a.createElement("span",null,i.a.createElement(Hi.a,{id:this.props.id,componentClass:"select",placeholder:"select",bsClass:"custom-metadata-multi-select-width",multiple:!0,onChange:this.onChange,size:this.state.options.length},this.state.options)),i.a.createElement("span",null,i.a.createElement(zt.a,{placement:"top",overlay:i.a.createElement(Ba.a,{id:this.props.id}," ",this.props.help)},i.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}var Yi=function(e){let t=Object.assign({},e);const a=Object(s.useState)(!0),r=Object(Vt.a)(a,2),n=r[0],l=r[1];function o(){l(!n),t.updated()}return i.a.createElement("div",null,n?null:i.a.createElement("div",{style:{justifyContent:"center",padding:5,display:"flex"}},i.a.createElement("br",null),i.a.createElement(aa.a,{style:{backgroundColor:"#5bc0de",color:"white"},onClick:o,variant:"contained"},"Add Entry"),i.a.createElement("br",null)),n?i.a.createElement($s,{entryAction:"Add",type:"alert",targetid:t.row.id,id:"add_entry",addedentry:l,errorToggle:t.errorToggle,toggleVisibility:o}):null,t.entryData.length>0?i.a.createElement(Qi,{entryData:t.entryData,type:"alert",id:t.row.id,showEntryData:t.showEntryData,errorToggle:t.errorToggle,createCallback:t.createCallback,removeCallback:t.removeCallback,entityData:t.entityData,addFlair:t.addFlair}):null)};class Qi extends i.a.Component{constructor(e){super(e),this.getEntryData=()=>{const e=this.props,t=e.type,a=e.id;if(this.setState({isMounted:!0}),"alert"===t||"entity"===t||1===this.props.isPopUp){na("scot/api/v2/".concat(t,"/").concat(a,"/entry"),null).then(function(e){this.state.isMounted&&(this.setState({showEntryData:!0,entryData:e.data.records}),e.data.records.forEach(function(t,a){this.props.createCallback(e.data.records[a].id,this.updatedCB)}.bind(this)),this.Watcher())}.bind(this)).catch(function(e){this.state.isMounted&&(this.setState({showEntryData:!0}),this.props.errorToggle("Failed to load entry data.",e))}.bind(this))}},this.getEntityData=()=>{const e=this.props,t=e.addFlair,a=e.type,s=e.id;if("alert"===a||"entity"===a||"incident"===a||"alertgroup"===a||1===this.props.isPopUp){na("scot/api/v2/".concat(a,"/").concat(s,"/entity"),null).then(function(e){let i=e.data.records;if(this.state.isMounted){this.setState({showEntityData:!0,entityData:i});let e={waitEntry:function(){!1===this.state.showEntryData?setTimeout(e.waitEntry,50):setTimeout(function(){t(i,null,a,null,s)}.bind(this))}.bind(this)};e.waitEntry()}}.bind(this)).catch(function(e){this.state.isMounted&&(this.setState({showEntityData:!0}),this.props.errorToggle("Failed to load entity data.",e))}.bind(this))}},this.updatedCB=()=>{this.getEntityData(),this.getEntryData()},this.flairToolbarToggle=(e,t,a,s,i)=>{this.state.isMounted&&this.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:a,entityoffset:s,entityobj:i})},this.flairToolbarOff=()=>{if(this.state.isMounted){let e=this.state.entityDetailKey+1;this.setState({flairToolbar:!1,entityDetailKey:e})}},this.linkWarningToggle=(e,t=!1)=>{this.state.isMounted&&(!1===this.state.linkWarningToolbar?this.setState({linkWarningToolbar:!0,link:e,nopop:t}):this.setState({linkWarningToolbar:!1,nopop:t}))},this.Watcher=()=>{let e=this.props.type+"-detail-container";if("alertgroup"!=this.props.type){let e="iframe";document.querySelectorAll(e).forEach(function(e,t){e.contentWindow.requestAnimationFrame(function(){if(null!=e.contentDocument){[].push(this.checkFlairHover),e.addEventListener("mouseenter",(function(t,a){let s=setInterval(this[0],50,e);console.log("Now watching iframe "+s)})),e.addEventListener("mouseleave",(function(){let t=q()(e).data("intervalID");window.clearInterval(t),console.log("No longer watching iframe "+t)}))}}.bind(this))}.bind(this))}else q()(e).find("a, .entity").not(".not_selectable").each(function(e,t){q()(t).off("mousedown"),q()(t).on("mousedown",function(e){let t=e.target;if("extras"==q()(t)[0].className&&(t=q()(t)[0].parentNode),q()(t).attr("url")){let e=q()(t).attr("url");this.linkWarningToggle(e)}else{let e=q()(t).attr("data-entity-id"),a=q()(t).attr("data-entity-value"),s=q()(t).offset(),i=q()(t);this.flairToolbarToggle(e,a,"entity",s,i)}}.bind(this))}.bind(this))},this.checkFlairHover=e=>{function t(){return e}"alertgroup"!=this.props.type&&(null!=e.contentDocument&&q()(e).contents().find(".entity").each(function(e,a){if("rgb(255, 0, 0)"==q()(a).css("background-color"))q()(a).data("state","down");else if("down"==q()(a).data("state")){q()(a).data("state","up");let e=q()(a).attr("data-entity-id"),s=q()(a).attr("data-entity-value"),i=q()(a),r=t(),n={top:q()(a).offset().top+q()(r).offset().top,left:q()(a).offset().left+q()(r).offset().left};this.flairToolbarToggle(e,s,"entity",n,i)}}.bind(this)),null!=e.contentDocument&&q()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==q()(t).css("color"))q()(t).data("state","down");else if("down"==q()(t).data("state")){q()(t).data("state","up");let e=q()(t).attr("url");this.linkWarningToggle(e)}}.bind(this)))},this.containerHeightAdjust=()=>{setTimeout(function(){let e,t=document.getElementsByClassName("ReactTable")[0].clientHeight;void 0!==t&&(0!==t?(e=window.innerHeight-t-q()("#header").height()-90,e+="px"):(e=q()(window).height()-q()("#header").height()-78,e+="px"),this.state.isMounted&&this.setState({height:e}))}.bind(this),500)},this.render=()=>{let e="detail-container",t=this.state.height,a=this.props.entryData,s=this.props.type,r=this.props.id,n=this.props.showEntryData,l="row-fluid entry-wrapper entry-wrapper-main";return"alert"===s?(l="row-fluid entry-wrapper entry-wrapper-main-nh",a=this.state.entryData,n=this.state.showEntryData):"alertgroup"===s?l="row-fluid alert-wrapper entry-wrapper-main":"entity"!==s&&1!==this.props.isPopUp||(l="row-fluid entry-wrapper-entity",a=this.state.entryData,n=this.state.showEntryData),"alert"!==s&&1!==this.props.isPopUp||(e=this.props.type+"-detail-container",t=null),i.a.createElement("div",{id:e,key:r,className:l,style:{height:t}},"entity"!==s&&"alert"!==s?i.a.createElement(Wi,{type:s,id:r,errorToggle:this.props.errorToggle,form:this.props.form,headerData:this.props.headerData}):null,"signature"===s&&null!==this.props.headerData?i.a.createElement(Mi,{type:s,id:r,headerData:this.props.headerData,errorToggle:this.props.errorToggle,showSignatureOptions:this.props.showSignatureOptions}):null,n?i.a.createElement(Xi,Object.assign({updated:this.updatedCB,removeCallback:this.props.removeCallback,createCallback:this.props.createCallback,data:a,type:s,id:r,entityData:this.state.entityData,entryToggle:this.props.entryToggle,subcomponent:this.props.subcomponent,setAlertColumns:this.props.setAlertColumns,setEntryEntities:this.props.setEntryEntities},this.props)):i.a.createElement("span",null,"Loading..."),this.props.entryToolbar?i.a.createElement("div",null,i.a.createElement($s,{entryAction:"Add",type:this.props.type,targetid:this.props.id,id:null,addedentry:this.props.entryToggle,updated:this.updatedCB,errorToggle:this.props.errorToggle})):null,this.props.fileUploadToolbar?i.a.createElement("div",null,i.a.createElement(Ti,{type:this.props.type,targetid:this.props.id,id:"file_upload",fileUploadToggle:this.props.fileUploadToggle,updated:this.updatedCB,errorToggle:this.props.errorToggle})):null,this.state.flairToolbar?i.a.createElement(oi,{key:this.state.entityDetailKey,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,entityid:this.state.entityid,entityvalue:this.state.entityvalue,entitytype:this.state.entitytype,type:this.props.type,id:this.props.id,entityoffset:this.state.entityoffset,entityobj:this.state.entityobj,linkWarningToggle:this.linkWarningToggle,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair}):null,this.state.linkWarningToolbar?i.a.createElement(Di,{linkWarningToggle:this.linkWarningToggle,link:this.state.link,nopop:this.state.nopop}):null)};let t=Math.floor(1e3*Math.random());this.state={showEntryData:this.props.showEntryData,showEntityData:this.props.showEntityData,entryData:this.props.entryData,entityData:void 0===this.props.entityData?null:this.props.entityData,entityid:null,entitytype:null,entityoffset:null,entityobj:null,key:this.props.id,flairToolbar:!1,notificationType:null,notificationMessage:"",height:null,entityDetailKey:t,isMounted:!1}}componentDidMount(){const e=this.props,t=e.type,a=e.id,s=e.addFlair;this.getEntryData(),null!==this.state.entityData&&s(this.state.entityData,null,t,null,a),this.props.createCallback(this.props.id,this.updatedCB),this.containerHeightAdjust(),window.addEventListener("resize",this.containerHeightAdjust),document.querySelector(".ReactTable").onresize=function(){this.containerHeightAdjust()}.bind(this)}componentWillReceiveProps(){this.containerHeightAdjust()}componentDidUpdate(){1==this.state.runWatcher&&this.Watcher()}componentWillUnmount(){this.setState({isMounted:!1})}}class Xi extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=[],t=this.props.data,a=this.props.type,s=this.props.items,r=[],n=this.props.id,l=this.props.entityData,o=null;if(void 0!==this.props.items){o=void 0===this.props.items[0].data_with_flair||this.props.flairOff?s[0].data.search:s[0].data_with_flair.search;for(let e=0;e<this.props.headerData.ahrefs.length;e++)r.push(i.a.createElement("a",{href:this.props.headerData.ahrefs[e].link},this.props.headerData.ahrefs[e].subject)),r.push(i.a.createElement("br",null))}if(void 0===t||void 0===t[0])return"alertgroup"!==a?i.a.createElement("div",null,i.a.createElement("div",{style:{color:"blue"}},"No entries found. Click the green Add Entry button if you would like to create one")):i.a.createElement("div",null,i.a.createElement("div",{style:{color:"blue"}},"No alerts found or they are unable to be rendered. Please check the source and correct the formatting of the alert if necessary"));if("alertgroup"!==a){let s=0;return t.forEach(function(t){e.push(i.a.createElement(er,{subcomponent:this.props.subcomponent,key:s,items:t,type:a,id:n,isPopUp:this.props.isPopUp,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,entityData:l,entryToggle:this.props.entryToggle,setEntryEntities:this.props.setEntryEntities})),s+=1}.bind(this)),i.a.createElement("div",null,e)}return i.a.createElement("div",null,i.a.createElement($i,Object.assign({subcomponent:this.props.subcomponent},this.props,{key:n,type:a,id:n,items:t,entityData:l,entryToggle:this.props.entryToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:this.props.addFlair,setAlertColumns:this.props.setAlertColumns,updated:this.props.updated})))}}}class $i extends i.a.Component{constructor(e){super(e),this.createData=()=>{const e=[];return this.props.items.forEach(function(t){let a={};this.state.flairOff||0===Object.entries(t.data_with_flair).length?(a=t.data,a["status "]=t.data.status):(a=t.data_with_flair,a["status "]=t.data_with_flair.status),a.id=t.id,a.status=t.status,a.entry_count=t.entry_count,e.push(a)}.bind(this)),e},this.state={columns:[],data:[],entityData:[],type:"",addFlair:null,promotionId:null,selected:[],flairOff:!1,expanded:{}}}componentDidMount(){if(this.props.items.length>0){const e=this.createData(),t=wa("alert",e,this.props.items,!0);this.setState({data:e,columns:t})}this.props.type&&this.setState({type:this.props.type,entityData:this.props.entityData}),this.props.addFlair&&this.setState({addFlair:this.props.addFlair}),this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected}),q()("#main-detail-container").keydown(function(e){q()("input").is(":focus")||65!==e.keyCode||!0!==e.ctrlKey&&!0!==e.metaKey||(this.handleSelectAll(),e.preventDefault())}.bind(this))}componentDidUpdate(e,t){if(e.entityData!==this.props.entityData&&this.setState({entityData:this.props.entityData,columns:wa("alert",this.state.data,this.props.items,!0,this.props.entityData)}),t.flairOff!==this.state.flairOff){let e=this.createData();this.setState({data:e})}if(e.items!==this.props.items){let e=this.createData();this.setState({data:e})}this.props.alertsSelected!==t.selected&&void 0!==this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected})}static getDerivedStateFromProps(e,t){return e.flairOff!==t.flairOff?{flairOff:e.flairOff}:e.alertsSelected!==t.selected?{selected:e.alertsSelected}:null}render(){const e=this.state,t=e.columns,a=e.data,s=this.props,r=s.addFlair,n=s.type,l=(s.headerData,s.entityData);s.updated;return i.a.createElement("div",null,i.a.createElement(Bt.a,{styleName:"styles.ReactTable",ref:e=>this.reactTable=e,key:2,data:a,columns:t,filterable:!0,expanded:this.state.expanded,onExpandedChange:(e,t,a)=>{this.setState({expanded:e}),r(l,null,"entry",null,null)},defaultFilterMethod:(e,t)=>{if(t[e.id].includes(e.value))return t},SubComponent:({row:e})=>i.a.createElement(Yi,{flag:this.props.subcomponent,row:e,entryToggle:this.props.entryToggle,errorToggle:this.props.errorToggle,entryData:this.props.entryData,showEntryData:this.props.showEntryData,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,entityData:this.props.entityData,addFlair:this.props.addFlair,updated:this.props.updated}),onFilteredChange:(e,t)=>{r(l,null,n,null,null)},onSortedChange:(e,t,a)=>{r(l,null,n,null,null)},showPagination:!1,pageSize:a.length,getTdProps:(e,t)=>({style:{maxWidth:"fit-content"}}),getTrProps:(e,t)=>t&&t.row&&void 0!==this.props.alertsSelected?{onClick:a=>{(a.ctrlKey||a.metaKey&&83===a.keyCode)&&this.props.handleSelectAll(e.sortedData),a.ctrlKey||a.metaKey?(a.preventDefault(),this.props.handleMultiSelection(t.original)):a.shiftKey?(document.getSelection().removeAllRanges(),this.props.handleShiftSelect(this.state.selected[0].id,t.original.id,e.sortedData)):this.props.handleSelection(t.original)},style:{background:this.state.selected.some(e=>t.original.id===e.id)?"#a7c6a5":"",borderBottom:"1px solid black",maxHeight:200,overflowY:"auto"}}:{style:{maxHeight:200,overflowY:"auto"}}}),i.a.createElement(Zi,{items:this.props.items,flairOff:this.props.flairOff,headerData:this.props.headerData}))}}class Zi extends i.a.Component{constructor(e){super(e)}render(){let e=null;const t=this.props.items;e=void 0===t[0].data_with_flair||this.props.flairOff?t[0].data.search:t[0].data_with_flair.search;let a=this.props.headerData.ahrefs.map((e,t)=>i.a.createElement("div",{key:t},i.a.createElement("a",{href:this.props.headerData.ahrefs[t].link},this.props.headerData.ahrefs[t].subject),i.a.createElement("br",null)));return i.a.createElement("div",null,void 0!==e?i.a.createElement("div",{className:"alertTableHorizontal",style:{outline:"1px solid black",borderRadius:5,padding:3,margin:"10px 0 15px"}},a,i.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}})):null)}}class er extends i.a.Component{constructor(e){super(e),this.componentDidMount=()=>{this.props.createCallback(this.props.items.id,this.refreshButton)},this.refreshButton=()=>{q()("#refresh-detail")&&q()("#refresh-detail").click()},this.editEntryToggle=()=>{!1===this.state.editEntryToolbar?this.setState({editEntryToolbar:!0}):this.setState({editEntryToolbar:!1})},this.replyEntryToggle=()=>{!1===this.state.replyEntryToolbar?this.setState({replyEntryToolbar:!0}):this.setState({replyEntryToolbar:!1})},this.deleteToggle=()=>{!1===this.state.deleteToolbar?this.setState({deleteToolbar:!0}):this.setState({deleteToolbar:!1})},this.permissionsToggle=()=>{!1===this.state.permissionsToolbar?this.setState({permissionsToolbar:!0}):this.setState({permissionsToolbar:!1})},this.reparseFlair=()=>{ca("/scot/api/v2/entry/".concat(this.props.items.id)).then((function(e){console.log("reparsing started")})).catch(function(e){this.props.errorToggle("failed to start reparsing of data",e)}.bind(this))},this.fileUploadToggle=()=>{!1===this.state.fileUploadToolbar?this.setState({fileUploadToolbar:!0}):this.setState({fileUploadToolbar:!1})},this.getEntryEntityData=e=>{na("scot/api/v2/entry/".concat(e,"/entity"),null).then(function(e){let t=e.data.records;this.props.setEntryEntities(t)}.bind(this)).catch(function(e){console.log("Couldnt get entry entity data: ".concat(e))}.bind(this))},this.render=()=>{let e=[],t=[],a=this.props.items,s=this.props.type,r=this.props.id,n=this.props.isPopUp,l=this.props.items.class,o=0,c=this.state.editEntryToolbar,d=this.editEntryToggle,h=this.props.errorToggle,p="row-fluid entry-outer",u="row-fluid entry-header",m="";"summary"===l&&(p+=" summary_entry",o=1),"task"===l&&("open"===a.metadata.task.status||"assigned"===a.metadata.task.status?(m="-- Task Owner "+a.metadata.task.who+" ",p+=" todo_open_outer",u+=" todo_open"):"closed"!==a.metadata.task.status&&"completed"!==a.metadata.task.status||null==a.metadata.task.who?"closed"!==a.metadata.task.status&&"completed"!==a.metadata.task.status||(p+=" todo_undefined_outer",u+=" todo_undefined"):(m="-- Task Owner "+a.metadata.task.who+" ",p+=" todo_completed_outer",u+=" todo_completed")),"alert"===l&&(p+=" event_entry_container_alert"),e.push(i.a.createElement(ar,{id:a.id,key:a.id,subitem:a,type:s,targetid:r,editEntryToolbar:c,editEntryToggle:d,isPopUp:n,errorToggle:this.props.errorToggle,setEntryEntities:this.props.setEntryEntities}));for(let y in a){(e=>{if("children"===e){a[e];a[e].forEach(function(e){t.push(new Array(i.a.createElement(er,{items:e,id:r,type:s,editEntryToolbar:c,editEntryToggle:d,isPopUp:n,errorToggle:h,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,setEntryEntities:this.props.setEntryEntities})))}.bind(this))}})(y)}e.push(t);let g=[];if(this.props.items&&this.props.items.actions)for(let y=0;y<this.props.items.actions.length;y++)this.props.items.actions[y].send_to_name&&this.props.items.actions[y].send_to_url&&g.push(i.a.createElement(tr,{id:this.props.items.actions[y].send_to_name,datahref:this.props.items.actions[y].send_to_url,errorToggle:this.props.errorToggle}));let f,b,v="["+a.id+"] ",E=" by "+a.owner+" "+m+"(updated on ",w=a.created,S=a.updated,T="entry-header-inner-"+this.props.id+" entry-header-inner";return"unset"!==a.tlp&&(b="amber"!==a.tlp?a.tlp:"orange",f="3px solid "+b),i.a.createElement("div",null,this.state.showEntityCreateModal?i.a.createElement(Fi,{match:this.state.highlightedText,modalActive:this.state.showEntityCreateModal,ToggleCreateEntity:this.ToggleCreateEntity,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback}):null,i.a.createElement("div",{className:p,style:{marginLeft:"auto",marginRight:"auto",width:"99.3%",border:f}},i.a.createElement("span",{className:"anchor",id:"/"+s+"/"+r+"/"+a.id}),i.a.createElement("div",{className:u},i.a.createElement("div",{id:T,className:T},"[",i.a.createElement(ke.Link,{style:{color:"black"},to:"/"+s+"/"+r+"/"+a.id},a.id),"]"," ",i.a.createElement(La.a,{value:1e3*a.created,format:"MM/DD/YYYY hh:mm:ss a"})," ","by ",a.owner," ",m,"(updated on"," ",i.a.createElement(La.a,{value:1e3*a.updated,format:"MM/DD/YYYY hh:mm:ss a"}),")",""!==this.state.highlightedText&&null!=this.state.highlightedText?i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.ToggleCreateEntity},"Create Entity"):null,""!==this.props.items.body_flair&&0===this.props.items.parsed?i.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ","Entry awaiting flair engine. Content may be inaccurate."):null,i.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},this.state.permissionsToolbar?i.a.createElement(Ls,{updateid:r,id:a.id,type:"entry",permissionData:a,permissionsToggle:this.permissionsToggle}):null,"unset"!==a.tlp&&void 0!==a.tlp?i.a.createElement("span",null,"TLP:"," ",i.a.createElement("span",{style:{color:b}},a.tlp," ")):null,i.a.createElement(bi.a,{bsSize:"xsmall",title:"Reply",key:a.id,id:"Reply "+a.id,onClick:this.replyEntryToggle,pullRight:!0},"entity"!==s?i.a.createElement(y.a,{eventKey:"1",onClick:this.fileUploadToggle},"Upload File"):null,g,i.a.createElement(y.a,{eventKey:"3"},i.a.createElement(ki,{type:s,id:r,entryid:a.id,summary:o,errorToggle:this.props.errorToggle})),i.a.createElement(y.a,{eventKey:"4"},i.a.createElement(xi,{type:s,id:r,entryid:a.id,taskData:a,errorToggle:this.props.errorToggle})),i.a.createElement(Va,{type:"entry",id:a.id,string:a.body_plain}),i.a.createElement(y.a,{onClick:this.permissionsToggle},"Permissions"),i.a.createElement(y.a,{onClick:this.reparseFlair},"Reparse Flair"),i.a.createElement(es,{type:"entry",id:a.id,tlp:a.tlp,errorToggle:this.props.errorToggle}),i.a.createElement(y.a,{onClick:()=>{this.getEntryEntityData(a.id)}},"Get entities for Entry"),i.a.createElement(y.a,{divider:!0}),i.a.createElement(y.a,{eventKey:"2",onClick:this.deleteToggle},"Delete")),i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.editEntryToggle},"Edit")))),e,this.state.replyEntryToolbar?i.a.createElement($s,{entryAction:"Reply",type:s,header1:v,header2:E,header3:")",createdTime:w,updatedTime:S,targetid:r,id:a.id,addedentry:this.replyEntryToggle,errorToggle:this.props.errorToggle}):null,this.state.fileUploadToolbar?i.a.createElement(Ti,{type:this.props.type,targetid:this.props.id,entryid:this.props.items.id,fileUploadToggle:this.fileUploadToggle,errorToggle:this.props.errorToggle}):null),this.state.deleteToolbar?i.a.createElement(cs,{type:s,id:r,deleteToggle:this.deleteToggle,entryid:a.id,errorToggle:this.props.errorToggle}):null)},this.componentWillReceiveProps=()=>{this.checkHighlight()},this.checkHighlight=()=>{let e,t=document.getElementById("iframe_"+this.props.items.id);if(t){if(null===t.contentWindow.getSelection())return;if(e=t.contentWindow.getSelection().toString(),this.state.highlightedText===e)return;console.log(t+" has highlighted text: "+e),this.setState({highlightedText:e})}},this.ToggleCreateEntity=()=>{this.setState({showEntityCreateModal:!this.state.showEntityCreateModal})},this.state={editEntryToolbar:!1,replyEntryToolbar:!1,deleteToolbar:!1,permissionsToolbar:!1,fileUploadToolbar:!1,showEntityCreateModal:!1,highlightedText:null,items:{}}}}class tr extends i.a.Component{constructor(e){super(e),this.submit=()=>{let e=this.props.datahref,t=this.props.id;(function(e,t){return oa.apply(this,arguments)})(e,null).then(function(e){this.setState({[t]:!0,disabled:!1})}.bind(this)).catch(function(e){this.props.errorToggle("failed to submit the entry action",e),this.setState({disabled:!1})}.bind(this))},this.render=()=>i.a.createElement(y.a,{disabled:this.state.disabled},i.a.createElement("span",{id:this.props.id,"data-href":this.props.datahref,onClick:this.submit,style:{display:"block"}},this.props.id," ",this.state[this.props.id]?i.a.createElement("span",{style:{color:"green"}},"success"):null)),this.state={[this.props.id]:!1,disabled:!1}}}class ar extends i.a.Component{constructor(e){super(e),this.setHeight=()=>{setTimeout(function(){void 0!=document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){let e;e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight,e=e+35+"px",this.state.height!=e&&this.setState({height:e})}.bind(this))}.bind(this),250)},this.state={height:"1px"}}componentWillReceiveProps(){this.setHeight()}componentDidMount(){this.setHeight()}render(){let e=this.props.subitem.body_flair;""==this.props.subitem.body_flair&&(e=this.props.subitem.body);let t=this.props.id,a="entry-body-"+this.props.id,s="entry-body-inner-"+this.props.id;return i.a.createElement("div",{id:a,key:this.props.id,className:"row-fluid entry-body"},i.a.createElement("div",{id:s,className:"row-fluid entry-body-inner",style:{marginLeft:"auto",marginRight:"auto",width:"99.3%"}},this.props.editEntryToolbar?i.a.createElement($s,{entryAction:"Edit",type:this.props.type,targetid:this.props.targetid,id:t,addedentry:this.props.editEntryToggle,parent:this.props.subitem.parent,errorToggle:this.props.errorToggle}):i.a.createElement(ai.a,{key:t,contentDidMount:this.setHeight,head:[i.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),i.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/prism.css"}),i.a.createElement("script",{src:"/libs/prism.js"})],frameBorder:"0",id:"iframe_"+t,sandbox:"allow-same-origin",style:{width:"100%",height:this.state.height}},i.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))))}}var sr=a(149);class ir extends i.a.Component{constructor(e){super(e),this.toggleBadgeEntry=e=>{0==this.state[e]?this.setState({[e]:!0}):1==this.state[e]&&this.setState({[e]:!1})},this.state={source:!1,tag:!1}}render(){let e=[],t=this.props.id,a=this.props.type,s=this.props.data,r="";if("tag"===this.props.badgeType?r="Tags":"source"===this.props.badgeType&&(r="Sources"),"guide"==this.props.type)return i.a.createElement("th",null);if(void 0!=s)for(let n=0;n<s.length;n++)e.push(i.a.createElement(rr,{data:s,badgeType:this.props.badgeType,dataOne:s[n],id:t,type:a,updated:this.props.updated,key:n,errorToggle:this.props.errorToggle}));return i.a.createElement("th",null,i.a.createElement("th",null,r,":"),i.a.createElement("td",null,e,this.state.source?i.a.createElement(nr,{data:s,type:a,id:t,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,this.state.tag?i.a.createElement(nr,{data:s,type:a,id:t,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,"tag"===this.props.badgeType?this.state.tag?i.a.createElement("span",{className:"add-tag-button"},i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:()=>{this.toggleBadgeEntry(this.props.badgeType)}},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):i.a.createElement("span",{className:"remove-tag-button"},i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:()=>{this.toggleBadgeEntry(this.props.badgeType)}},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):"source"===this.props.badgeType?this.state.source?i.a.createElement("span",{className:"add-source-button"},i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"danger",onClick:()=>{this.toggleBadgeEntry(this.props.badgeType)}},i.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):i.a.createElement("span",{className:"remove-source-button"},i.a.createElement(Ra.a,{bsSize:"xsmall",bsStyle:"success",onClick:()=>{this.toggleBadgeEntry(this.props.badgeType)}},i.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):null))}}class rr extends i.a.Component{constructor(...e){super(...e),this.badgeDelete=()=>{let e=this.props.badgeType,t=this.props.data,a=[];for(let i=0;i<t.length;i++)void 0!=t[i]&&("string"==typeof t[i]?t[i]!=this.props.dataOne&&a.push(t[i]):t[i].value!=this.props.dataOne.value&&a.push(t[i].value));let s={};s[e]=a,q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",success:function(e){console.log("deleted"+this.props.badgeType+" data")}.bind(this),error:function(t){this.props.errorToggle("Failed to delete"+e+", data ")}.bind(this)})}}render(){let e,t=this.props.dataOne;return"string"==typeof t?e=t:"object"==typeof t&&void 0!=t&&(e=t.value),"tag"===this.props.badgeType?i.a.createElement("span",{id:"event_tag",className:"tagButton"},e," ",i.a.createElement("span",{className:"tagButtonClose"},i.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):"source"===this.props.badgeType?i.a.createElement("span",{id:"event_source",className:"sourceButton"},e," ",i.a.createElement("span",{className:"sourceButtonClose"},i.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):null}}class nr extends i.a.Component{constructor(e){super(e),this.handleAddition=e=>{let t=this.props.badgeType,a=this.props.data.map((function(e){return"string"===typeof e?e:e.value}));if(a.includes(e.text))this.props.errorToggle(this.props.badgeType+" already exists");else{a.push(e.text);let s={};s[t]=a;ca("scot/api/v2/".concat(this.props.type,"/").concat(this.props.id),s).then(function(e){this.props.toggleBadgeEntry()}.bind(this)).catch(function(e){this.props.errorToggle("Failed to add "+this.props.badgeType+" data "),this.props.toggleBadgeEntry()}.bind(this))}},this.handleSuggestionOrTagConversion=e=>e.map((function(e){let t={};return t.id=e,t.text=e,t})),this.handleInputChange=e=>{if(e.length>0){let t=[],a=this.props.badgeType;na("/scot/api/v2/ac/".concat(a,"/").concat(e),null).then(function(e){t=e.data.records.map(e=>e),this.setState({suggestions:t})}.bind(this)).catch(function(e){this.props.errorToggle("Failed to get autocomplete data for tag",e)}.bind(this))}},this.state={suggestions:[]}}render(){let e=this.state.suggestions;return e=this.handleSuggestionOrTagConversion(e),i.a.createElement("span",{className:"tag-new"},i.a.createElement(sr.WithContext,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,tags:[]}))}}var lr=a(125),or=a.n(lr);function cr(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;let a=e.toPrecision(2).split("e"),s=1===a.length?0:Math.floor(Math.min(a[1].slice(1),14)/3),i=s<1?e.toFixed(0+t):(e/Math.pow(10,3*s)).toFixed(1+t);return(i<0?i:Math.abs(i))+["","K","M","B","T"][s]}var dr={entityUpdate:function(e,t,a,s,i,r){setTimeout(function(){let t={};for(let a in e)t[q()("<span />",{html:a}).html()]=e[a];"alertgroup"!==a?q()("iframe").each(function(e,a){a.contentWindow.requestAnimationFrame((function(){if(null!=a.contentDocument){let e=q()(a).contents();q()(a.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each((function(e,t){let a=q()(t).attr("href");q()(t).attr("url",a)})),e.find(".entity").each((function(e,a){if(null==q()(a).find(".extras")[0]){let e=q()("<span />",{html:q()(a).attr("data-entity-value")}).html();if(void 0!==e&&void 0!==t){let s=t;if(s=void 0!==s[e.toLowerCase()]?s[e.toLowerCase()]:s[e],void 0!==s){console.log("entity matched!");let e=s.id,t=cr(parseInt(s.count,10),0),i=s.data;console.log("entitydata for "+s.id),console.log(i);let r=s.entry,n=q()('<span class="noselect">');if(n.addClass("circleNumber"),n.addClass("extras"),n.text(t),q()(a).append(n),q()(a).attr("data-entity-id",e),q()(a).unbind("click"),void 0!==i){if(void 0!==i.scanner&&"true"===i.scanner.active&&q()(a).append(q()('<img class="extras" title="scanner">').attr("src","/images/flair/scanner.png")),void 0!==i.geoip&&i.geoip.data.isocode){let e;if(e="Sandia National Laboratories"===i.geoip.data.isp?"sandia":i.geoip.data.isocode,null!==e){let t=q()('<img title="'+e.toLowerCase()+'">').attr("src","/images/flags/"+e.toLowerCase()+".png");t.addClass("extras"),q()(a).append(t)}}void 0!==i.sidd&&0!==Object.keys(i.sidd.data).length&&i.sidd.data.constructor===Object&&q()(a).append(q()('<img class="extras" title="sidd">').attr("src","/images/flair/sidd.png")),void 0!==i.blocklist3&&(0!==i.blocklist3.data.firewall&&q()(a).append(q()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),0!==i.blocklist3.data.watch&&q()(a).append(q()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),0!==i.blocklist3.data.whitelist&&q()(a).append(q()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),0!==i.blocklist3.data.blackhole&&q()(a).append(q()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),0!==i.blocklist3.data.proxy_block?(console.log("proxy block detected!"),q()(a).append(q()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png"))):console.log("proxy where art thou"+i.blocklist3.data))}if(void 0!==r&&0!==r){let e=s.entries[0].body_plain;q()(a).append(q()('<img class="extras" title="'+e+'">').attr("src","/images/flair/note.png"))}}}}}))}}))}.bind(this)):"alertgroup"===a&&q()(document.body).find(".alertTableHorizontal").find(".entity").each((function(e,a){if(null==q()(a).find(".extras")[0]){let e=q()(document.body).find(".alertTableHorizontal");e.find("a").attr("target","_blank"),e.find("a").find(".entity").wrap("<a href='about:blank' target='targ'></a>"),e.find("a").each((function(e,t){let a=q()(t).attr("href");q()(t).attr("url",a)}));let s=q()("<span />",{html:q()(a).attr("data-entity-value")}).html();if(void 0!==s&&void 0!==t){let e=t;if(e=void 0!==e[s.toLowerCase()]?e[s.toLowerCase()]:e[s],void 0!==e){let t=e.id,s=cr(e.count),i=e.data;console.log("entitydata for "+e.id),console.log(i);let r=e.entry,n=q()('<span class="noselect">');if(n.addClass("circleNumber"),n.addClass("extras"),n.text(s),q()(a).append(n),q()(a).attr("data-entity-id",t),q()(a).unbind("click"),void 0!==i){if(void 0!==i.scanner&&"true"===i.scanner.active&&q()(a).append(q()('<img class="extras" title="scanner">').attr("src","/images/flair/scanner.png")),void 0!==i.sidd&&0!==Object.keys(i.sidd.data).length&&i.sidd.data.constructor===Object&&q()(a).append(q()('<img class="extras" title="sidd">').attr("src","/images/flair/sidd.png")),void 0!==i.geoip&&void 0!==i.geoip.data.isocode){let e;e="Sandia National Laboratories"===i.geoip.data.isp?"sandia":i.geoip.data.isocode;let t=q()('<img title="'+e.toLowerCase()+'">').attr("src","/images/flags/"+e.toLowerCase()+".png");t.addClass("extras"),q()(a).append(t)}void 0!==i.blocklist3&&(0!==i.blocklist3.data.firewall&&q()(a).append(q()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),0!==i.blocklist3.data.watch&&q()(a).append(q()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),0!==i.blocklist3.data.whitelist&&q()(a).append(q()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),0!==i.blocklist3.data.blackhole&&q()(a).append(q()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),0!==i.blocklist3.data.proxy_block?(console.log("proxy_block detected!"),q()(a).append(q()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png"))):console.log("Why no pblock? "+i.blocklist3.data))}if(void 0!==r&&0!==r){let t=e.entries[0].body_plain;q()(a).append(q()('<img class="extras" title="'+t+'">').attr("src","/images/flair/note.png"))}}}}})),void 0!==r&&null!==r&&r()}.bind(this),1e3)}};class hr extends s.Component{constructor(e){super(e),this.state={data:[],allSelected:!1,loading:!1},this.getLinks=this.getLinks.bind(this),this.handleTHeadCheckboxSelection=this.handleTHeadCheckboxSelection.bind(this),this.handleRowSelection=this.handleRowSelection.bind(this),this.handleCheckboxSelection=this.handleCheckboxSelection.bind(this)}componentWillMount(){this.getLinks(),this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=[{Header:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"links-checkbox"},i.a.createElement("i",{className:"fa fa".concat(this.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"}))),id:"selected",accessor:e=>e.selected,Cell:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"links-checkbox"},i.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"}))),maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Context",accessor:"context",minWidth:100,maxWidth:800,sortable:!0},{Header:"Memo",accessor:"memo",minWidth:100,maxWidth:800,sortable:!0},{Header:"Link ID",accessor:"linkid",maxWidth:100,sortable:!0}];return i.a.createElement(U.a,{dialogClassName:"links-modal",show:this.props.modalActive,onHide:this.props.linksModalToggle},i.a.createElement(U.a.Header,{closeButton:!0},i.a.createElement(U.a.Title,null,this.state.data.length," items linked to ",this.props.type," ",this.props.id)),i.a.createElement(U.a.Body,null,i.a.createElement(Bt.a,{columns:e,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items Linked.",loading:this.state.loading,style:{maxHeight:"60vh"},filterable:!0})),i.a.createElement(U.a.Footer,null,i.a.createElement(pr,{data:this.state.data,id:this.props.id,type:this.props.type,getLinks:this.getLinks,errorToggle:this.props.errorToggle})))}getLinks(){this.setState({loading:!0}),q.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id+"/link",success:function(e){let t=[];for(let a=0;a<e.records.length;a++){let s={};s.linkid=e.records[a].id,s.context=e.records[a].context;for(let i=0;i<e.records[a].vertices.length;i++)if(e.records[a].vertices[i].id===this.props.id){if(e.records[a].vertices[i].type===this.props.type)continue;s.id=e.records[a].vertices[i].id,s.type=e.records[a].vertices[i].type,s.memo=e.records[a].memo[i],t.push(s)}else s.id=e.records[a].vertices[i].id,s.type=e.records[a].vertices[i].type,s.memo=e.records[a].memo[i],t.push(s)}this.setState({data:t,loading:!1})}.bind(this),error:function(e){this.setState({loading:!1}),this.props.errorToggle("failed to get links",e)}.bind(this)})}handleRowSelection(e,t,a){return{onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;t.row.id===e.id&&t.row.type===e.type?e.selected=!0:e.selected=!1}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}}handleCheckboxSelection(e,t,a){return"selected"===a.id?{onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;if(t.row.id===e.id&&t.row.type===e.type){e.selected=!e.selected;break}}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:this.checkAllSelected(a)}),e.stopPropagation()}}:{}}handleTHeadCheckboxSelection(e,t,a,s){return"selected"===a.id?{onClick:t=>{let a=this.state.data,s=!this.state.allSelected;var i,r=Object(b.a)(a);try{for(r.s();!(i=r.n()).done;){let t=i.value;var n,l=Object(b.a)(e.pageRows);try{for(l.s();!(n=l.n()).done;){let e=n.value;if(t.id===e.id&&t.type===e.type){t.selected=s;break}}}catch(o){l.e(o)}finally{l.f()}}}catch(o){r.e(o)}finally{r.f()}this.setState({data:a,allSelected:s})}}:{}}checkAllSelected(e){var t,a=Object(b.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}class pr extends s.Component{constructor(e){super(e),this.state={entry:!1,thing:!1,actionSuccess:!1},this.RemoveLink=this.RemoveLink.bind(this),this.RemoveLinkAjax=this.RemoveLinkAjax.bind(this),this.ToggleActionSuccess=this.ToggleActionSuccess.bind(this)}componentWillMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){let e=!1,t=!1;var a,s=Object(b.a)(this.props.data);try{for(s.s();!(a=s.n()).done;){let s=a.value;s.type&&s.selected&&("entry"===s.type?e=!0:t=!0)}}catch(r){s.e(r)}finally{s.f()}return i.a.createElement("div",null,this.state.actionSuccess?i.a.createElement("div",null,i.a.createElement("span",{bsStyle:{color:"green"}},"Action Successful!")):null,i.a.createElement("div",null,t||e?i.a.createElement("h4",{style:{float:"left"}},"Actions"):i.a.createElement("div",null," ",this.props.data.length>0?i.a.createElement("h4",{style:{float:"left"}},"Select a link for options"):null," "),i.a.createElement(Kt.a,{style:{float:"right"}},t||e?i.a.createElement(P.a,{onClick:this.RemoveLink},"Remove Link"):null)))}RemoveLink(){var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&this.RemoveLinkAjax(parseInt(t.linkid))}}catch(a){t.e(a)}finally{t.f()}}RemoveLinkAjax(e){q.a.ajax({type:"delete",url:"/scot/api/v2/link/"+e,success:function(e){console.log("successfully removed link"),this.ToggleActionSuccess()}.bind(this),error:function(e){this.props.errorToggle("failed to remove link",e)}.bind(this)})}ToggleActionSuccess(){let e=!this.state.actionSuccess;this.props.getLinks(),this.setState({actionSuccess:e})}}var ur=a(964);const mr={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}};class gr extends s.Component{constructor(e){super(e),this.handleRowSelection=(e,t,a)=>({onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;t.row.id===e.id&&t.row.type===e.type?e.selected=!0:e.selected=!1}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}),this.handleCheckboxSelection=(e,t,a)=>"selected"===a.id?{onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;if(t.row.id===e.id&&t.row.type===e.type){e.selected=!e.selected;break}}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:this.checkAllSelected(a)}),e.stopPropagation()}}:{},this.handleTHeadCheckboxSelection=(e,t,a,s)=>"selected"===a.id?{onClick:t=>{let a=this.state.data,s=!this.state.allSelected;var i,r=Object(b.a)(a);try{for(r.s();!(i=r.n()).done;){let t=i.value;var n,l=Object(b.a)(e.pageRows);try{for(l.s();!(n=l.n()).done;){let e=n.value;if(t.id===e.id&&t.type===e.type){t.selected=s;break}}}catch(o){l.e(o)}finally{l.f()}}}catch(o){r.e(o)}finally{r.f()}this.setState({data:a,allSelected:s})}}:{},this.checkAllSelected=e=>{var t,a=Object(b.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(s){a.e(s)}finally{a.f()}return!0},this.getMarkedItems=()=>{let e=se("marked"),t={id:this.props.id,type:this.props.type,subject:this.props.string};e&&(e=JSON.parse(e),e.unshift(t),this.setState({data:e}))},this.state={data:[],allSelected:!1},this.handleTHeadCheckboxSelection=this.handleTHeadCheckboxSelection.bind(this),this.handleRowSelection=this.handleRowSelection.bind(this),this.handleCheckboxSelection=this.handleCheckboxSelection.bind(this),this.getMarkedItems=this.getMarkedItems.bind(this)}componentWillMount(){this.mounted=!0,this.getMarkedItems()}componentWillUnmount(){this.mounted=!1}render(){const e=[{Header:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"mark-checkbox"},i.a.createElement("i",{className:"fa fa".concat(this.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"}))),id:"selected",accessor:e=>e.selected,Cell:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"mark-checkbox"},i.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"}))),maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"subject",maxWidth:"100%",sortable:!0}];return i.a.createElement(U.a,{dialogClassName:"mark-modal",show:this.props.modalActive,onHide:this.props.markModalToggle},i.a.createElement(U.a.Header,{closeButton:!0},i.a.createElement(U.a.Title,null,"Marked Objects")),i.a.createElement(U.a.Body,null,this.state.data.length>0?i.a.createElement(Bt.a,{columns:e,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items marked.",style:{maxHeight:"60vh"},filterable:!0}):i.a.createElement("h3",null,"No marked items detected.")),i.a.createElement(U.a.Footer,null,i.a.createElement(yr,{data:this.state.data,id:this.props.id,type:this.props.type,getMarkedItems:this.getMarkedItems,errorToggle:this.props.errorToggle})))}}class yr extends s.Component{constructor(e){super(e),this.deleteCallback=e=>{!0===e&&this.RemoveSelected(),this.setState({pendingDelete:!1})},this.LinkContextChange=e=>{this.setState({linkContextString:e.target.value})},this.ExpandLinkToggle=e=>{if(!0===e||!1===e)this.setState({linkPanel:e,linkContextString:""});else{let e=!this.state.linkPanel;this.setState({linkPanel:e,linkContextString:""})}},this.RemoveSelected=()=>{var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&za(t.type,t.id)}}catch(a){t.e(a)}finally{t.f()}this.props.getMarkedItems(),this.state.actionSuccess&&this.setState({actionSuccess:!1})},this.StartDelete=()=>{this.setState({pendingDelete:!0})},this.MoveEntry=()=>{var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&"entry"===t.type&&this.EntryAjax(t.id,!0)}}catch(a){t.e(a)}finally{t.f()}},this.CopyEntry=()=>{var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&"entry"===t.type&&this.EntryAjax(t.id,!1)}}catch(a){t.e(a)}finally{t.f()}},this.Link=()=>{var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;if(t.selected){let e=[],a={},s={};a.id=parseInt(t.id),a.type=t.type,s.id=parseInt(this.props.id),s.type=this.props.type,e.push(a),e.push(s),this.LinkAjax(e)}}}catch(a){t.e(a)}finally{t.f()}},this.Reparse=()=>{this.setState({reparseButton:mr.LOADING}),q.a.when(...this.props.data.filter(e=>e.selected).map(e=>this.ReparseAjax(e))).then(()=>{this.setState({reparseButton:mr.SUCCESS})},e=>{console.error(e),this.setState({reparseButton:mr.ERROR}),this.props.errorToggle("error reparsing",e)}).always(()=>{setTimeout(()=>{this.setState({reparseButton:mr.READY})},2e3)})},this.ReparseAjax=e=>q.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"}),this.Promote=()=>{this.setState({promoteButton:mr.LOADING});let e=!0;q.a.when(...this.props.data.filter(e=>e.selected).map(e=>this.PromoteAjax(e))).then(()=>{this.setState({promoteButton:mr.SUCCESS})},t=>{e=!1,console.error(t),this.setState({promoteButton:mr.ERROR}),this.props.errorToggle("error adding alerts to event",t)}).always(()=>{setTimeout(()=>{this.setState({promoteButton:mr.READY}),e&&window.location.reload()},2e3)})},this.PromoteAjax=e=>q.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(this.props.id)}),contentType:"application/json; charset=UTF-8"}),this.LinkAjax=e=>{let t={weight:1};t.vertices=e,this.state.linkContextString&&(t.context=this.state.linkContextString),q.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to link",e)}.bind(this)})},this.EntryAjax=(e,t)=>{q.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){let s={};s={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},q.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(this),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(this)})},this.RemoveEntryAfterMove=e=>{q.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")},error:function(e){this.props.errorToggle("Failed to remove original entry",e)}})},this.ToggleActionSuccess=e=>{if(!0===e||!1===e)this.setState({actionSuccess:e});else{let e=!this.state.actionSuccess;this.setState({actionSuccess:e})}},this.state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:mr.READY,deleteButton:mr.READY,promoteButton:mr.READY}}componentWillMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){let e=!1,t=!1,a=!0,s=0;var r,n=Object(b.a)(this.props.data);try{for(n.s();!(r=n.n()).done;){let i=r.value;i.type&&i.selected&&(s++,"entry"===i.type?e=!0:t=!0,"alert"!==i.type&&(a=!1))}}catch(m){n.e(m)}finally{n.f()}const l=0!==s&&a&&"event"===this.props.type,o=this.state,c=o.reparseButton,d=o.deleteButton,h=o.promoteButton,p=o.pendingDelete;let u=null;return p&&(u=this.props.data.filter(e=>e.selected).map(e=>({type:e.type,id:e.id}))),i.a.createElement("div",null,this.state.actionSuccess?i.a.createElement("div",null,i.a.createElement(P.a,{bsStyle:"success",onClick:this.RemoveSelected},"Action Successful! Remove Mark?"),i.a.createElement(P.a,{onClick:this.ToggleActionSuccess},"Keep Marked")):i.a.createElement("div",{style:{display:"grid"}},i.a.createElement("div",null,t||e?i.a.createElement("h4",{style:{float:"left"}},"Actions"):i.a.createElement("div",null," ",this.props.data.length>0?i.a.createElement("h4",{style:{float:"left"}},"Select a Marked Object"):null," "),i.a.createElement(Kt.a,{style:{float:"right"}},e&&!t&&"alertgroup"!==this.props.type?i.a.createElement(P.a,{onClick:this.MoveEntry},"Move to ",this.props.type," ",this.props.id):null,e&&!t&&"alertgroup"!==this.props.type?i.a.createElement(P.a,{onClick:this.CopyEntry},"Copy to ",this.props.type," ",this.props.id):null,t||e?i.a.createElement(P.a,{onClick:this.ExpandLinkToggle},"Link to ",this.props.type," ",this.props.id):null,l&&i.a.createElement(P.a,{bsStyle:h.style,onClick:this.Promote,disabled:h.disabled},h.text?h.text:"Add to ".concat(this.props.type," ").concat(this.props.id)),(t||e)&&i.a.createElement(P.a,{bsStyle:c.style,onClick:this.Reparse,disabled:c.disabled},c.text?c.text:"Reparse Flair"),(t||e)&&i.a.createElement(P.a,{bsStyle:"warning",onClick:this.RemoveSelected},"Unmark"),(t||e)&&i.a.createElement(P.a,{bsStyle:"danger",onClick:this.StartDelete,disabled:d.disabled},d.text?d.text:"Delete"))),this.state.linkPanel&&(t||e)?i.a.createElement(I.a,{collapsible:!0,expanded:this.state.linkPanel},i.a.createElement(ur.a,{horizontal:!0},i.a.createElement(T.a,{sm:2},"Provide context to this link:"),i.a.createElement(T.a,{sm:9},i.a.createElement(Hi.a,{type:"text",value:this.state.linkContextString,placeholder:"optional",onChange:this.LinkContextChange})),i.a.createElement(T.a,{sm:1},i.a.createElement(P.a,{onClick:this.Link,bsStyle:"success"},"Submit")))):null,p&&i.a.createElement(ds,{things:u,errorToggle:this.props.errorToggle,callback:this.deleteCallback})))}}yr.defaultProps={data:{}},gr.defaultProps={modalActive:!0};class fr extends i.a.Component{constructor(e){super(e),this.onBlur=e=>{let t=e.target.value;if(""===t)return;let a=t.split(/[ ,]+/);this.setState({emailField:a})},this.getData=()=>{q.a.ajax({type:"get",url:"/scot/api/v2/prepexport/"+this.props.type+"/"+this.props.id,success:function(e){this.setState({data:e}),this.setState({leaveCatch:!1,showEditor:!0})}.bind(this),error:function(e){this.props.errorToggle("Failed to get export data from server!",e)}.bind(this)})},this.exportResponse=e=>{"success"===e&&this.setState({showEditor:!1,responseSuccess:!0})},this.state={showEditor:!1,data:null,responseSuccess:!1,emailField:[]}}componentWillMount(){this.getData()}render(){let e=!1;return this.state.responseSuccess&&(e=!0),i.a.createElement("div",null,i.a.createElement(U.a,{dialogClassName:"links-modal",show:!0,onHide:this.props.exportToggle},i.a.createElement(U.a.Header,{closeButton:!0},i.a.createElement(U.a.Title,null,"Export ",this.props.type," ",this.props.id)),i.a.createElement(U.a.Body,null,i.a.createElement("div",null,i.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email addresses"),i.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",onBlur:this.onBlur,placeholder:"Enter emails (comma-separated)",disabled:e})),i.a.createElement("br",null),this.state.showEditor?i.a.createElement($s,{entryAction:"Export",exportResponse:this.exportResponse,type:this.props.type,targetid:this.props.id,id:"add_entry",recipients:this.state.emailField,addedentry:this.props.exportToggle,content:this.state.data,errorToggle:this.props.errorToggle}):null,!this.state.showEditor&&this.state.responseSuccess?i.a.createElement(br,null):null,this.state.showEditor||this.state.responseSuccess?null:i.a.createElement("i",{className:"fa fa-spinner fa-spin fa-2x","aria-hidden":"true"}))))}}class br extends s.Component{render(){return i.a.createElement("div",null,i.a.createElement("i",{className:"fa fa-check","aria-hidden":"true",style:{color:"green"}})," ","Export Successful!")}}const vr={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};class Er extends s.Component{constructor(e){super(e),this.state={showAllPromotedDataToolbar:!1},this.showAllPromotedDataToggle=this.showAllPromotedDataToggle.bind(this)}showAllPromotedDataToggle(){!1===this.state.showAllPromotedDataToolbar?this.setState({showAllPromotedDataToolbar:!0}):this.setState({showAllPromotedDataToolbar:!1})}render(){let e=null,t=[],a=[],s=3;"event"===this.props.type?e="alert":"incident"===this.props.type&&(e="event");for(let r=0;r<this.props.data.length;r++){r>0&&t.push(i.a.createElement("span",null," , "));let a="/"+e+"/"+this.props.data[r];t.push(i.a.createElement("span",{key:this.props.data[r]},i.a.createElement(ke.Link,{to:a},this.props.data[r])))}this.props.data.length<3&&(s=this.props.data.length);for(let r=0;r<s;r++){r>0&&a.push(i.a.createElement("div",null," , "));let t="/"+e+"/"+this.props.data[r];a.push(i.a.createElement("div",{key:this.props.data[r]},i.a.createElement(ke.Link,{to:t},this.props.data[r])))}return this.props.data.length>3&&a.push(i.a.createElement("div",{onClick:this.showAllPromotedDataToggle},",",i.a.createElement("a",{href:"javascript:;"},"...more"))),i.a.createElement("td",null,i.a.createElement("span",{id:"promoted_from",style:{display:"flex"}},a),this.state.showAllPromotedDataToolbar?i.a.createElement(is.a,{isOpen:!0,onRequestClose:this.showAllPromotedDataToggle,style:vr},i.a.createElement("div",{className:"modal-header"},i.a.createElement("img",{src:"images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:this.showAllPromotedDataToggle}),i.a.createElement("h3",{id:"myModalLabel"},"Promoted From")),i.a.createElement("div",{className:"modal-body promoted-from-full"},t),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(P.a,{id:"cancel-modal",onClick:this.showAllPromotedDataToggle},"Close"))):null)}}var wr=Er;let Sr,Tr,kr,xr,Cr;class Dr extends i.a.Component{constructor(e){super(e),this.updated=(e,t)=>{this.setState({refreshing:!0,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1});let a="entry";"alertgroup"==this.props.type&&(a="alert"),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){if(this.state.isMounted){let t=e;this.setState({headerData:t,showEventData:!0,eventLoaded:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),"alertgroup"==this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(this),error:function(e){this.setState({showEventData:!0,eventLoaded:!0,isNotFound:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload detail data. Error message: "+e.responseText,e)}.bind(this)}),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/"+a,success:function(e){if(this.state.isMounted){let t=e.records;this.setState({showEntryData:!0,entryLoaded:!0,entryData:t,runWatcher:!0}),this.Watcher(),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1})}}.bind(this),error:function(e){this.setState({showEntryData:!0,entryLoaded:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entry data. Error message: "+e.responseText,e)}}),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/entity",success:function(e){if(this.state.isMounted){let a=e.records;this.setState({showEntityData:!0,entityLoaded:!0,entityData:a});var t={waitEntry:function(){0==this.state.entryLoaded?setTimeout(t.waitEntry,50):(setTimeout(function(){dr.entityUpdate(a,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(this)),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}))}.bind(this)};t.waitEntry()}}.bind(this),error:function(e){this.setState({showEntityData:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entity data.",e)}.bind(this)}),void 0!=e&&void 0!=t&&this.props.errorToggle(t)},this.flairToolbarToggle=(e,t,a,s,i)=>{this.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:a,entityoffset:s,entityobj:i})},this.flairToolbarOff=()=>{if(this.state.isMounted){let e=this.state.entityDetailKey+1;this.setState({flairToolbar:!1,entityDetailKey:e})}},this.linkWarningToggle=(e,t=!1)=>{!1===this.state.linkWarningToolbar?this.setState({linkWarningToolbar:!0,link:e,nopop:t}):this.setState({linkWarningToolbar:!1,nopop:t})},this.exportToggle=()=>{!1===this.state.exportModal?this.setState({exportModal:!0}):this.setState({exportModal:!1})},this.viewedbyfunc=e=>{let t=[];if(null!==e)for(let a in e.view_history)t.push(a);return t},this.entryToggle=()=>{!1===this.state.entryToolbar?this.setState({entryToolbar:!0}):this.setState({entryToolbar:!1})},this.deleteToggle=(e,t)=>{!1===this.state.deleteToolbar?this.setState({deleteToolbar:!0,deleteType:e}):this.setState({deleteToolbar:!1,deleteType:e}),t&&this.setState({isDeleted:!0})},this.changeHistoryToggle=()=>{!1===this.state.changeHistoryToolbar?this.setState({changeHistoryToolbar:!0}):this.setState({changeHistoryToolbar:!1})},this.viewedByHistoryToggle=()=>{!1===this.state.viewedByHistoryToolbar?this.setState({viewedByHistoryToolbar:!0}):this.setState({viewedByHistoryToolbar:!1})},this.permissionsToggle=()=>{!1===this.state.permissionsToolbar?this.setState({permissionsToolbar:!0}):this.setState({permissionsToolbar:!1})},this.entitiesToggle=()=>{!1===this.state.entitiesToolbar?this.setState({entitiesToolbar:!0}):this.setState({entitiesToolbar:!1,entryEntityData:null})},this.promoteToggle=()=>{!1===this.state.promoteToolbar?this.setState({promoteToolbar:!0}):this.setState({promoteToolbar:!1})},this.fileUploadToggle=()=>{!1===this.state.fileUploadToolbar?this.setState({fileUploadToolbar:!0}):this.setState({fileUploadToolbar:!1})},this.titleCase=e=>e.charAt(0).toUpperCase()+e.slice(1),this.Watcher=()=>{q()("iframe").each(function(e,t){t.contentWindow.requestAnimationFrame(function(){if(null!==t.contentDocument){let e=[];e.push(this.checkFlairHover),e.push(this.checkHighlight),q()(t).off("mouseenter"),q()(t).off("mouseleave"),q()(t).on("mouseenter",function(e,a){let s=setInterval(this[0],50,t),i=setInterval(this[1],50,t);q()(t).data("intervalID",s),q()(t).data("intervalID1",i),console.log("Now watching iframe "+s)}.bind(e)),q()(t).on("mouseleave",(function(){let e=q()(t).data("intervalID"),a=q()(t).data("intervalID1");window.clearInterval(e),window.clearInterval(a),console.log("No longer watching iframe "+e)}))}}.bind(this))}.bind(this)),"alertgroup"==this.props.type&&q()("#detail-container").find("a, .entity").not(".not_selectable").each(function(e,t){q()(t).off("mousedown"),q()(t).on("mousedown",function(e){let t=e.target;if("extras"==q()(t)[0].className&&(t=q()(t)[0].parentNode),q()(t).attr("url")){let e=q()(t).attr("url");this.linkWarningToggle(e)}else{let e=q()(t).attr("data-entity-id"),a=q()(t).attr("data-entity-value"),s=q()(t).offset(),i=q()(t);this.flairToolbarToggle(e,a,"entity",s,i)}}.bind(this))}.bind(this))},this.checkHighlight=e=>{let t;if(null!==e.contentWindow){if(t=e.contentWindow.getSelection().toString(),this.state.highlightedText==t)return;this.setState({highlightedText:t})}},this.checkFlairHover=(e,t)=>{function a(){return e}null!=e.contentDocument&&(q()(e).contents().find(".entity").each(function(e,t){if("rgb(255, 0, 0)"==q()(t).css("background-color"))q()(t).data("state","down");else if("down"==q()(t).data("state")){q()(t).data("state","up");let e=q()(t).attr("data-entity-id"),s=q()(t).attr("data-entity-value"),i=q()(t),r=a(),n={top:q()(t).offset().top+q()(r).offset().top,left:q()(t).offset().left+q()(r).offset().left};this.flairToolbarToggle(e,s,"entity",n,i)}}.bind(this)),q()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==q()(t).css("color"))q()(t).data("state","down");else if("down"==q()(t).data("state")){q()(t).data("state","up");let e=q()(t).attr("url");this.linkWarningToggle(e)}}.bind(this)))},this.summaryUpdate=()=>{this.forceUpdate()},this.scrollTo=()=>{void 0!==this.props.taskid&&q()(".entry-wrapper").scrollTop(q()(".entry-wrapper").scrollTop()+q()("#iframe_"+this.props.taskid).position().top-30)},this.guideRedirectToAlertListWithFilter=()=>{RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},this.props.handleFilter(null,null,!0,"alertgroup"),this.props.handleFilter([{id:"subject",value:RegExp.escape(this.state.headerData.data.applies_to[0])}],null,!1,"alertgroup"),window.open("#/alertgroup/")},this.setEntryEntities=e=>{this.entitiesToggle(),this.setState({entryEntityData:e})},this.showSignatureOptionsToggle=()=>{!1===this.state.showSignatureOptions?this.setState({showSignatureOptions:!0}):this.setState({showSignatureOptions:!1})},this.markModalToggle=()=>{!1===this.state.showMarkModal?this.setState({showMarkModal:!0}):this.setState({showMarkModal:!1})},this.ToggleProcessingMessage=e=>{this.setState({processing:e}),this.props.togglePreventClick()},this.linksModalToggle=()=>{let e=!this.state.showLinksModal;this.setState({showLinksModal:e})},this.toggleFlair=()=>{this.state.flairOff?(this.setState({flairOff:!1,runWatcher:!0}),setTimeout(function(){dr.entityUpdate(this.state.entityData,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(this))):this.setState({flairOff:!0})},this.handleSelection=e=>{console.log("Got selection click!"),this.setState({alertsSelected:[e]})},this.handleMultiSelection=e=>{if(this.checkSelection(e.id))this.setState({alertsSelected:this.state.alertsSelected.filter((function(t){return t.id!==e.id}))});else{let t=[...this.state.alertsSelected,e];this.setState({alertsSelected:t})}},this.handleSelectAll=e=>{const t=e.map(e=>e.id);this.setState({alertsSelected:t})},this.handleShiftSelect=(e,t,a)=>{e>t&&(e=[t,t=e][0]);let s=[];a.forEach(function(a){a.id<=t&&a.id>=e&&(this.checkSelection(a)||s.push(a))}.bind(this)),this.setState({alertsSelected:[...this.state.alertsSelected,...s]})};let t=Math.floor(1e3*Math.random());this.state={showEventData:!1,headerData:{},sourceData:"",tagData:"",permissionsToolbar:!1,entitiesToolbar:!1,changeHistoryToolbar:!1,viewedByHistoryToolbar:!1,entryToolbar:!1,deleteToolbar:!1,deleteType:null,promoteToolbar:!1,notificationType:null,notificationMessage:null,key:this.props.id,showEntryData:!1,entryData:"",showEntityData:!1,entityData:[],entryEntityData:null,entityid:null,entitytype:null,entityoffset:null,entityobj:null,flairToolbar:!1,linkWarningToolbar:!1,exportModal:!1,refreshing:!1,loading:!1,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1,guideID:null,fileUploadToolbar:!1,isNotFound:!1,runWatcher:!1,entityDetailKey:t,processing:!1,showSignatureOptions:!1,showMarkModal:!1,showLinksModal:!1,flairOff:!1,highlightedText:"",flairing:!1,isMounted:!1,alertsSelected:[],isDeleted:!1}}componentWillMount(){this.setState({loading:!0})}componentDidMount(){this.setState({isMounted:!0});let e={delay:function(){let e="entry";"alertgroup"===this.props.type&&(e="alert"),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){if(this.state.isMounted){let t=e;this.setState({headerData:t,showEventData:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),"alertgroup"===this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(this),error:function(e){this.setState({showEventData:!0,isNotFound:!0}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load detail data. Error message: "+e.responseText,e)}.bind(this)}),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/"+e,success:function(e){if(this.state.isMounted){let t=e.records;this.setState({showEntryData:!0,entryData:t,runWatcher:!0}),this.Watcher(),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1})}}.bind(this),error:function(e){this.setState({showEntryData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entry data. Error message: "+e.responseText,e)}}),q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/entity",success:function(e){if(this.state.isMounted){let a=e.records;this.setState({showEntityData:!0,entityData:a});var t={waitEntry:function(){0==this.state.showEntryData?setTimeout(t.waitEntry,50):(setTimeout(function(){dr.entityUpdate(a,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id,this.scrollTo)}.bind(this)),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}))}.bind(this)};t.waitEntry()}}.bind(this),error:function(e){this.setState({showEntityData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entity data.",e)}.bind(this)}),"alertgroup"==this.props.type&&q.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/guide",success:function(e){if(this.state.isMounted){let t=[];for(let a=0;a<e.records.length;a++)t.push(e.records[a].id);0===t.length&&(t=null),this.setState({guideID:t})}}.bind(this),error:function(e){this.setState({guideID:null}),this.props.errorToggle("Error: Failed to load guide data. Error message:"+e.responseText,e)}.bind(this)}),this.props.createCallback(this.props.id,this.updated)}.bind(this)};Sr=setTimeout(e.delay,400)}componentWillUnmount(){this.setState({isMounted:!1}),clearTimeout(Sr),"function"===this.state.entryData.forEach&&this.state.entryData.forEach(function(e){this.props.removeCallback(e.id)}.bind(this))}componentDidUpdate(){!0===this.state.runWatcher&&this.Watcher()}checkSelection(e){return!!this.state.alertsSelected.some(t=>e===t.id)}render(){let e=this.state.headerData,t=this.viewedbyfunc(e),a=this.props.type,s=this.titleCase(this.props.type),r=this.props.id,n="";return this.state.headerData.subject?n=this.state.headerData.subject:this.state.headerData.value?n=this.state.headerData.value:this.state.headerData.name?n=this.state.headerData.name:this.state.headerData.body&&(n=this.state.headerData.body),i.a.createElement("div",null," ",this.state.isNotFound?i.a.createElement("h1",null,"No record found."):i.a.createElement("div",null,i.a.createElement("div",{id:"header"},i.a.createElement("div",{id:"NewEventInfo",className:"entry-header-info-null"},i.a.createElement("div",{className:"details-subject",style:{display:"inline-flex",paddingLeft:"5px"}},this.state.showEventData?i.a.createElement(_r,{data:this.state.headerData,subjectType:s,type:a,id:this.props.id,errorToggle:this.props.errorToggle}):null,this.state.refreshing?i.a.createElement("span",{style:{color:"lightblue"}},"Refreshing Data..."):null,this.state.loading?i.a.createElement("span",{style:{color:"lightblue"}},"Loading..."):null,this.state.processing?i.a.createElement("span",{style:{color:"lightblue"}},"Processing Actions..."):null,this.state.flairing?i.a.createElement("span",{style:{color:"lightblue"}},"Flairing..."):null),"entity"!==a?i.a.createElement("div",{className:"details-table toolbar",style:{display:"flex"}},i.a.createElement("table",null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("td",null,i.a.createElement("div",{style:{marginLeft:"5px"}},this.state.showEventData?i.a.createElement(ja,{data:this.state.headerData,status:this.state.headerData.status,id:r,type:a,errorToggle:this.props.errorToggle}):null)),"entity"!==a?i.a.createElement("th",null,"Owner: "):null,"entity"!==a?i.a.createElement("td",null,i.a.createElement("span",null,this.state.showEventData?i.a.createElement(fs,{key:r,data:this.state.headerData.owner,type:a,id:r,updated:this.updated,errorToggle:this.props.errorToggle}):null)):null,"entity"!==a?i.a.createElement("th",null,"Updated: "):null,"entity"!==a?i.a.createElement("td",null,i.a.createElement("span",{id:"event_updated"},this.state.showEventData?i.a.createElement(Nr,{data:this.state.headerData.updated}):null)):null,("event"===a||"incident"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?i.a.createElement("th",null,"Promoted From:"):null,("event"===a||"incident"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?i.a.createElement(wr,{data:this.state.headerData.promoted_from,type:a,id:r}):null,"entity"!==a&&this.state.showEventData?i.a.createElement(ir,{data:this.state.tagData,id:r,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"tag"}):null,"entity"!==a&&this.state.showEventData?i.a.createElement(ir,{data:this.state.sourceData,id:r,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"source"}):null)))):null),i.a.createElement(or.a,{ref:"notificationSystem"}),this.state.exportModal?i.a.createElement(fr,{type:a,errorToggle:this.props.errorToggle,exportToggle:this.exportToggle,id:r}):null,this.state.linkWarningToolbar?i.a.createElement(Di,{linkWarningToggle:this.linkWarningToggle,link:this.state.link,nopop:this.state.nopop}):null,this.state.viewedByHistoryToolbar?i.a.createElement(Ms,{viewedByHistoryToggle:this.viewedByHistoryToggle,id:r,type:a,subjectType:s,viewedby:t,errorToggle:this.props.errorToggle}):null,this.state.changeHistoryToolbar?i.a.createElement(Cs,{changeHistoryToggle:this.changeHistoryToggle,id:r,type:a,subjectType:s,errorToggle:this.props.errorToggle}):null,this.state.entitiesToolbar?i.a.createElement("span",null,null!==this.state.entryEntityData?i.a.createElement(ws,{entitiesToggle:this.entitiesToggle,entityData:this.state.entryEntityData,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff}):i.a.createElement(ws,{entitiesToggle:this.entitiesToggle,entityData:this.state.entityData,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff})):null,this.state.deleteToolbar?i.a.createElement("div",null,"alert"!==this.state.deleteType?i.a.createElement(hs,{deleteType:this.state.deleteType,subjectType:s,id:r,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,removeCallback:this.props.removeCallback}):i.a.createElement(hs,{deleteType:this.state.deleteType,type:a,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,alertsSelected:this.state.alertsSelected,removeCallback:this.props.removeCallback})):null,this.state.showMarkModal?i.a.createElement(gr,{modalActive:!0,type:a,id:r,string:n,errorToggle:this.props.errorToggle,markModalToggle:this.markModalToggle}):null,this.state.showLinksModal?i.a.createElement(hr,{modalActive:!0,type:a,id:r,errorToggle:this.props.errorToggle,linksModalToggle:this.linksModalToggle}):null,this.state.showEventData?i.a.createElement(as,{type:a,subjectType:s,id:r,entryData:this.state.entryData,headerData:this.state.headerData,status:this.state.headerData.status,promoteToggle:this.promoteToggle,permissionsToggle:this.permissionsToggle,entryToggle:this.entryToggle,entitiesToggle:this.entitiesToggle,changeHistoryToggle:this.changeHistoryToggle,viewedByHistoryToggle:this.viewedByHistoryToggle,exportToggle:this.exportToggle,deleteToggle:this.deleteToggle,updated:this.updated,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,sourceToggle:this.sourceToggle,subjectName:this.state.headerData.subject,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,guideRedirectToAlertListWithFilter:this.guideRedirectToAlertListWithFilter,showSignatureOptionsToggle:this.showSignatureOptionsToggle,markModalToggle:this.markModalToggle,linksModalToggle:this.linksModalToggle,ToggleProcessingMessage:this.ToggleProcessingMessage,errorToggle:this.props.errorToggle,toggleFlair:this.toggleFlair,alertsSelected:this.state.alertsSelected,guideID:this.state.guideID}):null,this.state.permissionsToolbar?i.a.createElement(Ls,{updateid:r,id:r,type:a,permissionData:this.state.headerData,permissionsToggle:this.permissionsToggle,updated:this.updated,errorToggle:this.props.errorToggle}):null),this.state.showEventData&&"entity"!==a?i.a.createElement(Qi,{id:r,type:a,entryToggle:this.entryToggle,updated:this.updated,entryData:this.state.entryData,headerData:this.state.headerData,showEntryData:this.state.showEntryData,showEntityData:this.state.showEntityData,summaryUpdate:this.summaryUpdate,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entryToolbar:this.state.entryToolbar,alertPreSelectedId:this.props.alertPreSelectedId,errorToggle:this.props.errorToggle,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,showSignatureOptions:this.state.showSignatureOptions,flairOff:this.state.flairOff,highlightedText:this.state.highlightedText,form:this.props.form,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:dr.entityUpdate,handleSelection:this.handleSelection,handleShiftSelect:this.handleShiftSelect,handleMultiSelection:this.handleMultiSelection,handleSelectAll:this.handleSelectAll,alertsSelected:this.state.alertsSelected,setEntryEntities:this.setEntryEntities}):null,this.state.showEventData&&"entity"===a?i.a.createElement(oi,{entityid:r,form:this.props.form,entitytype:"entity",id:r,type:"entity",fullScreen:!0,errorToggle:this.props.errorToggle,linkWarningToggle:this.linkWarningToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:dr.entityUpdate}):null,this.state.flairToolbar?i.a.createElement(oi,{key:this.state.entityDetailKey,form:this.props.form,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entityid:parseInt(this.state.entityid,10),data:this.state.headerData,entityvalue:this.state.entityvalue,entitytype:this.state.entitytype,type:this.props.type,id:this.props.id,errorToggle:this.props.errorToggle,entityoffset:this.state.entityoffset,watcher:this.Watcher,entityobj:this.state.entityobj,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:dr.entityUpdate}):null))}}class Nr extends i.a.Component{render(){let e=this.props.data;return i.a.createElement("div",null,i.a.createElement(La.a,{value:1e3*e,format:"MM/DD/YY hh:mm:ss a"}))}}class _r extends i.a.Component{constructor(e){super(e),this.handleChange=e=>{if(null!==e){let t={[this.state.keyName]:e.target.value},a=e.target.value;q.a.ajax({type:"put",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.setState({value:a}),this.calculateWidth(a)}.bind(this),error:function(e){this.props.errorToggle("error: Failed to update the subject/name",e)}.bind(this)})}},this.onChange=e=>{this.setState({value:e.target.value})},this.handleEnterKey=e=>{"Enter"===e.key&&this.handleChange(e)},this.calculateWidth=e=>{let t;q()("#invisible").html(q()("<span></span>").text(e)),t=q()("#invisible").width()+25+"px",this.setState({width:t})},this.componentWillReceiveProps=e=>{let t=e.data.subject;"signature"===e.type?t=e.data.name:"entity"===e.type&&(t=e.data.value),this.setState({value:t}),this.calculateWidth(t)};let t="subject",a=this.props.data.subject;"signature"===this.props.type?(t="name",a=this.props.data.name):"entity"===this.props.type&&(t="value",a=this.props.data.value),this.state={value:a,width:"",keyName:t}}componentDidMount(){this.calculateWidth(this.state.value)}render(){let e=!1;return"entity"===this.props.type&&""!==this.state.value&&(e=!0),i.a.createElement("div",null,this.props.subjectType," ",this.props.id,":"," ",i.a.createElement("input",{type:"text",value:this.state.value,onKeyPress:this.handleEnterKey,onChange:this.onChange,onBlur:this.handleChange,style:{width:this.state.width,lineHeight:"normal"},className:"detail-header-input",disabled:e}))}}class Mr extends i.a.Component{constructor(...e){super(...e),this.render=()=>{let e=[];e.push(i.a.createElement(Dr,{key:this.props.id,id:this.props.id,type:this.props.type,toggleEventDisplay:this.props.viewEvent,taskid:this.props.taskid,alertPreSelectedId:this.props.alertPreSelectedId,handleFilter:this.props.handleFilter,errorToggle:this.props.errorToggle,history:this.props.history,form:this.props.form,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,togglePreventClick:this.props.togglePreventClick}));let t="100%";return void 0!==q()("#list-view")[0]&&(t="calc(100% - "+q()("#list-view").width()+"px)"),i.a.createElement("div",{id:"main-detail-container",className:"entry-container",style:{width:t,position:"relative"},tabIndex:"3"},e)}}}class Ar extends i.a.Component{constructor(e){super(e),this.componentWillMount=()=>{void 0===this.props.viewMode||"default"===this.props.viewMode||"landscape"===this.props.viewMode?this.Landscape():"portrait"===this.props.viewMode&&this.Portrait(),this.props.id&&this.ConvertAlertIdToAlertgroupId(this.props.id),this.ConvertEntryIdToType(this.props.id),q.a.ajax({type:"get",url:"/scot/api/v2/form",success:function(e){this.setState({form:e})}.bind(this),error:function(e){this.props.errorToggle("Failed to get form structure",e)}.bind(this)})},this.componentDidMount=()=>{let e,t=this.state.scrollheight,a=this.state.sort,s=this.state.filter,i=this.state.activepage.limit,r=this.state.activepage.page,n=[];void 0!==this.props.id&&this.props.id.length>0&&(l=this.props.id,"landscape"===this.state.viewMode&&(t="30vh"));let l=[],o=[],c=this.props.type+":listview";this.props.createCallback(c,this.reloadactive);let d="/scot/api/v2/"+this.state.type;"alert"===this.props.type&&(d="/scot/api/v2/alertgroup"),e=r*i;let h={limit:i,offset:e};if(void 0!==a||null===a){let e={};q.a.each(a,(function(t,a){let s=-1;a.desc||(s=1),e[a.id]=s})),h.sort=JSON.stringify(e)}void 0===a&&null!==a||q.a.each(s,(function(e,t){if("source"===t.id||"tag"===t.id){let e=[];var a,s=Object(b.a)(t.value);try{for(s.s();!(a=s.n()).done;){let t=a.value;e.push(t.name)}}catch(i){s.e(i)}finally{s.f()}h[t.id]=JSON.stringify(e)}else if("created"===t.id||"updated"===t.id){let e=[];e.push(t.value.start),e.push(t.value.end),h[t.id]=JSON.stringify(e)}else h[t.id]=JSON.stringify(t.value)})),Cr=q.a.ajax({type:"GET",url:d,data:h,traditional:!0,success:function(e){Tr=e,q.a.each(Tr.records,function(e,t){o[e]={},q.a.each(t,function(t,a){if("sources"===t||"source"===t){if(void 0!==a){let t=a.join(", ");o[e].source=t}}else if("tags"===t||"tag"===t){if(void 0!==a){let t=a.join(", ");o[e].tag=t}}else o[e][t]=a;"id"===t&&(this.props.createCallback(a,this.reloadactive),n.push(a))}.bind(this)),o[e].classname=e%2===0?"table-row roweven":"table-row rowodd"}.bind(this));let a=this.getPages(e.totalRecordCount);this.setState({scrollheight:t,objectarray:o,totalCount:e.totalRecordCount,loading:!1,idsarray:n,totalPages:a}),"alert"===this.props.type&&!1===this.state.showSelectedContainer||void 0===this.state.id||null===this.state.id?this.setState({showSelectedContainer:!1}):this.setState({showSelectedContainer:!0})}.bind(this),error:function(e){"abort"===!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(this)}),q()("#list-view-container").keydown(this.keyNavigate),q()(document.body).keydown(function(e){q()("input").is(":focus")||q()("textarea").is(":focus")||70===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleView()}.bind(this))},this.componentWillUnmount=()=>{document.removeEventListener("keydown",this.keyNavigate)},this.togglePreventClick=()=>{this.setState({preventClick:!this.state.preventClick})},this.keyNavigate=e=>{if("click"!==e.type){if(!["j","k","ArrowUp","ArrowDown"].includes(e.key))return;let t=(e.target||e.srcElement).tagName.toLowerCase();if("input"===t||"textarea"===t)return}let t=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected");if(!t)return;let a=null;switch(e.key){case"j":case"ArrowDown":default:a=t.parentElement.nextElementSibling;break;case"k":case"ArrowUp":a=t.parentElement.previousElementSibling}if(!a)return;let s=a.children[0].children[0].innerHTML;this.props.history.push("/".concat(this.state.type,"/").concat(s)),e.preventDefault(),e.stopPropagation()},this.reloadactive=()=>{this.getNewData()},this.ToggleCreateEntity=()=>{this.setState({showEntityCreateModal:!this.state.showEntityCreateModal})},this.render=()=>{let e,t=!1,a=this.state.scrollheight;e=null==this.state.listViewContainerDisplay?null:"0px",null!=this.state.id&&null!=this.state.typeCapitalized&&(document.title=this.state.typeCapitalized.charAt(0)+"-"+this.state.id),null==kt("listViewFilter"+this.props.type)&&null==kt("listViewSort"+this.props.type)&&null==kt("listViewPage"+this.props.type)||(t=!0);let s=wa(this.props.type,{},{},!1);return i.a.createElement("div",null,"entry"!==this.state.type?i.a.createElement("div",{key:this.state.listViewKey,className:"allComponents"},i.a.createElement("div",{className:"black-border-line"},i.a.createElement("div",{className:"mainview"},i.a.createElement("div",null,i.a.createElement("div",{className:"list-buttons"},"on"===this.props.notificationSetting?i.a.createElement(Ra.a,{eventkey:"1",onClick:this.props.notificationToggle,bsSize:"xsmall"},"Mute Notifications"):i.a.createElement(Ra.a,{eventkey:"2",onClick:this.props.notificationToggle,bsSize:"xsmall"},"Turn On Notifications"),"event"===this.props.type||"intel"===this.props.type||"incident"===this.props.type||"signature"===this.props.type||"guide"===this.props.type||"entity"===this.props.type?i.a.createElement(Ra.a,{onClick:this.createNewThing,eventkey:"6",bsSize:"xsmall"},"Create ",this.state.typeCapitalized):null,i.a.createElement(Ra.a,{eventkey:"5",bsSize:"xsmall",onClick:this.exportCSV},"Export to CSV"),i.a.createElement(Ra.a,{bsSize:"xsmall",onClick:this.toggleView},"Full Screen Toggle (f)"),t?i.a.createElement(Ra.a,{onClick:this.clearAll,eventkey:"3",bsSize:"xsmall",bsStyle:"info"},"Clear All Filters"):null),i.a.createElement("div",{id:"list-view-container",tabIndex:"1"},i.a.createElement("div",{id:"list-view",tabIndex:"2"},i.a.createElement(Bt.a,{columns:s,data:this.state.objectarray,style:{maxHeight:a},page:this.state.activepage.page,pages:this.state.totalPages,defaultPageSize:50,onPageChange:this.handlePageChange,onPageSizeChange:this.handlePageSizeChange,pageSize:this.state.activepage.limit,onFilteredChange:this.handleFilter,filtered:this.state.filter,onSortedChange:this.handleSort,sorted:this.state.sort,manual:!0,sortable:!0,filterable:!0,resizable:!0,styleName:"styles.ReactTable",className:"-striped -highlight",minRows:0,LoadingComponent:this.CustomTableLoader,loading:this.state.loading,getTrProps:this.handleRowSelection}))),i.a.createElement("div",{onMouseDown:this.dragdiv,className:"splitter",style:{display:"block",height:"10px",backgroundColor:"black",borderTop:"1px solid #AAA",borderBottom:"1px solid #AAA",cursor:"row-resize",overflow:"hidden"}}),this.state.showSelectedContainer?i.a.createElement(Mr,{key:this.state.id,id:this.state.id,type:this.state.queryType,alertPreSelectedId:this.state.alertPreSelectedId,taskid:this.state.entryid,handleFilter:this.handleFilter,errorToggle:this.props.errorToggle,history:this.props.history,togglePreventClick:this.togglePreventClick,form:this.state.form,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,togglePreventClick:this.togglePreventClick}):null,this.state.showEntityCreateModal?i.a.createElement(Fi,{match:"",modalActive:this.state.showEntityCreateModal,ToggleCreateEntity:this.ToggleCreateEntity,errorToggle:this.props.errorToggle}):null)))):null)},this.CustomTableLoader=()=>i.a.createElement("div",{className:"-loading"+(this.state.loading?" -active":"")},i.a.createElement(ct,{loading:this.state.loading})),this.AutoScrollToId=()=>{let e=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected"),t=document.querySelector(".ReactTable .rt-tbody");e?((t.scrollTop+t.offsetHeight-e.offsetHeight<e.offsetTop||e.offsetTop<t.scrollTop)&&(t.scrollTop=e.offsetTop-t.offsetHeight/2+e.offsetHeight/2),this.setState({initialAutoScrollToId:!0})):t.scrollTop=0},this.componentDidUpdate=(e,t)=>{for(let a=0;a<this.state.objectarray.length;a++){let e=this.state.objectarray[a].id;(null!=this.state.id&&this.state.id===e&&this.state.id!==t.id||null!=this.state.id&&this.state.id===e&&!1===t.initialAutoScrollToId)&&setTimeout(this.AutoScrollToId,300)}},this.componentWillReceiveProps=e=>{void 0===e.id?this.setState({type:e.type,id:null,showSelectedContainer:!1,scrollheight:q()(window).height()-170+"px"}):e.id!==this.props.id&&("alert"===this.props.type?(this.ConvertAlertIdToAlertgroupId(e.id),this.ConvertEntryIdToType(e.id),this.setState({type:e.type,alertPreSelectedId:e.id})):"task"===this.props.type?this.setState({type:e.type,queryType:e.queryType,id:e.id,entryid:e.id2}):this.setState({type:e.type,id:e.id}))},this.ConvertAlertIdToAlertgroupId=e=>{"alert"===this.props.type&&q.a.ajax({type:"get",url:"scot/api/v2/alert/"+e,success:function(e){let t=e;this.setState({id:t.alertgroup,showSelectedContainer:!0})}.bind(this),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(this)})},this.ConvertEntryIdToType=e=>{"entry"===this.props.type&&q.a.ajax({type:"get",url:"scot/api/v2/entry/"+e,async:!1,success:function(e){this.selected(e.target.type,e.target.id,this.props.id)}.bind(this),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(this)})},this.startdrag=e=>{q()("iframe").each((function(e,t){q()(t).addClass("pointerEventsOff")})),this.setState({manualScrollHeight:xr+e.clientY-kr+"px",scrollheight:xr+e.clientY-kr+"px"})},this.stopdrag=e=>{q()("iframe").each((function(e,t){q()(t).removeClass("pointerEventsOff")})),document.onmousemove=null},this.dragdiv=e=>{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();let t=document.getElementsByClassName("ReactTable");kr=e.clientY,xr=parseInt(document.defaultView.getComputedStyle(t[0]).height,10),document.onmousemove=this.startdrag,document.onmouseup=this.stopdrag},this.toggleView=()=>{0!==this.state.id.length&&!0===this.state.showSelectedContainer&&"none"!==this.state.listViewContainerDisplay?this.setState({listViewContainerDisplay:"none",scrollheight:"0px"}):this.setState({listViewContainerDisplay:null,scrollheight:"30vh"})},this.Landscape=()=>{document.onmousemove=null,document.onmousedown=null,document.onmouseup=null,q()(".splitter").css("width","100%"),q()(".mainview").show(),this.setState({classname:[" "," "," "," "],splitter:!1,display:"block",maxheight:"",alldetail:!0,differentviews:"100%",scrollheight:null!=this.state.id?"300px":q()(window).height()-170+"px",maxwidth:"",minwidth:"",scrollwidth:"100%",resize:"vertical"}),this.setState({listViewOrientation:"landscape-list-view"}),Dt("viewMode","landscape",1e3)},this.clearAll=()=>{let e=this.state.listViewKey+1;this.setState({listViewKey:e,activepage:{page:0,limit:this.state.activepage.limit},sort:[{id:"id",desc:!0}],filter:[]}),this.getNewData({page:0},[{id:"id",desc:!0}],{}),Ct("listViewFilter"+this.props.type),Ct("listViewSort"+this.props.type),Ct("listViewPage"+this.props.type)},this.selected=(e,t,a,s)=>{let i;null==s&&null==a?this.props.history.push("/"+e+"/"+t):null==s&&null!=a?this.props.history.push("/"+e+"/"+t+"/"+a):this.props.history.push("/"+e+"/"+s+"/"+t+"/"),"block"===this.state.display&&(i="30vh"),this.setState({alertPreSelectedId:0,scrollheight:i,showSelectedContainer:!0})},this.getNewData=(e,t,a)=>{this.setState({loading:!0});let s,i,r,n=t,l=a,o=(this.state.idsarray,[]);this.ConvertAlertIdToAlertgroupId(this.props.id),this.ConvertEntryIdToType(this.props.id),void 0==e?(i=this.state.activepage.page,s=this.state.activepage.limit):(i=void 0==e.page?this.state.activepage.page:e.page,s=void 0==e.limit?this.state.activepage.limit:e.limit),r=i*s,void 0==n&&(n=this.state.sort),void 0==l&&(l=this.state.filter);let c={limit:s,offset:r};if(void 0!=n){let e={};q.a.each(n,(function(t,a){let s=-1;a.desc||(s=1),e[a.id]=s})),c.sort=JSON.stringify(e)}void 0!=l&&q.a.each(l,(function(e,t){if("source"==t.id||"tag"==t.id){let e=[];var a,s=Object(b.a)(t.value);try{for(s.s();!(a=s.n()).done;){let t=a.value;e.push(t.name)}}catch(i){s.e(i)}finally{s.f()}c[t.id]=JSON.stringify(e)}else if("created"==t.id||"updated"==t.id||"occurred"==t.id){let e=[];e.push(t.value.start),e.push(t.value.end),c[t.id]=JSON.stringify(e)}else c[t.id]=JSON.stringify(t.value)}));let d=[];1==this.state.loading&&Cr.abort(),Cr=q.a.ajax({type:"GET",url:"/scot/api/v2/"+this.state.type,data:c,traditional:!0,success:function(e){Tr=e,q.a.each(Tr.records,function(e,t){d[e]={},q.a.each(t,function(t,a){if("sources"==t||"source"==t){if(void 0!=a){let t=a.join(", ");d[e].source=t}}else if("tags"==t||"tag"==t){if(void 0!=a){let t=a.join(", ");d[e].tag=t}}else d[e][t]=a;"id"==t&&(this.props.createCallback(a,this.reloadactive),o.push(a))}.bind(this)),d[e].classname=e%2==0?"table-row roweven":"table-row rowodd"}.bind(this));let t=this.getPages(e.totalRecordCount);this.setState({totalCount:e.totalRecordCount,activepage:{page:i,limit:s},objectarray:d,loading:!1,idsarray:o,totalPages:t})}.bind(this),error:function(e){"abort"==!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(this)})},this.exportCSV=()=>{let e=[],t=this.state.columns;q.a.each(t,(function(t,a){e.push(a)}));let a="";q()(".rt-tbody").find(".rt-tr").each((function(e,t){let s=[];q()(t).find(".rt-td").each((function(e,t){let a=q()(t).text();a=a.replace(/,/g,"|"),s.push(a)})),a+=s.join()+"\n"}));let s=e.join()+"\n";a=s+a;let i="data:text/csv;charset=utf-8,"+encodeURIComponent(a);window.open(i)},this.handleSort=(e,t)=>{let a=[];if(!0===t)this.setState({sort:[{id:"id",desc:!0}]});else{var s,i=Object(b.a)(e);try{for(i.s();!(s=i.n()).done;){let e=s.value;e.id&&a.push(e)}}catch(n){i.e(n)}finally{i.f()}}this.setState({sort:a}),this.getNewData(null,a,null);let r="listViewSort"+this.props.type;Dt(r,JSON.stringify(a),1e3)},this.handleFilter=(e,t,a,s)=>{let i=[],r=this.props.type;if(void 0!==s&&(r=s),!0!==a){var n,l=Object(b.a)(e);try{for(l.s();!(n=l.n()).done;){let e=n.value;e.id&&i.push(e)}}catch(o){l.e(o)}finally{l.f()}this.setState({filter:i}),s!==this.props.type&&void 0!==s||this.getNewData({page:0},null,i),Dt("listViewFilter"+r,JSON.stringify(i),1e3)}else this.setState({filter:i})},this.titleCase=e=>e.charAt(0).toUpperCase()+e.slice(1),this.createNewThing=()=>{let e;if("signature"===this.props.type)e=JSON.stringify({name:"Name your Signature",status:"disabled"});else if("guide"===this.props.type)e=JSON.stringify({subject:"ENTER A GUIDE NAME",applies_to:["documentation"]});else{if("entity"===this.props.type)return void this.ToggleCreateEntity();e=JSON.stringify({subject:"No Subject"})}q.a.ajax({type:"POST",url:"/scot/api/v2/"+this.props.type,data:e,success:function(e){this.selected(this.props.type,e.id)}.bind(this),error:function(e){this.props.errorToggle("failed to create new thing",e)}.bind(this)})},this.handlePageChange=e=>{this.getNewData({page:e});let t="listViewPage"+this.props.type;Dt(t,JSON.stringify({page:e,limit:this.state.activepage.limit}))},this.handlePageSizeChange=(e,t)=>{this.getNewData({limit:e,page:t});let a="listViewPage"+this.props.type;Dt(a,JSON.stringify({page:t,limit:e}))},this.getPages=e=>Math.ceil((e||1)/this.state.activepage.limit);let t=this.props.type,a=this.props.id,s=this.props.type,r=null,n=q()(window).height()-170+"px",l=!1,o=[{id:"id",desc:!0}],c={page:0,limit:50},d=[];xa.columnsDisplay[this.props.type],xa.columns[this.props.type],xa.columnsClassName[this.props.type];null!=this.props.listViewSort&&(o=JSON.parse(this.props.listViewSort)),null!=this.props.listViewPage&&(c=JSON.parse(this.props.listViewPage)),null!=this.props.listViewFilter&&(d=JSON.parse(this.props.listViewFilter)),"alert"===this.props.type&&(l=!1,h="Alertgroup",t="alertgroup",s="alertgroup",r=a),"task"===this.props.type&&(t="task",s=this.props.queryType);let h=this.titleCase(this.props.type);this.state={togglePreventClick:!1,splitter:!0,selectedColor:"#AEDAFF",sourcetags:[],tags:[],startepoch:"",endepoch:"",idtext:"",totalCount:0,activepage:c,statustext:"",subjecttext:"",idsarray:[],classname:[" "," "," "," "],alldetail:!0,viewsarrow:[0,0],idarrow:[-1,-1],subjectarrow:[0,0],statusarrow:[0,0],resize:"horizontal",createdarrow:[0,0],sourcearrow:[0,0],tagsarrow:[0,0],viewstext:"",entriestext:"",scrollheight:n,display:"flex",differentviews:"",maxwidth:"915px",maxheight:n,minwidth:"650px",suggestiontags:[],suggestionssource:[],sourcetext:"",tagstext:"",scrollwidth:"650px",reload:!1,viewfilter:!1,viewevent:!1,showevent:!0,objectarray:[],csv:!0,fsearch:"",listViewOrientation:"landscape-list-view",columns:xa.columns[this.props.type],columnsDisplay:xa.columnsDisplay[this.props.type],columnsClassName:xa.columnsClassName[this.props.type],typeCapitalized:h,type:t,queryType:s,id:a,showSelectedContainer:l,listViewContainerDisplay:null,viewMode:this.props.viewMode,offset:0,sort:o,filter:d,match:null,alertPreSelectedId:r,entryid:this.props.id2,listViewKey:1,loading:!0,initialAutoScrollToId:!1,manualScrollHeight:null,showEntityCreateModal:!1,form:[]},this.handleRowSelection=this.handleRowSelection.bind(this)}handleRowSelection(e,t,a,s){return{onClick:e=>{if(!0!==this.state.preventClick){if(this.state.id===t.row.id)return;let e=this.state.scrollheight;return"block"==this.state.display&&(e="30vh"),"task"===this.state.type?this.props.history.push("/task/"+t.row.target_type+"/"+t.row.target_id+"/"+t.row.id):this.props.history.push("/"+this.state.type+"/"+t.row.id),void this.setState({alertPreSelectedId:0,scrollheight:e,showSelectedContainer:!0})}this.props.errorToggle("Currently processing action(s). Please wait.")},className:t.row.id===parseInt(this.props.id)?"selected":null}}}var jr=a(66),Or=a.n(jr),Lr=a(5),Pr=a.n(Lr),Ir=a(972),Fr=a(977),Rr=a(973),Ur=a(445),Hr=a(971),Wr=a(967),Br=a(974),Vr=a(966),zr=a(965),qr=a(983);const Kr=e=>({textField:{marginLeft:"-8px",marginRight:e.spacing.unit},root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},textInput:{backgroundColor:"white",color:"black"}}),Gr={username:"",fullname:"",password:"",description:"",name:"",id:null,suggestions:[],groups:[],active:0};class Jr extends i.a.Component{constructor(e){super(e),this.formatGroups=()=>{if(this.props.groups.length>0){let e=[];this.props.groups.forEach((function(t){let a={};a.id=t.name,a.text=t.name,e.push(a)})),this.setState({suggestions:e})}},this.resetState=()=>{this.setState(Gr)},this.checkBlankInputs=e=>{let t=!1;return"user"===e?""!==this.state.username&&""!==this.state.fullname&&""!==this.state.password&&(t=!0):""!==this.state.name&&""!==this.state.description&&(t=!0),t},this.buildDataObj=e=>{let t={};return"user"===e?(t.username=this.state.username,t.fullname=this.state.fullname,t.password=this.state.password,t.groups=this.state.groups,t.active=this.state.active?1:0):"group"===e&&(t.name=this.state.name,t.description=this.state.description),t},this.handleGroups=e=>{const t=this.props,a=t.enqueueSnackbar,s=t.type;if(e.length>0){let t=[];e.forEach((function(e){t.push(e.id)})),this.setState({groups:t})}else a("Error handling groups  ".concat(s),{variant:"error"})},this.handlePUT=()=>{const e=this.props,t=e.enqueueSnackbar,a=e.type;let s=this.buildDataObj(a);this.checkBlankInputs(a)&&De.a.put("/scot/api/v2/".concat(a,"/").concat(this.state.id),s).then(function(e){t("Successfully updated ".concat(a,"."),{variant:"success"}),this.resetState(),this.props.fetchData(a),this.props.handleClose()}.bind(this)).catch((function(e){t("Failed updating ".concat(a),{variant:"error"})}))},this.handlePOST=()=>{const e=this.props,t=e.enqueueSnackbar,a=e.type;let s=this.buildDataObj(a);this.checkBlankInputs(a)&&De.a.post("/scot/api/v2/".concat(a,"/"),s).then(function(e){console.log(e),t("Successfully added ".concat(a,"."),{variant:"success"}),this.resetState(),this.props.fetchData(a),this.props.handleClose()}.bind(this)).catch((function(e){t("Failed creating ".concat(a),{variant:"error"}),console.log(e)}))},this.handleChange=(e,t)=>{if("input"===e.nativeEvent.type){let t=e.target.value;this.setState({[e.target.id]:t})}else"click"===e.nativeEvent.type?"checkbox"===e.target.type&&this.setState({[e.target.value]:t}):this.setState({[e.target.name]:t.props.value})},this.state=Gr}componentDidMount(){this.formatGroups(),this.props.editObject&&("user"===this.props.type?this.setState({username:this.props.editObject.username,fullname:this.props.editObject.fullname,password:this.props.editObject.password,id:this.props.editObject.id,active:this.props.editObject.active,groups:this.props.editObject.groups}):"group"===this.props.type&&this.setState({name:this.props.editObject.name,description:this.props.editObject.description,id:this.props.editObject.id}))}render(){const e=this.props,t=e.classes;e.onClose,e.selectedValue,e.type,Object(f.a)(e,["classes","onClose","selectedValue","type"]);return i.a.createElement("div",null,i.a.createElement(zs.a,{className:t.card},i.a.createElement(qs.a,null,this.props.editObject?i.a.createElement(Vs.a,{variant:"h5",component:"h2"},"Edit ",this.props.type," ",i.a.createElement("b",null,this.props.editObject.username," ")):i.a.createElement(Vs.a,{variant:"h5",component:"h2"},"Create ",this.props.type," "),"group"===this.props.type?i.a.createElement("div",null,i.a.createElement(Br.a,{id:"name",label:"Group Name",value:this.state.name,onChange:this.handleChange,variant:"outlined",helperText:"Enter name of group",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),i.a.createElement("br",null),i.a.createElement(Br.a,{id:"description",label:"Description",value:this.state.description,onChange:this.handleChange,variant:"outlined",helperText:"Enter description for group",InputLabelProps:{shrink:!0},fullWidth:!0,style:{marginTop:8,marginBottom:8}})):i.a.createElement("div",null,i.a.createElement(Br.a,{id:"username",label:"Username",value:this.state.username,onChange:this.handleChange,variant:"outlined",helperText:"Enter a valid username",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),i.a.createElement("br",null),i.a.createElement(Br.a,{id:"fullname",label:"Full Name",value:this.state.fullname,onChange:this.handleChange,variant:"outlined",helperText:"Provide your full name",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),i.a.createElement("br",null),i.a.createElement(Br.a,{id:"password",label:"Password",type:"password",autoComplete:"current-password",margin:"normal",variant:"outlined",helperText:"Enter a valid password",value:this.state.password,onChange:this.handleChange,fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),i.a.createElement("br",null),i.a.createElement(zr.a,{control:i.a.createElement(qr.a,{checked:this.state.active,onChange:this.handleChange,value:"active"}),label:"Active?"}),i.a.createElement("br",null),i.a.createElement("b",null,"Groups"),i.a.createElement(Qr,{editObject:this.props.editObject,handleGroups:this.handleGroups,id:this.state.id,suggestions:this.state.suggestions}),i.a.createElement("br",null)),i.a.createElement("br",null)),i.a.createElement(Vr.a,null,this.props.editObject?i.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},i.a.createElement(aa.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),i.a.createElement(aa.a,{variant:"contained",color:"secondary",onClick:this.handlePUT,className:t.button},"Submit")):i.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},i.a.createElement(aa.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),i.a.createElement(aa.a,{variant:"contained",color:"secondary",onClick:this.handlePOST,className:t.button},"Submit")))))}}class Yr extends i.a.Component{constructor(e){super(e),this.mapUsersGroupsToTags=()=>{De.a.get("/scot/api/v2/user?id=".concat(this.props.id)).then(e=>{const t=[];e.data.totalRecordCount>0&&(e.data.records.forEach((function(e){let a={};a.id=e.name,a.text=e.name,t.push(a)})),this.setState({groups:t}))})},this.handleDelete=e=>{const t=this.state.groups;this.setState({groups:t.filter((t,a)=>a!==e)})},this.handleAddition=e=>{const t=this.props.enqueueSnackbar;if(this.checkValidGroup(e.id)){let t=this.state.groups;t.push(e),this.setState({groups:t}),this.props.handleGroups(this.state.groups)}else t("Invalid group. Please add an existing group")},this.state={groups:[]}}componentDidMount(){if(this.props.editObject){let e=[];this.props.editObject.groups.forEach((function(t){let a={};a.id=t,a.text=t,e.push(a)})),this.setState({groups:e})}}shouldComponentUpdate(e,t){return this.state!==t&&(this.props.handleGroups(t.groups),!0)}checkValidGroup(e){return!!this.props.suggestions.some((function(t){return t.id===e}))}render(){const e=this.state.groups,t=this.props.suggestions;this.props.classes;return i.a.createElement("div",null,i.a.createElement(sr.WithContext,{classNames:{tagInput:"tagInputClass",tagInputField:"tagInputFieldClass"},placeholder:"Add a new group",inline:!1,tags:e,suggestions:t,handleDelete:this.handleDelete,handleAddition:this.handleAddition}))}}const Qr=Object(ot.a)(Kr)(Yr),Xr=Object(rs.b)(Object(ot.a)(Kr)(Jr));var $r=a(968),Zr=a(970),en=a(279),tn=a.n(en),an=a(969);class sn extends i.a.Component{constructor(e){super(e),this.handleDelete=()=>{const e=this.props,t=e.enqueueSnackbar,a=e.type,s=e.id;let i="/scot/api/v2/".concat(a,"/").concat(s);De.a.delete(i).then(function(){t("Successfully deleted ".concat(a,"."),{variant:"success"}),this.props.fetchData(a),this.props.handleClose()}.bind(this)).catch((function(e){console.log(e),t("Failed deleting ".concat(a,"."),{variant:"error"}),this.props.handleClose()}))},this.state={deletetext:""}}render(){const e=this.props.classes;return i.a.createElement("div",null,i.a.createElement(zs.a,{className:e.card},i.a.createElement(qs.a,null,i.a.createElement(Vs.a,{variant:"h5",component:"h2"},"Are you sure you want to delete ",this.props.type," ",this.props.text,"?"),i.a.createElement("br",null),i.a.createElement("div",null,i.a.createElement(aa.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:()=>this.handleDelete(this.props.id),variant:"contained"},"Yes"),i.a.createElement(aa.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}var rn=Object(rs.b)(Object(ot.a)(e=>({card:{minWidth:400,marginBottom:20}}))(sn));class nn extends i.a.Component{constructor(e){super(e),this.edit=(e,t)=>{let a="/scot/api/v2/".concat(e,"?id=").concat(t);De.a.get(a).then(function(t){this.setState({editObject:t.data.records[0],type:e,showModal:!0})}.bind(this)).catch((function(e){console.log(e)}))},this.showUserDialog=()=>{this.setState({showModal:!0,type:"user"})},this.showGroupDialog=()=>{this.setState({showModal:!0,type:"group"})},this.handleUserClose=()=>{this.setState({showModal:!1})},this.handleClose=e=>{this.setState({showModal:!1,id:null,type:"",editObject:null})},this.handleListItemClick=e=>{this.props.onClose(e)},this.getColumns=e=>{let t=[];return"user"===e?t=[{Header:"ID",accessor:"id",width:50},{Header:"Full Name",accessor:"fullname",width:90},{Header:"Username",accessor:"username",width:70},{Header:"Active",id:"active",accessor:e=>i.a.createElement("center",null,(e.active,i.a.createElement("div",null,i.a.createElement(zr.a,{control:i.a.createElement(qr.a,{onChange:()=>this.handleActiveToggle(e.id),checked:e.active,value:e.active})})))),width:80},{Header:"Edit / Delete",id:"edit",accessor:t=>i.a.createElement("center",null,i.a.createElement(aa.a,{size:"small",style:{marginLeft:5},onClick:()=>this.edit(e,t.id),variant:"contained"},"Edit"),i.a.createElement(aa.a,{size:"small",style:{marginLeft:5},onClick:()=>this.toggleAreYouSure(t.id,e),color:"secondary",variant:"contained"},i.a.createElement(tn.a,null))),width:200}]:"group"===e&&(t=[{Header:"ID",accessor:"id",width:50},{Header:"Group Name",accessor:"name",width:100},{Header:"Group Description",accessor:"description",width:100},{Header:"Edit / Delete",id:"edit",accessor:t=>i.a.createElement("center",null,i.a.createElement(aa.a,{size:"small",style:{marginLeft:5},onClick:()=>this.edit(e,t.id),variant:"contained"},"Edit"),i.a.createElement(aa.a,{size:"small",style:{marginLeft:5},onClick:()=>this.toggleAreYouSure(t.id,e),color:"secondary",variant:"contained"},i.a.createElement(tn.a,null))),width:200}]),t},this.setUserGroupResults=(e,t)=>{"user"===e?this.setState({userdata:t.records}):"group"===e&&this.setState({groupdata:t.records})},this.toggleAreYouSure=(e,t)=>{this.setState({areYouSure:!0,id:e,type:t})},this.handleAreYouSureClose=()=>{this.setState({areYouSure:!1})},this.fetchData=e=>{De.a.get("/scot/api/v2/".concat(e,"?limit=0")).then(({data:t})=>this.setUserGroupResults(e,t))},this.handleActiveToggle=e=>{let t=this.getUserObject(e);this.setState({userdata:this.state.userdata.map(t=>t.id===e?Object(v.a)(Object(v.a)({},t),{},{active:!t.active}):t),updateId:t.id})},this.getUserObject=e=>this.state.userdata.filter(t=>e===t.id?t:null)[0],this.state={userdata:[],groupdata:[],showModal:!1,editObject:null,id:null,type:"",areYouSure:!1,updateId:null}}componentDidUpdate(e,t){const a=this.props.enqueueSnackbar;if(t.userdata!==this.state.userdata&&null!==this.state.updateId){const e=this.getUserObject(this.state.updateId);De.a.put("/scot/api/v2/user/".concat(this.state.updateId),{active:e.active}).then(function(e){a("Successfully updated user.",{variant:"success"}),this.setState({updateId:null})}.bind(this)).catch((function(e){a("Failed updating user",{variant:"error"})}))}}componentDidMount(){this.fetchData("user"),this.fetchData("group")}render(){const e=this.props,t=e.classes,a=Object(f.a)(e,["classes"]),s=this.state,r=s.groupdata;let n=s.userdata.length>10,l=r.length>10;return i.a.createElement("div",{className:t.root},i.a.createElement("br",null),i.a.createElement(si.a,{className:t.paper,elevation:1},i.a.createElement(Vs.a,{variant:"h5",component:"h3"},"Please be advised"),i.a.createElement(Vs.a,{component:"p"},"In order to properly add a user, they must belong to a group. A user is added to a group at time of creatino or upon 'Edit'. Groups MUST include the string 'scot' in the name or they will be ignored by the system. You must activate a user in order to begin logging in as the user.")),i.a.createElement("br",null),i.a.createElement(Wr.a,{container:!0,spacing:8},i.a.createElement(Wr.a,{item:!0,xs:12,sm:6},i.a.createElement(Vs.a,{variant:"h4",gutterBottom:!0},"Users ",i.a.createElement($r.a,null)),i.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.a.createElement(Vs.a,{variant:"h5",gutterBottom:!0},"Add User"),i.a.createElement(an.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showUserDialog,color:"secondary","aria-label":"Add"},i.a.createElement(ua.a,null))),i.a.createElement(Bt.a,{data:this.state.userdata,columns:this.getColumns("user"),pageSize:this.state.userdata.length,defaultPageSize:10,showPagination:n})),i.a.createElement(Wr.a,{item:!0,xs:12,sm:6},i.a.createElement(Vs.a,{variant:"h4",gutterBottom:!0},"Groups ",i.a.createElement(Zr.a,null)),i.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.a.createElement(Vs.a,{variant:"h5",gutterBottom:!0},"Add Group"),i.a.createElement(an.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showGroupDialog,color:"secondary","aria-label":"Add"},i.a.createElement(ua.a,null))),i.a.createElement(Bt.a,{data:this.state.groupdata,columns:this.getColumns("group"),pageSize:this.state.groupdata.length,defaultPageSize:10,showPagination:l}))),i.a.createElement(Js.a,{open:this.state.showModal,onClose:this.handleClose,"aria-labelledby":"simple-dialog-title"},i.a.createElement(Xr,{id:this.state.id,groups:this.state.groupdata,type:this.state.type,editObject:this.state.editObject,handleClose:this.handleClose,fetchData:e=>{this.fetchData(e)}})),this.state.areYouSure?i.a.createElement(Js.a,Object.assign({open:this.state.areYouSure,onClose:this.handleAreYouSureClose,"aria-labelledby":"simple-dialog-title"},a),i.a.createElement(rn,{type:this.state.type,fetchData:e=>{this.fetchData(e)},handleClose:this.handleAreYouSureClose,id:this.state.id})):null)}}var ln=Object(rs.b)(Object(ot.a)(e=>({root:{flexGrow:1},paper:Object(v.a)(Object(v.a)({},e.mixins.gutters()),{},{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit})}))(nn)),on=a(441),cn=a.n(on),dn=a(157),hn=a.n(dn);class pn extends i.a.Component{constructor(e){super(e),this.GetKeys=this.GetKeys.bind(this),this.GetAvailableGroups=this.GetAvailableGroups.bind(this),this.CreateKey=this.CreateKey.bind(this),this.DeleteKey=this.DeleteKey.bind(this),this.GroupChange=this.GroupChange.bind(this),this.ToggleActiveStatus=this.ToggleActiveStatus.bind(this),this.state={Api:null,keys:null,availableGroups:null}}GetKeys(){q.a.ajax({type:"get",url:"/scot/api/v2/apikey",success:function(e){this.setState({keys:e.records})}.bind(this),error:function(){this.setState({keys:"failed to get keys"})}.bind(this)})}GetAvailableGroups(){q.a.ajax({type:"get",url:"/scot/api/v2/group?limit=0",success:function(e){this.setState({availableGroups:e.records})}.bind(this)})}CreateKey(){q.a.ajax({type:"post",url:"/scot/api/v2/apikey",success:function(){this.GetKeys()}.bind(this)})}DeleteKey(e){q.a.ajax({type:"delete",url:"/scot/api/v2/apikey/".concat(e.target.id),success:function(){this.GetKeys()}.bind(this)})}GroupChange(e,t){q.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){this.GetKeys()}.bind(this)})}ToggleActiveStatus(e,t){q.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),contentType:"application/json; charset=UTF-8",data:JSON.stringify({active:t}),success:function(){this.GetKeys()}.bind(this)})}componentDidMount(){this.GetKeys(),this.GetAvailableGroups()}render(){const e=[];if(void 0!=this.state.keys)for(let t=0;t<this.state.keys.length;t++){let a,s;const r=[];if(a=1==this.state.keys[t].active?i.a.createElement("span",{style:{color:"green"}},"active"):i.a.createElement("span",{style:{color:"red"}},"not active"),void 0!=this.state.keys[t].groups)for(let e=0;e<this.state.keys[t].groups.length;e++)r.push(i.a.createElement("div",null,"this.state.keys[i].groups[j]"));e.push(i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("div",null,this.state.keys[t].apikey),i.a.createElement("div",null,this.state.keys[t].username),i.a.createElement("span",null,"Key is ",a),i.a.createElement("span",{className:"pull-right pointer"},i.a.createElement("i",{id:this.state.keys[t].id,className:"fa fa-trash","aria-hidden":"true",onClick:this.DeleteKey})),i.a.createElement("div",null,i.a.createElement(un,{id:this.state.keys[t].id,currentGroups:this.state.keys[t].groups,allGroups:this.state.availableGroups,GroupChange:this.GroupChange,ToggleActiveStatus:this.ToggleActiveStatus,keyActiveStatus:this.state.keys[t].active,keyActiveStatusCss:s}))),i.a.createElement("hr",null)))}return i.a.createElement("div",{id:"api",className:"administration_api"},i.a.createElement("h1",null,"API"),i.a.createElement(cn.a,{bsStyle:"info",header:"Your api keys"},e),i.a.createElement(Ra.a,{bsStyle:"success",onClick:this.CreateKey},"Create API Key"))}}class un extends i.a.Component{constructor(e){super(e),this.Open=this.Open.bind(this),this.Close=this.Close.bind(this),this.DeleteGroup=this.DeleteGroup.bind(this),this.ToggleActiveStatus=this.ToggleActiveStatus.bind(this),this.state={showModal:!1}}Open(){this.setState({showModal:!0})}Close(){this.setState({showModal:!1})}DeleteGroup(e){const t=[];var a,s=Object(b.a)(this.props.currentGroups);try{for(s.s();!(a=s.n()).done;){const s=a.value;void 0!=s&&s!=e.target.parentNode.textContent&&t.push(s)}}catch(i){s.e(i)}finally{s.f()}this.props.GroupChange(this.props.id,t)}ToggleActiveStatus(){let e;e=1==this.props.keyActiveStatus?0:1,this.props.ToggleActiveStatus(this.props.id,e)}render(){const e=[],t=[];if(this.props.currentGroups){var a,s=Object(b.a)(this.props.currentGroups);try{for(s.s();!(a=s.n()).done;){const e=a.value;t.push(i.a.createElement("span",{className:"tagButton"},e,i.a.createElement("i",{id:this.props.id,onClick:this.DeleteGroup,className:"fa fa-times tagButtonClose"})))}}catch(o){s.e(o)}finally{s.f()}var r,n=Object(b.a)(this.props.currentGroups);try{for(n.s();!(r=n.n()).done;){const t=r.value;e.push(i.a.createElement("span",{className:"tagButton"},t))}}catch(o){n.e(o)}finally{n.f()}}let l=1===this.props.keyActiveStatus?"active":"not active";return i.a.createElement("div",null,"Current Groups: ",e,i.a.createElement("div",null,i.a.createElement(Ra.a,{onClick:this.Open,bsSize:"small"},"Edit API key settings")),i.a.createElement(hn.a,{show:this.state.showModal,onHide:this.Close},i.a.createElement(hn.a.Header,{closeButton:!0},i.a.createElement(hn.a.Title,null,"Edit API key settings")),i.a.createElement(hn.a.Body,null,i.a.createElement("div",null,i.a.createElement("h4",null,"Current Groups:"),t),i.a.createElement("hr",null),i.a.createElement("div",null,"Key is ",i.a.createElement("span",{className:this.props.keyActiveStatusCss},l),i.a.createElement(Ra.a,{onClick:this.ToggleActiveStatus,bsSize:"xsmall"},"Toggle Active Status")))))}}const mn={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}};class gn extends s.Component{constructor(e){super(e),this.state={data:[],allSelected:!1},this.handleTHeadCheckboxSelection=this.handleTHeadCheckboxSelection.bind(this),this.handleRowSelection=this.handleRowSelection.bind(this),this.handleCheckboxSelection=this.handleCheckboxSelection.bind(this),this.getDeletedItems=this.getDeletedItems.bind(this)}componentWillMount(){this.mounted=!0,this.getDeletedItems()}componentWillUnmount(){this.mounted=!1}render(){const e=[{Header:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"mark-checkbox"},i.a.createElement("i",{className:"fa fa".concat(this.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"}))),id:"selected",accessor:e=>e.selected,Cell:e=>i.a.createElement("div",null,i.a.createElement("div",{className:"mark-checkbox"},i.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"}))),maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"data.id",id:"data.id",column:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"data.subject",id:"data.subject",column:"subject",maxWidth:"100%",sortable:!0},{Header:"Body",accessor:"data.body",id:"data.body",column:"body",maxWidth:"100%",sortable:!0}];let t=[];for(let a in this.state.data)t.push(this.state.data[a].data);return i.a.createElement("div",null,this.state.data.length>0?i.a.createElement(Bt.a,{columns:e,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No deleted items were found.",style:{maxHeight:"60vh"},filterable:!0}):i.a.createElement("h3",null,"No deleted items were found."),this.state.data.length>0?i.a.createElement(yn,{data:this.state.data,id:this.props.id,type:this.props.type,getDeletedItems:this.getDeletedItems,errorToggle:this.props.errorToggle}):null)}handleRowSelection(e,t,a){return{onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;t.row["data.id"]==e.data.id&&t.row.type==e.type?e.selected=!0:e.selected=!1}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:!1})},style:{background:void 0!=t&&t.row.selected?"rgb(174, 218, 255)":null}}}handleCheckboxSelection(e,t,a){return"selected"==a.id?{onClick:e=>{let a=this.state.data;var s,i=Object(b.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;if(t.row["data.id"]==e.data.id&&t.row.type==e.type){e.selected?e.selected=!e.selected:e.selected=!0;break}}}catch(r){i.e(r)}finally{i.f()}this.setState({data:a,allSelected:this.checkAllSelected(a)}),e.stopPropagation()}}:{}}handleTHeadCheckboxSelection(e,t,a,s){return"selected"===a.id?{onClick:t=>{let a=this.state.data,s=!this.state.allSelected;var i,r=Object(b.a)(a);try{for(r.s();!(i=r.n()).done;){let t=i.value;var n,l=Object(b.a)(e.pageRows);try{for(l.s();!(n=l.n()).done;){let e=n.value;if(t.data.id==e["data.id"]&&t.data.type==e["data.type"]){t.selected=s;break}}}catch(o){l.e(o)}finally{l.f()}}}catch(o){r.e(o)}finally{r.f()}this.setState({data:a,allSelected:s})}}:{}}checkAllSelected(e){var t,a=Object(b.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(s){a.e(s)}finally{a.f()}return!0}getDeletedItems(){q.a.ajax({type:"get",url:"/scot/api/v2/deleted/?limit=0",success:function(e){this.setState({data:e.records})}.bind(this),error:function(e){console.log("unable to get deleted items")}.bind(this)})}}class yn extends s.Component{constructor(e){super(e),this.state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:mn.READY,deleteButton:mn.READY,promoteButton:mn.READY},this.RemoveSelected=this.RemoveSelected.bind(this),this.MoveEntry=this.MoveEntry.bind(this),this.CopyEntry=this.CopyEntry.bind(this),this.EntryAjax=this.EntryAjax.bind(this),this.Link=this.Link.bind(this),this.LinkAjax=this.LinkAjax.bind(this),this.Reparse=this.Reparse.bind(this),this.ReparseAjax=this.ReparseAjax.bind(this),this.Promote=this.Promote.bind(this),this.PromoteAjax=this.PromoteAjax.bind(this),this.ToggleActionSuccess=this.ToggleActionSuccess.bind(this),this.ExpandLinkToggle=this.ExpandLinkToggle.bind(this),this.LinkContextChange=this.LinkContextChange.bind(this),this.deleteCallback=this.deleteCallback.bind(this),this.StartDelete=this.StartDelete.bind(this),this.Restore=this.Restore.bind(this),this.Purge=this.Purge.bind(this)}componentWillMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}deleteCallback(e){!0===e&&this.RemoveSelected(),this.setState({pendingDelete:!1})}render(){let e=!1,t=!1,a=!0,s=0;var r,n=Object(b.a)(this.props.data);try{for(n.s();!(r=n.n()).done;){let i=r.value;i.type&&i.selected&&(s++,"entry"===i.type?e=!0:t=!0,"alert"!==i.type&&(a=!1))}}catch(c){n.e(c)}finally{n.f()}0!=s&&a&&this.props.type;const l=this.state;l.reparseButton,l.deleteButton,l.promoteButton;let o=null;return l.pendingDelete&&(o=this.props.data.filter(e=>e.selected).map(e=>({type:e.type,id:e.id}))),i.a.createElement("div",null,i.a.createElement(or.a,{ref:"notificationSystem"}),this.state.actionSuccess?i.a.createElement("div",null,i.a.createElement(P.a,{bsStyle:"success",onClick:this.props.getDeletedItems},"Action Successful! Click to reload data.")):i.a.createElement("div",{style:{display:"grid"}},i.a.createElement("div",null,i.a.createElement("h4",{style:{float:"left"}})," ",this.props.data.length>0?i.a.createElement("h4",{style:{float:"left"}},"Select a Deleted Object"):null,i.a.createElement(Kt.a,{style:{float:"right"}},i.a.createElement(P.a,{bsStyle:"success",onClick:this.Restore},"Restore"),i.a.createElement(P.a,{bsStyle:"danger",onClick:this.Purge},"Purge")))))}Restore(e){var t,a=Object(b.a)(this.props.data);try{for(a.s();!(t=a.n()).done;){let e=t.value;e.selected&&q.a.ajax({type:"put",url:"/scot/api/v2/deleted/"+e.id,data:JSON.stringify({status:"undelete"}),success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Restored",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to restore items")}.bind(this)})}}catch(s){a.e(s)}finally{a.f()}}Purge(e){var t,a=Object(b.a)(this.props.data);try{for(a.s();!(t=a.n()).done;){let e=t.value;e.selected&&q.a.ajax({type:"delete",url:"/scot/api/v2/deleted/"+e.id,success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Purged",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to purge items")}.bind(this)})}}catch(s){a.e(s)}finally{a.f()}}LinkContextChange(e){this.setState({linkContextString:e.target.value})}ExpandLinkToggle(e){if(1==e||0==e)this.setState({linkPanel:e,linkContextString:""});else{let e=!this.state.linkPanel;this.setState({linkPanel:e,linkContextString:""})}}RemoveSelected(){var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&za(t.type,t.id)}}catch(a){t.e(a)}finally{t.f()}this.props.getDeletedItems(),this.state.actionSuccess&&this.setState({actionSuccess:!1})}StartDelete(){this.setState({pendingDelete:!0})}MoveEntry(){var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&"entry"==t.type&&this.EntryAjax(t.id,!0)}}catch(a){t.e(a)}finally{t.f()}}CopyEntry(){var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;t.selected&&"entry"==t.type&&this.EntryAjax(t.id,!1)}}catch(a){t.e(a)}finally{t.f()}}Link(){var e,t=Object(b.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){let t=e.value;if(t.selected){let e=[],a={},s={};a.id=parseInt(t.id),a.type=t.type,s.id=parseInt(this.props.id),s.type=this.props.type,e.push(a),e.push(s),this.LinkAjax(e)}}}catch(a){t.e(a)}finally{t.f()}}Reparse(){this.setState({reparseButton:mn.LOADING}),q.a.when(...this.props.data.filter(e=>e.selected).map(e=>this.ReparseAjax(e))).then(()=>{this.setState({reparseButton:mn.SUCCESS})},e=>{console.error(e),this.setState({reparseButton:mn.ERROR}),this.props.errorToggle("error reparsing",e)}).always(()=>{setTimeout(()=>{this.setState({reparseButton:mn.READY})},2e3)})}ReparseAjax(e){return q.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"})}Promote(){this.setState({promoteButton:mn.LOADING});let e=!0;q.a.when(...this.props.data.filter(e=>e.selected).map(e=>this.PromoteAjax(e))).then(()=>{this.setState({promoteButton:mn.SUCCESS})},t=>{e=!1,console.error(t),this.setState({promoteButton:mn.ERROR}),this.props.errorToggle("error adding alerts to event",t)}).always(()=>{setTimeout(()=>{this.setState({promoteButton:mn.READY}),e&&window.location.reload()},2e3)})}PromoteAjax(e){return q.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(this.props.id)}),contentType:"application/json; charset=UTF-8"})}LinkAjax(e){let t={weight:1};t.vertices=e,this.state.linkContextString&&(t.context=this.state.linkContextString),q.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to link",e)}.bind(this)})}EntryAjax(e,t){q.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){let s={};s={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},q.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(s),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(this),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(this)})}RemoveEntryAfterMove(e){q.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")}.bind(this),error:function(e){this.props.errorToggle("Failed to remove original entry",e)}.bind(this)})}ToggleActionSuccess(e){if(1==e||0==e)this.setState({actionSuccess:e});else{let e=!this.state.actionSuccess;this.setState({actionSuccess:e})}}}function fn(e){return i.a.createElement(Vs.a,{component:"div",style:{padding:24}},e.children)}yn.defaultProps={data:{}},gn.defaultProps={modalActive:!0};const bn=Object(Ur.a)({typography:{fontSize:20}});class vn extends i.a.Component{constructor(...e){super(...e),this.state={value:0},this.handleChange=(e,t)=>{this.setState({value:t})}}render(){const e=this.props.classes,t=this.state.value;return i.a.createElement(Hr.a,{theme:bn},i.a.createElement("div",{className:e.root},i.a.createElement(Ir.a,{className:Pr()(e.appBar,e.typography),position:"static"},i.a.createElement(Fr.a,{value:t,indicatorColor:"primary",centered:!0,onChange:this.handleChange},i.a.createElement(Rr.a,{label:"Users / Groups"}),i.a.createElement(Rr.a,{label:"API"}),i.a.createElement(Rr.a,{label:"Undelete"}))),0===t&&i.a.createElement(fn,null,i.a.createElement(ln,null)),1===t&&i.a.createElement(fn,null,i.a.createElement(pn,null)),2===t&&i.a.createElement(fn,null,i.a.createElement(gn,null))))}}var En=Object(ot.a)(e=>({root:{flexGrow:1},appBar:{backgroundColor:"#2196f3"},typography:{fontSize:20}}))(vn);class wn{constructor(){this.s4=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1),this.get_guid=()=>this.s4()+this.s4()+this.s4()+this.s4()+this.s4()+this.s4()+this.s4()+this.s4(),this.register_client=e=>{this.client=this.get_guid(),this.whoami=ie("whoami"),q.a.ajax({type:"POST",url:"/scotaq/amq",data:{message:"chat",type:"listen",clientId:this.client,destination:"topic://scot"},success:function(t){console.log("Registered client as "+this.client),e||setTimeout(function(){this.get_data()}.bind(this),1e3)}.bind(this),error:function(e){console.log("Error: failed to register client, retry in 1 sec"),setTimeout((function(){this.register_client()}),1e3)}})},this.get_data=()=>{let e=new Date;q.a.ajax({type:"GET",url:"/scotaq/amq",data:{clientId:this.client,timeout:2e4,d:e.getTime(),r:Math.random(),json:"true",username:this.whoami},success:function(e){console.log("Received Message"),setTimeout(function(){this.get_data()}.bind(this),40),q()(e).text().split("\n").forEach(function(e,t){if(""!==e){let t=JSON.parse(e);return console.log(t),this.process_message(t),this.handle_update(t),!0}}.bind(this))}.bind(this),error:function(){setTimeout(function(){this.getData(this.client)}.bind(this),1e3),console.log("AMQ not detected, retrying in 1 second.")}})},this.create_callback_object=(e,t)=>{let a=e;if(this.checkNumber(a)&&(a=parseInt(a,10)),this.cb_map.has(a))this.cb_map.get(a).add(t);else{let e=new Set;e.add(t),this.cb_map.set(a,e)}},this.remove_callback_object=e=>{this.cb_map.delete(e)},this.process_message=e=>{"wall"===e.action?(this.activemqwho=e.data.who,this.activemqmessage=e.data.message,this.activemqwhen=e.data.when,this.activemqwall=!0):(this.activemqaction=e.action,this.activemqid=e.data.id,this.activemqtype=e.data.type,this.activemqwho=e.data.who,this.activemqguid=e.guid,this.activemqhostname=e.hostname,this.activemqpid=e.pid)},this.execute_callback_function=e=>{try{let t=this.cb_map.get(e);void 0!==t&&t.forEach((function(e){e()}));let a=this.cb_map.get("notification");void 0!==a&&a.forEach((function(e){e()}))}catch(t){throw t}},this.handle_update=e=>{let t="";"wall"===e.action?t="wall":"created"===e.action?t="".concat(e.data.type,":listview"):("updated"===e.action||"deleted"===e.action)&&(t=e.data.id),this.execute_callback_function(t)},this.client="",this.whoami="",this.amqdebug="",this.activemqaction="",this.activemqaction="",this.activemqid="",this.activemqwho="",this.activemqtype="",this.activemqguid="",this.activemqhostname="",this.activemqpid="",this.activemqwhen="",this.activemqwall="",this.cb_map=new Map}checkNumber(e){let t=parseInt(e,10);return!isNaN(t)}}class Sn extends i.a.Component{constructor(e){super(e),this.componentWillReceiveProps=e=>{let t=kt("viewMode"),a=kt("notification");if(e.match.params.value)var s=kt("listViewFilter"+e.match.params.value.toLowerCase()),i=kt("listViewSort"+e.match.params.value.toLowerCase()),r=kt("listViewPage"+e.match.params.value.toLowerCase());void 0===a&&(a="on"),this.state.handler||this.GetHandler(),this.state.whoami||this.WhoAmIQuery(),this.setState({viewMode:t,notificationSetting:a,listViewFilter:s,listViewSort:i,listViewPage:r})},this.componentDidMount=()=>{this.GetHandler(),this.WhoAmIQuery(),this.AMQ.register_client(),this.AMQ.create_callback_object("wall",this.wall),this.AMQ.create_callback_object("notification",this.notification),"/"===this.props.match.url&&q()(document.body).keydown(function(e){this.ee(e)}.bind(this))},this.eedraw=()=>{q()("#content").css("transform","rotateX(20deg)"),q()(document.body).prepend('<span id="ee">Lbh sbhaq gur rtt. Cbfg gb gur jnyy "V sbhaq gur rtt, pna lbh?"</span>')},this.eeremove=()=>{q()("#content").css("transform","rotateX(0deg)"),q()("#ee").remove()},this.componentWillUnmount=()=>{var e;e="whoami",localStorage.removeItem(e)},this.componentWillMount=()=>{let e=kt("notification");void 0==e&&(e="on"),this.setState({notificationSetting:e})},this.ee=e=>{let t="837279877769847269697171";if(t.includes(this.state.eestring))if(this.state.eestring+e.keyCode===t)this.eedraw(),setTimeout(this.eeremove,2e3);else{if(q()("input").is(":focus"))return;if(!0!==e.ctrlKey&&!0!==e.metaKey){let t=this.state.eestring+e.keyCode;this.setState({eestring:t})}}else this.setState({eestring:""})},this.notification=()=>{if("/"===this.props.match.path&&this.props.match.isExact&&fe.includes(this.props.stateProps.activemqstate))return;let e=this.refs.notificationSystem;if("scot-alerts"!==this.AMQ.activemqwho&&"scot-admin"!==this.AMQ.activemqwho&&"scot-flair"!==this.AMQ.activemqwho&&void 0!==e&&this.AMQ.activemqwho!==this.state.whoami&&""!==this.AMQ.activemqwho&&"api"!==this.AMQ.activemqwho&&!0!==this.AMQ.activemqwall&&"entity"!==this.AMQ.activemqtype&&"on"===this.state.notificationSetting){let t="".concat(this.AMQ.activemqwho," ").concat(this.AMQ.activemqaction," ").concat(this.AMQ.activemqtype," : ").concat(this.AMQ.activemqid),a=this.AMQ.activemqtype,s=this.AMQ.activemqstate,i=this.AMQ.activemqid;e.addNotification({message:t,level:"info",autoDismiss:5,action:"delete"!==s?{label:"View",callback:function(){window.open("/#/"+a+"/"+i)}}:null})}},this.wall=e=>{if("/"!==this.props.match.path||!this.props.match.isExact){var t=this.refs.notificationSystem,a=new Date(1e3*this.AMQ.activemqwhen);a=a.toLocaleString(),!0===this.AMQ.activemqwall&&t.addNotification({message:a+" "+this.AMQ.activemqwho+": "+this.AMQ.activemqmessage,level:"warning",autoDismiss:0})}},this.errorToggle=(e,t)=>{let a=e;if(t)if(t.responseJSON){if("Authentication Required"===t.responseJSON.error)return this.setState({csrf:t.responseJSON.csrf}),void this.loginToggle(t.responseJSON.csrf)}else"Service Unavailable"===t.statusText&&(a=t.statusText);this.refs.notificationSystem.addNotification({message:a,level:"error",autoDismiss:0})},this.notificationToggle=()=>{"off"===this.state.notificationSetting?(this.setState({notificationSetting:"on"}),Dt("notification","on",1e3)):(this.setState({notificationSetting:"off"}),Dt("notification","off",1e3))},this.loginToggle=(e,t)=>{if(this.state.login||!0===t)this.state.login&&!0===t&&(this.setState({login:!1}),this.props.history.push(this.state.origurl));else{let e=this.props.location.pathname;this.props.history.push("/"),this.setState({login:!0,origurl:e})}},this.LogOut=()=>{q.a.ajax({type:"get",url:"/logout",success:function(e){this.setState({login:!0}),console.log("Successfully logged out"),this.WhoAmIQuery()}.bind(this),error:function(e){this.error("Failed to log out",e)}.bind(this)})},this.WhoAmIQuery=()=>{q.a.ajax({type:"get",url:"scot/api/v2/whoami",success:function(e){var t,a;t="whoami",a=e.user,localStorage.setItem(t,a),e.data&&this.setState({sensitivity:e.data.sensitivity,whoami:e.user})}.bind(this),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(this)})},this.GetHandler=()=>{q.a.ajax({type:"get",url:"/scot/api/v2/handler?current=1",success:function(e){this.setState({handler:e.records[0].username})}.bind(this),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(this)})},this.render=()=>{let e,t="Incident Handler: "+this.state.handler;return this.props.match.params.value&&(e=this.props.match.params.value.toLowerCase()),i.a.createElement(A,null,i.a.createElement(o.a,{inverse:!0,fixedTop:!0,fluid:!0},i.a.createElement(o.a.Header,null,i.a.createElement(o.a.Brand,null,i.a.createElement(ke.Link,{to:"/",style:{margin:"0",padding:"0"}},i.a.createElement("img",{src:"/images/scot-600h.png",alt:"",style:{width:"50px"}}))),i.a.createElement(o.a.Toggle,null)),i.a.createElement(o.a.Collapse,null,i.a.createElement(d.a,null,i.a.createElement(Or.a,{to:"/alertgroup",activeClassName:"active"},i.a.createElement(p.a,null,"Alert")),i.a.createElement(Or.a,{to:"/event",activeClassName:"active"},i.a.createElement(p.a,null,"Event")),i.a.createElement(Or.a,{to:"/incident",activeClassName:"active"},i.a.createElement(p.a,null,"Incident")),i.a.createElement(Or.a,{to:"/intel",activeClassName:"active"},i.a.createElement(p.a,null,"Intel")),i.a.createElement(m.a,{id:"nav-dropdown",title:"More"},i.a.createElement(Or.a,{to:"/task",activeClassName:"active"},i.a.createElement(y.a,null,"Task")),i.a.createElement(Or.a,{to:"/guide",activeClassName:"active"},i.a.createElement(y.a,null,"Guide")),i.a.createElement(Or.a,{to:"/signature",activeClassName:"active"},i.a.createElement(y.a,null,"Signature")),i.a.createElement(Or.a,{to:"/entity",activeClassName:"active"},i.a.createElement(y.a,null,"Entity")),i.a.createElement(Or.a,{to:"/reports",activeClassName:"active"},i.a.createElement(y.a,null,"Reports")),i.a.createElement(y.a,{divider:!0}),i.a.createElement(Or.a,{to:"/admin",activeClassName:"active"},i.a.createElement(y.a,null,"Administration")),i.a.createElement(y.a,{href:"/docs/index.html"},"Documentation"),i.a.createElement(y.a,{divider:!0}),i.a.createElement(y.a,{href:"/cyberchef/index.html"},"Cyber Chef"),i.a.createElement(y.a,{divider:!0}),i.a.createElement(y.a,{href:"/#/",onClick:this.LogOut},"Log Out")),i.a.createElement(p.a,{href:"/incident_handler.html"},t)),i.a.createElement("span",{id:"ouo_warning",className:"ouo-warning"},this.state.sensitivity),i.a.createElement("span",{id:"scot_version",style:{float:"right",marginTop:"3px",padding:"10px 10px",position:"relative",color:"white"},className:"scot_version"},"V3.7"),i.a.createElement(jt,{errorToggle:this.errorToggle}))),i.a.createElement("div",{className:"mainNavPadding"},i.a.createElement(Ht,{csrf:this.state.csrf,modalActive:this.state.login,loginToggle:this.loginToggle,WhoAmIQuery:this.WhoAmIQuery,GetHandler:this.GetHandler,errorToggle:this.errorToggle,origurl:this.state.origurl}),i.a.createElement(or.a,{ref:"notificationSystem"}),i.a.createElement(Wt.d,{exact:!0,path:"/",render:e=>i.a.createElement(Tt,{loggedIn:!this.state.login,sensitivity:this.state.sensitivity,errorToggle:this.errorToggle,clientId:this.state.clientId,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object})}),"admin"===e?i.a.createElement(Wt.d,{exact:!0,path:"/admin"},i.a.createElement(En,null)):null,"alert"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"alertgroup"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"entry"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"event"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"incident"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"task"===e?i.a.createElement(Ar,{isTask:!0,queryType:this.props.match.params.type,viewMode:this.state.viewMode,type:this.props.match.params.value,id:this.props.match.params.id,id2:this.props.match.params.id2,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"guide"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"intel"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"signature"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"entity"===e?i.a.createElement(Ar,{id:this.props.match.params.id,id2:this.props.match.params.id2,viewMode:this.state.viewMode,type:e,notificationToggle:this.notificationToggle,notificationSetting:this.state.notificationSetting,listViewFilter:this.state.listViewFilter,listViewSort:this.state.listViewSort,listViewPage:this.state.listViewPage,errorToggle:this.errorToggle,history:this.props.history,createCallback:this.AMQ.create_callback_object,removeCallback:this.AMQ.remove_callback_object}):null,"reports"===e&&!this.props.match.params.id&&i.a.createElement(it,null),"reports"===e&&this.props.match.params.id&&i.a.createElement(rt,{reportType:this.props.match.params.id}),"wall"===e?i.a.createElement(It,{errorToggle:this.errorToggle}):null))},this.state={open:!1,notificationSetting:"on",login:!1,csrf:"",origurl:"",sensitivity:"",whoami:void 0,handler:void 0,eestring:"",clientId:null},this.notification=this.notification.bind(this),this.loginToggle=this.loginToggle.bind(this),this.errorToggle=this.errorToggle.bind(this),this.AMQ=new wn}}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Tn=a(444),kn=a(132),xn=a(443);let Cn=a(56).createBrowserHistory;n.a.render(i.a.createElement(xn.a,{history:Cn()},i.a.createElement(rs.a,null,i.a.createElement(Tn.a,null,i.a.createElement(kn.a,{exact:!0,path:"/",component:Sn}),i.a.createElement(kn.a,{exact:!0,path:"/:value",component:Sn}),i.a.createElement(kn.a,{exact:!0,path:"/:value/:id",component:Sn}),i.a.createElement(kn.a,{exact:!0,path:"/:value/:id/:id2",component:Sn}),i.a.createElement(kn.a,{path:"/:value/:type/:id/:id2",component:Sn})))),document.getElementById("root"))}},[[525,1,2]]]);
//# sourceMappingURL=main.6d5cd80e.chunk.js.map