(this.webpackJsonpscotui=this.webpackJsonpscotui||[]).push([[0],{1040:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(22),o=a.n(i),s=a(3),l=a(5),c=a(6),d=a(7),p=a(170),u=a.n(p),h=a(323),m=a.n(h),g=a(168),y=a.n(g),f=a(335),v=a.n(f),b=a(33),E=a.n(b),k=a(85),w=a(20),S=a(41),T=a(45),C=a(8),x=a(1098),j=a(1130),O=a(1099),D=a(1100),N=a(1101),_=a(1),A=a.n(_),M=a(483),L=a(325),P={key:A.a.string.isRequired,default:A.a.any.isRequired},F={getUserConfig:A.a.func,setUserConfig:A.a.func},I=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={userConfig:{loading:!0}},n.update=n.update.bind(Object(l.a)(n)),n.setUserConfig=n.setUserConfig.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"getChildContext",value:function(){return{getUserConfig:this.getUserConfig,setUserConfig:this.setUserConfig}}},{key:"getUserConfig",value:function(){return new Promise((function(e,t){var a=localStorage["userConfig"];e(a?JSON.parse(a):{})}))}},{key:"setUserConfig",value:function(e){var t=this;return new Promise((function(t,a){var n,r;n="userConfig",r=JSON.stringify(e),localStorage.setItem(n,r),t()})).then((function(){t.update()}))}},{key:"update",value:function(){var e=this;this.getUserConfig().then((function(t){e.setState({userConfig:t})}))}},{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){return r.a.createElement(L.a,{value:this.state.userConfig,channel:"userConfig"},r.a.createElement("div",null,this.props.children))}}]),a}(n.PureComponent);I.childContextTypes=F;A.a.shape({config:A.a.any.isRequired,setUserConfig:A.a.func.isRequired,getUserConfig:A.a.func.isRequired,loading:A.a.bool}).isRequired;var R=a(326),U=a.n(R),W=a(1086),H=a(486),B=a(1125),V=function(e,t){return r.a.createElement("div",{style:{position:"relative"}},e,r.a.createElement("span",{className:"panel-button right"},r.a.createElement(H.a,{onClick:t,bsSize:"small"},r.a.createElement("i",{className:"fa fa-close"}))))},z=function(e){var t=e.children,a=e.onRemove,n=e.editable,i=e.title;return r.a.createElement("div",{className:"widget ".concat(n&&"editable")},!n&&t,n&&r.a.createElement(B.a,{header:V(i,a)},r.a.cloneElement(t,{editMode:n})))},q=a(1126),K=function(e){var t=e.widgets,a=e.layout,n=e.isOpen,i=e.onClose,o=e.onSelect,s=new Set;a.rows.forEach((function(e){e.columns.forEach((function(e){e.widgets.forEach((function(e){s.add(e.key)}))}))}));var l=Object.keys(t).filter((function(e){return!s.has(e)})).map((function(e,a){var n=t[e];return r.a.createElement("div",{key:a,className:"picker-item",onClick:function(){o(e)}},r.a.createElement("h3",null,n.title),r.a.createElement("p",null,n.description))}));return l.length||(l=r.a.createElement("h2",null,"No available widgets")),r.a.createElement(q.a,{show:n,onHide:i,className:"WidgetPicker"},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Pick a Widget")),r.a.createElement(q.a.Body,{className:"picker-grid"},l),r.a.createElement(q.a.Footer,null,r.a.createElement(H.a,{onClick:i},"Cancel")))},G={rows:[{columns:[{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]}]}]},J=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={editable:null!=e.saveDashboard,editMode:e.isNew,layout:e.layout,title:e.title,widgetPicker:!1,newWidgetOptions:{}},n.onAdd=n.onAdd.bind(Object(l.a)(n)),n.updateLayout=n.updateLayout.bind(Object(l.a)(n)),n.updateTitle=n.updateTitle.bind(Object(l.a)(n)),n.reset=n.reset.bind(Object(l.a)(n)),n.saveDashboard=n.saveDashboard.bind(Object(l.a)(n)),n.toggleEdit=n.toggleEdit.bind(Object(l.a)(n)),n.togglePicker=n.togglePicker.bind(Object(l.a)(n)),n.selectWidget=n.selectWidget.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"onAdd",value:function(e,t,a){this.setState({widgetPicker:!0,newWidgetOptions:{row:t,col:a}})}},{key:"updateLayout",value:function(e){this.setState({layout:e})}},{key:"updateTitle",value:function(e){this.setState({title:e.target.value})}},{key:"toggleEdit",value:function(){this.setState({editMode:!this.state.editMode})}},{key:"saveDashboard",value:function(){this.state.title?(this.props.saveDashboard(this.state.title,this.state.layout),this.toggleEdit()):this.props.errorToggle("Please enter a dashboard title")}},{key:"reset",value:function(){this.setState({layout:this.props.layout,title:this.props.title,editMode:!1,widgetPicker:!1,newWidgetOptions:{}})}},{key:"togglePicker",value:function(){this.setState({widgetPicker:!this.state.widgetPicker})}},{key:"selectWidget",value:function(e){var t=this.state.newWidgetOptions,a=t.row,n=t.col;this.updateLayout(Object(R.addWidget)(this.state.layout,a,n,e)),this.togglePicker()}},{key:"render",value:function(){return r.a.createElement("div",{className:"dashboard"},r.a.createElement(K,{widgets:this.props.widgets,layout:this.state.layout,isOpen:this.state.widgetPicker,onClose:this.togglePicker,onSelect:this.selectWidget}),r.a.createElement(Y,{title:this.state.title,editable:this.state.editable,editMode:this.state.editMode,onEdit:this.toggleEdit,onSave:this.saveDashboard,onCancel:this.reset,handleTitleChange:this.updateTitle,isNew:this.props.isNew}),r.a.createElement(W.a,{fluid:!0},r.a.createElement(U.a,{onRemove:this.updateLayout,onMove:this.updateLayout,onAdd:this.onAdd,editable:this.state.editMode,layout:this.state.layout,widgets:this.props.widgets,frameComponent:z})))}}]),a}(n.PureComponent);J.defaultProps={title:"",layout:G,isNew:!1};var Y=function(e){var t=e.title,a=e.editMode,n=e.onEdit,i=e.onSave,o=e.onCancel,s=e.handleTitleChange,l=e.isNew;return e.editable?r.a.createElement("div",{className:"titleBar clearfix"},a&&r.a.createElement("form",{onSubmit:i},r.a.createElement("input",{type:"text",className:"title",value:t,placeholder:"Dashboard Title",onChange:s}),r.a.createElement(H.a,{bsStyle:"primary",bsSize:"small",onClick:i},"Save"),r.a.createElement(H.a,{bsStyle:"warning",bsSize:"small",disabled:l,onClick:o},"Cancel")),!a&&r.a.createElement("div",{className:"edit"},r.a.createElement(H.a,{bsSize:"xsmall",onClick:n},r.a.createElement("i",{className:"fa fa-edit"})))):null},Q=a(2),X=a.n(Q),$=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={statusData:{},error:null},n.updateData=n.updateData.bind(Object(l.a)(n)),n.fetchError=n.fetchError.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){X.a.ajax({type:"get",url:"scot/api/v2/status",success:this.updateData,error:this.fetchError}),this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"updateData",value:function(e){this._isMounted&&this.setState({statusData:e})}},{key:"fetchError",value:function(e){this._isMounted&&this.setState({error:e})}},{key:"render",value:function(){var e=this.props.className,t=void 0===e?"":e,a=[];if(Array.isArray(this.state.statusData)){var n,i=Object(w.a)(this.state.statusData);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=o.name,l=o.status;l||(l="unknown"),a.push(r.a.createElement(Z,{key:s,name:s,status:l}))}}catch(d){i.e(d)}finally{i.f()}}var c=["Status",t];return a.length>4&&c.push("cols-2"),r.a.createElement("div",{className:c.join(" ")},this.state.error&&r.a.createElement(B.a,{bsStyle:"danger",header:"Error"},this.state.error),a)}}]),a}(n.PureComponent),Z=function(e){var t=e.name,a=e.status;return r.a.createElement("div",{className:"service status-".concat(a),title:"Status: ".concat(a)},t)},ee=$,te=a(1087),ae=a(1088),ne=function(e){return r.a.createElement("span",{className:"emoji",role:"img","aria-label":e.label?e.label:"","aria-hidden":e.label?"false":"true"},e.symbol)},re=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},ie=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateCategory=function(){var e=(n.state.categoryIndex+1)%n.state.gameCategories.length;n._isMounted&&n.setState({categoryIndex:e})},n.updateData=function(e){var t=[];for(var a in e)null!==a&&(console.log("".concat(re(a))),t.push(r.a.createElement(oe,{category:a,data:e[a]})));n._isMounted&&n.setState({gameData:e,gameCategories:t})},n.fetchError=function(e){n._isMounted&&n.setState({error:e})},n.state={gameData:[],gameCategories:[],categoryIndex:0,error:null},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this._isMounted=!0,X.a.ajax({type:"get",url:"/scot/api/v2/game",success:this.updateData,error:this.fetchError}),this.categoryInterval=setInterval(this.updateCategory,5e3)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.categoryInterval&&clearInterval(this.categoryInterval),this._isMounted=!1}},{key:"render",value:function(){return r.a.createElement(te.a,{className:"Gamification"},r.a.createElement("h3",null,"Leaders"),this.state.error&&r.a.createElement(B.a,{bsStyle:"danger",header:"Error"},this.state.error),this.state.gameCategories[this.state.categoryIndex])}}]),a}(n.PureComponent),oe=function(e){var t=e.category,a=e.data;return r.a.createElement(B.a,{className:"category"},r.a.createElement(B.a.Title,null,r.a.createElement("b",null,"".concat(re(t)," - ").concat(a[0].tooltip))),r.a.createElement(B.a.Body,null,r.a.createElement("div",null,""!==a[0].username&&null!==a[0].username&&null!=a[0].count&&""!==a[0].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd47"})," ",a[0].username," ",r.a.createElement(ae.a,null,a[0].count)):null,""!==a[1].username&&null!=a[1].username&&null!=a[1].count&&""!==a[1].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd48"})," ",a[1].username," ",r.a.createElement(ae.a,null,a[1].count)):null,""!==a[2].username&&null!=a[2].username&&null!=a[2].count&&""!==a[2].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd49"})," ",a[2].username," ",r.a.createElement(ae.a,null,a[2].count)):null)))},se=ie,le=function(e,t){localStorage.setItem(e,t)},ce=function(e){return localStorage[e]},de=function(e){return localStorage[e]},pe=a(1089);var ue=a(127),he=a.n(ue),me=a(321),ge=Object(me.extendMoment)(he.a),ye=864e5,fe=function(e,t){return!e||Date.now()-e>1e3*t},ve=function(){return{start:Math.floor(new Date(Date.now()-ye).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+ye).setHours(23,59,59,999)/1e3)}},be=function(){return{start:Math.floor(new Date(Date.now()-7*ye).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+ye).setHours(23,59,59,999)/1e3)}},Ee=function(e){return[e.start,e.end]},ke=function(e){return e.start+", "+e.end},we={wall:"warning",create:"info",delete:"danger"},Se=["create","delete"],Te={create:120,delete:60,wall:3600},Ce=0,xe=1,je=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={users:[],notifications:n.loadWall()},n.updateActivity=n.updateActivity.bind(Object(l.a)(n)),n.updateUsers=n.updateUsers.bind(Object(l.a)(n)),n.wallMessage=n.wallMessage.bind(Object(l.a)(n)),n.notification=n.notification.bind(Object(l.a)(n)),n.fetchError=n.fetchError.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.refreshTimer=setInterval(this.updateActivity,3e4),this.updateActivity(),this.props.createCallback("wall",this.wallMessage)}},{key:"componentWillUnmount",value:function(){this.refreshTimer&&clearInterval(this.refreshTimer)}},{key:"updateActivity",value:function(){this.updateUsers();var e=this.state.notifications.filter((function(e){return!fe(1e3*e.time,Te[e.action])}));this.setState({notifications:e},this.persistWall)}},{key:"updateUsers",value:function(){var e=this;X.a.ajax({type:"get",url:"/scot/api/v2/who",success:function(t){e.setState({users:t.records.map((function(e){return{type:Ce,who:e.username,time:(t=e.last_activity,(Date.now()-1e3*t)/1e3)};var t}))})},error:this.fetchError})}},{key:"persistWall",value:function(){var e=this.state.notifications.filter((function(e){return"wall"===e.action}));le("walls",JSON.stringify(e))}},{key:"loadWall",value:function(){var e=ce("walls");return e?JSON.parse(e):[]}},{key:"wallMessage",value:function(e){var t=this.state.notifications;t.push({type:xe,time:e.activemqwhen,who:e.activemqwho,message:e.activemqmessage,level:we.wall,action:"wall"}),this.setState({notifications:t},this.persistWall)}},{key:"notification",value:function(e){if(!["scot-flair","scot-alerts","scot-admin","","api"].includes(e.activemqwho)&&!0!==e.activemqwall&&"entity"!==e.activemqtype&&["create","delete"].includes(e.activemqstate)){var t=this.state.notifications;t.push({type:xe,time:Date.now()/1e3,who:e.activemqwho,message:e.activemqmessage+e.activemqid,level:we[e.activemqstate],action:e.activemqstate}),this.setState({notifications:t})}}},{key:"addDebugItems",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this.state.notifications,a=0;a<e;a++)t.push({type:xe,time:Date.now()/1e3,who:"fred",message:"blah",level:we.create,action:"create"});this.setState({notifications:t})}},{key:"fetchError",value:function(e){}},{key:"buildActivityItem",value:function(e,t){var a,n=function(e){var t=Math.floor(e/31536e3);return t>1?t+" years":(t=Math.floor(e/2592e3))>1?t+" months":(t=Math.floor(e/86400))>1?t+" days":(t=Math.floor(e/3600))>1?t+" hours":(t=Math.floor(e/60))>1?t+" minutes":Math.floor(e)+" seconds"}((a=e.time,(Date.now()-1e3*a)/1e3)),i="";switch(e.type){default:case Ce:i=e.who;break;case xe:i="".concat(e.who,": ").concat(e.message)}return r.a.createElement(Oe,{key:t,badge:n,style:e.level},i)}},{key:"render",value:function(){var e=this,t=this.props.className,a=["Activity",void 0===t?"":t],n=this.state.users.concat(this.state.notifications).sort((function(e,t){return t.time-e.time})).map(this.buildActivityItem),i=!0;if(this.marquee&&this.well){var s=window.getComputedStyle(this.marquee);parseInt(s.width,10)-parseInt(s.paddingLeft,10)>this.well.offsetWidth&&(i=!1)}return r.a.createElement(te.a,{bsSize:"small",className:a.join(" "),ref:function(t){return e.well=o.a.findDOMNode(t)}},r.a.createElement("div",{className:"marquee ".concat(i?"stopped":""),ref:function(t){return e.marquee=t}},n))}}]),a}(n.Component),Oe=function(e){var t=e.children,a=e.badge,n=void 0===a?null:a,i=e.style,o=void 0===i?"default":i;return r.a.createElement("div",{className:"activity-item"},r.a.createElement(pe.a,{bsStyle:o},t,null!==n&&r.a.createElement(ae.a,null,n)))},De=je,Ne=a(40),_e=a(27),Ae=a(35),Me=a.n(Ae),Le=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getData=function(){var e="/scot/api/v2/graph/dhheatmap?collection="+n.state.collection+"&type="+n.state.type+"&year="+n.state.year;Me.a.get(e).then((function(e){n.setState({data:e.data})}))},n.loadHeatMap=function(){if(!n.props.editMode){var e=30,t=30,a=1e3-(t-0),r=300-(e-30),i=Math.floor(a/24),o=1.5*i,s=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],l=_e.n("#report_heatmap"),c=l.select("g");c.empty()&&(c=l.append("g").attr("transform","translate( "+t+", "+e+" )")),c.selectAll(".dayLabel").data(["Mo","Tu","We","Th","Fr","Sa","Su"]).enter().append("text").text((function(e){return e})).attr("x",0).attr("y",(function(e,t){return t*i})).style("text-anchor","end").attr("transform","translate( -6, "+i/1.5+" )").attr("class",(function(e,t){return t>=0&&t<=4?"dayLabel axis axis-worktime":"dayLabel axis"})),c.selectAll(".timeLabel").data(["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"]).enter().append("text").text((function(e){return e})).attr("x",(function(e,t){return t*i})).attr("y",0).style("text-anchor","middle").attr("transform","translate( "+i/2+", -6 )").attr("class",(function(e,t){return t>=7&&t<=16?"timeLabel axis axis-worktime":"timeLabel axis"})),l.selectAll(".legend").remove(),l.selectAll(".legend-text").remove();var d=_e.k().domain([0,8,_e.g(n.state.data,(function(e){return e.value}))]).range(s),p=c.selectAll(".hour").data(n.state.data,(function(e){return e.day+":"+e.hour}));p.append("title"),p.enter().append("rect").style("fill",s[0]).merge(p).attr("x",(function(e){return(e.hour-1)*i})).attr("y",(function(e){return(e.day-1)*i})).attr("rx",4).attr("ry",4).attr("class","hour").attr("width",i).attr("height",i).transition().duration(1e3).style("fill",(function(e){return d(e.value)})),p.select("title").text((function(e){return e.value})),p.exit().remove();var u=c.selectAll(".legend").data([0].concat(d.quantiles()),(function(e){return e}));u.enter().append("rect").attr("class","legend").attr("x",(function(e,t){return o*t})).attr("y",r).attr("width",o).attr("height",i/2).style("fill",(function(e,t){return s[t]})),u.enter().append("text").text((function(e){return"\u2265 "+Math.round(e)})).attr("class","legend-text").attr("x",(function(e,t){return o*t})).attr("y",r+i)}},n.collectionChange=function(e){n.setState({collection:e.target.value})},n.yearChange=function(e){n.setState({year:e.target.value})},n.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_heatmap")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},n.state={collection:"event",type:"created",year:"2017",data:[]},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.getData(),this.loadHeatMap()}},{key:"componentDidUpdate",value:function(){this.loadHeatMap()}},{key:"render",value:function(){var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Day of Week, Hour of Day Heatmap"),r.a.createElement("label",{htmlFor:"year",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Year = ",r.a.createElement("span",{id:"year-value"}),r.a.createElement("input",{className:"report_input",type:"number",min:"2013",step:"1",value:this.state.year,id:"year",onChange:this.yearChange,disabled:e})),r.a.createElement("label",{htmlFor:"collection",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Collection = ",r.a.createElement("span",{id:"year-value"}),r.a.createElement("select",{id:"collection",value:this.state.collection,onChange:this.collectionChange,disabled:e},r.a.createElement("option",{value:"event"},"event"),r.a.createElement("option",{value:"alert"},"alert"),r.a.createElement("option",{value:"incident"},"incident"))),r.a.createElement(H.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_heatmap",viewBox:"0 0 1000 380"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),a}(n.PureComponent);function Pe(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var r=this,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];clearTimeout(t),t=setTimeout((function(){t=null,n||e.apply(r,o)}),a),n&&!t&&e.apply(this,[].concat(o))}}var Fe=function(e){var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60)+"s";return n&&(r=n+"m "+r),a&&(r=a+"h "+r),t&&(r=t+"d "+r),r},Ie=20,Re=60,Ue=50,We=1e3-Ue-20,He=500-Ie-Re,Be={All:"#3b35a6",Promoted:"#eebd31",Incident:"#e63041"},Ve=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).initChart=function(){n.svg=_e.n("#report_art").append("g").attr("transform","translate( "+Ue+","+Ie+" )"),n.xAxisEl=n.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(He," )")),n.yAxisEl=n.svg.append("g").attr("class","y axis"),n.yAxisEl.append("text").attr("transform","rotate(-90)").attr("x",0-He/2).attr("y",0).attr("dy","1em").style("text-anchor","start").style("fill","black").text("Response Time"),n.chartInit=!0},n.updateChart=function(){var e=new Set;n.state.chartData.dates.forEach((function(t){t.values.forEach((function(t){e.add(t.name)}))}));var t=new Set;n.state.chartData.lines.forEach((function(e){t.add(e.name)}));var a=_e.g(n.state.chartData.dates,(function(e){return _e.g(e.values,(function(e){return e.value}))})),r=_e.h().padding(.1).rangeRound([0,We]).domain(n.state.chartData.dates.map((function(e){return e.date}))),i=_e.h().domain(Array.from(e)).rangeRound([0,r.bandwidth()]),o=_e.i().clamp(!0).range([He,0]).domain([0,a]).nice(),s=_e.a().scale(r),l=_e.b().scale(o).ticks(20).tickFormat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=e[0],n=e[e.length-1],r=_e.o(a,n,t);return function(e){var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),i=Math.floor(e%60);return t?r<86400?"".concat(t,"d ").concat(a,"h"):t+"d":a?r<3600?"".concat(a,"h ").concat(n,"m"):a+"h":n?r<60?"".concat(n,"m ").concat(i,"s"):n+"m":i+"s"}}(o.domain(),20));n.xAxisEl.transition().call(s),n.yAxisEl.transition().call(l);var c=n.svg.selectAll(".date").data(n.state.chartData.dates,(function(e){return e.date}));c.exit().transition().style("opacity",0).attr("height",0).attr("y",He).remove(),c.enter().append("g").attr("class","date").attr("transform",(function(e){return"translate( ".concat(r(e.date),", 0 )")})).selectAll(".bar").data((function(e){return e.values})).enter().append("rect").attr("class","bar").style("fill",(function(e){return Be[e.name]})).attr("width",i.bandwidth()).attr("x",(function(e){return i(e.name)})).attr("y",He).attr("height",0).append("title").text((function(e){return Fe(e.value)})),c.transition().attr("transform",(function(e){return"translate( ".concat(r(e.date),", 0 )")})),n.svg.selectAll(".date").selectAll(".bar").transition().attr("width",i.bandwidth()).attr("x",(function(e){return i(e.name)})).attr("y",(function(e){return o(e.value)})).attr("height",(function(e){return He-o(e.value)})),n.svg.select(".avg-holder").remove(),n.svg.select(".avg-holder-border").remove();var d=n.svg.append("g").attr("class","avg-holder"),p=d.selectAll(".avg").data(n.state.chartData.lines).enter().append("text").attr("class","avg").attr("transform",(function(e,t){return"translate( 0, ".concat(15*t," )")}));p.append("tspan").attr("x",0).attr("font-weight","bold").text((function(e){return"".concat(e.name,":")})),p.append("tspan").attr("x",100).text((function(e){return Fe(e.value)}));var u=d.node().getBBox();d.attr("transform","translate( ".concat(We-u.width,", 0 )"));n.svg.append("rect").attr("fill","none").attr("stroke","black").attr("class","avg-holder-border").attr("x",u.x-2).attr("y",u.y-2).attr("width",u.width+4).attr("height",u.height+4).node().transform.baseVal.initialize(d.node().transform.baseVal.getItem(0));n.svg.select(".legend-holder").remove();var h=n.svg.append("g").attr("class","legend-holder"),m=h.selectAll(".legend").data(Array.from(e)).enter().append("g").attr("class","legend");m.append("rect").attr("width",20).attr("x",0).attr("y",0).attr("height",20).style("fill",(function(e){return Be[e]})),m.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").text((function(e){return e}));var g=0;h.selectAll(".legend").attr("transform",(function(e,t){var a=g;return g+=this.getBBox().width+15,"translate( ".concat(a,", 0 )")}));var y=h.node().getBBox().width;h.attr("transform","translate( ".concat(We/2-y/2,", ").concat(He+Re/2," )"))},n.loadArt=function(){if(n.state.date&&n.state.length&&!n.props.editMode){var e="?days=".concat(n.state.length,"&targetdate=").concat(n.state.date,"&unit=").concat(n.state.unit);Me.a.get("/scot/api/v2/metric/response_avg_last_x_days"+e).then((function(e){n.setState({chartData:e.data})}))}},n.unitChange=function(e){n.setState({unit:e.target.value},(function(){return n.loadArt()}))},n.lengthChange=function(e){n.setState({length:e.target.value},(function(){return n.loadArt()}))},n.dateChange=function(e){n.setState({date:e.target.value},(function(){return n.loadArt()}))},n.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_art")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o};var r=(new Date).toISOString().slice(0,10);return n.state={length:7,date:r,unit:"day",chartData:{dates:[],lines:[]}},n.loadArt=Pe(n.loadArt),n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.initChart(),this.loadArt()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Alert Response Time"),r.a.createElement("label",{htmlFor:"date",style:{display:"inline-block",textAlign:"right"}},"Initial Date =\xa0",r.a.createElement("input",{className:"report_input",type:"date",value:this.state.date,onChange:this.dateChange,placeholder:"yyyy-mm-dd",pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}",disabled:e})),r.a.createElement("label",{htmlFor:"length",style:{display:"inline-block",textAlign:"right"}},"Length =\xa0",r.a.createElement("input",{className:"report_name",type:"number",min:"1",step:"1",value:this.state.length,id:"length",onChange:this.lengthChange,disabled:e})),r.a.createElement("label",{htmlFor:"unit",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Unit =\xa0",r.a.createElement("select",{id:"unit",value:this.state.unit,onChange:this.unitChange,disabled:!0},r.a.createElement("option",{value:"hour"},"hourly"),r.a.createElement("option",{value:"day"},"daily"),r.a.createElement("option",{value:"month"},"monthly"),r.a.createElement("option",{value:"year"},"yearly"))),r.a.createElement(H.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_art",viewBox:"0 0 1000 500"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),a}(n.PureComponent),ze=function(e,t){e.each((function(e,a){if(!(this.getComputedTextLength()<t)){for(var n=_e.n(this),r=n.text().split(/\s+/).reverse(),i=null,o=[],s=1,l=n.attr("x"),c=n.attr("y"),d=parseFloat(n.attr("dy")),p=n.text(null).append("tspan").attr("x",l).attr("y",c).attr("dy",d+"em");i=r.pop();)o.push(i),p.text(o.join(" ")),p.node().getComputedTextLength()>t&&(s++,o.pop(),p.text(o.join(" ")),o=[i],p=n.append("tspan").attr("x",l).attr("y",c).attr("dy",.8+d+"em").text(i));var u=this.getBBox().height/(2*s)*(s-1);n.attr("transform","translate( 0, -".concat(u," )"))}}))},qe=5,Ke=200,Ge=60,Je=1e3-Ke-30,Ye=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).initChart=function(){n.height=0,n.xScale=_e.i().rangeRound([0,Je]),n.yScale=_e.h().rangeRound([0,n.height]).padding(.3),n.colors=_e.j(_e.m),n.xAxis=_e.a().scale(n.xScale),n.yAxis=_e.b().scale(n.yScale),n.svg=_e.n("#report_alertpower").attr("viewBox","0 0 1000 ".concat(n.height+qe+Ge)).append("g").attr("transform","translate( ".concat(Ke,", ").concat(qe," )")),n.yAxisEl=n.svg.append("g").attr("class","y axis"),n.xAxisEl=n.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(n.height," )")),n.xAxisEl.append("text").attr("text-anchor","middle").attr("x",Je/2).attr("y",30).style("fill","black").style("font-size","12px").text("Alert Count"),n.LegendHolder=n.svg.append("g").attr("class","legend-holder"),n.chartInit=!0},n.updateChart=function(){var e=n.state.chartData;n.height=32*e.length,_e.n("#report_alertpower").transition().attr("viewBox","0 0 1000 ".concat(n.height+qe+Ge)),n.dataTypes=_e.e(e[0]).filter((function(e){return!["name","values","total","score","max"].includes(e)})),n.colors.domain(n.dataTypes),e.forEach((function(e){e.name=e.name.replace(/ \([0-9]+\)/,""),"number"===typeof e.score&&(e.score=""+e.score);var t=0;e.values=n.dataTypes.map((function(a){var n=t,r=t+e[a];return t+=e[a],{name:a,count:e[a],start:n,end:r}})),e.total=e.values[e.values.length-1].end,e.max=_e.g(n.dataTypes,(function(t){return e[t]}))})),n.stackedMax=_e.g(e,(function(e){return e.total})),n.groupedMax=_e.g(e,(function(e){return _e.g(n.dataTypes,(function(t){return e[t]}))})),n.yScale.rangeRound([0,n.height]).domain(e.map((function(e){return e.name}))),n.yAxisEl.call(n.yAxis),n.svg.selectAll(".y.axis .tick text").call(ze,Ke-20);var t=n.svg.selectAll(".alert").data(e,(function(e){return e.name}));t.exit().transition().attr("height",0).style("opacity",0).remove(),t.enter().append("g").attr("class","alert").attr("transform",(function(e){return"translate( 1, ".concat(n.yScale(e.name)," )")})).append("text").attr("dy","1.2em"),t.transition().attr("transform",(function(e){return"translate( 1, ".concat(n.yScale(e.name)," )")}));var a=n.svg.selectAll(".alert").selectAll("rect").data((function(e){return e.values})),r=a.enter().append("rect").attr("x",0).attr("y",0).attr("width",0).attr("height",n.yScale.bandwidth());r.merge(a).style("fill",(function(e){return n.colors(e.name)})),r.append("title").merge(a.select("title")).text((function(e){return"".concat(e.name,": ").concat(e.count)}));var i=n.LegendHolder.selectAll(".legend").data(n.dataTypes);i.exit().remove(),(i=i.enter().append("g").attr("class","legend")).append("rect").attr("width",20).attr("x",0).attr("y",0).attr("height",20).style("fill",(function(e){return n.colors(e)})),i.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text((function(e){return e}));var o=0;n.LegendHolder.selectAll(".legend").attr("transform",(function(e,t){var a=o;return o+=this.getBBox().width+15,"translate( ".concat(a,", 0 )")}));var s=n.LegendHolder.node().getBBox().width;n.LegendHolder.transition().attr("transform","translate( ".concat(Je/2-s/2,", ").concat(n.height+Ge-20," )")),"grouped"===n.state.displayMode?n.transitionGrouped():n.transitionStacked()},n.transitionStacked=function(){n.xScale.domain([0,n.stackedMax]).nice(),n.xAxisEl.transition().call(n.xAxis).attr("transform","translate( 0, ".concat(n.height," )")),n.svg.selectAll(".alert rect").transition().delay((function(e,t){return 5*t})).duration(500).attr("width",(function(e){return n.xScale(e.end)-n.xScale(e.start)})).attr("x",(function(e){return n.xScale(e.start)})).transition().attr("height",n.yScale.bandwidth()).attr("y",0),n.svg.selectAll(".alert text").transition().delay((function(e,t){return t*n.dataTypes.length*5+t})).duration(500).attr("transform",(function(e){return"translate( ".concat(n.xScale(e.total)+10,", 0 )")})).tween("text",(function(e){var t=_e.n(this),a=_e.d(t.text(),e.score),n=e.score.split("."),r=n.length>1?Math.pow(10,n[0].length):1;return function(e){return t.text(Math.round(a(e)*r)/r)}}))},n.transitionGrouped=function(){n.xScale.domain([0,n.groupedMax]).nice(),n.xAxisEl.transition().call(n.xAxis).attr("transform","translate( 0, ".concat(n.height," )"));var e=n.displayModeChanged?500:0;n.svg.selectAll(".alert").selectAll("rect").transition().delay((function(e,t){return 5*t})).duration(e).attr("height",n.yScale.bandwidth()/n.dataTypes.length).attr("y",(function(e,t){return n.yScale.bandwidth()/n.dataTypes.length*t})).transition().duration(500).attr("x",0).attr("width",(function(e){return n.xScale(e.end)-n.xScale(e.start)})),n.svg.selectAll(".alert text").transition().delay((function(t,a){return 5*a+e})).attr("transform",(function(e){return"translate( ".concat(n.xScale(e.max)+10,", 0 )")})).tween("text",(function(e){var t=_e.n(this),a=_e.d(t.text(),e.score),n=e.score.split("."),r=n.length>1?Math.pow(10,n[0].length):1;return function(e){return t.text(Math.round(a(e)*r)/r)}})),n.displayModeChanged=!1},n.loadData=function(){if(n.state.chartResults&&!n.props.editMode){var e="?sort=".concat(n.state.chartSort,"&dir=").concat(n.state.chartSortDir,"&count=").concat(n.state.chartResults,"&filter=").concat(encodeURIComponent(n.state.chartFilter));Me.a.get("/scot/api/v2/metric/alert_power"+e).then((function(e){n.setState({chartData:e.data})}))}},n.dataChange=function(e){var t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),n.setState({[t.name]:t.value},n.loadData)},n.displayModeChang=function(e){n.displayModeChanged=!0,n.setState({displayMode:e.target.value})},n.preventSubmit=function(e){e.preventDefault(),e.stopPropagation()},n.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_alertpower")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},n.state={displayMode:"stacked",chartData:[],chartResults:20,chartSort:"power",chartSortDir:"desc",chartFilter:""},n.loadData=Pe(n.loadData),n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.initChart(),this.updateChart(),this.loadData()}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Alert Power"),r.a.createElement("form",{onSubmit:this.preventSubmit},r.a.createElement("label",null,"Filter =\xa0",r.a.createElement("input",{className:"report_input",type:"text",style:{background:"initial",border:"1px solid #ccc"},name:"chartFilter",value:this.state.chartFilter,onChange:this.dataChange,placeholder:"All",disabled:e}))),r.a.createElement("form",{onSubmit:this.preventSubmit},r.a.createElement("label",null,"Sort by =\xa0",r.a.createElement("select",{name:"chartSort",value:this.state.chartSort,onChange:this.dataChange,disabled:e},r.a.createElement("option",{value:"power"},"Power Score"),r.a.createElement("option",{value:"count"},"Alert Count"),r.a.createElement("option",{value:"promoted"},"Promoted Count"),r.a.createElement("option",{value:"incident"},"Incident Count")),r.a.createElement("select",{name:"chartSortDir",value:this.state.chartSortDir,onChange:this.dataChange,disabled:e},r.a.createElement("option",{value:"desc"},"Desc"),r.a.createElement("option",{value:"asc"},"Asc"))),r.a.createElement("label",null,"Results =\xa0",r.a.createElement("input",{className:"report_input",type:"number",min:1,max:50,name:"chartResults",value:this.state.chartResults,onChange:this.dataChange,disabled:e}))),r.a.createElement("form",null,r.a.createElement("label",null,r.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"grouped",checked:"grouped"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Grouped"),"\xa0",r.a.createElement("label",null,r.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"stacked",checked:"stacked"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Stacked"),r.a.createElement(H.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_alertpower",viewBox:"0 0 1000 100"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),a}(n.PureComponent),Qe=5,Xe=40,$e=60,Ze=1e3-Xe-20,et=600-Qe-$e,tt=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).initChart=function(){var e=new Date;n.xScale=_e.l().rangeRound([0,Ze]).domain([e-6048e5,e]),n.yScale=_e.i().rangeRound([et,0]).domain([0,0]),n.xAxis=_e.a().scale(n.xScale),n.yAxis=_e.b().scale(n.yScale),n.svg=_e.n("#report_created").attr("viewBox","0 0 1000 ".concat(et+Qe+$e)).append("g").attr("transform","translate( ".concat(Xe,", ").concat(Qe," )")),n.yAxisEl=n.svg.append("g").attr("class","y axis"),n.yAxisEl.call(n.yAxis),n.xAxisEl=n.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(et," )")),n.xAxisEl.append("text").attr("text-anchor","middle").attr("x",Ze/2).attr("y",$e-10).style("font-size","10px").style("fill","black").text("Toggle Trendlines"),n.xAxisEl.call(n.xAxis),n.statusLine=_e.f().curve(_e.c).x((function(e){return n.xScale(new Date(1e3*e.time))})).y((function(e){return n.yScale(e.value)})),n.lineHolder=n.svg.append("g").attr("class","lines").attr("clip-path","url(#bounds)"),n.LegendHolder=n.svg.append("g").attr("class","legend-holder").style("font-family","sans-serif"),n.chartInit=!0},n.updateChart=function(){n.yScale.domain([0,Math.max(_e.g(n.state.chartData,(function(e){return e.shown&&e.data.length?_e.g(e.data,(function(e){return e.value})):0})),10)]).nice(),n.colors=_e.j(_e.m).domain(n.state.chartData.map((function(e){return e.name})));var e=n.lineHolder.selectAll(".line").data(n.state.chartData,(function(e){return e.name}));e.exit().transition().style("opacity",0).remove(),e.enter().append("path").attr("class",(function(e){return"line ".concat(e.name)})).style("stroke",(function(e){return n.colors(e.name)})).style("stroke-width",2).style("fill","none").attr("d",(function(e){return n.statusLine(e.data)})),n.LegendHolder.selectAll(".legend").remove();var t=n.LegendHolder.selectAll(".legend").data(n.state.chartData,(function(e){return e.name}));(t=t.enter().append("g").attr("class","legend").style("cursor","pointer").on("click",(function(e){var t=n.state.chartData.map((function(t){return t.name===e.name&&(t.shown=!e.shown),t}));console.log("newData = ".concat(t)),n.setState({chartData:t})}))).append("rect").attr("width",20).attr("x",0).attr("y",7.5).attr("height",5).style("fill",(function(e){return e.shown?n.colors(e.name):"transparent"})).style("stroke",(function(e){return n.colors(e.name)})).style("stroke-width",1),t.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text((function(e){return e.name})).append("title").text((function(e){return"Toggle ".concat(e.name," line")}));var a=0;n.LegendHolder.selectAll(".legend").attr("transform",(function(e,t){var n=a;return a+=this.getBBox().width+15,"translate( ".concat(n,", 0 )")}));var r=n.LegendHolder.node().getBBox().width;n.LegendHolder.attr("transform","translate( ".concat(Ze/2-r/2,", ").concat(et+$e-40," )")),n.yAxisEl.transition().call(n.yAxis),e.transition().attr("d",(function(e){return n.statusLine(e.data)})).style("stroke",(function(e){return e.shown?n.colors(e.name):"transparent"}))},n.loadData=function(){if(n.props.editMode){var e=n.genData();return e=e.map((function(e){return e.shown=n.state.chartData.reduce((function(t,a){return t&&(a.name!==e.name||a.shown)}),!0),e})),void n.setState({chartData:e})}Me.a.get("/scot/api/v2/metric/create_histo?range=7").then((function(e){try{console.log(e),e=e.data.map((function(e){return e.shown=n.state.chartData.reduce((function(t,a){return t&&(a.name!==e.name||a.shown)}),!0),e})),n.setState({chartData:e})}catch(t){console.log("Malformed data"),console.log(e),console.error(t)}}))},n.genData=function(){var e={alerts:5e3,alertgroups:500,entries:100,events:15,intel:5,incidents:5},t=new Date,a=new Date(Date.now()-6048e5),n=[];for(["alerts","alertgroups","events","incidents","entries","intel"].forEach((function(e){n.push({name:e,data:[]})}));a<=t;a=new Date(a.getTime()+216e5))n.forEach((function(t){t.data.push({time:a.getTime()/1e3,value:Math.random()*e[t.name]})}));return n},n.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_created")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},n.state={chartData:[]},n.loadData=Pe(n.loadData),n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.initChart(),this.loadData()}},{key:"dataChange",value:function(e){var t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),this.setState({[t.name]:t.value},this.loadData)}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Items Created"),r.a.createElement("form",null,r.a.createElement(H.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_created",viewBox:"0 0 1000 600"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),a}(n.Component),at=function(e){switch(e){default:case"heatmap":return Le;case"alertpower":return Ye;case"art":return Ve;case"created":return tt}},nt=function(e){switch(e){default:case"heatmap":return"Heatmap";case"alertpower":return"Alert Power";case"art":return"Alert Response Time";case"created":return"Items Created"}},rt=function(e){switch(e){default:case"heatmap":return"Heatmap of incoming alerts, event, and incidents";case"alertpower":return"Chart of alerts in terms of how frequently they're promoted or become incidents";case"art":return"Chart of average alert, event, and incident response time";case"created":return"Chart of newly created items"}},it=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.a.createElement("div",{style:{position:"relative"}},nt(e),t&&r.a.createElement(Ne.Link,{to:"/reports/".concat(e),className:"panel-button right"},r.a.createElement(H.a,{bsSize:"small"},r.a.createElement("i",{className:"fa fa-external-link","aria-hidden":!0}))),a&&r.a.createElement(Ne.Link,{to:"/reports",className:"panel-button left"},r.a.createElement(H.a,{bsSize:"small"},r.a.createElement("i",{className:"fa fa-arrow-left","aria-hidden":!0}))))},ot=function(){return r.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h2",null,"Reports")),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement(B.a,{header:it("heatmap",!0)},r.a.createElement(Le,null)),r.a.createElement(B.a,{header:it("alertpower",!0)},r.a.createElement(Ye,null))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(B.a,{header:it("art",!0)},r.a.createElement(Ve,null)),r.a.createElement(B.a,{header:it("created",!0)},r.a.createElement(tt,null)))))},st=function(e){var t=e.reportType,a=void 0===t?"heatmap":t;return r.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},r.a.createElement("div",{className:"container"},r.a.createElement(B.a,{header:it(a,!1,!0)},function(e){switch(e){default:case"heatmap":return r.a.createElement(Le,null);case"alertpower":return r.a.createElement(Ye,null);case"art":return r.a.createElement(Ve,null);case"created":return r.a.createElement(tt,null)}}(a))))},lt=a(1134),ct=a(1093),dt=a(17);var pt=Object(dt.a)((function(e){return{progress:{margin:2*e.spacing.unit}}}))((function(e){var t=e.classes,a=e.loading;return r.a.createElement("div",{className:"LoadingContainer"},a&&r.a.createElement(ct.a,{className:t.progress}))})),ut=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={data:[],loading:!1},n}return Object(C.a)(a,[{key:"fetchData",value:function(){var e=this;this.setState({loading:!0});var t=X.a.extend(!0,{},this.props.queryOptions);t.sort&&(t.sort=JSON.stringify(t.sort)),t.filter&&delete(t=Object(S.a)(Object(S.a)({},t),t.filter)).filter,this.props.newBadge&&t.columns.push("created"),X.a.ajaxSetup({traditional:!0}),X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.thingType,data:t}).then((function(t){e.setState({data:e.props.processData(t.records),loading:!1})}),(function(t){e.props.errorToggle("Failed to fetch data: "+t),e.setState({loading:!1})}))}},{key:"componentDidMount",value:function(){this.props.editMode||this.fetchData()}},{key:"genThingItem",value:function(e,t){return r.a.createElement(Ne.Link,{key:t,to:this.props.getLink(this.props.thingType,e),className:"list-group-item"},this.props.getSummary(e),this.props.newBadge&&(a=e.created,!fe(1e3*a,86400))&&r.a.createElement(pe.a,{bsStyle:"primary"},"New!"),r.a.createElement("i",{className:"fa fa-angle-right"}));var a}},{key:"render",value:function(){var e=this,t=this.state.data.map((function(t,a){return e.genThingItem(t,a)}));return this.props.editMode?t=[1,2,3,4,5].map((function(t){return r.a.createElement("div",{className:"list-group-item"},e.props.thingType," - ",t)})):0===t.length&&(t=r.a.createElement("div",{className:"list-group-item list-group-item-".concat(this.props.emptyStyle)},this.props.emptyString)),r.a.createElement("div",{className:"ThingList"},!this.props.editMode&&r.a.createElement("h1",null,this.props.title),this.state.loading?r.a.createElement(pt,{loading:!0}):r.a.createElement(lt.a,null,t))}}]),a}(n.PureComponent);ut.defaultProps={queryOptions:{limit:5,offset:0,sort:{id:-1},columns:["id","subject"]},processData:function(e){return e},getSummary:function(e){return e.subject},getLink:function(e,t){return"".concat(e,"/").concat(t.id)},emptyString:"No Data",emptyStyle:"warning",newBadge:!0};var ht,mt={intel:{type:ut,title:"Recent Intel",description:"List of the 5 most recent Intel entries",props:{thingType:"intel",title:"Recent Intel"}}},gt={events:{type:ut,title:"Recent Events",description:"List of the 5 most recent events",props:{thingType:"event",title:"Recent Events"}}},yt={incidents:{type:ut,title:"Recent Incidents",description:"List of the 5 most recent Incidents",props:{thingType:"incident",title:"Recent Incidents"}}},ft={tasks:{type:ut,title:"Open Tasks",description:"List of recent open tasks",props:{thingType:"task",title:"Open Tasks",queryOptions:{limit:5,offset:0,sort:{updated:-1},filter:{"metadata.task.status":"open"},columns:["id","body_plain","target"]},getSummary:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},getLink:function(e,t){var a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None",emptyStyle:"info"}}},vt={yourTasks:{type:ut,title:"Your Tasks",description:"List of open tasks that you own",props:{thingType:"task",title:"Your Tasks",queryOptions:{limit:5,offset:0,sort:{updated:1},filter:{"metadata.task.status":"open",owner:ce("whoami")},columns:["id","body_plain","target"]},getSummary:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},getLink:function(e,t){var a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None!",emptyStyle:"success"}}},bt={unviewedAlerts:{type:ut,title:"Unviewed Alerts",description:"Recent alerts with zero views",props:{thingType:"alertgroup",title:"Unviewed Alerts",queryOptions:{limit:5,offset:0,sort:{id:-1},filter:{created:JSON.stringify(Ee(ve())),views:0},columns:["id","subject"]},newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},Et={topEvents:{type:ut,title:"Important Events",description:"Recent Events with open tasks",props:{thingType:"event",title:"Important Events",queryOptions:{limit:5,offset:0,sort:{has_tasks:1},filter:{created:JSON.stringify(Ee(ve()))},columns:["id","subject","has_tasks"]},processData:function(e){return e.filter((function(e){return e.has_tasks}))},getSummary:function(e){return"".concat(e.subject," (").concat(e.has_tasks," open task").concat(e.has_tasks>1?"s":"",")")},newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},kt={viewedEvents:{type:ut,title:"Most Viewed Events",description:"Events with the most views over the last week",props:{thingType:"event",title:"Most Viewed Events",queryOptions:{limit:5,offset:0,sort:{views:-1},filter:{created:JSON.stringify(Ee(be()))},columns:["id","subject","views"]},processData:function(e){return e.filter((function(e){return e.views>0}))},getSummary:function(e){return"".concat(e.subject," (").concat(e.views," view").concat(e.views>1?"s":"",")")}}}},wt={entryEvents:{type:ut,title:"Events with Entries",description:"Events with the most entries over the last week",props:{thingType:"event",title:"Events with Entries",queryOptions:{limit:5,offset:0,sort:{entry_count:-1},filter:{created:JSON.stringify(Ee(be()))},columns:["id","subject","entry_count"]},processData:function(e){return e.filter((function(e){return e.entry_count>0}))},getSummary:function(e){return"".concat(e.subject," (").concat(e.entry_count," ").concat(e.entry_count>1?"entries":"entry",")")}}}},St=Object(S.a)(Object(S.a)({},Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)({},mt),gt),yt),ft),vt),bt),Et),kt),wt)),function(){for(var e={},t=0,a=["heatmap","art","alertpower","created"];t<a.length;t++){var n=a[t];e[n]={type:at(n),title:nt(n),description:rt(n)}}return e}()),Tt=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={_isMounted:!1},n.switchTab=n.switchTab.bind(Object(l.a)(n)),n.closeTab=n.closeTab.bind(Object(l.a)(n)),n.saveTab=n.saveTab.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"defaultTab",value:function(){var e=X.a.extend(!0,{},G);return e.rows[0].columns[0].widgets.push({key:"heatmap"}),e.rows[0].columns[1].widgets.push({key:"art"}),e.rows[0].columns[2].widgets.push({key:"created"}),{title:"Default",layout:r.a.createElement(J,{widgets:St,title:"Default",layout:e,errorToggle:this.props.errorToggle})}}},{key:"newTab",value:function(){var e=this.props.userConfig.config,t=Object(T.a)(e.tabs);t.push({}),this.updateDashboardConfig({curTab:t.length,tabs:t})}},{key:"buildTab",value:function(e,t){var a=this,n=r.a.createElement(J,{widgets:St,title:e.title,layout:e.layout,saveDashboard:function(e,n){a.saveTab(t,e,n)},isNew:null==e.layout,errorToggle:this.props.errorToggle});return{title:e.title,layout:n}}},{key:"saveTab",value:function(e,t,a){var n=this.props.userConfig.config,r=Object(T.a)(n.tabs),i={title:t,layout:a};r[e]=i,this.updateDashboardConfig({tabs:r})}},{key:"closeTab",value:function(e){if(!(e<1)){var t=this.props.userConfig.config,a=Object(T.a)(t.tabs);a.splice(e-1,1),this.updateDashboardConfig({curTab:e-1,tabs:a})}}},{key:"switchTab",value:function(e){e!==this.props.userConfig.config.curTab&&("new"!==e?this.updateDashboardConfig({curTab:e}):this.newTab())}},{key:"updateDashboardConfig",value:function(e){var t=this.props.userConfig.config;this.props.userConfig.setUserConfig(Object(S.a)(Object(S.a)({},t),e))}},{key:"render",value:function(){var e=this;if(!this.props.loggedIn||this.props.userConfig.loading)return r.a.createElement("div",{className:"homePageDisplay"},r.a.createElement("div",{className:"home-grid loggedOut"},r.a.createElement("div",{className:"title-area"},r.a.createElement("h1",null,"Sandia Cyber Omni Tracker",r.a.createElement("br",null),"3.5"))));var t=r.a.createElement("div",{className:"home-grid"},r.a.createElement("div",{className:"title-area"}),r.a.createElement(ee,{className:"status-area"}),r.a.createElement("div",{className:"game-area"},r.a.createElement(se,null)),r.a.createElement(De,{createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,className:"activity-area"})),a=this.props.userConfig.config,n=a.tabs,i=[];i.push(this.defaultTab());var o,s=0,l=Object(w.a)(n);try{for(l.s();!(o=l.n()).done;){var c=o.value;i.push(this.buildTab(c,s++))}}catch(u){l.e(u)}finally{l.f()}var d=i.map((function(t,n){var i=t.title,o=void 0===i?"New Dashboard":i;t.layout,Object(k.a)(t,["title","layout"]);return r.a.createElement(x.a,{eventKey:n,key:n},o,n===a.curTab&&0!==n&&r.a.createElement("span",{onClick:function(){return e.closeTab(n)}},"\xa0",r.a.createElement("i",{className:"fa fa-times",style:{cursor:"pointer"}})))}));d.push(r.a.createElement(x.a,{eventKey:"new",key:"new"},"+"));var p=i.map((function(e,t){e.title;var a=e.layout,n=Object(k.a)(e,["title","layout"]);return r.a.createElement(j.a.Pane,Object.assign({eventKey:t,key:t},n),a)}));return r.a.createElement("div",{className:"homePageDisplay"},r.a.createElement(j.a.Container,{id:"DashboardTabs",activeKey:a.curTab,onSelect:this.switchTab},r.a.createElement(O.a,null,r.a.createElement(D.a,{sm:12},r.a.createElement(N.a,{bsStyle:"tabs"},d)),r.a.createElement(D.a,{sm:12},r.a.createElement(j.a.Content,{mountOnEnter:!0,unmountOnExit:!0},t,p)))))}}]),a}(n.PureComponent),Ct=(ht={key:"dashboard",default:{curTab:0,tabs:[]}},A.a.checkPropTypes(P,ht,"argument","withUserConfig"),function(e){var t=function(t){Object(c.a)(n,t);var a=Object(d.a)(n);function n(e){var t;return Object(s.a)(this,n),(t=a.call(this,e)).state={},t.setUserSubConfig=t.setUserSubConfig.bind(Object(l.a)(t)),t}return Object(C.a)(n,[{key:"setUserSubConfig",value:function(e){var t=Object(S.a)({},this.props.userConfig);t[ht.key]=e,this.context.setUserConfig(t)}},{key:"render",value:function(){var t=this.props,a=t.userConfig,n=Object(k.a)(t,["userConfig"]),i=a[ht.key]||ht.default,o={userConfig:{loading:!0===a.loading,config:i,setUserConfig:this.setUserSubConfig,getUserConfig:this.context.getUserConfig}};return r.a.createElement(e,Object.assign({},n,o))}}]),n}(n.PureComponent);return t.contextTypes=F,t.displayName="withUserConfig(".concat(Object(M.a)(e),")"),function(e){return r.a.createElement(L.b,{channel:"userConfig"},(function(a){return r.a.createElement(t,Object.assign({userConfig:a},e))}))}})(Tt),xt=function(e){var t=jt(e);if(""!==t)return t},jt=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},Ot=function(e){document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"},Dt=function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r},Nt=a(489),_t=a.n(Nt),At=a(328),Mt=a.n(At),Lt=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){X()(document).keyup(function(e){void 0!==X()("#main-search-results")[0]&&27===e.keyCode&&(this.closeSearch(),e.preventDefault())}.bind(Object(l.a)(n)))},n.closeSearch=function(){n.setState({showSearchToolbar:!1,searchString:""})},n.doSearch=function(e){X.a.ajax({type:"get",url:"/scot/api/v2/esearch",data:{qstring:e},success:function(t){e===X()("#main-search")[0].value&&this.setState({results:t.records,showSearchToolbar:!0,searching:!1,searchString:e})}.bind(Object(l.a)(n)),error:function(){this.setState({searching:!1})}.bind(Object(l.a)(n))}),n.setState({searching:!0})},n.handleEnterKey=function(e){"Enter"===e.key&&n.doSearch(e.target.value)},n.onChange=function(e){n.doSearch(e.target.value)},n.componentDidUpdate=function(){n.state.searchString},n.render=function(){var e=[];if(void 0!==n.state.results)if(void 0!==n.state.results[0])for(var t=0;t<n.state.results.length;t++)e.push(r.a.createElement(Ft,{dataOne:n.state.results[t],key:t,index:t,searchString:n.state.searchString}));else e.push(r.a.createElement("div",{style:{display:"inline-flex"}},r.a.createElement("div",{style:{display:"flex"}},"No results returned")));return r.a.createElement("div",{className:"esearch",style:{zIndex:"100"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("input",{id:"main-search",className:"esearch-query",style:{marginTop:"3px",padding:"10px 10px",float:"right",position:"relative",color:"black"},placeholder:"\uf002 Search",charSet:"utf-8",onKeyPress:n.handleEnterKey,onChange:n.onChange}),n.state.searching?r.a.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw",style:{color:"white"}}):null),n.state.showSearchToolbar?r.a.createElement("div",{id:"main-search-results",style:{display:"flex",flexFlow:"row",position:"absolute",right:"10px",top:"53px",background:"#f3f3f3",border:"black",borderStyle:"solid"}},r.a.createElement("div",null,r.a.createElement(Pt,{closeSearch:n.closeSearch}),r.a.createElement("div",{style:{overflowY:"auto",maxHeight:"600px",display:"table-caption"}},e))):null)},n.componentWillUnmount=function(){X()(document).off("keypress")},n.state={showSearchToolbar:!1,searchResults:null,entityHeight:"60vh",searching:!1,searchString:""},n}return a}(r.a.Component),Pt=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){return r.a.createElement("div",{className:"table-row header",style:{color:"black",display:"flex"}},r.a.createElement("div",{style:{flexGrow:1,display:"flex"}},r.a.createElement("div",{style:{width:"100%",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},"Search Results - Score Displayed",r.a.createElement("i",{className:"fa fa-times pull-right",style:{color:"red",margin:"2px",cursor:"pointer"},onClick:e.props.closeSearch}))))},e}return a}(r.a.Component),Ft=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=e.props.dataOne.type,a=e.props.dataOne.id,n=e.props.dataOne.entryid,i=e.props.dataOne.score,o=[],s="even";It(e.props.index)||(s="odd");var l="search_result_row list-view-row"+s,c="/"+t+"/"+a;if(void 0!==n&&(c="/"+t+"/"+a+"/"+n),void 0!==e.props.dataOne.highlight)if("string"===typeof e.props.dataOne.highlight)o.push(r.a.createElement("span",{className:"search_snippet_container panel col"},r.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),r.a.createElement("span",{className:"search_snippet_result"},e.props.dataOne.highlight)));else if(X.a.isArray(e.props.dataOne.highlight))o.push(r.a.createElement("span",{className:"search_snippet_container panel col"},r.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),r.a.createElement("span",{className:"search_snippet_result"},e.props.dataOne.highlight[0])));else for(var d in e.props.dataOne.highlight){var p=e.props.searchString.split(" ");o.push(r.a.createElement(_t.a,{activeClassName:Mt.a.Active,highlightClassName:"search_snippet_result",className:"search_snippet_result",searchWords:p,autoEscape:!0,textToHighlight:e.props.dataOne.highlight[d][0],highlightClassName:Mt.a.Highlight,highlightStyle:{backgroundColor:"yellow"}}))}return r.a.createElement("div",{key:Date.now(),className:l},r.a.createElement(Ne.Link,{to:c,style:{display:"flex"}},r.a.createElement("span",{className:"panel panel-default",style:{display:"flex",flexFlow:"column",borderColor:"black",borderWidth:"thin",margin:"0px"}},r.a.createElement("div",{className:"panel-heading h4 search-heading"},t," ",a," - ",i),r.a.createElement("div",{className:"search-snippet",style:{display:"flex",overflowX:"hidden",wordWrap:"break-word"}},r.a.createElement("span",{className:"container-fluid",style:{textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",width:"600px"}},o)))))},e}return a}(r.a.Component);function It(e){return e%2===0}var Rt=a(15),Ut=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).sendWallMessage=function(){if(""===n.state.wallMessage)alert("Please enter text"),n.setState({buttonStatus:"warning"});else{n.setState({buttonText:"Loading",buttonLoading:!0});var e={msg:n.state.wallMessage};X.a.ajax({type:"post",url:"scot/api/v2/wall",data:e,traditional:!0,success:function(){this.setState({buttonStatus:"success",buttonText:"Sent",buttonLoading:!1})}.bind(Object(l.a)(n)),error:function(e){this.setState({buttonStatus:"danger",buttonText:"Failed - Try Again?",buttonLoading:!1}),this.props.errorToggle("Failed to send message",e)}.bind(Object(l.a)(n))})}},n.inputChange=function(e){n.setState({wallMessage:e.target.value})},n.render=function(){return r.a.createElement("div",{className:"allComponents",style:{"margin-left":"17px"}},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"main-header-info-child"},r.a.createElement("h2",{htmlFor:"message"},"Message to all SCOT users:"),r.a.createElement("input",{id:"message",style:{width:"700px"},placeholder:"Enter message to be displayed to everyone using SCOT",value:n.state.wallMessage,onChange:n.inputChange}),r.a.createElement(Rt,{onClick:n.sendWallMessage,bsStyle:n.state.buttonStatus,disabled:n.state.buttonLoading},n.state.buttonText)))))},n.state={wallMessage:"",buttonStatus:"primary",buttonText:"Send",buttonLoading:!1},n}return a}(r.a.Component),Wt=a(490),Ht=a.n(Wt),Bt=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={user:"",pass:""},n.SSO=n.SSO.bind(Object(l.a)(n)),n.NormalAuth=n.NormalAuth.bind(Object(l.a)(n)),n.isEnterPressed=n.isEnterPressed.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e="/sso?orig_url=/#"+this.props.origurl;return r.a.createElement(q.a,{dialogClassName:"login-modal",show:this.props.modalActive},r.a.createElement(q.a.Header,null,r.a.createElement(q.a.Title,{style:{textAlign:"center"}},"SCOT Login")),r.a.createElement(q.a.Body,{style:{textAlign:"center"}},r.a.createElement("img",{src:Ht.a,alt:"SCOT Logo"}),r.a.createElement(H.a,{type:"submit",href:e},"Sign in using SSO"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("i",{className:"fa fa-user"})),r.a.createElement("input",{id:"user",type:"user",ref:"user",defaultValue:"",className:"form-control",placeholder:"Username or Email"})),r.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("i",{className:"fa fa-lock"})),r.a.createElement("input",{id:"pass",type:"password",ref:"pass",defaultValue:"",placeholder:"Password",className:"form-control",onKeyPress:this.isEnterPressed})),r.a.createElement(H.a,{type:"submit",className:"btn btn-primary",onClick:this.NormalAuth,style:{marginBottom:"25px",width:"140px"}},"Submit"),r.a.createElement("br",null)))}},{key:"isEnterPressed",value:function(e){"Enter"===e.key&&this.NormalAuth()}},{key:"SSO",value:function(){var e={orig_url:"%2f"};X.a.ajax({type:"get",url:"sso",crossDomain:!0,data:e,success:function(e){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){this.props.errorToggle("Failed to log in using SSO")}.bind(this)})}},{key:"NormalAuth",value:function(){var e={};e.user=this.refs.user.value,e.pass=this.refs.pass.value,e.csrf_token=this.props.csrf,X.a.ajax({type:"post",url:"auth",data:e,success:function(){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){"Failed CSRF check"===e.responseText?this.props.errorToggle("Failed to log in due to bad CSRF token. Please reload the page and then log in. Error: "+e.responseText):this.props.errorToggle("Failed to log in using normal auth: "+e.responseText)}.bind(this)})}}]),a}(n.Component);Bt.defaultProps={modalActive:!0};var Vt=Bt,zt=a(92),qt=a(59),Kt=a(163),Gt=a(1135),Jt=a(1102),Yt=a(1103),Qt=a(491),Xt=a.n(Qt),$t=a(329),Zt=a.n($t),ea=a(492),ta=a.n(ea),aa=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).handleDelete=function(e){var t=n.state.tags;if(t.splice(e,1),0===t.length)return n.props.onChange(""),void n.setState({tags:t,placeholder:""});n.props.onChange(t),n.setState({tags:t,placeholder:""})},n.handleAdd=function(e){var t=n.state.tags;n.state.maxTags&&t.length>=n.state.maxTags?n.setState({placeholder:"Only "+n.state.maxTags+" allowed. Please delete a tag to add another one"}):(t.push(e),n.props.onChange(t),n.setState({tags:t,placeholder:""}))},n.handleInputChange=function(e){if(e&&e.length>=2){var t=[];X.a.ajax({type:"get",url:"/scot/api/v2/ac/"+n.props.type+"/"+e,success:function(e){e=e.records;for(var a=0;a<e.length;a++){var n={};n.id=a+1,n.name=e[a],t.push(n)}this.setState({suggestions:t})}.bind(Object(l.a)(n)),error:function(e){console.log("failed to get autocomplete data")}})}},n.showHideInput=function(){"userdef"===n.props.type&&n.props.maxTags&&n.state.tags.length>=n.props.maxTags?X()(".react-tags__search").hide():X()(".react-tags__search").show()};var r=[];n.props.value&&(r=n.props.value);var i=void 0;return n.props.maxTags&&(i=n.props.maxTags),n.state={suggestions:[],tags:r,maxTags:i,placeholder:""},n}return Object(C.a)(a,[{key:"componentDidUpdate",value:function(){this.showHideInput()}},{key:"render",value:function(){return r.a.createElement("div",{className:"TagInput"},r.a.createElement(ta.a,{tags:this.state.tags,suggestions:this.state.suggestions,handleAddition:this.handleAdd,handleDelete:this.handleDelete,handleInputChange:this.handleInputChange,autoresize:!1,autofocus:!1,allowBackspace:!1,allowNew:!0,placeholder:this.state.placeholder,tagComponent:na}))}}]),a}(n.Component),na=function(e){var t=e.classNames,a=e.onDelete,n=e.tag;return r.a.createElement("div",{className:t.selectedTag},r.a.createElement("span",{className:t.selectedTagName},n.name),r.a.createElement("i",{className:"fa fa-remove","aria-hidden":"true",onClick:a}))},ra=aa,ia=a(1104),oa=a(57),sa=a.n(oa),la=a(135);function ca(e,t){return da.apply(this,arguments)}function da(){return(da=Object(la.a)(sa.a.mark((function e(t,a){return sa.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==a){e.next=6;break}return e.next=3,Me.a.get(t);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,Me.a.get(t,{params:a});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pa(){return(pa=Object(la.a)(sa.a.mark((function e(t,a){return sa.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a){e.next=6;break}return e.next=3,Me.a.post(t,a);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,Me.a.post(t);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ua(e,t){return ha.apply(this,arguments)}function ha(){return(ha=Object(la.a)(sa.a.mark((function e(t,a){return sa.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me.a.put(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ma(){return(ma=Object(la.a)(sa.a.mark((function e(t){return sa.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me.a.delete(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ga=a(192),ya=a.n(ga),fa=a(493),va=a.n(fa),ba={numberFilter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(Zt.a,{debounceTimeout:200,type:"number",minLength:1,min:0,value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%"}})},stringFilter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(Zt.a,{debounceTimeout:200,minLength:1,value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%"}})},dropdownFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["open","closed","promoted"],t=arguments.length>1?arguments[1]:void 0;return function(a){var n=a.filter,i=a.onChange;return r.a.createElement(Gt.a,{trigger:"focus",placement:"bottom",overlay:r.a.createElement(Jt.a,{id:"status_popover",style:{maxWidth:"400px"}},r.a.createElement(Yt.a,{vertical:!0,style:{maxHeight:"50vh",overflowY:"auto",position:"relative"}},e.map((function(e){return r.a.createElement(H.a,{key:e,onClick:function(){return i(e)},active:n&&n.value===e,style:{textTransform:"capitalize",textAlign:t||null}},e)}))),n&&r.a.createElement(H.a,{block:!0,onClick:function(){return i("")},bsStyle:"primary",style:{marginTop:"3px"}},"Clear"))},r.a.createElement("input",{type:"text",value:n?n.value:"",readOnly:!0,style:{width:"100%",cursor:"pointer"}}))}},dateRange:function(e){var t,a=e.filter,n=e.onChange;return r.a.createElement(Gt.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:r.a.createElement(Jt.a,{id:"daterange_popover",style:{maxWidth:"350px"}},r.a.createElement(Xt.a,{numberOfCalendars:2,selectionType:"range",showLegend:!1,singleDateRange:!0,onSelect:function(e,t){n(function(e){return{start:Math.round(e.start)/1e3,end:Math.round(e.end)/1e3}}(e))},value:a?(t=a.value,ge.range(1e3*t.start,1e3*t.end)):null}),a&&r.a.createElement(H.a,{block:!0,onClick:function(){n(""),document.dispatchEvent(new MouseEvent("click"))},bsStyle:"primary"},"Clear"))},r.a.createElement("input",{type:"text",value:a?ke(a.value):"",readOnly:!0,style:{width:"100%",cursor:"pointer"}}))},tagFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tag";return function(t){var a=t.filter,n=t.onChange;return r.a.createElement(ra,{type:e,onChange:n,value:a?a.value:[]})}}},Ea={dateFormater:function(e){var t=new Date(1e3*e.value);return r.a.createElement("span",null,t.toLocaleString())},alertStatus:function(e){var t=e.value.split("/").map((function(e){return parseInt(e.trim(),10)})),a=Object(Kt.a)(t,3),n=a[0],i=a[1],o="open btn-danger";return a[2]?o="promoted btn-warning":i&&(n||(o="closed btn-success")),r.a.createElement("div",{className:"alertStatusCell ".concat(o)},e.value)},textStatus:function(e){var t="green";return"open"===e.value||"disabled"===e.value||"assigned"===e.value||"paused"===e.value?t="red":"promoted"===e.value&&(t="orange"),r.a.createElement("span",{style:{color:t}},e.value)},alertStatusAlerts:function(e){return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(ja,{row:e}))},flairCell:function(e){return void 0!==e?r.a.createElement(Ca,{value:e.value}):null},appliesTo:function(e){if(void 0!==e){if(Array.isArray(e.original.data.applies_to)){var t=e.original.data.applies_to.map((function(e){return e}));return r.a.createElement("span",null,t.join(", "))}return r.a.createElement("span",null,e.original.data.applies_to)}}},ka={Id:{Header:"ID",accessor:"id",width:80,Filter:ba.numberFilter},AlertStatus:{Header:"Status",accessor:function(e){return e.open_count+" / "+e.closed_count+" / "+e.promoted_count},column:["open_count","closed_count","promoted_count"],id:"status",width:150,Filter:ba.dropdownFilter(),Cell:Ea.alertStatus,style:{padding:0}},EventStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter()},FeedStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter()},DispatchStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter()},IntelStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter()},ProductStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter()},IncidentStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter(["open","closed"])},SigStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:Ea.textStatus,Filter:ba.dropdownFilter(["enabled","disabled"])},TaskStatus:{Header:"Task Status",accessor:function(e){return e.metadata.task.status},id:"metadata.task.status",column:"metadata",Cell:Ea.textStatus,Filter:ba.dropdownFilter(["open","assigned","closed"])},TaskSummary:{Header:"Task Summary",accessor:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},id:"summary",minWidth:400,maxWidth:5e3,Filter:ba.stringFilter},Subject:{Header:"Subject",accessor:"subject",minWidth:400,maxWidth:5e3,Filter:ba.stringFilter},Location:{Header:"Location",accessor:"location",minWidth:80,maxWidth:180,Filter:ba.stringFilter},Created:{Header:"Created",accessor:"created",minWidth:100,maxWidth:180,Filter:ba.dateRange,Cell:Ea.dateFormater},Updated:{Header:"Updated",accessor:"updated",minWidth:100,maxWidth:180,Filter:ba.dateRange,Cell:Ea.dateFormater},Occurred:{Header:"When",accessor:"when",minWidth:100,maxWidth:180,Filter:ba.dateRange,Cell:Ea.dateFormater},LastAttempt:{Header:"Last Attempt",accessor:"last_attempt",minWidth:100,maxWidth:180,Filter:ba.dateRange,Cell:Ea.dateFormater},LastArticle:{Header:"Last Article",accessor:"last_article",minWidth:100,maxWidth:180,Filter:ba.dateRange,Cell:Ea.dateFormater},Sources:{Header:"Sources",accessor:"source",column:"source",id:"source",minWidth:120,Filter:ba.tagFilter("source")},Tags:{Header:"Tags",accessor:"tag",column:"tag",id:"tag",minWidth:120,Filter:ba.tagFilter("tag")},TaskOwner:{Header:"Task Owner",accessor:"owner",maxWidth:80,Filter:ba.stringFilter},Owner:{Header:"Owner",accessor:"owner",maxWidth:80,Filter:ba.stringFilter},Entries:{Header:"Entries",accessor:"entry_count",maxWidth:70,Filter:ba.numberFilter},Articles:{Header:"Articles",accessor:"article_count",maxWidth:70,Filter:ba.numberFilter},Promotions:{Header:"Promotions",accessor:"promotions",maxWidth:70,Filter:ba.numberFilter},Views:{Header:"Views",accessor:"views",maxWidth:70,Filter:ba.numberFilter},DOE:{Header:"DOE",accessor:"doe_report_id",maxWidth:100,Filter:ba.stringFilter},IncidentType:{Header:"Type",accessor:"type",minWidth:200,maxWidth:250,Filter:ba.dropdownFilter(["Type 1 : Root Compromise","Type 1 : User Compromise","Type 1 : Loss/Theft/Missing Desktop","Type 1 : Loss/Theft/Missing Laptop","Type 1 : Loss/Theft/Missing Media","Type 1 : Loss/Theft/Missing Other","Type 1 : Malicious Code Trojan","Type 1 : Malicious Code Virus","Type 1 : Malicious Code Worm","Type 1 : Malicious Code Other","Type 1 : Web Site Defacement","Type 1 : Denial of Service","Type 1 : Critical Infrastructure Protection","Type 1 : Unauthorized Use","Type 1 : Information Compromise","Type 2 : Attempted Intrusion","Type 2 : Reconnaissance Activity"],"left")},AppliesTo:{Header:"Applies To",id:"data.applies_to",accessor:function(e){return e.data.applies_to},Cell:Ea.appliesTo,Filter:ba.tagFilter,minWidth:400,maxWidth:5e3},Value:{Header:"Value",accessor:"value",Filter:ba.stringFilter,minWidth:400,maxWidth:5e3},Name:{Header:"Name",accessor:"name",Filter:ba.stringFilter,minWidth:200,maxWidth:300},Group:{Header:"Group",accessor:function(e){return e.data.signature_group?e.data.signature_group.join(", "):""},column:"signature_group",id:"data.signature_group",Filter:ba.stringFilter},Type:{Header:"Type",accessor:function(e){return e.data.type},id:"data.type",Filter:ba.stringFilter,minWidth:100,maxWidth:150},EntityType:{Header:"Type",accessor:"type",Filter:ba.stringFilter,minWidth:100,maxWidth:150},FeedType:{Header:"Type",accessor:"type",Filter:ba.stringFilter,minWidth:100,maxWidth:150},Description:{Header:"Description",accessor:function(e){return e.data.description},Filter:ba.stringFilter,minWidth:400,id:"data.description",maxWidth:5e3},Uri:{Header:"URI",accessor:function(e){return e.uri},Filter:ba.stringFilter,minWidth:400,id:"uri",maxWidth:5e3},TargetType:{Header:"Type",accessor:function(e){return e.target.type},column:"target",id:"target_type",Filter:ba.stringFilter},TargetId:{Header:"Target Id",accessor:function(e){return e.target.id},column:"target",id:"target_id",Filter:ba.numberFilter},OpenTasks:{Header:"Open Tasks",accessor:"has_tasks",Filter:ba.numberFilter,maxWidth:90,filterable:!1},Status:{accessor:"status",Header:"Status",width:100,Cell:Ea.alertStatusAlerts},EntryCountColumn:{width:50,resizable:!0,expander:!0,filter:!1,accessor:"entry_count",Header:"Entries",Expander:function(e){var t=e.isExpanded,a=Object(k.a)(e,["isExpanded"]);return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},t?r.a.createElement(ia.a,{variant:"contained",style:{backgroundColor:"orange",color:"white"}},"Close entries"):r.a.createElement("div",null,0==a.original.entry_count?r.a.createElement(ya.a,null):r.a.createElement(ia.a,{variant:"contained",size:"small",style:{backgroundColor:"#5bc0de",color:"white"}},a.original.entry_count," entries")))},getProps:function(e,t,a){return{className:"show-pointer"}}}},wa={style:{padding:"5px 5px"}},Sa={alert:["Id","Status","EntryCountColumn"],alertgroup:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views","OpenTasks"],event:["Id","Location","EventStatus","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","OpenTasks"],incident:["Id","Location","DOE","IncidentStatus","Owner","Subject","Occurred","IncidentType",{title:"Tags",options:{minWidth:100,maxWidth:150}},{title:"Sources",options:{minWidth:100,maxWidth:150}}],dispatch:["Id","Location","DispatchStatus","Subject","Created","Updated","Sources",{title:"Tags",options:{minWidth:200,maxWidth:250}},"Owner","Entries","Views"],intel:["Id","Location","IntelStatus","Subject","Created","Updated","Sources",{title:"Tags",options:{minWidth:200,maxWidth:250}},"Owner","Entries","Views","OpenTasks"],product:["Id","Location","ProductStatus","Subject","Created","Updated","Sources",{title:"Tags",options:{minWidth:200,maxWidth:250}},"Owner","Entries","Views","OpenTasks"],feed:["Id","Name","FeedStatus","FeedType","Uri","LastAttempt","LastArticle","Articles","Promotions"],task:["Id","Location","Subject","TargetType","TargetId",{title:"TaskOwner",options:{minWidth:150,maxWidth:500}},"TaskStatus","TaskSummary",{title:"Updated",options:{minWidth:150,maxWidth:500}}],signature:["Id","Location","Name","Type","SigStatus","Group","Description","Owner","Tags","Sources","Updated"],guide:["Id","Location","Subject","AppliesTo"],entity:["Id","Location","Value","EntityType","Entries"],default:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views"]},Ta=function(e,t,a,n){function r(e){return e.reduce((function(e,t){return void 0!==e.width?e.width+t.width:e+t.width}))}Sa.hasOwnProperty(e)||(e="default"),!1===n&&"alert"===e&&(e="alertgroup");var i,o=[],s=Object(w.a)(Sa[e]);try{for(s.s();!(i=s.n()).done;){var l=i.value,c={};"object"===typeof l?c=Object(S.a)(Object(S.a)({},ka[l.title]),l.options):"string"===typeof l&&(c=ka[l]),o.push(Object(S.a)(Object(S.a)({},wa),c))}}catch(g){s.e(g)}finally{s.f()}if("alert"===e){a.length>0&&(a[0].data.columns&&a[0].data.columns.forEach(function(e,a){if("status"!==e){var n={accessor:e,Header:e,filter:!0,Cell:function(e){return Ea.flairCell(e)},width:xa(t,e,e)};o.push(n)}else{var r={accessor:"status ",Header:e,filter:!0,Cell:function(e){return Ea.flairCell(e)},width:80};o.push(r)}}.bind(void 0)),o.forEach((function(e,t){e.getProps=function(e,a){return{style:{backgroundColor:t%2===0?"#bababa45":""}}}})));var d=3;o.forEach((function(e){90===e.width&&d++,e.accessor.includes("time")&&d++}));var p=window.innerWidth-32,u=r(o);if(u<p){var h=p-u,m=h/(o.length-d);o.forEach(function(e){(u=r(o))<p&&"id"!==e.accessor&&"entry_count"!==e.accessor&&"status"!==e.accessor&&90!==e.width&&!0!==e.accessor.includes("time")&&(e.width+m<h?(e.width=e.width+m,u=r(o)):e.width=e.width+h)}.bind(void 0))}}return o},Ca=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.value;return r.a.createElement("div",{style:{wordBreak:"break-word"},className:"alertTableHorizontal",dangerouslySetInnerHTML:{__html:e}})}}]),a}(r.a.Component),xa=function(e,t,a){("string"===typeof t||t instanceof String)&&(t=function(e){return e[t]});var n=Math.max.apply(Math,Object(T.a)(e.map((function(e){var t=e[a];return void 0!==t?function(e){try{return va()(e).length}catch(t){return e.length}}(t):0}))).concat([a.length]));return n<13&&"status"!==a?90:Math.min(400,9*n)},ja=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getPromotionInfo=function(e){return ca("/scot/api/v2/alert/".concat(e,"/event"),{})},n.state={element:null,loading:!0},n}return Object(C.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this;e.row.value!==this.props.row.value&&this.getPromotionInfo(this.props.row.original.id).then((function(e){e&&t.setState({element:e})}))}},{key:"componentDidMount",value:function(){var e=this;this.getPromotionInfo(this.props.row.original.id).then((function(t){t&&e.setState({element:t})}))}},{key:"render",value:function(){var e=this;return"closed"===this.props.row.value?r.a.createElement("p",{style:{color:"green"}},this.props.row.value):"open"===this.props.row.value?r.a.createElement("p",{style:{color:"red"}},this.props.row.value):"promoted"===this.props.row.value?this.state.element?r.a.createElement(ia.a,{variant:"contained",onMouseDown:function(){return t=e.state.element.data.records[0].id,void window.open("#/event/"+t);var t},style:{backgroundColor:"orange",color:"white"}},this.props.row.value):r.a.createElement("span",null,"Loading..."):void 0}}]),a}(r.a.Component),Oa={columnsDisplay:{alertgroup:["ID","Status","Subject","Created","Sources","Tags","Views","Open Tasks"],alert:["ID","Status","Subject","Created","Sources","Tags","Views"],event:["ID","Status","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","Open Tasks"],incident:["ID","DOE","Status","Owner","Subject","Occurred","Type","Tags","Sources"],task:["Entry Id","Body","Type","ID","Status","Owner","Updated"],guide:["ID","Subject","Applies To"],intel:["ID","Subject","Created","Updated","Source","Tags","Owner","Entries","Views"],feed:["ID","Status","Name","Uri","LastAttempt","LastArticle","Articles","Promotions"],signature:["ID","Name","Type","Status","Group","Description","Owner","Tag","Source","Updated"],entity:["ID","Value","Type","Entries"]},columns:{alertgroup:["id","status","subject","created","source","tag","views","has_tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has_tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target.type","target.id","metadata.status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],feed:["id","status","name","uri","last_attempt","last_article","article_count","promotions"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]},columnsClassName:{alertgroup:["id","status","subject","created","source","tag","views","has-tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has-tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target_type","target_id","task_status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],feed:["id","status","name","uri","last_attempt","last_article","article_count","promotions"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]}},Da=a(702),Na=a(284),_a=a(33),Aa=a(120),Ma=a(419),La=a(40).Link,Pa=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).componentDidMount=function(){"alertgroup"===e.props.type&&X()("#list-view").keydown(function(e){X()("input").is(":focus")||"promoted"!==this.props.status&&(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey?this.statusAjax("open"):67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.statusAjax("closed"))}.bind(Object(l.a)(e)))},e.componentWillUnmount=function(){X()("#list-view").unbind("keydown")},e.trackAll=function(){e.statusAjax("tracked")},e.untrackAll=function(){e.statusAjax("untracked")},e.activeAll=function(){e.statusAjax("active")},e.pauseAll=function(){e.statusAjax("paused")},e.closeAll=function(){e.statusAjax("closed")},e.openAll=function(){e.statusAjax("open")},e.enableAll=function(){e.statusAjax("enabled")},e.disableAll=function(){e.statusAjax("disabled")},e.statusAjax=function(t){console.log(t);var a={status:t};X.a.ajax({type:"put",url:"scot/api/v2/"+e.props.type+"/"+e.props.id,data:JSON.stringify(a),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success status change to: "+e)},error:function(e){this.props.errorToggle("Failed to change status",e)}.bind(Object(l.a)(e))})},e.render=function(){var t,a="",n="",i="";return"open"===e.props.status||"disabled"===e.props.status||"untracked"===e.props.status?(a="danger",i="alertgroup_open"):"closed"===e.props.status||"enabled"===e.props.status||"tracked"===e.props.status?(a="success",i="alertgroup_closed"):"promoted"===e.props.status&&(a="default",i="alertgroup_promoted"),"alertgroup"===e.props.type&&(n=e.props.data.open_count+" / "+e.props.data.closed_count+" / "+e.props.data.promoted_count),"event"===e.props.type?t="/incident/"+e.props.data.promotion_id:"intel"===e.props.type?t="/product/"+e.props.data.promotion_id:"dispatch"===e.props.type&&(t="/intel/"+e.props.data.promotion_id),"guide"===e.props.type?r.a.createElement("div",null):"alertgroup"===e.props.type?r.a.createElement(Da,null,r.a.createElement(Na,{placement:"top",overlay:r.a.createElement(Ma,{id:e.props.id},"open/closed/promoted alerts")},r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,title:n,id:"dropdown",className:i},r.a.createElement(_a,{eventKey:"1",onClick:e.openAll,bsSize:"xsmall"},r.a.createElement("b",null,"Open")," All Alerts"),r.a.createElement(_a,{eventKey:"2",onClick:e.closeAll},r.a.createElement("b",null,"Close")," All Alerts")))):"incident"===e.props.type?r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,id:"event_status",className:i,style:{fontSize:"14px"},title:e.props.status},r.a.createElement(_a,{eventKey:"1",onClick:e.openAll},"Open Incident"),r.a.createElement(_a,{eventKey:"2",onClick:e.closeAll},"Close Incident")):"feed"===e.props.type?r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,id:"feed_status",className:i,style:{fontSize:"14px"},title:e.props.status},r.a.createElement(_a,{eventKey:"1",onClick:e.activeAll},"Active Feed"),r.a.createElement(_a,{eventKey:"2",onClick:e.pauseAll},"Pause Feed")):"signature"===e.props.type?r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,id:"event_status",className:i,style:{fontSize:"14px"},title:e.props.status},r.a.createElement(_a,{eventKey:"1",onClick:e.enableAll},"Enable Signature"),r.a.createElement(_a,{eventKey:"2",onClick:e.disableAll},"Disable Signature")):"entity"===e.props.type?r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,id:"event_status",className:i,style:{fontSize:"14px"},title:e.props.status},r.a.createElement(_a,{eventKey:"1",onClick:e.trackAll},"Track"),r.a.createElement(_a,{eventKey:"2",onClick:e.untrackAll},"Untracked")):r.a.createElement("div",null,"promoted"===e.props.status?r.a.createElement(La,{to:t,role:"button",className:"btn btn-warning"},e.props.status):r.a.createElement(Aa,{bsSize:"xsmall",bsStyle:a,id:"event_status",className:i,style:{fontSize:"14px"},title:e.props.status},r.a.createElement(_a,{eventKey:"1",onClick:e.openAll},"Open"),r.a.createElement(_a,{eventKey:"2",onClick:e.closeAll},"Close")))},e}return a}(r.a.Component),Fa=a(101),Ia=a.n(Fa),Ra=a(187),Ua=a.n(Ra),Wa=a(15),Ha=a.n(Wa),Ba=a(15),Va=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){"alert"===n.props.type?(n.setState({newType:"Event"}),n.setState({newURL:"event"})):"event"===n.props.type?(n.setState({newType:"Incident"}),n.setState({newURL:"incident"})):"dispatch"===n.props.type?(n.setState({newType:"Intel"}),n.setState({newURL:"intel"})):"intel"===n.props.type&&(n.setState({newType:"Product"}),n.setState({newURL:"product"}))},n.promote=function(){var e=JSON.stringify({promote:"new"});X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:e,contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully promoted"),window.location.assign("#/"+this.state.newURL+"/"+e.pid)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("error","Failed to promote",e)}.bind(Object(l.a)(n))})},n.render=function(){return r.a.createElement(Ba,{bsStyle:"warning",eventkey:"1",bsSize:"xsmall",onClick:n.promote},r.a.createElement("img",{src:"/images/megaphone.png",alt:""}),r.a.createElement("span",null,"Promote to ",n.state.newType))},n.state={newURL:null,newType:null},n}return a}(r.a.Component),za=a(1105),qa=a(1106),Ka=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={isMarked:!1},n.removeMarkedItemsHandler=n.removeMarkedItemsHandler.bind(Object(l.a)(n)),n.getMarkedItemsHandler=n.getMarkedItemsHandler.bind(Object(l.a)(n)),n.setMarkedItemsHandler=n.setMarkedItemsHandler.bind(Object(l.a)(n)),n.getSelectedAlerts=n.getSelectedAlerts.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.getMarkedItemsHandler()}},{key:"componentWillReceiveProps",value:function(e){this.getMarkedItemsHandler(),e.isAlert&&this.setState({isMarked:!1})}},{key:"render",value:function(){return"entry"===this.props.type?r.a.createElement(za.a,{onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},r.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.state.isMarked?r.a.createElement("span",null,"Marked"):r.a.createElement("span",null,"Mark")):r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:"mark_tooltip"},"Mark selected"," ",this.props.isAlert?r.a.createElement("span",null,"alerts"):this.props.type)},r.a.createElement(H.a,{bsSize:"xsmall",onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},r.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.props.isAlert?r.a.createElement("span",null,"Mark selected"):null))}},{key:"getMarkedItemsHandler",value:function(){var e=Ja(),t=!1;if(e){var a,n=Object(w.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.id===this.props.id&&r.type===this.props.type){t=!0;break}}}catch(i){n.e(i)}finally{n.f()}}this.setState({isMarked:t})}},{key:"removeMarkedItemsHandler",value:function(){if(this.props.isAlert)for(var e=this.getSelectedAlerts(),t=0;t<e.length;t++)Ga("alert",e[t]);else Ga(this.props.type,this.props.id);this.setState({isMarked:!1})}},{key:"setMarkedItemsHandler",value:function(){if(this.props.isAlert)for(var e=this.getSelectedAlerts(),t=0;t<e.length;t++)Ya("alert",e[t],this.props.string);else Ya(this.props.type,this.props.id,this.props.string);this.setState({isMarked:!0})}},{key:"getSelectedAlerts",value:function(){return this.props.alertsSelected.map((function(e){return e.id}))}}]),a}(r.a.Component),Ga=function(e,t){var a=Ja();if(a){for(var n=0;n<a.length;n++)if(a[n].type===e&&a[n].id===t){a.splice(n,1);break}le("marked",JSON.stringify(a))}},Ja=function(){var e=ce("marked");if(e)return e=JSON.parse(e)},Ya=function(e,t,a){var n=[],r=Ja();if(r){var i,o=Object(w.a)(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.type===e&&s.id===t||n.push(s)}}catch(l){o.e(l)}finally{o.f()}}n.push({id:t,type:e,subject:a.substring(0,120)}),le("marked",JSON.stringify(n))};Ka.defaultProps={isMarked:!1};var Qa,Xa,$a,Za,en=a(186),tn=a.n(en),an=a(33),nn=a(292),rn=a(418),on=a(284),sn=a(746),ln=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).selectColor=function(t){var a={tlp:t};e.serverRequest=X.a.ajax({type:"put",url:"/scot/api/v2/"+e.props.type+"/"+e.props.id+"/",data:JSON.stringify(a),contentType:"application/json; charset=UTF-8",success:function(){console.log("set tlp")},error:function(e){this.props.errorToggle("Failed to set TLP",e)}})},e.render=function(){return r.a.createElement("span",{style:{padding:"entry"===e.props.type?"3px 20px":null}},r.a.createElement(on,{placement:"top",overlay:r.a.createElement(sn,{id:"tlp-tooltip"},e.props.tlp)},r.a.createElement(tn.a,{bsSize:"xsmall",bsStyle:{padding:"entry"===e.props.type?"3px 20px":null}},r.a.createElement(nn,null,r.a.createElement("svg",{id:"trafficlight1",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle1",r:"5",cx:"6",cy:"6",style:{fill:"red"===e.props.tlp||"white"===e.props.tlp?e.props.tlp:"gray",stroke:"black",strokeWidth:"2"}})),r.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle2",r:"5",cx:"6",cy:"6",style:{fill:"amber"===e.props.tlp&&"white"!==e.props.tlp?"orange":"white"===e.props.tlp?"white":"gray",stroke:"black",strokeWidth:"2"}})),r.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle3",r:"5",cx:"6",cy:"6",style:{fill:"green"===e.props.tlp||"white"===e.props.tlp?e.props.tlp:"gray",stroke:"black",strokeWidth:"2"}}))),r.a.createElement(rn,null,r.a.createElement(an,{header:!0},"Traffic Light Protocol (TLP) Color"),r.a.createElement(an,{eventKey:"unset",onSelect:e.selectColor},"Unset"),r.a.createElement(an,{eventKey:"red",onSelect:e.selectColor},"Red"),r.a.createElement(an,{eventKey:"amber",onSelect:e.selectColor},"Amber"),r.a.createElement(an,{eventKey:"green",onSelect:e.selectColor},"Green"),r.a.createElement(an,{eventKey:"white",onSelect:e.selectColor},"White"),r.a.createElement(an,{divider:!0}),r.a.createElement(an,{href:"https://www.us-cert.gov/tlp"},"What is TLP?")))))},e}return a}(r.a.Component),cn=a(494),dn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).toggleFlair=function(){var e=!n.state.globalFlairState;n.props.toggleFlair(),X()("iframe").each(function(e,t){if(null!=t.contentDocument){var a=X()(t).contents(),n=a.find(".entity-off"),r=a.find(".entity");!1===this.state.globalFlairState?(a.find(".extras").show(),a.find(".flair-off").hide(),n.each((function(e,t){X()(t).addClass("entity"),X()(t).removeClass("entity-off")}))):(a.find(".extras").hide(),a.find(".flair-off").show(),r.each((function(e,t){X()(t).addClass("entity-off"),X()(t).removeClass("entity")})))}}.bind(Object(l.a)(n))),n.setState({globalFlairState:e})},n.alertOpenOrCloseSelected=function(e){var t=[];n.props.alertsSelected.length>0?t=n.props.alertsSelected:n.props.entryData.length>0&&(t=n.props.entryData);var a={alerts:t.map((function(t){var a={id:t.id,status:e};return"closed"===e&&(a.closed=Math.round((new Date).getTime()/1e3)),a}))};n.props.ToggleProcessingMessage(!0),ua("/scot/api/v2/".concat(n.props.type,"/").concat(n.props.id),a).then(function(){console.log("success"),this.props.ToggleProcessingMessage(!1)}.bind(Object(l.a)(n))).catch(function(t){this.props.errorToggle("failed to ".concat(e," selected alerts"),t),this.props.ToggleProcessingMessage(!1)}.bind(Object(l.a)(n)))},n.alertPromoteSelected=function(){var e=JSON.stringify({promote:"new"}),t=n.props.alertsSelected.map((function(e){return e.id}));n.props.ToggleProcessingMessage(!0),ua("/scot/api/v2/alert/".concat(t[0]),e).then(function(e){var a={promote:e.data.pid};1===t.length&&this.props.ToggleProcessingMessage(!1),t.forEach(function(e,n){0===n?console.log("promoting rest of alerts"):ua("/scot/api/v2/alert/".concat(e),a).then(function(){n+1===t.length&&this.props.ToggleProcessingMessage(!1)}.bind(this)).catch(function(e){this.props.errorToggle("failed to promoted selected alerts",e)}.bind(this))}.bind(this))}.bind(Object(l.a)(n)))},n.alertSelectExisting=function(){var e=prompt("Please Enter Event ID to promote into");""!==e&&null!==e&&(n.props.alertsSelected.forEach(function(t){var a={promote:parseInt(e,10)};ua("/scot/api/v2/alert/".concat(t.id),a).then((function(){console.log("Successfully promoted to event ".concat(e))})).catch(function(){prompt("Please use numbers only"),this.selectExisting()}.bind(this))}.bind(Object(l.a)(n))),window.open("#/event/"+e))},n.alertExportCSV=function(){var e=n.props.alertsSelected,t=[];e.forEach(function(e){Object.keys(e).forEach((function(t){if("string"===typeof e[t]){var a=e[t];e[t]=a.replace(/(<([^>]+)>)/gi,"")}})),t.push(e)}.bind(Object(l.a)(n))),n.setState({dataToDownload:t},(function(){n.csvLink.link.click()}))},n.PrintPrepare=function(){X()("iframe").contents().each((function(e,t){X()(t).find("blockquote").each((function(e,t){X()(t).css({"max-height":"5000px"})})),X()(t).find("pre").each((function(e,t){X()(t).css({"max-height":"5000px","word-wrap":"break-word"})}))})),setTimeout(function(){this.forceUpdate()}.bind(Object(l.a)(n)),500),setTimeout((function(){X()("#print-button").click()}),1e3)},n.Print=function(){window.print()},n.componentDidMount=function(){"alertgroup"!==n.props.type&&"alert"!==n.props.type||X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("open"),67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("closed"))}.bind(Object(l.a)(n))),X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||84===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleFlair()}.bind(Object(l.a)(n)))},n.componentWillUnmount=function(){X()("#main-detail-container").unbind("keydown")},n.guideToggle=function(){n.props.flairToolbarToggle(n.props.guideID,null,"guide",{top:0,left:0},null)},n.sourceToggle=function(){n.props.flairToolbarToggle(n.props.id,null,"source",{top:0,left:0},null)},n.createGuide=function(){var e=JSON.stringify({subject:"ENTER A GUIDE NAME",data:{applies_to:[n.props.subjectName]}});X.a.ajax({type:"POST",url:"/scot/api/v2/guide",data:e,contentType:"application/json; charset=UTF-8",success:function(e){window.open("/#/guide/"+e.id)},error:function(e){this.props.errorToggle("failed to create a new guide",e)}.bind(Object(l.a)(n))})},n.reparseFlair=function(){X.a.ajax({type:"put",url:"/scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8",success:function(){console.log("reparsing started")},error:function(e){this.props.errorToggle("failed to reparse flair",e)}.bind(Object(l.a)(n))})},n.createLinkSignature=function(){X.a.ajax({type:"POST",url:"/scot/api/v2/signature",data:JSON.stringify({target:{id:n.props.id,type:n.props.type},name:"Name your Signature",status:"disabled"}),contentType:"application/json; charset=UTF-8",success:function(e){var t="/#/signature/"+e.id;window.open(t,"_blank")},error:function(e){this.props.errorToggle("failed to create a signature",e)}.bind(Object(l.a)(n))})},n.manualUpdate=function(){n.props.updated(null,null)},n.render=function(){var e=n.props.subjectType,t=n.props.type,a=n.props.id,i=n.props.status,o="";if(n.props.headerData.subject?o=n.props.headerData.subject:n.props.headerData.value?o=n.props.headerData.value:n.props.headerData.name?o=n.props.headerData.name:n.props.headerData.body&&(o=n.props.headerData.body),"alertgroup"!==t){var s=!0;return"promoted"!==i?"alert"===t?"Event":"event"===t?"Incident":"dispatch"===t?"Intel":"intel"===t?"Product":"incident"!==t&&"guide"!==t&&"signature"!==t&&"feed"!==t&&"entity"!==t||(s=!1):s=!1,r.a.createElement("div",{className:"entry-header detail-buttons"},"entity"!==t?r.a.createElement(Ha.a,{eventkey:"1",bsStyle:"success",onClick:n.props.entryToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-plus-circle","aria-hidden":"true"})," Add Entry"):null,"entity"!==t?r.a.createElement(Ha.a,{eventkey:"2",onClick:n.props.fileUploadToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-upload","aria-hidden":"true"})," Upload File"):null,r.a.createElement(Ha.a,{eventkey:"3",onClick:n.toggleFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),"alertgroup"===t||"event"===t||"dispatch"===t||"intel"===t?r.a.createElement(Ha.a,{eventkey:"4",onClick:n.props.viewedByHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,r.a.createElement(Ha.a,{eventkey:"5",onClick:n.props.changeHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),"entity"!==t?r.a.createElement(Ha.a,{eventkey:"6",onClick:n.props.permissionsToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-users","aria-hidden":"true"})," Permissions"):null,r.a.createElement(ln,{type:t,id:a,tlp:n.props.headerData.tlp}),r.a.createElement(Ha.a,{eventkey:"7",onClick:n.props.entitiesToggle,bsSize:"xsmall"},r.a.createElement("span",{className:"entity"},"__")," View Entities"),"guide"===t?r.a.createElement(Ha.a,{eventkey:"8",onClick:n.props.guideRedirectToAlertListWithFilter,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-table","aria-hidden":"true"})," View Related Alerts"):null,r.a.createElement(Ha.a,{onClick:n.props.linksModalToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),s?r.a.createElement(Va,{type:t,id:a,updated:n.props.updated,errorToggle:n.props.errorToggle}):null,"signature"!==t?r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:n.createLinkSignature},r.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"):null,"signature"===t?r.a.createElement(Ha.a,{eventkey:"11",onClick:n.props.showSignatureOptionsToggle,bsSize:"xsmall",bsStyle:"warning"},"View Custom Options"):null,r.a.createElement(Ha.a,{onClick:n.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},r.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),r.a.createElement(Ha.a,{onClick:n.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ha.a,{onClick:n.props.exportToggle,bsSize:"xsmall",id:"export-button"},r.a.createElement("i",{className:"fa fa-share","aria-hidden":"true"})," Export"," ",e," "),r.a.createElement(Ha.a,{bsStyle:"danger",eventkey:"9",onClick:function(){return n.props.deleteToggle(t)},bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e),r.a.createElement(Ua.a,{style:{float:"right"}},r.a.createElement(Ka,{type:t,id:a,string:o}),r.a.createElement(Ha.a,{onClick:n.props.markModalToggle,bsSize:"xsmall"},"Marked Objects"),r.a.createElement(Ha.a,{id:"refresh-detail",bsStyle:"info",eventkey:"10",onClick:n.manualUpdate,bsSize:"xsmall",style:{float:"right"}},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))))}return r.a.createElement("div",{className:"entry-header second-menu detail-buttons"},r.a.createElement(Ua.a,{style:{float:"right"}},r.a.createElement(Ka,{type:t,id:a,string:o}),r.a.createElement(Ha.a,{onClick:n.props.markModalToggle,bsSize:"xsmall"},"Marked Actions"),r.a.createElement(Ha.a,{bsStyle:"info",eventkey:"16",onClick:n.manualUpdate,bsSize:"xsmall",style:{float:"right"}},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))),r.a.createElement("span",{className:"entry-header detail-buttons"},r.a.createElement(Ha.a,{eventkey:"1",onClick:n.toggleFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),r.a.createElement(Ha.a,{eventkey:"2",onClick:n.reparseFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"})," Reparse Flair"),r.a.createElement("span",null,null!==n.props.guideID?r.a.createElement(Ha.a,{eventkey:"3",onClick:n.guideToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/guide.png",alt:""})," Guide"):r.a.createElement(Ha.a,{eventkey:"3",onClick:n.createGuide,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/guide.png",alt:""})," Create Guide")),null==n.props.headerData?null:r.a.createElement(Ha.a,{eventkey:"4",onClick:n.sourceToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/code.png",alt:""})," View Source"),r.a.createElement(Ha.a,{eventkey:"5",onClick:n.props.entitiesToggle,bsSize:"xsmall"},r.a.createElement("span",{className:"entity"},"__")," View Entities"),"alertgroup"===t||"event"===t||"intel"===t?r.a.createElement(Ha.a,{eventkey:"6",onClick:n.props.viewedByHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,r.a.createElement(Ha.a,{eventkey:"7",onClick:n.props.changeHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),r.a.createElement(ln,{type:t,id:a,tlp:n.props.headerData.tlp}),r.a.createElement(Ha.a,{onClick:n.props.linksModalToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:n.createLinkSignature},r.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"),r.a.createElement(Ha.a,{onClick:n.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ha.a,{bsStyle:"danger",eventkey:"8",onClick:function(){return n.props.deleteToggle(t)},bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e)),n.props.alertsSelected.length>0?r.a.createElement("span",null,r.a.createElement(Ha.a,{eventkey:"8",onClick:function(){return n.alertOpenOrCloseSelected("open")},bsSize:"xsmall",bsStyle:"danger"},r.a.createElement("img",{src:"/images/open.png",alt:""})," Open Selected"),r.a.createElement(Ha.a,{eventkey:"9",onClick:function(){return n.alertOpenOrCloseSelected("closed")},bsSize:"xsmall",bsStyle:"success"},r.a.createElement("i",{className:"fa fa-flag-checkered","aria-hidden":"true"})," Close Selected"),r.a.createElement(Ha.a,{eventkey:"10",onClick:n.alertPromoteSelected,bsSize:"xsmall",bsStyle:"warning"},r.a.createElement("img",{src:"/images/megaphone.png",alt:""})," Promote Selected"),r.a.createElement(Ha.a,{eventkey:"11",onClick:n.alertSelectExisting,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/megaphone_plus.png",alt:""})," Add Selected to"," ",r.a.createElement("b",null,"Existing Event")),r.a.createElement(cn.CSVLink,{data:n.state.dataToDownload,filename:"data.csv",className:"hidden",ref:function(e){return n.csvLink=e},target:"_blank"}),r.a.createElement(Ha.a,{eventkey:"14",onClick:n.alertExportCSV,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/csv_text.png",alt:""})," Export to CSV"),r.a.createElement(Ka,{type:t,id:a,string:o,isAlert:!0,getSelectedAlerts:n.getSelectedAlerts,alertsSelected:n.props.alertsSelected}),r.a.createElement(Ha.a,{onClick:n.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},r.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),r.a.createElement(Ha.a,{onClick:n.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ha.a,{eventkey:"15",onClick:function(){return n.props.deleteToggle("alert")},bsSize:"xsmall",bsStyle:"danger"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete Selected")):null)},n.state={globalFlairState:!0,promoteRemaining:null,dataToDownload:[]},n}return a}(r.a.Component),pn=a(58),un=a.n(pn),hn=a(56),mn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"},overlay:{zIndex:"1101"}},gn={READY:{style:"danger"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"warning"}},yn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).deleteItems=function(){var e=n.props.deleteType,t=[];(t="alert"!==e?[parseInt(n.props.id,10)]:n.props.alertsSelected.map((function(e){return e.id}))).forEach(function(a,n){var r=this.props.enqueueSnackbar,i=function(e){return ma.apply(this,arguments)}("/scot/api/v2/".concat(e,"/").concat(a));this.props.removeCallback(parseInt(this.props.id,10)),i.then(function(){n===t.length-1&&"alert"===e&&this.props.updated(),"alert"!==e?(this.props.history.push("/"+e),r("Successfully deleted ".concat(this.props.id,"."),{variant:"success"})):"alert"===e&&r("Successfully deleted ".concat(a,"."),{variant:"success"})}.bind(this)).catch((function(e){r("Failed deleting exception.",{variant:"error"})}))}.bind(Object(l.a)(n))),n.props.deleteToggle(e)},n.state={key:e.id},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.deleteType,t="";if("alert"!==e)t=" ".concat(e,": ").concat(this.props.id);else if("alert"===e){var a=this.props.alertsSelected.map((function(e){return r.a.createElement("span",{style:{paddingRight:10}},e.id)}));t=r.a.createElement("span",null,e,"(s) : ",a)}return r.a.createElement(un.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:mn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(H.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),r.a.createElement(H.a,{bsStyle:"danger",id:"delete",onClick:this.deleteItems},"Delete")))}}]),a}(r.a.Component),fn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={key:e.id},n.toggle=n.toggle.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"toggle",value:function(){X.a.ajax({type:"delete",url:"scot/api/v2/entry/"+this.props.entryid,success:function(e){console.log("success: "+e);this.state.key}.bind(this),error:function(e){this.props.errorToggle("Failed to delete entry",e)}.bind(this)}),this.props.deleteToggle()}},{key:"render",value:function(){return r.a.createElement(un.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:mn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete Entry: ",this.props.entryid,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(H.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),r.a.createElement(H.a,{bsStyle:"danger",id:"delete",onClick:this.toggle},"Delete")))}}]),a}(n.PureComponent),vn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={deleteButton:gn.READY},n.deleteAll=n.deleteAll.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"deleteAll",value:function(){var e=this;this.setState({deleteButton:gn.LOADING});var t=!0,a=this.props.things;Array.isArray(a)||(a=[a]),X.a.when.apply(X.a,Object(T.a)(a.map((function(t){return e.deleteAjax(t)})))).then((function(){e.setState({deleteButton:gn.SUCCESS})}),(function(a){console.error(a),e.setState({deleteButton:gn.ERROR}),e.props.errorToggle("error deleting",a),t=!1})).always((function(){setTimeout((function(){e.setState({deleteButton:gn.READY}),e.props.callback(t)}),2e3)}))}},{key:"deleteAjax",value:function(e){return X.a.ajax({type:"delete",url:"/scot/api/v2/"+e.type+"/"+e.id,contentType:"application/json; charset=UTF-8"})}},{key:"render",value:function(){var e=this.props.things,t="";t=Array.isArray(e)?e.map((function(e){return"".concat(e.type,": ").concat(e.id)})).join(", "):"".concat(e.type,": ").concat(e.id);var a=this.state.deleteButton;return r.a.createElement(un.a,{isOpen:!0,onRequestClose:this.props.callback,style:mn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.callback}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(H.a,{id:"cancel-delete",onClick:this.props.callback},"Cancel"),r.a.createElement(H.a,{bsStyle:a.style,id:"delete",onClick:this.deleteAll,disabled:a.disabled},a.text?a.text:"Delete")))}}]),a}(n.PureComponent),bn=Object(hn.withSnackbar)(yn),En=a(330),kn=a.n(En),wn=a(120),Sn=a.n(wn),Tn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Cn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=de("whoami");e&&n.setState({whoami:e})},n.componentWillReceiveProps=function(){n.setState({currentOwner:n.props.data})},n.toggle=function(){if(void 0!==n.state.whoami){var e={owner:n.state.whoami};X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){},error:function(e){this.props.errorToggle("Failed to change owner",e)}.bind(Object(l.a)(n))})}else n.props.errorToggle("Failed to detect current user");n.ownerToggle()},n.ownerToggle=function(){!1===n.state.ownerToolbar?n.setState({ownerToolbar:!0}):n.setState({ownerToolbar:!1})},n.render=function(){return r.a.createElement("div",null,r.a.createElement(Sn.a,{bsSize:"xsmall",id:"event_owner",title:n.state.currentOwner},r.a.createElement(E.a,{eventKey:"1",onClick:n.ownerToggle},"Take Ownership")),n.state.ownerToolbar?r.a.createElement(un.a,{isOpen:!0,onRequestClose:n.ownerToggle,style:Tn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:n.ownerToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Take Ownership")),r.a.createElement("div",{className:"modal-body"},"Are you sure you want to take ownership of this event?"),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(kn.a,{id:"cancel-ownership",onClick:n.ownerToggle},"Cancel"),r.a.createElement(kn.a,{bsStyle:"info",id:"take-ownership",onClick:n.toggle},"Take Ownership"))):null)},n.state={currentOwner:n.props.data,whoami:void 0,ownerToolbar:!1},n}return a}(r.a.Component),xn=a(58),jn=a(15),On={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Dn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).render=function(){return r.a.createElement("div",null,r.a.createElement(xn,{isOpen:!0,onRequestClose:n.props.entitiesToggle,style:On},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:n.props.entitiesToggle}),r.a.createElement("h3",{id:"myModalLabel"},"List of Entities")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"50vh",overflowY:"auto"}},n.state.entitiesBody?r.a.createElement(Nn,{data:n.props.entityData,flairToolbarToggle:n.props.flairToolbarToggle}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(jn,{onClick:n.props.entitiesToggle},"Done"))))},n.state={entitiesBody:!0},n}return a}(r.a.Component),Nn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=[],a=e.props.data,n={entities:{}},i=n.entities;for(var o in a){var s={},l=a[o].type,c=o;if(s[a[o].id]=c,i.hasOwnProperty(l))i[l].push(s);else{var d=[];d.push(s),i[l]=d}}for(var p in i){var u=p,h=i[p];t.push(r.a.createElement(_n,{type:u,value:h,flairToolbarToggle:e.props.flairToolbarToggle}))}return r.a.createElement("div",null,t)},e}return a}(r.a.Component),_n=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){for(var t=[],a=e.props.type,n=e.props.value,i=0;i<n.length;i++){var o=n[i],s=null,l=null;for(var c in o)s=c,l=o[c];t.push(r.a.createElement(An,{entityValue:l,entityId:s,flairToolbarToggle:e.props.flairToolbarToggle}))}return r.a.createElement("div",{style:{border:"1px solid black",width:"500px"}},r.a.createElement("h3",null,a),r.a.createElement("div",{style:{fontWeight:"normal",maxHeight:"300px",overflowY:"auto"}},t))},e}return a}(r.a.Component),An=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).toggle=function(){e.props.flairToolbarToggle(e.props.entityId,e.props.entityValue,"entity")},e.render=function(){var t=e.props.entityValue;return r.a.createElement("a",{href:"javascript: void(0)",onClick:e.toggle},t,r.a.createElement("br",null))},e}return a}(r.a.Component),Mn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Ln=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){X.a.ajax({type:"get",url:"/scot/api/v2/"+n.props.type+"/"+n.props.id+"/history",success:function(e){this.setState({historyBody:!0,data:e.records})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to get change history",e)}.bind(Object(l.a)(n))})},n.render=function(){return r.a.createElement("div",null,r.a.createElement(un.a,{isOpen:!0,onRequestClose:n.props.changeHistoryToggle,style:Mn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:n.props.changeHistoryToggle}),r.a.createElement("h3",{id:"myModalLabel"},n.props.subjectType," Change History")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",width:"700px",overflowY:"auto"}},n.state.historyBody?r.a.createElement(Pn,{data:n.state.data}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ha.a,{onClick:n.props.changeHistoryToggle},"Done"))))},n.state={historyBody:!1,data:""},n}return a}(r.a.Component),Pn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=[],a=e.props.data;for(var n in a)t.push(r.a.createElement(Fn,{data:a[n]}));return r.a.createElement("div",null,t)},e}return a}(r.a.Component),Fn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=e.props.data;return r.a.createElement("div",null,"ID: ",t.id," -"," ",r.a.createElement(Ia.a,{value:1e3*t.when,format:"MM/DD/YYYY hh:mm:ss a"})," -"," ",t.who," - ",t.what)},e}return a}(r.a.Component),In={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Rn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={historyBody:!1,data:""},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){this.setState({historyBody:!0,data:e})}.bind(this),error:function(e){this.props.errorToggle("failed to get user change history",e)}.bind(this)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(un.a,{isOpen:!0,onRequestClose:this.props.viewedByHistoryToggle,style:In},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:this.props.viewedByHistoryToggle}),r.a.createElement("h3",{id:"myModalLabel"},this.props.subjectType," Viewed By")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",overflowY:"auto"}},this.state.historyBody?r.a.createElement(Un,{data:this.state.data}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ha.a,{onClick:this.props.viewedByHistoryToggle},"Done"))))}}]),a}(r.a.Component),Un=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=[],t=this.props.data;for(var a in t.view_history)e.push(r.a.createElement(Wn,{data:t.view_history[a],prop:a}));return r.a.createElement("div",null,e)}}]),a}(r.a.Component),Wn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.data,t=this.props.prop;return r.a.createElement("div",null,r.a.createElement("b",null,t)," at"," ",r.a.createElement(Ia.a,{value:1e3*e.when,format:"MM/DD/YYYY hh:mm:ss a"})," ","from IP: ",e.where)}}]),a}(r.a.Component),Hn=a(188).WithContext,Bn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).toggleNewReadPermission=function(){!1===n.state.readPermissionEntry?n.setState({readPermissionEntry:!0}):!0===n.state.readPermissionEntry&&n.setState({readPermissionEntry:!1})},n.toggleNewModifyPermission=function(){!1===n.state.modifyPermissionEntry?n.setState({modifyPermissionEntry:!0}):!0===n.state.modifyPermissionEntry&&n.setState({modifyPermissionEntry:!1})},n.permissionsfunc=function(e){console.log(e.groups);var t=[],a=[],n=[];for(var r in e.groups){e.groups[r];"read"===r?e.groups[r].forEach((function(e){a.push(e)})):"modify"===r&&e.groups[r].forEach((function(e){t.push(e)}))}return n.push(a),n.push(t),n},n.render=function(){var e=[],t=[],a=n.props.permissionData,i=n.permissionsfunc(a),o=n.props.id,s=n.props.type;if(void 0!==i[0])for(var l=0;l<i[0].length;l++){t.push(r.a.createElement(Vn,{data:i[0][l],dataRead:i[0],dataModify:i[1],updateid:n.props.updateid,id:o,type:s,read_modify:"read",updated:n.props.updated}))}if(void 0!==i[1])for(var c=0;c<i[1].length;c++){e.push(r.a.createElement(Vn,{data:i[1][c],dataRead:i[0],dataModify:i[1],updateid:n.props.updateid,id:o,type:s,read_modify:"modify",updated:n.props.updated}))}return"entry"===s?r.a.createElement("div",{id:"",className:""},r.a.createElement("span",{style:{display:"inline-flex"}},"Read Groups: ",t,n.state.readPermissionEntry?r.a.createElement("span",{style:{display:"inherit",color:"white"}},r.a.createElement(zn,{readUpdate:1,modifyUpdate:0,dataRead:i[0],dataModify:i[1],type:s,updateid:n.props.updateid,id:o,toggleNewReadPermission:n.toggleNewReadPermission,updated:n.props.updated,permissionsToggle:n.props.permissionsToggle})):null,n.state.readPermissionEntry?r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:n.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:n.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,n.state.modifyPermissionEntry?r.a.createElement("span",{style:{display:"inherit",color:"white"}},r.a.createElement(zn,{readUpdate:0,modifyUpdate:1,dataRead:i[0],dataModify:i[1],type:s,updateid:n.props.updateid,id:o,toggleNewModifyPermission:n.toggleNewModifyPermission,updated:n.props.updated,permissionsToggle:n.props.permissionsToggle})):null,n.state.modifyPermissionEntry?r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:n.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:n.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})))):r.a.createElement("div",{id:"",className:"toolbar entry-header-info-null",style:{paddingTop:"0px"}},r.a.createElement("span",{style:{display:"inline-flex",paddingRight:"10px",paddingLeft:"5px"}},r.a.createElement("h4",null,"Permissions:")),"Read Groups: ",t,n.state.readPermissionEntry?r.a.createElement(zn,{readUpdate:1,modifyUpdate:0,dataRead:i[0],dataModify:i[1],type:s,updateid:n.props.updateid,id:o,toggleNewReadPermission:n.toggleNewReadPermission,updated:n.props.updated,permissionsToggle:n.props.permissionsToggle}):null,n.state.readPermissionEntry?r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:n.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:n.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,n.state.modifyPermissionEntry?r.a.createElement(zn,{readUpdate:0,modifyUpdate:1,dataRead:i[0],dataModify:i[1],type:s,updateid:n.props.updateid,id:o,toggleNewModifyPermission:n.toggleNewModifyPermission,updated:n.props.updated,permissionsToggle:n.props.permissionsToggle}):null,n.state.modifyPermissionEntry?r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:n.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:n.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("img",{src:"/images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:n.props.permissionsToggle}))},n.state={readPermissionEntry:!1,modifyPermissionEntry:!1},n}return a}(r.a.Component),Vn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).permissionDelete=function(){var t={},a=[],n=e.props.data,r=e.props.dataRead,i=e.props.dataModify;if("read"===e.props.read_modify){for(var o=0;o<r.length;o++)r[o]!==n&&a.push(r[o]);t.read=a,t.modify=i}else if("modify"===e.props.read_modify){for(var s=0;s<i.length;s++)i[s]!==n&&a.push(i[s]);t.read=r,t.modify=a}X.a.ajax({type:"put",url:"scot/api/v2/"+e.props.type+"/"+e.props.id,data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success")},error:function(e){this.props.errorToggle("error Failed to delete group",e)}.bind(Object(l.a)(e))})},e.render=function(){var t=e.props.data;e.props.type;return r.a.createElement("span",{id:"permission_source",className:"permissionButton"},t,r.a.createElement("span",{className:"fa fa-times permissionButtonClose","aria-hidden":"true",onClick:e.permissionDelete}))},e}return a}(r.a.Component),zn=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleAddition=function(e){var t={},a=n.props.dataRead,r=n.props.dataModify,i=n.props.permissionsToggle;1===n.props.readUpdate?a.push(e.text):1===n.props.modifyUpdate&&r.push(e.text),void 0!==n.props.toggleNewModifyPermission?i=n.props.toggleNewModifyPermission:void 0!==n.props.toggleNewReadPermission&&(i=n.props.toggleNewReadPermission),t.read=a,t.modify=r,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: permission added"),i()},error:function(e){i(),this.props.errorToggle("error Failed to add group",e)}.bind(Object(l.a)(n))})},n.handleInputChange=function(e){},n.handleDelete=function(){},n.handleDrag=function(){},n.state={suggestions:n.props.options,key:n.props.updateid},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this.state.suggestions;return r.a.createElement("span",{className:"tag-new"},r.a.createElement(Hn,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,handleDelete:this.handleDelete,handleDrag:this.handleDrag,minQueryLength:1,customCSS:1}))}}]),a}(r.a.Component),qn=a(495),Kn=a(169),Gn=a.n(Kn),Jn=a(122),Yn=a.n(Jn),Qn=a(197),Xn=a(1045),$n=a(1109),Zn=a(1110),er=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handlePUT=function(){var e=n.props,t=e.enqueueSnackbar,a=e.id,r={body:n.state.editedtext,target_id:n.props.targetid,parent:n.props.parent,target_type:n.props.type,parsed:0},i="/scot/api/v2/entry/".concat(a);Me.a.put(i,r).then(function(){t("Successfully updated entry",{variant:"success"}),this.props.handleClose(),this.props.addedEntry()}.bind(Object(l.a)(n))).catch((function(e){console.log(e),t("Failed updated entry.",{variant:"error"}),this.props.handleClose()}))},n.handleEditorChange=function(e){n.setState({editedtext:e}),console.log("State is now: ".concat(n.state.editedtext))},n.state={editedtext:""},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.setState({editedtext:this.props.localconflict})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement($n.a,{className:e.card},r.a.createElement(Zn.a,null,r.a.createElement(Xn.a,{variant:"h5",component:"h2"},"Uh-oh! It looks like there was a conflict between your ",this.props.type," and the one cached saved on server."),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("div",{id:"remote",className:"remote"},r.a.createElement("b",null,"Changes on server: "),r.a.createElement(Qn.a,{className:"remote",initialValue:this.props.remoteconflict,disabled:!0})),r.a.createElement("br",null),r.a.createElement("div",{id:"local",className:"local"},r.a.createElement("b",null,"Your changes: "),r.a.createElement(Qn.a,{initialValue:this.state.editedtext,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",onEditorChange:this.handleEditorChange,value:this.state.editedtext,init:{selector:"textarea",plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen spellchecker | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote",theme:"modern",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.addButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",onclick:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}))),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(ia.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:this.handlePUT,variant:"contained"},"Send Update to Server"),r.a.createElement(ia.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}]),a}(r.a.Component),tr=Object(hn.withSnackbar)(Object(dt.a)((function(e){return{card:{minWidth:700,marginBottom:20}}}))(er)),ar=a(1132),nr=a(15),rr=a(40).Prompt,ir=a(40).Link,or=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=de("whoami");e&&n.setState({whoami:e}),"Edit"===n.props.entryAction&&X.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+n.props.id,success:function(e){this.setState({content:e.body,asyncContentLoaded:!0,recentlyUpdated:e.updated}),this.forceUpdate()}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Error getting original data from source. Copy/Paste original",e),this.setState({content:"Error getting original data from source. Copy/Paste original",asyncContentLoaded:!0}),this.forceUpdate()}.bind(Object(l.a)(n))}),X()("#not_saved_entry_"+n.state.key).position()&&X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#not_saved_entry_"+n.state.key).position().top)},n.onCancel=function(){n.setState({leaveCatch:!1}),n.props.addedentry(),n.setState({change:!1})},n.submit=function(){if(""===X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").text()&&0===X()("#"+n.state.key+"_ifr").contents().find("#tinymce").find("img").length)alert("Please Add Some Text");else if("Reply"===n.props.entryAction){var e={};X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){X()(t).find("img").each((function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}}))})),e=JSON.stringify({parent:Number(n.props.id),body:X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(n.props.targetid),target_type:n.props.type,tlp:"unset"}),X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(l.a)(n))})}else"Edit"===n.props.entryAction?X.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+n.props.id,success:function(e){this.state.recentlyUpdated!==e.updated?(this.forEdit(!1),this.setState({showConflict:!0,remoteconflict:e.body})):this.forEdit(!0)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to get data for edit",e)}.bind(Object(l.a)(n))}):"alert"===n.props.type?(X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){X()(t).find("img").each((function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}}))})),e=JSON.stringify({body:X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(n.props.targetid),target_type:"alert",tlp:"unset",parent:0}),X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry(),this.props.toggleVisibility()}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(l.a)(n))})):(X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){X()(t).find("img").each((function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}}))})),e={parent:0,body:X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(n.props.targetid),target_type:n.props.type,tlp:"unset"},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(l.a)(n))}))},n.exportContent=function(){if(n.props.recipients.length>0){var e;X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){X()(t).find("img").each((function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}}))})),e=JSON.stringify({body:X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").html(),to:n.props.recipients,thing:n.props.type}),X.a.ajax({type:"post",url:"/scot/api/v2/sendexport",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(){this.setState({leaveCatch:!1}),this.props.exportResponse("success")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to export "+this.props.type,e),this.props.exportResponse("error")}.bind(Object(l.a)(n))})}else n.props.errorToggle("Please enter a valid email address")},n.handleClose=function(){n.setState({showConflict:!1})},n.forEdit=function(e){if(e){X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").each((function(e,t){X()(t).find("img").each((function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}}))}));var t={parent:Number(n.props.parent),body:X()("#tiny_"+n.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(n.props.targetid),target_type:n.props.type,parsed:0};X.a.ajax({type:"put",url:"/scot/api/v2/entry/"+n.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to edit entry.",e)}.bind(Object(l.a)(n))})}},n.handleEditorChange=function(e){n.setState({localcontent:e})},n.render=function(){var e="not_saved_entry_"+n.state.key;return r.a.createElement("div",{id:e,className:"not_saved_entry"},n.state.showConflict?r.a.createElement(ar.a,{fullWidth:!0,maxWidth:"md",open:n.state.showConflict,onClose:n.handleClose,"aria-labelledby":"simple-dialog-title"},r.a.createElement(tr,{targetid:n.props.targetid,type:n.props.type,parent:n.props.parent,addedEntry:n.props.addedentry,id:n.props.id,localconflict:n.state.localcontent,handleClose:n.handleClose,remoteconflict:n.state.remoteconflict})):null,r.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},r.a.createElement("div",{className:"row-fluid entry-header"},r.a.createElement("div",{className:"entry-header-inner"},"[",r.a.createElement(ir,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",n.state.whoami,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Export"===n.props.entryAction?r.a.createElement(nr,{bsSize:"xsmall",onClick:n.exportContent,bsStyle:"success"},"Export"):r.a.createElement(nr,{bsSize:"xsmall",onClick:n.submit,bsStyle:"success"},"Submit"),r.a.createElement(nr,{bsSize:"xsmall",onClick:n.onCancel},"Cancel")))),n.state.asyncContentLoaded?r.a.createElement(Qn.a,{id:n.state.tinyID,className:"inputtext",initialValue:n.state.content,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools",onEditorChange:n.handleEditorChange,init:{table_default_attributes:{border:"5",borderStyle:"solid",borderColor:"blue"},auto_focus:n.state.tinyID,browser_spellcheck:!0,contextmenu:!1,codesample_languages:[{text:"C",value:"c"},{text:"C#",value:"csharp"},{text:"C++",value:"cpp"},{text:"Docker",value:"docker"},{text:"HTTP",value:"http"},{text:"JavaScript",value:"javascript"},{text:"Java",value:"java"},{text:"JSON",value:"json"},{text:"Markdown",value:"md"},{text:"Perl",value:"perl"},{text:"PHP",value:"php"},{text:"Powershell",value:"powershell"},{text:"Python",value:"python"},{text:"Ruby",value:"ruby"},{text:"Bash / Shell",value:"bash"},{text:"Splunk SPL ",value:"splunk-spl"},{text:"Visual Basic",value:"visual-basic"},{text:"HTML/XML",value:"markup"}],plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools codesample",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},paste_postprocess:function(e,t){t.node.querySelectorAll("table").forEach((function(e){e.setAttribute("border","1"),e.setAttribute("cellpadding","1"),e.setAttribute("cellspacing","0")}))},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen  | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote | codesample",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.ui.registry.addMenuButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",fetch:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}):r.a.createElement("div",null,"Loading Editor...")),r.a.createElement(rr,{when:n.state.leaveCatch,message:"Unsubmitted entry detected. You may want to submit or copy the contents of the entry before navigating elsewhere. Click CANCEL to prevent navigation elsewhere."}))};var i,o,c=new Date,d="tiny_"+(c=c.getTime());switch(n.props.entryAction){case"Add":case"Reply":i="",o=!0;break;case"Copy To Entry":i=n.props.content,o=!0;break;case"Edit":i="",o=!1;break;case"Export":i=n.props.content,o=!0;break;default:i="",o=!0}return n.state={tinyID:d,key:c,content:i,asyncContentLoaded:o,leaveCatch:!0,whoami:void 0,recentlyUpdated:0,showConflict:!1,localcontent:""},n}return a}(r.a.Component),sr=a(498),lr=a.n(sr),cr=a(193),dr=a.n(cr),pr=a(336),ur=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).componentWillMount=function(){},n.onLoad=function(){if(void 0!==document.getElementById("iframe_"+n.props.id)&&null!==document.getElementById("iframe_"+n.props.id))if("complete"===document.getElementById("iframe_"+n.props.id).contentDocument.readyState){var e=X()("#iframe_"+n.props.id),t=X()(e).contents(),a=X()(t).find("head");a&&(X()(a).find("link")||a.append(X()("<link/>",{rel:"stylesheet",href:"css/sandbox.css",type:"text/css"}))),setTimeout(function(){void 0!==document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){var e;e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight,e+="px",this.state.height!==e&&this.setState({height:e})}.bind(this))}.bind(Object(l.a)(n)),250)}else setTimeout(n.onLoad,0)},n.componentDidMount=function(){n.setState({isMounted:!0});var e=n.state.tabs,t=n.props.entityvalue;if("source"!==n.props.entitytype)if(void 0===n.state.entityid||isNaN(n.state.entityid))X.a.ajax({type:"GET",url:"scot/api/v2/"+n.props.entitytype+"/byname",data:{name:t},success:function(t){var a=t.id;this.state.isMounted&&(this.setState({entityid:a}),X.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/"+a,success:function(t){var n={data:t,entityid:a,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(n),this.state.isMounted){var r=[];r.push(a),this.setState({tabs:e,currentKey:a,initialLoad:!0,processedIds:r}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to get entity detail id information ",e)}.bind(Object(l.a)(n))});else{var a=n.state.entityid;Array.isArray(a)||(a=[parseInt(a,10)]);for(var r=0;r<a.length;r++)X.a.ajax({type:"GET",url:"scot/api/v2/"+n.props.entitytype+"/"+a[r],success:function(t){var a={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(a),this.state.isMounted){var n=[];n.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:n}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(Object(l.a)(n))})}else{var i={data:n.props.data,entityid:n.props.entityid,entitytype:n.props.entitytype,valueClicked:n.props.entitytype};e.push(i);var o=[];o.push(n.props.entityid),n.setState({tabs:e,currentKey:parseInt(n.props.entityid,10),initialLoad:!0,processedIds:o}),n.props.createCallback(n.props.entityid,n.updated)}X()(document).keydown(function(e){X()("input").is(":focus")||void 0===X()("#main-search-results")[0]&&27===e.keyCode&&(this.props.flairToolbarOff(),e.preventDefault())}.bind(Object(l.a)(n))),n.containerHeightAdjust(),window.addEventListener("resize",n.containerHeightAdjust),n.onLoad(),X()("iframe").each((function(e,t){t.contentWindow.requestAnimationFrame((function(){if(null!=t.contentDocument){var e=X()(t).contents();X()(t.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each((function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)}))}}))}))},n.componentWillUnmount=function(){n.setState({isMounted:!1}),X()(document).off("keydown")},n.componentWillReceiveProps=function(e){n.onLoad();var t={checkForInitialLoadComplete:function(){var a={addNewEntity:function(){var t=this.state.tabs;if("source"!==e.entitytype)void 0===e.entityid||isNaN(e.entityid)?X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/byname",data:{name:e.entityvalue},success:function(a){var n=a.id;this.state.isMounted&&(this.setState({entityid:n}),X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+n,success:function(a){var r={data:a,entityid:n,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(r),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity id detail information",e)}.bind(this)}):X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+e.entityid,success:function(a){var n={data:a,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(n),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)});else{var a={data:e.data,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entitytype};t.push(a);var n=[];n.push(e.entityid),this.setState({tabs:t,currentKey:parseInt(e.entityid,10),initialLoad:!0,processedIds:n}),this.props.createCallback(e.entityid,this.updated),this.props.watcher()}}.bind(this)};if(!1===this.state.initialLoad)setTimeout(t.checkForInitialLoadComplete,50);else if(void 0!==e&&null!=e.entitytype&&void 0!==e.entityid)for(var n=parseInt(e.entityid,10),r=0;r<this.state.tabs.length;r++){if(n===this.state.tabs[r].entityid||"guide"===this.state.tabs[r].entitytype&&"guide"===e.entitytype)return void(this.state.isMounted&&this.setState({currentKey:n}));for(var i=this.state.processedIds,o=!0,s=0;s<i.length;s++)i[s]===n&&(o=!1);o&&(a.addNewEntity(),i.push(n),this.setState({processedIds:i}))}}.bind(Object(l.a)(n))};t.checkForInitialLoadComplete(),n.containerHeightAdjust()},n.updated=function(){for(var e=n.state.tabs,t=(n.props.entityvalue,function(t){var a=t;X.a.ajax({type:"GET",url:"scot/api/v2/"+n.props.entitytype+"/"+e[t].entityid,success:function(t){var n={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e[a]=n,this.state.isMounted){var r=[];r.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:r})}}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to get updated entity detail information",e)}.bind(Object(l.a)(n))})}),a=0;a<e.length;a++)t(a)},n.checkFlairHover=function(e){null!=e.contentDocument&&X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"===X()(t).css("color"))X()(t).data("state","down");else if("down"===X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.props.linkWarningToggle(a)}}.bind(Object(l.a)(n)))},n.initDrag=function(e){if(X()("#dragme").hasClass("entityPopUpMaxSizeDefault")){var t=X()("#dragme").height()+"px";X()("#dragme").css("height",t),X()("#dragme").removeClass("entityPopUpMaxSizeDefault")}var a=document.getElementById("dragme");Qa=e.clientX,Xa=e.clientY,$a=parseInt(document.defaultView.getComputedStyle(a).width,10),Za=parseInt(document.defaultView.getComputedStyle(a).height,10),document.documentElement.addEventListener("mousemove",n.doDrag,!1),document.documentElement.addEventListener("mouseup",n.stopDrag,!1),n.blockiFrameMouseEvent()},n.doDrag=function(e){var t=document.getElementById("dragme");console.log("elem.style.width before: ".concat(t.style.width)),console.log("e.clientX before: ".concat(e.clientX)),console.log("startX before: ".concat(Qa)),console.log("startwidth before: ".concat($a)),$a+e.clientX-Qa>586&&(t.style.width=$a+e.clientX-Qa+"px"),Za+e.clientY-Xa>386&&(t.style.height=Za+e.clientY-Xa+"px")},n.stopDrag=function(e){document.documentElement.removeEventListener("mousemove",n.doDrag,!1),document.documentElement.removeEventListener("mouseup",n.stopDrag,!1),n.allowiFrameMouseEvent()},n.moveDivInit=function(e){document.documentElement.addEventListener("mouseup",n.moveDivStop,!1),n.blockiFrameMouseEvent()},n.moveDivStop=function(e){document.documentElement.removeEventListener("mouseup",n.moveDivStop,!1),n.allowiFrameMouseEvent()},n.blockiFrameMouseEvent=function(){X()("iframe").each((function(e,t){X()(t).addClass("pointerEventsOff")}))},n.allowiFrameMouseEvent=function(){X()("iframe").each((function(e,t){X()(t).removeClass("pointerEventsOff")}))},n.handleSelectTab=function(e){n.setState({currentKey:e})},n.positionRightBoundsCheck=function(e){return e?X()(document).width()-(n.state.defaultEntityOffset.left+e)-n.state.entityWidthint:X()(document).width()-n.state.defaultEntityOffset.left-n.state.entityWidthint},n.containerHeightAdjust=function(){var e;!0===n.props.fullScreen&&(X()("#list-view-container")[0]?(e=X()(window).height()-X()("#list-view-container").height()-X()("#header").height()-70,e+="px"):(e=X()(window).height()-X()("#header").height()-70,e+="px"),n.state.isMounted&&n.setState({height:e}))},n.render=function(){var e,t=[],a="box react-draggable entityPopUp entityPopUpMaxSizeDefault";(!0===n.props.fullScreen||X()("react-draggable-dragged"))&&(a="box react-draggable entityPopUp"),!0===n.props.fullScreen&&(a+=" height100percent");for(var i=0;i<n.state.tabs.length;i++){var o=i+1,s="tab";s="guide"===n.state.tabs[i].entitytype?"guide":"source"===n.state.tabs[i].entitytype?"source":void 0!==n.state.tabs[i].valueClicked?n.state.tabs[i].valueClicked.slice(0,15):"",t.push(r.a.createElement(Yn.a,{className:"tab-content",eventKey:n.state.tabs[i].entityid,title:s},r.a.createElement(hr,{addFlair:n.props.addFlair,data:n.state.tabs[i].data,form:n.props.form,type:n.props.type,id:n.props.id,entityid:n.state.tabs[i].entityid,entitytype:n.state.tabs[i].entitytype,valueClicked:n.state.tabs[i].valueClicked,i:o,key:o,errorToggle:n.props.errorToggle,linkWarningToggle:n.props.linkWarningToggle,createCallback:n.props.createCallback,removeCallback:n.props.removeCallback})))}if(n.state.defaultEntityOffset&&n.state.entityobj){n.positionRightBoundsCheck();e=n.positionRightBoundsCheck(X()(n.state.entityobj).width())<0?n.state.defaultEntityOffset.left-n.state.entityWidthint:n.state.defaultEntityOffset.left+X()(n.state.entityobj).width()}else 50,e=0;return!0===n.props.fullScreen?r.a.createElement("div",{id:"popup-flex-container",style:{height:n.state.height},className:"entity-full-screen"},r.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},r.a.createElement(Gn.a,{className:"tab-content",defaultActiveKey:n.props.entityid,activeKey:n.state.currentKey,onSelect:n.handleSelectTab,bsStyle:"pills",animation:!1},t))):r.a.createElement(lr.a,{handle:"#handle",onMouseDown:n.moveDivInit},r.a.createElement("div",{id:"dragme",className:a,style:{width:n.state.entityWidth,left:e,maxHeight:"90vh"}},r.a.createElement("div",{id:"popup-flex-container",style:{height:"100%",display:"flex",flexFlow:"row"}},r.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},r.a.createElement("div",{id:"handle",style:{width:"100%",background:"#292929",color:"white",fontWeight:"900",fontSize:"large",textAlign:"center",cursor:"move",flex:"0 1 auto"}},r.a.createElement("div",null,r.a.createElement("span",{className:"pull-left",style:{paddingLeft:"5px"}},r.a.createElement("i",{className:"fa fa-arrows","aria-hidden":"true"})),r.a.createElement("span",{className:"pull-right",style:{cursor:"pointer",paddingRight:"5px"}},r.a.createElement("i",{className:"fa fa-times",style:{color:"red"},onClick:n.props.flairToolbarOff})))),r.a.createElement(Gn.a,{className:"tab-content",defaultActiveKey:n.props.entityid,activeKey:n.state.currentKey,onSelect:n.handleSelectTab,bsStyle:"pills",animation:!1},t)),r.a.createElement("div",{id:"sidebar",onMouseDown:n.initDrag,style:{flex:"0 1 auto",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden",width:"5px"}})),r.a.createElement("div",{id:"footer",onMouseDown:n.initDrag,style:{display:"block",height:"5px",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden"}})))};var i="100%",o="700px",c="70vh";return!0===n.props.fullScreen&&(i="95vh",o="95%",c="95vh"),n.state={entityData:null,entityid:n.props.entityid,entityHeight:i,entityWidth:o,entityWidthint:700,entityMaxHeight:c,tabs:[],initialLoad:!1,processedIds:[],valueClicked:"",defaultEntityOffset:n.props.entityoffset,entityobj:n.props.entityobj,height:null,isMounted:!1},n}return a}(r.a.Component),hr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){if("entity"===e.props.entitytype)return r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},r.a.createElement("h4",{id:"myModalLabel"},null!=e.props.data?r.a.createElement(mr,{value:e.props.valueClicked,data:e.props.data,errorToggle:e.props.errorToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair}):r.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading..."))),r.a.createElement("div",{style:{height:"100%",display:"flex",flex:"1 1 auto",marginLeft:"10px",flexFlow:"inherit",minHeight:"1px"}},null!=e.props.data?r.a.createElement(gr,{data:e.props.data,entityid:e.props.entityid,type:e.props.type,id:e.props.id,errorToggle:e.props.errorToggle,linkWarningToggle:e.props.linkWarningToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair}):r.a.createElement("div",null,"Loading...")));if("guide"===e.props.entitytype){var t="/guide/"+e.props.entityid;return r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},r.a.createElement(Ne.Link,{to:t,target:"_blank"},r.a.createElement("h4",{id:"myModalLabel"},null!=e.props.data?r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement(mr,{value:e.props.entityid,errorToggle:e.props.errorToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair})),r.a.createElement("div",null,r.a.createElement(mr,{value:e.props.data.applies_to,errorToggle:e.props.errorToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair}))):r.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading...")))),r.a.createElement("div",{style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=e.props.data?r.a.createElement(br,{entityid:e.props.entityid,form:e.props.form,data:e.props.data,entitytype:e.props.entitytype,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair}):r.a.createElement("div",null,"Loading...")))}return"source"===e.props.entitytype?r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),r.a.createElement("div",{id:"source-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=e.props.entitytype?r.a.createElement(Er,{data:e.props.data,entityid:e.props.entityid,entitytype:e.props.entitytype,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback}):r.a.createElement("div",null,"Loading..."))):"entry"===e.props.entitytype?r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),r.a.createElement("div",{id:"entry-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=e.props.entitytype?r.a.createElement("div",null,r.a.createElement(or,{entryAction:"Add",type:"alert",targetid:e.props.entityid,id:"add_entry",addedentry:e.entryToggle,errorToggle:e.props.errorToggle}),r.a.createElement(oi,{type:"alert",id:e.props.entityid,isPopUp:1,headerData:e.props.data,errorToggle:e.props.errorToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair})):r.a.createElement("div",null,"Loading..."))):void 0},e}return a}(r.a.Component),mr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){if(void 0!==e.props.data){var t="/entity/"+e.props.data.id;return r.a.createElement("div",{className:"flair_header"},r.a.createElement("div",null,r.a.createElement(Ne.Link,{to:t,target:"_blank"},"Entity ",e.props.data.id),r.a.createElement("span",null,"\xa0"),r.a.createElement(Pa,{status:e.props.data.status,id:e.props.data.id,type:"entity",errorToggle:e.props.errorToggle}),r.a.createElement("span",null,"\xa0"),r.a.createElement(Ka,{type:"entity",id:e.props.data.id,string:e.props.value}),r.a.createElement("span",null,"\xa0"),e.props.data.data&&e.props.data.data.scanner&&"true"==e.props.data.data.scanner.active?r.a.createElement("img",{class:"extras",title:"scanner",src:"/images/flair/scanner.png"}):null),r.a.createElement("div",null,r.a.createElement("span",null,e.props.data.type,":"),"\xa0",r.a.createElement("span",null,e.props.value)))}return r.a.createElement("div",{className:"flair_header"},e.props.value)},e}return a}(r.a.Component),gr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateAppearances=function(e){if(null!==e&&0!==e){var t=n.state.appearances+e;n.state.isMounted&&n.setState({appearances:t})}},n.entryToggle=function(){!1===n.state.entryToolbar?n.setState({entryToolbar:!0}):n.setState({entryToolbar:!1})},n.showFullEntityButton=function(){"entity"!==n.props.type&&n.setState({showFullEntityButton:!0})},n.linkOnClickIntercept=function(e){n.props.linkWarningToggle(e.target.id,e.target.dataset.nopop)},n.render=function(){var e=[],t=[],a=[],i=4;if(void 0!==n.props.data){var o=n.props.data.data;for(var s in o)if(void 0!==o[s])if("geoip"===s)a.push(r.a.createElement(Yn.a,{eventKey:i,className:"entityPopUpButtons",style:{overflow:"auto"},title:s},r.a.createElement(yr,{data:o[s].data,type:n.props.type,id:n.props.id,entityData:n.props.data,errorToggle:n.props.errorToggle}))),i++;else if("data"===o[s].type)e.push(r.a.createElement(Yn.a,{eventKey:i,className:"entityPopUpButtons",style:{overflow:"auto"},title:s},r.a.createElement(fr,{dataSource:o[s],type:n.props.type,id:n.props.id,errorToggle:n.props.errorToggle}))),i++;else if("link"===o[s].type&&"Lookup in Likaboss"!==o[s].data.title){var l=!!o[s].data.nopopup;console.log(o[s].data),t.push(r.a.createElement(Ha.a,{bsSize:"xsmall",id:o[s].data.url,"data-nopop":l,onMouseDown:n.linkOnClickIntercept,target:"_blank"},o[s].data.title)),i++}}var c="/entity/"+n.props.entityid;return r.a.createElement(Gn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},r.a.createElement(Yn.a,{eventKey:1,className:"entityPopUpButtons",title:n.state.appearances,style:{height:"100%"}},r.a.createElement("div",null,t),r.a.createElement("div",{style:{maxHeight:"30vh",overflowY:"auto"}},r.a.createElement("span",null,r.a.createElement("b",null,"Appears: ",n.state.appearances," times")),!0===n.state.showFullEntityButton?r.a.createElement("span",{style:{paddingLeft:"5px"}},r.a.createElement(Ne.Link,{to:c,style:{color:"#c400ff"},target:"_blank"},"List truncated due to large amount of references. Click to view the whole entity")):null,r.a.createElement("br",null),r.a.createElement(vr,{entityid:n.props.entityid,updateAppearances:n.updateAppearances,type:n.props.type,showFullEntityButton:n.showFullEntityButton,errorToggle:n.props.errorToggle}),r.a.createElement("br",null)),r.a.createElement("hr",{style:{marginTop:".5em",marginBottom:".5em"}}),r.a.createElement("div",{style:{maxHeight:"50vh",overflowY:"auto"}},r.a.createElement("div",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:n.entryToggle},"Add Entry"),r.a.createElement("br",null)),n.state.entryToolbar?r.a.createElement(or,{entryAction:"Add",type:"entity",targetid:n.props.entityid,id:"add_entry",addedentry:n.entryToggle,errorToggle:n.props.errorToggle}):null,r.a.createElement(oi,{type:"entity",addFlair:n.props.addFlair,id:n.props.entityid,isPopUp:1,errorToggle:n.props.errorToggle,createCallback:n.props.createCallback,removeCallback:n.props.removeCallback}))),a,e)},n.state={loading:"Loading Entries",entryToolbar:!1,appearances:0,showFullEntityButton:!1,isMounted:!1},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}}]),a}(r.a.Component),yr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).copyToEntry=function(){!1===n.state.copyToEntryToolbar?n.setState({copyToEntryToolbar:!0}):n.setState({copyToEntryToolbar:!1})},n.copyToEntity=function(){!1===n.state.copyToEntityToolbar?n.setState({copyToEntityToolbar:!0}):n.setState({copyToEntityToolbar:!1})},n.state={copyToEntryToolbar:!1,copyToEntityToolbar:!1},n}return Object(C.a)(a,[{key:"render",value:function(){var e=[],t=[];for(var a in t.push("<table>"),this.props.data){var n=this.props.data[a];e.push(r.a.createElement("tr",null,r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},r.a.createElement("b",null,a)),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},this.props.data[a]))),t.push('<tr><td style={{paddingRight:"4px", paddingLeft:"4px"}}><b>'+a+'</b></td><td style={{paddingRight:"4px", paddingLeft:"4px"}}>'+n+"</td></tr>")}t.push("</table>");var i=t.join("");return r.a.createElement("div",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.copyToEntity},"Copy to ",r.a.createElement("b",null,"entity")," entry"),"alertgroup"!==this.props.type?r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.copyToEntry},"Copy to"," ",r.a.createElement("b",null,this.props.type," ",this.props.id)," ","entry"):null,this.state.copyToEntryToolbar?r.a.createElement(or,{entryAction:"Copy To Entry",type:this.props.type,targetid:this.props.id,id:this.props.id,addedentry:this.copyToEntry,content:i,errorToggle:this.props.errorToggle}):null,this.state.copyToEntityToolbar?r.a.createElement(or,{entryAction:"Copy To Entry",type:"entity",targetid:this.props.entityData.id,id:this.props.entityData.id,addedentry:this.copyToEntity,content:i,errorToggle:this.props.errorToggle}):null,r.a.createElement("div",{className:"entityTableWrapper"},r.a.createElement("table",{className:"tablesorter entityTableHorizontal",id:"sortableentitytable",width:"100%"},e)))}}]),a}(r.a.Component),fr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.dataSource;return r.a.createElement("div",{style:{overflowY:"auto",maxHeight:"70vh"}},r.a.createElement("div",null,r.a.createElement(qn.a,{data:e,expandLevel:4})))}}]),a}(r.a.Component),vr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.setState({isMounted:!0});["incident","event","intel","guide","signature","alert","dispatch","product"].forEach(function(e){var t=[],a=[],n=[],r=[];ca("scot/api/v2/entity/".concat(this.props.entityid,"/").concat(e)).then(function(i){var o=i.data.records;this.props.updateAppearances(o.length),o.forEach(function(i){i.type=e,"open"===i.status?t.push(i):"closed"===i.status?a.push(i):"promoted"===i.status?n.push(i):r.push(i)}.bind(this)),t.sort(this.compareUpdatedDate),a.sort(this.compareUpdatedDate),n.sort(this.compareUpdatedDate),r.sort(this.compareUpdatedDate);var s=this.state.loadingType;s[e]=!1,this.setState({entityReferencesData:[].concat(Object(T.a)(this.state.entityReferencesData),n,t,a,r),loadingType:s})}.bind(this))}.bind(Object(l.a)(n))),n.state.entityReferencesData.length>0&&n.props.showFullEntityButton()},n.componentDidUpdate=function(){},n.componentWillUnmount=function(){n.setState({isMounted:!1})},n.compareUpdatedDate=function(e,t){return e.updated>t.updated?-1:1},n.render=function(){var e=n.state.loading;n.state.loadingSignature||n.state.loadingEvents||n.state.loadingAlerts||n.state.loadingIncidents||n.state.loadingIncidents||(e=!1);n.props.entityid;return n.state.entityReferencesData.length>0&&(console.log("got data"),console.log(n.state.entityReferencesData),n.state.entityReferencesData.length),r.a.createElement("div",null,e?r.a.createElement("span",null,"Loading: ",n.state.loadingAlerts?r.a.createElement("span",null,"Alerts "):null,n.state.loadingEvents?r.a.createElement("span",null,"Events "):null,n.state.loadingIncidents?r.a.createElement("span",null,"Incidents "):null,n.state.loadingIntel?r.a.createElement("span",null,"Intel "):null,n.state.loadingSignature?r.a.createElement("span",null,"Signature "):null):null,r.a.createElement(pr.a,null,r.a.createElement(qt.a,{className:"-striped -highlight",data:n.state.entityReferencesData,columns:[{Header:"Status",accessor:"status",width:79,Cell:function(e){var t="";return void 0===e.original.status?r.a.createElement("div",null,"N/A"):"closed"===e.original.status?r.a.createElement("span",{style:{color:"green"}},e.original.status):"open"===e.original.status?r.a.createElement("span",{style:{color:"red"}},e.original.status):"promoted"===e.original.status?("alert"===e.original.type?t="/#/event/".concat(e.original.promotion_id):"event"===e.original.type?t="/#/incident/".concat(e.original.promotion_id):"dispatch"===e.original.type?t="/#/intel/".concat(e.original.promotion_id):"intel"===e.original.type&&(t="/#/product/".concat(e.original.promotion_id)),r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(H.a,{bsSize:"xsmall",bsStyle:"warning",href:t,target:"_blank",style:{lineHeight:"12pt",fontSize:"10pt",marginLeft:"auto"}},e.original.status))):void 0}},{Header:"ID",accessor:"id",width:85,Cell:function(e){if(e.original.id)return r.a.createElement(Ne.Link,{to:"/".concat(e.original.type,"/").concat(e.original.id),target:"_blank"},e.original.id)}},{Header:"type",accessor:"type",width:50},{Header:"Entries",accessor:"entry_count",width:66},{Header:"subject",accessor:"subject"},{Header:"updated",accessor:"updated",width:121,Cell:function(e){var t="Unknown";return void 0!==e.original.updated&&(t=Math.floor((Math.round((new Date).getTime()/1e3)-e.original.updated)/86400)),r.a.createElement("span",null,t," days ago")}}],minRows:0,sortable:!0})))};var i=100;return"entity"===n.props.type&&(i=void 0),n.state={entityReferencesData:[],maxRecords:i,loadingType:{alert:!0,event:!0,incident:!0,dispatch:!0,intel:!0,product:!0,signature:!0,guide:!0},loading:!0,isMounted:!1,order:"asc",orderBy:"id"},n}return a}(r.a.Component),br=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).entryToggle=function(){!1===n.state.entryToolbar?n.setState({entryToolbar:!0}):n.setState({entryToolbar:!1})},n.state={entryToolbar:!1},n}return Object(C.a)(a,[{key:"render",value:function(){return r.a.createElement(Gn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"pills"},r.a.createElement(Yn.a,{eventKey:1,style:{overflow:"auto",maxHeight:"70vh"}},r.a.createElement("div",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.entryToggle},"Add Entry"),r.a.createElement("br",null)),this.state.entryToolbar?r.a.createElement(or,{entryAction:"Add",type:"guide",targetid:this.props.entityid,id:"add_entry",addedentry:this.entryToggle,errorToggle:this.props.errorToggle}):null,r.a.createElement(oi,{addFlair:this.props.addFlair,type:"guide",form:this.props.form,id:this.props.entityid,isPopUp:1,headerData:this.props.data,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback})))}}]),a}(r.a.Component),Er=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Source"),r.a.createElement(Gn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},r.a.createElement(Yn.a,{eventKey:1,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Rendered"},r.a.createElement(dr.a,{style:{width:"100%"},head:r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",height:"500px"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body}}))),r.a.createElement(Yn.a,{eventKey:2,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Raw Text"},r.a.createElement(dr.a,{head:r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),style:{width:"100%"},frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",styleSheets:["/css/sandbox.css"],height:"500px"},">",r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body_plain}})))))}}]),a}(r.a.Component),kr=a(501),wr=a.n(kr),Sr=a(509),Tr=a(15),Cr=a(40).Link,xr=[],jr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onCancel=function(){xr=[],n.props.fileUploadToggle()},n.Close=function(e){for(var t=0;t<xr.length;t++)e.target.id===xr[t].name&&xr.splice(t,1);n.setState({files:xr})},n.onDrop=function(e){for(var t=0;t<e.length;t++)xr.push(e[t]);console.log(e),n.setState({files:xr})},n.submit=function(){if(xr.length>0)for(var e=0;e<xr.length;e++){var t=new FormData;t.append("upload",xr[e]),t.append("target_type",n.props.type),t.append("target_id",Number(n.props.targetid)),null!=n.props.entryid&&t.append("entry_id",n.props.entryid);var a=new XMLHttpRequest;a.addEventListener("progress",n.uploadProgress),a.addEventListener("load",n.uploadComplete),a.addEventListener("error",n.uploadFailed),a.addEventListener("abord",n.uploadCancelled),a.open("POST","/scot/api/v2/file"),console.log(t),a.send(t)}else alert("Select a file to upload before submitting.")},n.uploadComplete=function(){n.onCancel()},n.uploadFailed=function(){n.props.errorToggle("An error occured. Upload failed.")},n.state={files:[],edit:!1,stagecolor:"#000",enable:!0,addentry:!0,saved:!0,enablesave:!0,whoami:void 0},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=de("whoami");e&&this.setState({whoami:e}),X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#not_saved_entry_"+this.props.id).position().top)}},{key:"render",value:function(){var e="not_saved_entry_"+this.props.id;return r.a.createElement("div",{id:e},r.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},r.a.createElement("div",{className:"row-fluid entry-header"},r.a.createElement("div",{className:"entry-header-inner"},"[",r.a.createElement(Cr,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",this.state.whoami,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},r.a.createElement(Tr,{bsSize:"xsmall",onClick:this.submit},"Submit"),r.a.createElement(Tr,{bsSize:"xsmall",onClick:this.onCancel},"Cancel")))),r.a.createElement(Sr.a,{onDrop:this.onDrop},(function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",Object.assign({style:{"border-width":"2px","border-color":"#000","border-radius":"4px","border-style":"dashed","text-align":"center","background-color":"azure"}},t()),r.a.createElement("input",a()),r.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")))})),this.state.files?r.a.createElement("div",null," ",this.state.files.map(function(e){return r.a.createElement("ul",{style:{"list-style-type":"none",margin:"0",padding:"0"}},r.a.createElement("li",null,r.a.createElement("p",{style:{display:"inline"}},e.name),r.a.createElement("button",{style:{"line-height":"1px"},className:"btn btn-info",id:e.name,onClick:this.Close},"x")))}.bind(this))):null))}}]),a}(r.a.Component),Or=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).toggle=function(){var e;1===n.props.summary?e="entry":0===n.props.summary&&(e="summary");var t={class:e};X.a.ajax({type:"put",url:"scot/api/v2/entry/"+n.props.entryid,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make summary",e)}.bind(Object(l.a)(n))})},n.render=function(){var e,t="Summary Loading...";return 0===n.props.summary?(t="Make Summary",e=n.toggle):1===n.props.summary&&(t="Remove Summary",e=n.toggle),r.a.createElement("span",{style:{display:"block"},onClick:e},t)},n.state={key:n.props.id},n}return a}(r.a.Component),Dr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=de("whoami");n.setState({whoami:e})},n.makeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+n.props.entryid,data:JSON.stringify({make_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(Object(l.a)(n))})},n.closeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+n.props.entryid,data:JSON.stringify({close_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(Object(l.a)(n))})},n.takeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+n.props.entryid,data:JSON.stringify({take_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make Task owner",e)}.bind(Object(l.a)(n))})},n.render=function(){var e,t="Task Loading...";return"task"===n.props.taskData.class?void 0===n.props.taskData.metadata.task.status||null===n.props.taskData.metadata.task.status||"task"!==n.props.taskData.class?(t="Make Task",e=n.makeTask):n.state.whoami!==n.props.taskData.metadata.task.who&&"open"===n.props.taskData.metadata.task.status?(t="Assign task to me",e=n.takeTask):n.state.whoami===n.props.taskData.metadata.task.who&&"open"===n.props.taskData.metadata.task.status?(t="Close Task",e=n.closeTask):"closed"===n.props.taskData.metadata.task.status||"completed"===n.props.taskData.metadata.task.status?(t="Reopen Task",e=n.makeTask):n.state.whoami===n.props.taskData.metadata.task.who&&"assigned"===n.props.taskData.metadata.task.status?(t="Close Task",e=n.closeTask):n.state.whoami!==n.props.taskData.metadata.task.who&&"assigned"===n.props.taskData.metadata.task.status&&(t="Assign task to me",e=n.takeTask):(t="Make Task",e=n.makeTask),r.a.createElement("span",{style:{display:"block"},onClick:e},t)},n.state={whoami:void 0},n}return a}(r.a.Component),Nr={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},_r=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).proceed=function(){window.open(e.props.link,"_blank").opener=null,e.props.linkWarningToggle()},e.apiOnly=function(){e.props.linkWarningToggle(),fetch(e.props.link),alert("Request Submitted. Refresh entity display to see results")},e.componentWillMount=function(){if("true"!==e.props.nopop){var t=window.location.href,a=new RegExp(/((https?|ftp):\/\/[a-zA-Z0-9\-_\.]+\.)?([a-zA-Z0-9\-_\.]+\.([a-zA-Z]{1,63}))/,"i"),n=e.props.link.match(a),r=t.match(a);if(void 0!=n&&void 0!=r)n[3]===r[3]&&e.proceed();else void 0==n&&e.proceed()}else e.apiOnly()},e.render=function(){return r.a.createElement("div",null,r.a.createElement(un.a,{isOpen:!0,onRequestClose:e.props.linkWarningToggle,style:Nr},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:e.props.linkWarningToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Browse to site?")),r.a.createElement("div",{className:"modal-body"},"The link you clicked may take you to a site outside SCOT. If this is a link an attacker controls you may be tipping your hand.",r.a.createElement("br",null),r.a.createElement("b",null,e.props.link)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ha.a,{id:"cancel-delete",onClick:e.props.linkWarningToggle},"Cancel"),r.a.createElement(Ha.a,{bsStyle:"info",id:"proceed",onClick:e.proceed},"Proceed"))))},e}return a}(r.a.Component),Ar=(a(311),a(331)),Mr=a.n(Ar),Lr=(a(919),a(920),a(921),a(922),a(923),a(924),a(925),a(926),a(927),a(928),a(930),a(931),a(932),a(933),a(934),a(935),a(936),a(937),a(938),a(939),a(940),a(941),a(942),a(943),a(944),a(945),a(946),a(947),function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.setState({value:e})},n.submitSigBody=function(e){var t="scot/api/v2/sigbody/";n.state.viewVersionid;"put"==n.state.ajaxType&&(t="scot/api/v2/sigbody/"+n.state.viewSigBodyid),X.a.ajax({type:n.state.ajaxType,url:t,data:JSON.stringify({signature_id:parseInt(n.props.id),body:n.state.value}),contentType:"application/json; charset=UTF-8",success:function(e){var t;console.log("successfully changed signature data"),t=void 0==e.revision?this.state.viewVersionid:e.revision,this.setState({readOnly:!0,cursorEnabledDisabled:"cursorDisabled",ajaxType:null,viewVersionid:t,viewSigBodyid:e.id})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to create/update sigbody",e)}.bind(Object(l.a)(n))})},n.componentWillReceiveProps=function(e){n.setState({signatureData:e.headerData})},n.editSigBody=function(e){n.setState({readOnly:!1,lastViewVersionid:n.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"put"})},n.createNewSigBody=function(){n.setState({readOnly:!1,viewVersionid:null,lastViewVersionid:n.state.viewVersionid,value:"",cursorEnabledDisabled:"cursorEnabled",ajaxType:"post"})},n.createNewSigBodyFromSig=function(){n.setState({readOnly:!1,lastViewVersionid:n.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"post",viewVersionid:null})},n.Cancel=function(){var e="";0!==Object.keys(n.state.signatureData.version).length&&void 0!=n.state.signatureData.version[n.state.signatureData.prod_sigbody_id]&&(e=n.state.signatureData.version[n.state.lastViewVersionid].body),n.setState({readOnly:!0,value:e,viewVersionid:n.state.lastViewVersionid,cursorEnabledDisabled:"cursorDisabled",ajaxType:null})},n.viewSigBody=function(e){!0===n.state.readOnly&&n.setState({value:n.state.signatureData.version[e.target.id].body,viewVersionid:e.target.id,viewSigBodyid:e.target.viewSigBodyid})},n.keyboardHandlerUpdate=function(e){Dt("signatureKeyboardHandler",e.target.text,1e3),n.setState({currentKeyboardHandler:e.target.text})},n.languageModeUpdate=function(e){Dt("signatureLanguageMode",e.target.text,1e3),n.setState({currentLanguageMode:e.target.text})},n.editorThemeUpdate=function(e){Dt("signatureEditorTheme",e.target.text,1e3),n.setState({currentEditorTheme:e.target.text})};var r=new Date;r=r.getTime();var i,o="",c="none",d="java",p="github",u=n.props.headerData.prod_sigbody_id;if(void 0!=xt("signatureKeyboardHandler")&&(c=xt("signatureKeyboardHandler")),void 0!=xt("signatureLanguageMode")&&(d=xt("signatureLanguageMode")),void 0!=xt("signatureEditorTheme")&&(p=xt("signatureEditorTheme")),0!==Object.keys(n.props.headerData.version).length)if(void 0!=n.props.headerData.version[n.props.headerData.prod_sigbody_id]||0==n.props.headerData.version[n.props.headerData.prod_sigbody_id])o=n.props.headerData.version[n.props.headerData.prod_sigbody_id].body,i=n.props.headerData.version[n.props.headerData.prod_sigbody_id].id;else for(var h in n.props.headerData.version)h<u||(u=h,o=n.props.headerData.version[h].body,i=n.props.headerData.version[h].id);return n.state={readOnly:!0,value:o,signatureData:n.props.headerData,loaded:!0,viewSigBodyid:i,viewVersionid:u,lastViewVersionid:null,key:r,cursorEnabledDisabled:"cursorDisabled",keyboardHandlers:["none","vim","emacs"],currentKeyboardHandler:c,languageModes:["bro","csharp","c_cpp","html","javascript","java","json","markdown","mysql","perl","powershell","python","ruby","sass","xml","yaml"],currentLanguageMode:d,editorThemes:["github","monokai","kuroir","solarized_dark","solarized_light","terminal","textmate","tomorrow","twilight","xcode"],currentEditorTheme:p,ajaxType:null},n}return Object(C.a)(a,[{key:"render",value:function(){var e=[],t=[],a=[],n=[],i="not_saved_signature_entry_"+this.state.key,o=this.state.currentKeyboardHandler,s=[],l=0;if(0!==Object.keys(this.state.signatureData).length&&0!==Object.keys(this.state.signatureData.version).length)for(var c in this.state.signatureData.version){var d=this.state.signatureData.version[c].revision,p=this.state.signatureData.version[c].revision,u=this.state.signatureData.version[c].id;this.state.signatureData.prod_sigbody_id==d?p=d+" - Production":this.state.signatureData.qual_sigbody_id==d&&(p=d+" - Quality");var h=void 0;h=1!=this.state.readOnly,e.push(r.a.createElement(E.a,{id:d,key:d,onClick:this.viewSigBody,eventKey:d,viewSigBodyid:u,bsSize:"xsmall",disabled:h},p)),d>l&&(l=d)}if(void 0!=this.state.keyboardHandlers)for(var m=0;m<this.state.keyboardHandlers.length;m++)t.push(r.a.createElement(E.a,{id:m,key:m,onClick:this.keyboardHandlerUpdate,eventKey:m,bsSize:"xsmall"},this.state.keyboardHandlers[m]));if("none"==this.state.currentKeyboardHandler&&(o=null),void 0!=this.state.languageModes)for(var g=0;g<this.state.languageModes.length;g++)a.push(r.a.createElement(E.a,{id:g,key:g,onClick:this.languageModeUpdate,eventKey:g,bsSize:"xsmall"},this.state.languageModes[g]));if(void 0!=this.state.editorThemes)for(var y=0;y<this.state.editorThemes.length;y++)n.push(r.a.createElement(E.a,{id:y,key:y,onClick:this.editorThemeUpdate,eventKey:y,bsSize:"xsmall"},this.state.editorThemes[y]));return this.state.signatureData.prod_sigbody_id==this.state.viewVersionid?s.push(r.a.createElement("span",{className:"signature_production_color"},this.state.viewVersionid," - Production")):this.state.signatureData.qual_sigbody_id==this.state.viewVersionid?s.push(r.a.createElement("span",{className:"signature_quality_color"},this.state.viewVersionid," - Quality")):s.push(r.a.createElement("span",null,this.state.viewVersionid)),r.a.createElement("div",{id:"signatureDetail",className:"signatureDetail"},this.state.loaded?r.a.createElement("div",null,r.a.createElement(Pr,{signatureData:this.state.signatureData,type:this.props.type,id:this.props.id,currentLanguageMode:this.state.currentLanguageMode,currentEditorTheme:this.state.currentEditorTheme,currentKeyboardHandlerApplied:o,errorToggle:this.props.errorToggle,showSignatureOptions:this.props.showSignatureOptions}),r.a.createElement("div",{id:i,className:"not_saved_signature_entry"},r.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",{className:"row-fluid signature-entry-header"},r.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Body: ",s,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Editor Theme:",r.a.createElement(Sn.a,{bsSize:"xsmall",title:this.state.currentEditorTheme,id:"bg-nested-dropdown",style:{marginRight:"10px"}},n),"Language Handler:",r.a.createElement(Sn.a,{bsSize:"xsmall",title:this.state.currentLanguageMode,id:"bg-nested-dropdown",style:{marginRight:"10px"}},a),"Keyboard Handler:",r.a.createElement(Sn.a,{bsSize:"xsmall",title:this.state.currentKeyboardHandler,id:"bg-nested-dropdown",style:{marginRight:"10px"}},t),"Signature Body Version:",r.a.createElement(Sn.a,{bsSize:"xsmall",title:s,id:"bg-nested-dropdown",style:{marginRight:"10px"}},e),this.state.readOnly?r.a.createElement("span",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.createNewSigBody,bsStyle:"success"},"Create new version"),0!=this.state.viewVersionid?r.a.createElement("span",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.createNewSigBodyFromSig},"Create new version using this base"),r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.editSigBody},"Update displayed version")):null):r.a.createElement("span",null,r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.submitSigBody},"Submit"),r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:this.Cancel},"Cancel"))))),r.a.createElement(Mr.a,{mode:this.state.currentLanguageMode,theme:this.state.currentEditorTheme,onChange:this.onChange,name:"signatureEditor",editorProps:{$blockScrolling:!0},keyboardHandler:o,value:this.state.value,width:"100%",maxLines:50,minLines:10,readOnly:this.state.readOnly,className:this.state.cursorEnabledDisabled,showPrintMargin:!1})))):r.a.createElement("div",null,"Loading Signature Data..."))}}]),a}(r.a.Component)),Pr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).submitMetaData=function(e){var t=e.target.id,a=e.target.value;if("options"==t||"target"==t){try{a=JSON.parse(a)}catch(o){return void n.props.errorToggle("Failed to convert string to object. Try adding quotation marks around the key and values")}var r=typeof a;if("object"!==r)return void n.props.errorToggle("options need to be an object but were detected as: "+r)}var i={};i[t]=a,X.a.ajax({type:"put",url:"scot/api/v2/signature/"+n.props.id,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully changed signature data")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to update signature metadata",e)}.bind(Object(l.a)(n))})},n.onOptionsChange=function(e){n.setState({optionsValue:e})},n.state={optionsValue:JSON.stringify(n.props.signatureData.options)},n}return Object(C.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.showSignatureOptions?r.a.createElement("div",{id:"signatureTable2",className:"signatureTableOptions"},r.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",{className:"row-fluid signature-entry-header"},r.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Options",r.a.createElement(Ha.a,{type:"submit",bsSize:"xsmall",bsStyle:"success",onClick:this.submitMetaData,id:"options",value:this.state.optionsValue},"Apply"))),r.a.createElement(Mr.a,{mode:"json",theme:this.props.currentEditorTheme,onChange:this.onOptionsChange,name:"signatureEditorOptions",editorProps:{$blockScrolling:!0},keyboardHandler:this.props.currentKeyboardHandlerApplied,value:this.state.optionsValue,minLines:10,maxLines:25,width:"100%",readOnly:!1,showPrintMargin:!1}))):null)}}]),a}(r.a.Component),Fr=(r.a.Component,a(500)),Ir=a.n(Fr),Rr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={suggestions:[],value:""},n.HandleAdd=n.HandleAdd.bind(Object(l.a)(n)),n.HandleInputChange=n.HandleInputChange.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.value&&this.setState({value:this.props.value})}},{key:"HandleAdd",value:function(e){this.setState({value:e}),this.props.OnChange(e)}},{key:"HandleInputChange",value:function(e){if(this.props.OnChange(e.target.value),this.setState({value:e.target.value}),e.target&&e.target.value.length>=1){var t=[];X.a.ajax({type:"get",url:"/scot/api/v2/ac/"+this.props.type+"/"+e.target.value,success:function(e){e=e.records;for(var a=0;a<e.length;a++)if("string"===typeof e[a]){var n={};n.label=e[a],t.push(n)}this.setState({suggestions:t})}.bind(this),error:function(){console.log("failed to get autocomplete data")}})}}},{key:"render",value:function(){return r.a.createElement("div",{className:"AutoCompleteInput"},r.a.createElement(Ir.a,{getItemValue:function(e){return e.label},items:this.state.suggestions,renderItem:function(e,t){return r.a.createElement("div",{style:{background:t?"lightgray":"white"}},e.label)},value:this.state.value,onChange:this.HandleInputChange,onSelect:this.HandleAdd,menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",overflow:"auto",maxHeight:"200px",top:"unset",left:"unset",position:"absolute"},inputProps:{style:{width:"100%"}},wrapperProps:{style:{width:"300px"}}}))}}]),a}(n.Component),Ur=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).HasSpacesCheck=function(e){!0===/\s/g.test(e)?n.setState({multiword:"yes"}):n.setState({multiword:"no"})},n.GetCount=function(){n.setState({countLoading:!0});var e=encodeURIComponent(n.state.match);X.a.ajax({type:"get",url:"/scot/api/v2/hitsearch?match="+e,success:function(e){this.setState({count:e.count,countLoading:!1})}.bind(Object(l.a)(n)),error:function(e){this.setState({count:"unable to get count",countLoading:!1})}.bind(Object(l.a)(n))})},n.Confirmation=function(){!1===n.state.confirmation?(n.GetCount(),n.setState({confirmation:!0})):n.setState({confirmation:!1,value:""})},n.Submit=function(){var e={value:n.state.value,match:n.state.match,status:"active",entry_id:n.props.reparseEntryId,options:{multiword:n.state.multiword}};X.a.ajax({type:"POST",url:"/scot/api/v2/entitytype",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.props.ToggleCreateEntity()}.bind(Object(l.a)(n)),error:function(e){e.responseJSON.error_msg?this.props.errorToggle("failed to create user defined entity: error_message: "+e.responseJSON.error_msg,e):this.props.errorToggle("failed to create user defined entity",e)}.bind(Object(l.a)(n))})},n.OnChangeMatch=function(e){n.setState({match:e.target.value}),n.HasSpacesCheck(e.target.value)},n.OnChangeValue=function(e){n.setState({value:e})},n.state={value:"",match:"",userdef:!0,status:"tracked",multiword:"yes",confirmation:!1,countLoading:!1},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.match&&this.setState({match:this.props.match}),this.mounted=!0}},{key:"componentDidMount",value:function(){this.HasSpacesCheck(this.props.match)}},{key:"componentWillUnmount",value:function(){X()(document).unbind("keypress"),this.mounted=!1}},{key:"render",value:function(){return r.a.createElement(q.a,{dialogClassName:"entity-create-modal",show:this.props.modalActive,onHide:this.props.ToggleCreateEntity},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,this.state.confirmation?r.a.createElement("span",null,"Confirm and submit user defined entity"):r.a.createElement("span",null,"Create a user defined entity"))),r.a.createElement(q.a.Body,null,this.state.confirmation?r.a.createElement("span",null,r.a.createElement("div",null,"Entity Name: ",r.a.createElement("b",null,this.state.match)),r.a.createElement("div",null,"Entity Type: ",r.a.createElement("b",null,this.state.value)),r.a.createElement("div",null,"Multiword: ",r.a.createElement("b",null,this.state.multiword))):r.a.createElement("span",null,r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("span",{style:{width:"150px"}},r.a.createElement("b",null,"New Entity Name:")),r.a.createElement("span",{style:{width:"300px"}},r.a.createElement("input",{type:"tag",onChange:this.OnChangeMatch,value:this.state.match,style:{width:"100%"}}))),r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("span",{style:{width:"150px"}},r.a.createElement("b",null,"Entity Type:")),r.a.createElement("span",null,r.a.createElement(Rr,{type:"entitytype",OnChange:this.OnChangeValue,value:this.state.value}))))),r.a.createElement(q.a.Footer,null,this.state.confirmation?r.a.createElement("span",null,r.a.createElement("span",{style:{color:"red",float:"left"}},this.state.countLoading?r.a.createElement("span",null,"Count: is loading..."):r.a.createElement("span",null,"Count: ",this.state.count)),r.a.createElement("span",null,r.a.createElement(H.a,{onClick:this.Submit,bsStyle:"success"},"Submit"),r.a.createElement(H.a,{onClick:this.Confirmation},"Go Back"))):r.a.createElement("span",null,this.state.value.length>=1&&this.state.match.length>=1?r.a.createElement(H.a,{onClick:this.Confirmation,bsStyle:"primary",type:"submit",active:!0},"Continue"):null,r.a.createElement(H.a,{onClick:this.props.ToggleCreateEntity},"Cancel"))))}}]),a}(n.Component),Wr=a(251),Hr=a.n(Wr),Br=a(1131),Vr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onChange=function(t){var a=t.target.id,n=t.target.value,r={};r["data."+a]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+e.props.type+"/"+e.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data"),this.forceUpdate()}.bind(Object(l.a)(e)),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(Object(l.a)(e))})},e}return Object(C.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.headerData!==e.headerData}},{key:"render",value:function(){var e=[],t=[],a=[],n=[],i=[],o=[],s=[],l=this.props.form[this.props.headerData.data_fmt_ver];if(l)for(var c=0;c<l.length;c++){var d=l[c].value,p=l[c].value_type.url;switch(p&&(p=p.replace("%s",this.props.id)),l[c].value_type.key.split(".").reduce((function(e,t){return e[t]}),this.props.headerData.data)&&(d=l[c].value_type.key.split(".").reduce((function(e,t){return e[t]}),this.props.headerData.data)),l[c].type){case"dropdown":"static"==l[c].value_type.type?t.push(r.a.createElement(zr,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,value:d,dropdownValues:l[c].value,help:l[c].help})):t.push(r.a.createElement(zr,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help}));break;case"input":"static"==l[c].value_type.type?n.push(r.a.createElement(qr,{onBlur:this.onChange,value:d,id:l[c].key,label:l[c].label,help:l[c].help})):n.push(r.a.createElement(qr,{onBlur:this.onChange,id:l[c].key,label:l[c].label,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help}));break;case"calendar":if("static"==l[c].value_type.type){var u=1e3*d;a.push(r.a.createElement(Kr,{typeTitle:l[c].label,value:u,typeLower:l[c].key,type:this.props.type,id:this.props.id,help:l[c].help}))}else a.push(r.a.createElement(Kr,{typeTitle:l[c].label,typeLower:l[c].key,type:this.props.type,id:this.props.id,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"textarea":"static"==l[c].value_type.type?i.push(r.a.createElement(Gr,{id:l[c].key,value:d,onBlur:this.onChange,label:l[c].label,help:l[c].help})):i.push(r.a.createElement(Gr,{id:l[c].key,onBlur:this.onChange,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"input_multi":"static"==l[c].value_type.type?o.push(r.a.createElement(Jr,{id:l[c].key,value:d,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:l[c].label,help:l[c].help})):o.push(r.a.createElement(Jr,{id:l[c].key,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"boolean":"static"==l[c].value_type.type?s.push(r.a.createElement(Yr,{id:l[c].key,value:d,onChange:this.onChange,label:l[c].label,help:l[c].help})):s.push(r.a.createElement(Yr,{id:l[c].key,onChange:this.onChange,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"multi_select":"static"==l[c].value_type.type?e.push(r.a.createElement(Qr,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,value:d,dropdownValues:l[c].value,help:l[c].help,mainType:this.props.type,mainId:this.props.id})):e.push(r.a.createElement(Qr,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help,mainType:this.props.type,mainId:this.props.id}))}}return r.a.createElement("div",null,l?r.a.createElement("div",{className:"custom-metadata-table container"},r.a.createElement("div",{className:"row"},t,a,n,i,o,s,e)):null)}}]),a}(r.a.Component),zr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=[],a="",n=this.props.referenceKey;if("qual_sigbody_id"==n||"prod_sigbody_id"==n)for(var i in t.push(r.a.createElement("option",null,"0")),e.version)e.version[i].revision==e.data[n]&&(a=e.data[n]),t.push(r.a.createElement("option",null,e.version[i].revision));else for(var o=0;o<e[this.props.referenceKey].length;o++)1==e[this.props.referenceKey][o].selected&&(a=e[this.props.referenceKey][o].value),t.push(r.a.createElement("option",null,e[this.props.referenceKey][o].value));this.setState({selected:a,options:t})}.bind(Object(l.a)(n))})},n.onChange=function(e){n.props.onChange(e),n.setState({selected:e.target.value})},n.state={selected:null,options:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){if(this.props.dynamic)this.getDynamic();else{for(var e=[],t="",a=0;a<this.props.dropdownValues.length;a++)this.props.value==this.props.dropdownValues[a].value&&(t=this.props.value),e.push(r.a.createElement("option",null,this.props.dropdownValues[a].value));this.setState({selected:t,options:e})}}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({selected:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("select",{id:this.props.id,value:this.state.selected,onChange:this.onChange},this.state.options)),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),qr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t;t=e[this.props.referenceKey],this.setState({value:t})}.bind(Object(l.a)(n))})},n.inputOnChange=function(e){n.setState({value:e.target.value})},n.state={value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value})),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Kr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=1e3*e[this.props.referenceKey];this.setState({value:t,loading:!1})}.bind(Object(l.a)(n))})},n.onChange=function(e){var t="data."+n.props.typeLower,a=e._d.getTime()/1e3,r={};r[t]=a,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(Object(l.a)(n))})},n.showCalendar=function(){0==n.state.showCalendar?n.setState({showCalendar:!0}):n.setState({showCalendar:!1})};var r=!1;return n.props.dynamic&&(r=!0),n.state={showCalendar:!1,loading:r,value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div",style:{display:"flex",flexFlow:"row"}},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.typeTitle),this.state.loading?r.a.createElement("span",null,"Loading..."):r.a.createElement(Hr.a,{className:"custom-metadata-input-width",value:this.state.value,onChange:this.onChange}),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Gr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.inputOnChange=function(e){n.setState({value:e.target.value})},n.state={value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))),r.a.createElement("span",null,r.a.createElement("textarea",{id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value,className:"custom-metadata-textarea-width"})))}}]),a}(r.a.Component),Jr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.handleAddition=function(e){if(void 0!==n.state.value){for(var t=[],a=n.state.value,r=0;r<a.length;r++)void 0!=a[r]&&("string"==typeof a[r]?t.push(a[r]):t.push(a[r].value));t.push(e.target.value);var i={},o="data."+n.props.id;i[o]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: group added"),this.setState({inputValue:"",value:i[this.props.id]})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add group",e)}.bind(Object(l.a)(n))})}},n.InputChange=function(e){n.setState({inputValue:e.target.value})},n.handleDelete=function(e){for(var t=n.state.value,a=e.target.id,r=[],i=0;i<t.length;i++)void 0!=t[i]&&("string"==typeof t[i]?t[i]!=a&&r.push(t[i]):t[i].value!=a&&r.push(t[i].value));var o={data:{[n.props.id]:r}};X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(o),contentType:"application/json; charset=UTF-8",success:function(e){this.setState({value:o[this.props.id]}),console.log("deleted group success: "+e)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to delete group",e)}.bind(Object(l.a)(n))})},n.state={inputValue:"",value:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){var e,t=this.state.value,a=[];if(void 0!==t)for(var n=0;n<t.length;n++)"string"==typeof t[n]?e=t[n]:"object"==typeof t[n]&&void 0!=t[n]&&(e=t[n].value),a.push(r.a.createElement("span",{id:"event_signature",className:"tagButton"},e," ",r.a.createElement("i",{id:e,onClick:this.handleDelete,className:"fa fa-times tagButtonClose"})));return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onChange:this.InputChange,value:this.state.inputValue}),""!=this.state.inputValue?r.a.createElement(H.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.handleAddition,value:this.state.inputValue},"Submit"):r.a.createElement(H.a,{bsSize:"xsmall",bsType:"submit",disabled:!0},"Submit")),r.a.createElement("span",{className:"custom-metadata-multi-input-tags"},a),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Yr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.componentWillReceiveProps=function(e){e.dynamic?n.getDynamic():n.setState({value:e.value})},n.onChange=function(e){var t;t="true"==e.target.value?1:0;var a={target:{}};a.target.id=n.props.id,a.target.value=t,n.props.onChange(a)},n.state={value:!1},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{type:"checkbox",className:"custom-metadata-input-width",id:this.props.id,name:this.props.id,value:this.state.value,onClick:this.onChange})),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Qr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).makeForm=function(e){var t=n.props;e&&(t=e);for(var a=[],i=0;i<t.dropdownValues.length;i++)t.value.includes(t.dropdownValues[i].value)?a.push(r.a.createElement("option",{selected:!0},t.dropdownValues[i].value)):a.push(r.a.createElement("option",null,t.dropdownValues[i].value));n.setState({options:a})},n.getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){for(var t=[],a=0;a<e[this.props.referenceKey].length;a++)1==e[this.props.referenceKey][a].selected?t.push(r.a.createElement("option",{selected:!0},e[this.props.referenceKey][a].value)):t.push(r.a.createElement("option",null,e[this.props.referenceKey][a].value));this.setState({options:t})}.bind(Object(l.a)(n))})},n.componentWillReceiveProps=function(e){e.dynamic?n.getDynamic():n.makeForm(e)},n.onChange=function(e){for(var t=[],a=0;a<e.target.options.length;a++)if(void 0!=e.target.options[a]){if(1!=e.target.options[a].selected)continue;t.push(e.target.options[a].value)}var r={};r["data."+n.props.id]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: multi select added")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add multi select",e)}.bind(Object(l.a)(n))}),n.setState({selected:e.target.value})},n.state={options:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.makeForm()}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement(Br.a,{id:this.props.id,componentClass:"select",placeholder:"select",bsClass:"custom-metadata-multi-select-width",multiple:!0,onChange:this.onChange,size:this.state.options.length},this.state.options)),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Xr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onChange=function(t){var a=t.target.id,n=t.target.value,r={};r[a]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+e.props.type+"/"+e.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed feed table data"),this.forceUpdate()}.bind(Object(l.a)(e)),error:function(e){this.props.errorToggle("Failed to updated feed table data",e)}.bind(Object(l.a)(e))})},e}return Object(C.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.headerData!==e.headerData}},{key:"render",value:function(){for(var e=[{label:"Status",key:"status",type:"dropdown",value:[{value:"active",selected:1},{value:"paused",selected:0}],help:"Activate or Pause fetches from Feed"},{label:"Feed Name",key:"name",type:"input",value:"enter feed name",help:"Name to reference feed by"},{label:"URI of Feed",key:"uri",type:"input",value:"https://uri.goes.here",help:"Enter the URI to access the Feed"},{label:"Feed type",key:"type",type:"dropdown",value:[{value:"RSS",selected:1},{value:"Twitter",selected:0},{value:"Email",selected:0}],help:"Select type of feed"}],t=[],a=0;a<e.length;a++){var n=e[a].value,i=e[a].key;switch(this.props.headerData[i]&&(n=this.props.headerData[i]),e[a].type){case"dropdown":t.push(r.a.createElement($r,{onChange:this.onChange,label:e[a].label,id:e[a].key,referenceKey:e[a].key,value:n,dropdownValues:e[a].value,help:e[a].help}));break;case"input":t.push(r.a.createElement(Zr,{onBlur:this.onChange,value:n,id:e[a].key,label:e[a].label,help:e[a].help}));break;case"calendar":var o=1e3*n;t.push(r.a.createElement(ei,{typeTitle:e[a].label,value:o,typeLower:e[a].key,type:this.props.type,id:this.props.id,help:e[a].help}));break;case"textarea":t.push(r.a.createElement(ti,{id:e[a].key,value:n,onBlur:this.onChange,label:e[a].label,help:e[a].help}));break;case"input_multi":t.push(r.a.createElement(ai,{id:e[a].key,value:n,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:e[a].label,help:e[a].help}));break;case"boolean":t.push(r.a.createElement(ni,{id:e[a].key,value:n,onChange:this.onChange,label:e[a].label,help:e[a].help}));break;case"multi_select":t.push(r.a.createElement(ri,{onChange:this.onChange,label:e[a].label,id:e[a].key,referenceKey:e[a].key,value:n,dropdownValues:e[a].value,help:e[a].help,mainType:this.props.type,mainId:this.props.id}))}}return r.a.createElement("div",null,e?r.a.createElement("div",{className:"custom-metadata-table container"},r.a.createElement("div",{className:"row"},t)):null)}}]),a}(r.a.Component),$r=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=[],a="",n=this.props.referenceKey;if("qual_sigbody_id"==n||"prod_sigbody_id"==n)for(var i in t.push(r.a.createElement("option",null,"0")),e.version)e.version[i].revision==e.data[n]&&(a=e.data[n]),t.push(r.a.createElement("option",null,e.version[i].revision));else for(var o=0;o<e[this.props.referenceKey].length;o++)1==e[this.props.referenceKey][o].selected&&(a=e[this.props.referenceKey][o].value),t.push(r.a.createElement("option",null,e[this.props.referenceKey][o].value));this.setState({selected:a,options:t})}.bind(Object(l.a)(n))})},n.onChange=function(e){n.props.onChange(e),n.setState({selected:e.target.value})},n.state={selected:null,options:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){if(this.props.dynamic)this.getDynamic();else{for(var e=[],t="",a=0;a<this.props.dropdownValues.length;a++)this.props.value==this.props.dropdownValues[a].value&&(t=this.props.value),e.push(r.a.createElement("option",null,this.props.dropdownValues[a].value));this.setState({selected:t,options:e})}}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({selected:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("select",{id:this.props.id,value:this.state.selected,onChange:this.onChange},this.state.options)),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),Zr=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t;t=e[this.props.referenceKey],this.setState({value:t})}.bind(Object(l.a)(n))})},n.inputOnChange=function(e){n.setState({value:e.target.value})},n.state={value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value})),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),ei=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=1e3*e[this.props.referenceKey];this.setState({value:t,loading:!1})}.bind(Object(l.a)(n))})},n.onChange=function(e){var t=n.props.typeLower,a=e._d.getTime()/1e3,r={};r[t]=a,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(Object(l.a)(n))})},n.showCalendar=function(){0==n.state.showCalendar?n.setState({showCalendar:!0}):n.setState({showCalendar:!1})};var r=!1;return n.props.dynamic&&(r=!0),n.state={showCalendar:!1,loading:r,value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div",style:{display:"flex",flexFlow:"row"}},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.typeTitle),this.state.loading?r.a.createElement("span",null,"Loading..."):r.a.createElement(Hr.a,{className:"custom-metadata-input-width",value:this.state.value,onChange:this.onChange}),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),ti=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.inputOnChange=function(e){n.setState({value:e.target.value})},n.state={value:""},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))),r.a.createElement("span",null,r.a.createElement("textarea",{id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value,className:"custom-metadata-textarea-width"})))}}]),a}(r.a.Component),ai=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.handleAddition=function(e){if(void 0!==n.state.value){var t=[],a=n.state.value;console.log("handleAddition data is ",a);for(var r=0;r<a.length;r++)void 0!=a[r]&&("string"==typeof a[r]?t.push(a[r]):t.push(a[r].value));t.push(e.target.value);var i={},o=n.props.id;i[o]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: group added"),this.setState({inputValue:"",value:i[this.props.id]})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add group",e)}.bind(Object(l.a)(n))})}},n.InputChange=function(e){n.setState({inputValue:e.target.value})},n.handleDelete=function(e){for(var t=n.state.value,a=e.target.id,r=[],i=0;i<t.length;i++)void 0!=t[i]&&("string"==typeof t[i]?t[i]!=a&&r.push(t[i]):t[i].value!=a&&r.push(t[i].value));var o={data:{[n.props.id]:r}};X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(o),contentType:"application/json; charset=UTF-8",success:function(e){this.setState({value:o[this.props.id]}),console.log("deleted group success: "+e)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to delete group",e)}.bind(Object(l.a)(n))})},n.state={inputValue:"",value:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){var e,t=this.state.value,a=[];if(void 0!==t)for(var n=0;n<t.length;n++)"string"==typeof t[n]?e=t[n]:"object"==typeof t[n]&&void 0!=t[n]&&(e=t[n].value),a.push(r.a.createElement("span",{id:"event_signature",className:"tagButton"},e," ",r.a.createElement("i",{id:e,onClick:this.handleDelete,className:"fa fa-times tagButtonClose"})));return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onChange:this.InputChange,value:this.state.inputValue}),""!=this.state.inputValue?r.a.createElement(H.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.handleAddition,value:this.state.inputValue},"Submit"):r.a.createElement(H.a,{bsSize:"xsmall",bsType:"submit",disabled:!0},"Submit")),r.a.createElement("span",{className:"custom-metadata-multi-input-tags"},a),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),ni=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(l.a)(n))})},n.componentWillReceiveProps=function(e){e.dynamic?n.getDynamic():n.setState({value:e.value})},n.onChange=function(e){var t;t="true"==e.target.value?1:0;var a={target:{}};a.target.id=n.props.id,a.target.value=t,n.props.onChange(a)},n.state={value:!1},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{type:"checkbox",className:"custom-metadata-input-width",id:this.props.id,name:this.props.id,value:this.state.value,onClick:this.onChange})),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component),ri=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).makeForm=function(e){var t=n.props;e&&(t=e);for(var a=[],i=0;i<t.dropdownValues.length;i++)t.value.includes(t.dropdownValues[i].value)?a.push(r.a.createElement("option",{selected:!0},t.dropdownValues[i].value)):a.push(r.a.createElement("option",null,t.dropdownValues[i].value));n.setState({options:a})},n.getDynamic=function(){X.a.ajax({type:"get",url:n.props.fetchURL,success:function(e){for(var t=[],a=0;a<e[this.props.referenceKey].length;a++)1==e[this.props.referenceKey][a].selected?t.push(r.a.createElement("option",{selected:!0},e[this.props.referenceKey][a].value)):t.push(r.a.createElement("option",null,e[this.props.referenceKey][a].value));this.setState({options:t})}.bind(Object(l.a)(n))})},n.componentWillReceiveProps=function(e){e.dynamic?n.getDynamic():n.makeForm(e)},n.onChange=function(e){for(var t=[],a=0;a<e.target.options.length;a++)if(void 0!=e.target.options[a]){if(1!=e.target.options[a].selected)continue;t.push(e.target.options[a].value)}var r={};r[n.props.id]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.mainType+"/"+n.props.mainId,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: multi select added")}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to add multi select",e)}.bind(Object(l.a)(n))}),n.setState({selected:e.target.value})},n.state={options:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.makeForm()}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement(Br.a,{id:this.props.id,componentClass:"select",placeholder:"select",bsClass:"custom-metadata-multi-select-width",multiple:!0,onChange:this.onChange,size:this.state.options.length},this.state.options)),r.a.createElement("span",null,r.a.createElement(Gt.a,{placement:"top",overlay:r.a.createElement(qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),a}(r.a.Component);var ii=function(e){var t=Object.assign({},e),a=Object(n.useState)(!0),i=Object(Kt.a)(a,2),o=i[0],s=i[1];function l(){s(!o),t.updated()}return r.a.createElement("div",null,o?null:r.a.createElement("div",{style:{justifyContent:"center",padding:5,display:"flex"}},r.a.createElement("br",null),r.a.createElement(ia.a,{style:{backgroundColor:"#5bc0de",color:"white"},onClick:l,variant:"contained"},"Add Entry"),r.a.createElement("br",null)),o?r.a.createElement(or,{entryAction:"Add",type:"alert",targetid:t.row.id,id:"add_entry",addedentry:s,errorToggle:t.errorToggle,toggleVisibility:l}):null,t.entryData.length>0?r.a.createElement(oi,{entryData:t.entryData,type:"alert",id:t.row.id,showEntryData:t.showEntryData,errorToggle:t.errorToggle,createCallback:t.createCallback,removeCallback:t.removeCallback,entityData:t.entityData,addFlair:t.addFlair}):null)},oi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).getEntryData=function(){var e=n.props,t=e.type,a=e.id;(n.setState({isMounted:!0}),"alert"===t||"entity"===t||1===n.props.isPopUp)&&ca("scot/api/v2/".concat(t,"/").concat(a,"/entry"),null).then(function(e){this.state.isMounted&&(this.setState({showEntryData:!0,entryData:e.data.records}),e.data.records.forEach(function(t,a){this.props.createCallback(e.data.records[a].id,this.updatedCB)}.bind(this)),this.Watcher())}.bind(Object(l.a)(n))).catch(function(e){this.state.isMounted&&(this.setState({showEntryData:!0}),this.props.errorToggle("Failed to load entry data.",e))}.bind(Object(l.a)(n)))},n.getEntityData=function(){var e=n.props,t=e.addFlair,a=e.type,r=e.id;"alert"!==a&&"entity"!==a&&"incident"!==a&&"alertgroup"!==a&&1!==n.props.isPopUp||ca("scot/api/v2/".concat(a,"/").concat(r,"/entity"),null).then(function(e){var n=e.data.records;if(this.state.isMounted){this.setState({showEntityData:!0,entityData:n});var i={waitEntry:function(){!1===this.state.showEntryData?setTimeout(i.waitEntry,50):setTimeout(function(){t(n,null,a,null,r)}.bind(this))}.bind(this)};i.waitEntry()}}.bind(Object(l.a)(n))).catch(function(e){this.state.isMounted&&(this.setState({showEntityData:!0}),this.props.errorToggle("Failed to load entity data.",e))}.bind(Object(l.a)(n)))},n.updatedCB=function(){n.getEntityData(),n.getEntryData()},n.flairToolbarToggle=function(e,t,a,r,i){n.state.isMounted&&n.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:a,entityoffset:r,entityobj:i})},n.flairToolbarOff=function(){if(n.state.isMounted){var e=n.state.entityDetailKey+1;n.setState({flairToolbar:!1,entityDetailKey:e})}},n.linkWarningToggle=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.state.isMounted&&(!1===n.state.linkWarningToolbar?n.setState({linkWarningToolbar:!0,link:e,nopop:t}):n.setState({linkWarningToolbar:!1,nopop:t}))},n.Watcher=function(){var e=n.props.type+"-detail-container";if("alertgroup"!=n.props.type){document.querySelectorAll("iframe").forEach(function(e,t){e.contentWindow.requestAnimationFrame(function(){if(null!=e.contentDocument){[].push(this.checkFlairHover),e.addEventListener("mouseenter",(function(t,a){var n=setInterval(this[0],50,e);console.log("Now watching iframe "+n)})),e.addEventListener("mouseleave",(function(){var t=X()(e).data("intervalID");window.clearInterval(t),console.log("No longer watching iframe "+t)}))}}.bind(this))}.bind(Object(l.a)(n)))}else X()(e).find("a, .entity").not(".not_selectable").each(function(e,t){X()(t).off("mousedown"),X()(t).on("mousedown",function(e){var t=e.target;if("extras"==X()(t)[0].className&&(t=X()(t)[0].parentNode),X()(t).attr("url")){var a=X()(t).attr("url");this.linkWarningToggle(a)}else{var n=X()(t).attr("data-entity-id"),r=X()(t).attr("data-entity-value"),i=X()(t).offset(),o=X()(t);this.flairToolbarToggle(n,r,"entity",i,o)}}.bind(this))}.bind(Object(l.a)(n)))},n.checkFlairHover=function(e){"alertgroup"!=n.props.type&&(null!=e.contentDocument&&X()(e).contents().find(".entity").each(function(t,a){if("rgb(255, 0, 0)"==X()(a).css("background-color"))X()(a).data("state","down");else if("down"==X()(a).data("state")){X()(a).data("state","up");var n=X()(a).attr("data-entity-id"),r=X()(a).attr("data-entity-value"),i=X()(a),o=e,s={top:X()(a).offset().top+X()(o).offset().top,left:X()(a).offset().left+X()(o).offset().left};this.flairToolbarToggle(n,r,"entity",s,i)}}.bind(Object(l.a)(n))),null!=e.contentDocument&&X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==X()(t).css("color"))X()(t).data("state","down");else if("down"==X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.linkWarningToggle(a)}}.bind(Object(l.a)(n))))},n.containerHeightAdjust=function(){setTimeout(function(){var e,t;void 0!==(t=document.getElementsByClassName("ReactTable")[0].clientHeight)&&(0!==t?(e=window.innerHeight-t-X()("#header").height()-90,e+="px"):(e=X()(window).height()-X()("#header").height()-78,e+="px"),this.state.isMounted&&this.setState({height:e}))}.bind(Object(l.a)(n)),500)},n.render=function(){var e="detail-container",t=n.state.height,a=n.props.entryData,i=n.props.type,o=n.props.id,s=n.props.showEntryData,l="row-fluid entry-wrapper entry-wrapper-main";return"alert"===i?(l="row-fluid entry-wrapper entry-wrapper-main-nh",a=n.state.entryData,s=n.state.showEntryData):"alertgroup"===i?l="row-fluid alert-wrapper entry-wrapper-main":"entity"!==i&&1!==n.props.isPopUp||(l="row-fluid entry-wrapper-entity",a=n.state.entryData,s=n.state.showEntryData),"alert"!==i&&1!==n.props.isPopUp||(e=n.props.type+"-detail-container",t=null),r.a.createElement("div",{id:e,key:o,className:l,style:{height:t}},"entity"!==i&&"alert"!==i&&"feed"!==i?r.a.createElement(Vr,{type:i,id:o,errorToggle:n.props.errorToggle,form:n.props.form,headerData:n.props.headerData}):null,"feed"===i?r.a.createElement(Xr,{type:i,id:o,errorToggle:n.props.errorToggle,form:n.props.form,headerData:n.props.headerData}):null,"signature"===i&&null!==n.props.headerData?r.a.createElement(Lr,{type:i,id:o,headerData:n.props.headerData,errorToggle:n.props.errorToggle,showSignatureOptions:n.props.showSignatureOptions}):null,s?r.a.createElement(si,Object.assign({updated:n.updatedCB,removeCallback:n.props.removeCallback,createCallback:n.props.createCallback,data:a,type:i,id:o,entityData:n.state.entityData,entryToggle:n.props.entryToggle,subcomponent:n.props.subcomponent,setAlertColumns:n.props.setAlertColumns,setEntryEntities:n.props.setEntryEntities},n.props)):r.a.createElement("span",null,"Loading..."),n.props.entryToolbar?r.a.createElement("div",null,r.a.createElement(or,{entryAction:"Add",type:n.props.type,targetid:n.props.id,id:null,addedentry:n.props.entryToggle,updated:n.updatedCB,errorToggle:n.props.errorToggle})):null,n.props.fileUploadToolbar?r.a.createElement("div",null,r.a.createElement(jr,{type:n.props.type,targetid:n.props.id,id:"file_upload",fileUploadToggle:n.props.fileUploadToggle,updated:n.updatedCB,errorToggle:n.props.errorToggle})):null,n.state.flairToolbar?r.a.createElement(ur,{key:n.state.entityDetailKey,flairToolbarToggle:n.flairToolbarToggle,flairToolbarOff:n.flairToolbarOff,entityid:n.state.entityid,entityvalue:n.state.entityvalue,entitytype:n.state.entitytype,type:n.props.type,id:n.props.id,entityoffset:n.state.entityoffset,entityobj:n.state.entityobj,linkWarningToggle:n.linkWarningToggle,errorToggle:n.props.errorToggle,createCallback:n.props.createCallback,removeCallback:n.props.removeCallback,addFlair:n.props.addFlair}):null,n.state.linkWarningToolbar?r.a.createElement(_r,{linkWarningToggle:n.linkWarningToggle,link:n.state.link,nopop:n.state.nopop}):null)};var i=Math.floor(1e3*Math.random());return n.state={showEntryData:n.props.showEntryData,showEntityData:n.props.showEntityData,entryData:n.props.entryData,entityData:void 0===n.props.entityData?null:n.props.entityData,entityid:null,entitytype:null,entityoffset:null,entityobj:null,key:n.props.id,flairToolbar:!1,notificationType:null,notificationMessage:"",height:null,entityDetailKey:i,isMounted:!1},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.type,a=e.id,n=e.addFlair;this.getEntryData(),null!==this.state.entityData&&n(this.state.entityData,null,t,null,a),this.props.createCallback(this.props.id,this.updatedCB),this.containerHeightAdjust(),window.addEventListener("resize",this.containerHeightAdjust),document.querySelector(".ReactTable").onresize=function(){this.containerHeightAdjust()}.bind(this)}},{key:"componentWillReceiveProps",value:function(){this.containerHeightAdjust()}},{key:"componentDidUpdate",value:function(){1==this.state.runWatcher&&this.Watcher()}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}}]),a}(r.a.Component),si=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=[],a=e.props.data,n=e.props.type,i=e.props.items,o=[],s=e.props.id,c=e.props.entityData;if(void 0!==e.props.items){void 0===e.props.items[0].data_with_flair||e.props.flairOff?i[0].data.search:i[0].data_with_flair.search;for(var d=0;d<e.props.headerData.ahrefs.length;d++)o.push(r.a.createElement("a",{href:e.props.headerData.ahrefs[d].link},e.props.headerData.ahrefs[d].subject)),o.push(r.a.createElement("br",null))}if(void 0===a||void 0===a[0])return"alertgroup"!==n?r.a.createElement("div",null,r.a.createElement("div",{style:{color:"blue"}},"No entries found. Click the green Add Entry button if you would like to create one")):r.a.createElement("div",null,r.a.createElement("div",{style:{color:"blue"}},"No alerts found or they are unable to be rendered. Please check the source and correct the formatting of the alert if necessary"));if("alertgroup"!==n){var p=0;return a.forEach(function(e){t.push(r.a.createElement(di,{subcomponent:this.props.subcomponent,key:p,items:e,type:n,id:s,isPopUp:this.props.isPopUp,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,entityData:c,entryToggle:this.props.entryToggle,setEntryEntities:this.props.setEntryEntities})),p+=1}.bind(Object(l.a)(e))),r.a.createElement("div",null,t)}return r.a.createElement("div",null,r.a.createElement(li,Object.assign({subcomponent:e.props.subcomponent},e.props,{key:s,type:n,id:s,items:a,entityData:c,entryToggle:e.props.entryToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,addFlair:e.props.addFlair,setAlertColumns:e.props.setAlertColumns,updated:e.props.updated})))},e}return a}(r.a.Component),li=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).createData=function(){console.log("createData");var e=[];return n.props.items.forEach(function(t){var a={};this.state.flairOff||0===Object.entries(t.data_with_flair).length?(a=t.data)["status "]=t.data.status:(a=t.data_with_flair)["status "]=t.data_with_flair.status,a.id=t.id,a.status=t.status,a.entry_count=t.entry_count,console.log("adding dataitem"),console.log(a),e.push(a)}.bind(Object(l.a)(n))),e},n.state={columns:[],data:[],entityData:[],type:"",addFlair:null,promotionId:null,selected:[],flairOff:!1,expanded:{}},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){if(console.log("componentDidMount"),this.props.items.length>0){var e=this.createData(),t=Ta("alert",e,this.props.items,!0);this.setState({data:e,columns:t})}this.props.type&&this.setState({type:this.props.type,entityData:this.props.entityData}),this.props.addFlair&&this.setState({addFlair:this.props.addFlair}),this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected}),X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||65!==e.keyCode||!0!==e.ctrlKey&&!0!==e.metaKey||(this.handleSelectAll(),e.preventDefault())}.bind(this))}},{key:"componentDidUpdate",value:function(e,t){if(console.log("componentDidUpdate"),e.entityData!==this.props.entityData&&this.setState({entityData:this.props.entityData,columns:Ta("alert",this.state.data,this.props.items,!0,this.props.entityData)}),t.flairOff!==this.state.flairOff){var a=this.createData();this.setState({data:a})}if(e.items!==this.props.items){var n=this.createData();this.setState({data:n})}this.props.alertsSelected!==t.selected&&void 0!==this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected})}},{key:"render",value:function(){var e=this,t=this.state,a=t.columns,n=t.data,i=this.props,o=i.addFlair,s=i.type,l=(i.headerData,i.entityData);i.updated;return r.a.createElement("div",null,r.a.createElement(qt.a,{styleName:"styles.ReactTable",ref:function(t){return e.reactTable=t},key:2,data:n,columns:a,filterable:!0,expanded:this.state.expanded,onExpandedChange:function(t,a,n){e.setState({expanded:t}),o(l,null,"entry",null,null)},defaultFilterMethod:function(e,t){if(t[e.id].includes(e.value))return t},SubComponent:function(t){var a=t.row;return r.a.createElement(ii,{flag:e.props.subcomponent,row:a,entryToggle:e.props.entryToggle,errorToggle:e.props.errorToggle,entryData:e.props.entryData,showEntryData:e.props.showEntryData,errorToggle:e.props.errorToggle,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,entityData:e.props.entityData,addFlair:e.props.addFlair,updated:e.props.updated})},onFilteredChange:function(e,t){o(l,null,s,null,null)},onSortedChange:function(e,t,a){o(l,null,s,null,null)},showPagination:!1,pageSize:n.length,getTdProps:function(e,t){return{style:{maxWidth:"fit-content"}}},getTrProps:function(t,a){return a&&a.row&&void 0!==e.props.alertsSelected?{onClick:function(n){(n.ctrlKey||n.metaKey&&83===n.keyCode)&&e.props.handleSelectAll(t.sortedData),n.ctrlKey||n.metaKey?(n.preventDefault(),e.props.handleMultiSelection(a.original)):n.shiftKey?(document.getSelection().removeAllRanges(),e.props.handleShiftSelect(e.state.selected[0].id,a.original.id,t.sortedData)):e.props.handleSelection(a.original)},style:{background:e.state.selected.some((function(e){return a.original.id===e.id}))?"#a7c6a5":"",borderBottom:"1px solid black",maxHeight:200,overflowY:"auto"}}:{style:{maxHeight:200,overflowY:"auto"}}}}),r.a.createElement(ci,{items:this.props.items,flairOff:this.props.flairOff,headerData:this.props.headerData}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.flairOff!==t.flairOff?{flairOff:e.flairOff}:e.alertsSelected!==t.selected?{selected:e.alertsSelected}:null}}]),a}(r.a.Component),ci=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(C.a)(a,[{key:"render",value:function(){var e=this,t=null,a=this.props.items;t=void 0===a[0].data_with_flair||this.props.flairOff?a[0].data.search:a[0].data_with_flair.search;var n=this.props.headerData.ahrefs.map((function(t,a){return r.a.createElement("div",{key:a},r.a.createElement("a",{href:e.props.headerData.ahrefs[a].link},e.props.headerData.ahrefs[a].subject),r.a.createElement("br",null))}));return r.a.createElement("div",null,void 0!==t?r.a.createElement("div",{className:"alertTableHorizontal",style:{outline:"1px solid black",borderRadius:5,padding:3,margin:"10px 0 15px"}},n,r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})):null)}}]),a}(r.a.Component),di=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.props.createCallback(n.props.items.id,n.refreshButton)},n.refreshButton=function(){X()("#refresh-detail")&&X()("#refresh-detail").click()},n.editEntryToggle=function(){!1===n.state.editEntryToolbar?n.setState({editEntryToolbar:!0}):n.setState({editEntryToolbar:!1})},n.replyEntryToggle=function(){!1===n.state.replyEntryToolbar?n.setState({replyEntryToolbar:!0}):n.setState({replyEntryToolbar:!1})},n.deleteToggle=function(){!1===n.state.deleteToolbar?n.setState({deleteToolbar:!0}):n.setState({deleteToolbar:!1})},n.permissionsToggle=function(){!1===n.state.permissionsToolbar?n.setState({permissionsToolbar:!0}):n.setState({permissionsToolbar:!1})},n.reparseFlair=function(){ua("/scot/api/v2/entry/".concat(n.props.items.id)).then((function(e){console.log("reparsing started")})).catch(function(e){this.props.errorToggle("failed to start reparsing of data",e)}.bind(Object(l.a)(n)))},n.fileUploadToggle=function(){!1===n.state.fileUploadToolbar?n.setState({fileUploadToolbar:!0}):n.setState({fileUploadToolbar:!1})},n.getEntryEntityData=function(e){ca("scot/api/v2/entry/".concat(e,"/entity"),null).then(function(e){var t=e.data.records;this.props.setEntryEntities(t)}.bind(Object(l.a)(n))).catch(function(e){console.log("Couldnt get entry entity data: ".concat(e))}.bind(Object(l.a)(n)))},n.render=function(){var e=[],t=[],i=n.props.items,o=n.props.type,s=n.props.id,c=n.props.isPopUp,d=n.props.items.class,p=0,u=n.state.editEntryToolbar,h=n.editEntryToggle,m=n.props.errorToggle,g="row-fluid entry-outer",y="row-fluid entry-header",f="";for(var v in"summary"===d&&(g+=" summary_entry",p=1),"task"===d&&("open"===i.metadata.task.status||"assigned"===i.metadata.task.status?(f="-- Task Owner "+i.metadata.task.who+" ",g+=" todo_open_outer",y+=" todo_open"):"closed"!==i.metadata.task.status&&"completed"!==i.metadata.task.status||null==i.metadata.task.who?"closed"!==i.metadata.task.status&&"completed"!==i.metadata.task.status||(g+=" todo_undefined_outer",y+=" todo_undefined"):(f="-- Task Owner "+i.metadata.task.who+" ",g+=" todo_completed_outer",y+=" todo_completed")),"alert"===d&&(g+=" event_entry_container_alert"),e.push(r.a.createElement(ui,{id:i.id,key:i.id,subitem:i,type:o,targetid:s,editEntryToolbar:u,editEntryToggle:h,isPopUp:c,errorToggle:n.props.errorToggle,setEntryEntities:n.props.setEntryEntities})),i){!function(e){if("children"===e){i[e];i[e].forEach(function(e){t.push(new Array(r.a.createElement(a,{items:e,id:s,type:o,editEntryToolbar:u,editEntryToggle:h,isPopUp:c,errorToggle:m,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,setEntryEntities:this.props.setEntryEntities})))}.bind(Object(l.a)(n)))}}(v)}e.push(t);var b=[];if(n.props.items&&n.props.items.actions)for(var k=0;k<n.props.items.actions.length;k++)n.props.items.actions[k].send_to_name&&n.props.items.actions[k].send_to_url&&b.push(r.a.createElement(pi,{id:n.props.items.actions[k].send_to_name,datahref:n.props.items.actions[k].send_to_url,errorToggle:n.props.errorToggle}));var w,S,T="["+i.id+"] ",C=" by "+i.owner+" "+f+"(updated on ",x=i.created,j=i.updated,O="entry-header-inner-"+n.props.id+" entry-header-inner";return"unset"!==i.tlp&&(w="3px solid "+(S="amber"!==i.tlp?i.tlp:"orange")),r.a.createElement("div",null,n.state.showEntityCreateModal?r.a.createElement(Ur,{reparseEntryId:n.props.items.id,match:n.state.highlightedText,modalActive:n.state.showEntityCreateModal,ToggleCreateEntity:n.ToggleCreateEntity,errorToggle:n.props.errorToggle,createCallback:n.props.createCallback,removeCallback:n.props.removeCallback}):null,r.a.createElement("div",{className:g,style:{marginLeft:"auto",marginRight:"auto",width:"99.3%",border:w}},r.a.createElement("span",{className:"anchor",id:"/"+o+"/"+s+"/"+i.id}),r.a.createElement("div",{className:y},r.a.createElement("div",{id:O,className:O},"[",r.a.createElement(Ne.Link,{style:{color:"black"},to:"/"+o+"/"+s+"/"+i.id},i.id),"]"," ",r.a.createElement(Ia.a,{value:1e3*i.created,format:"MM/DD/YYYY hh:mm:ss a"})," ","by ",i.owner," ",f,"(updated on"," ",r.a.createElement(Ia.a,{value:1e3*i.updated,format:"MM/DD/YYYY hh:mm:ss a"}),")",""!==n.state.highlightedText&&null!=n.state.highlightedText?r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:n.ToggleCreateEntity},"Create Entity"):null,""!==n.props.items.body_flair&&0===n.props.items.parsed?r.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ","Entry awaiting flair engine. Content may be inaccurate."):null,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},n.state.permissionsToolbar?r.a.createElement(Bn,{updateid:s,id:i.id,type:"entry",permissionData:i,permissionsToggle:n.permissionsToggle}):null,"unset"!==i.tlp&&void 0!==i.tlp?r.a.createElement("span",null,"TLP:"," ",r.a.createElement("span",{style:{color:S}},i.tlp," ")):null,r.a.createElement(wr.a,{bsSize:"xsmall",title:"Reply",key:i.id,id:"Reply "+i.id,onClick:n.replyEntryToggle,pullRight:!0},"entity"!==o?r.a.createElement(E.a,{eventKey:"1",onClick:n.fileUploadToggle},"Upload File"):null,b,r.a.createElement(E.a,{eventKey:"3"},r.a.createElement(Or,{type:o,id:s,entryid:i.id,summary:p,errorToggle:n.props.errorToggle})),r.a.createElement(E.a,{eventKey:"4"},r.a.createElement(Dr,{type:o,id:s,entryid:i.id,taskData:i,errorToggle:n.props.errorToggle})),r.a.createElement(Ka,{type:"entry",id:i.id,string:i.body_plain}),r.a.createElement(E.a,{onClick:n.permissionsToggle},"Permissions"),r.a.createElement(E.a,{onClick:n.reparseFlair},"Reparse Flair"),r.a.createElement(ln,{type:"entry",id:i.id,tlp:i.tlp,errorToggle:n.props.errorToggle}),r.a.createElement(E.a,{onClick:function(){n.getEntryEntityData(i.id)}},"Get entities for Entry"),r.a.createElement(E.a,{divider:!0}),r.a.createElement(E.a,{eventKey:"2",onClick:n.deleteToggle},"Delete")),r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:n.editEntryToggle},"Edit")))),e,n.state.replyEntryToolbar?r.a.createElement(or,{entryAction:"Reply",type:o,header1:T,header2:C,header3:")",createdTime:x,updatedTime:j,targetid:s,id:i.id,addedentry:n.replyEntryToggle,errorToggle:n.props.errorToggle}):null,n.state.fileUploadToolbar?r.a.createElement(jr,{type:n.props.type,targetid:n.props.id,entryid:n.props.items.id,fileUploadToggle:n.fileUploadToggle,errorToggle:n.props.errorToggle}):null),n.state.deleteToolbar?r.a.createElement(fn,{type:o,id:s,deleteToggle:n.deleteToggle,entryid:i.id,errorToggle:n.props.errorToggle}):null)},n.componentWillReceiveProps=function(){n.checkHighlight()},n.checkHighlight=function(){var e,t=document.getElementById("iframe_"+n.props.items.id);if(t){if(null===t.contentWindow.getSelection())return;if(e=t.contentWindow.getSelection().toString(),n.state.highlightedText===e)return;console.log(t+" has highlighted text: "+e),n.setState({highlightedText:e})}},n.ToggleCreateEntity=function(){n.setState({showEntityCreateModal:!n.state.showEntityCreateModal})},n.state={editEntryToolbar:!1,replyEntryToolbar:!1,deleteToolbar:!1,permissionsToolbar:!1,fileUploadToolbar:!1,showEntityCreateModal:!1,highlightedText:null,items:{}},n}return a}(r.a.Component),pi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).submit=function(){var e=n.props.datahref,t=n.props.id;(function(e,t){return pa.apply(this,arguments)})(e,null).then(function(e){this.setState({[t]:!0,disabled:!1})}.bind(Object(l.a)(n))).catch(function(e){this.props.errorToggle("failed to submit the entry action",e),this.setState({disabled:!1})}.bind(Object(l.a)(n)))},n.render=function(){return r.a.createElement(E.a,{disabled:n.state.disabled},r.a.createElement("span",{id:n.props.id,"data-href":n.props.datahref,onClick:n.submit,style:{display:"block"}},n.props.id," ",n.state[n.props.id]?r.a.createElement("span",{style:{color:"green"}},"success"):null))},n.state={[n.props.id]:!1,disabled:!1},n}return a}(r.a.Component),ui=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).setHeight=function(){setTimeout(function(){void 0!=document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){var e;e=(e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight)+35+"px",this.state.height!=e&&this.setState({height:e})}.bind(this))}.bind(Object(l.a)(n)),250)},n.state={height:"1px"},n}return Object(C.a)(a,[{key:"componentWillReceiveProps",value:function(){this.setHeight()}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this.props.subitem.body_flair;""==this.props.subitem.body_flair&&(e=this.props.subitem.body);var t=this.props.id,a="entry-body-"+this.props.id,n="entry-body-inner-"+this.props.id;return r.a.createElement("div",{id:a,key:this.props.id,className:"row-fluid entry-body"},r.a.createElement("div",{id:n,className:"row-fluid entry-body-inner",style:{marginLeft:"auto",marginRight:"auto",width:"99.3%"}},this.props.editEntryToolbar?r.a.createElement(or,{entryAction:"Edit",type:this.props.type,targetid:this.props.targetid,id:t,addedentry:this.props.editEntryToggle,parent:this.props.subitem.parent,errorToggle:this.props.errorToggle}):r.a.createElement(dr.a,{key:t,contentDidMount:this.setHeight,head:[r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/prism.css"}),r.a.createElement("script",{src:"/libs/prism.js"})],frameBorder:"0",id:"iframe_"+t,sandbox:"allow-same-origin",style:{width:"100%",height:this.state.height}},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))))}}]),a}(r.a.Component),hi=a(188),mi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).toggleBadgeEntry=function(e){0==n.state[e]?n.setState({[e]:!0}):1==n.state[e]&&n.setState({[e]:!1})},n.state={source:!1,tag:!1},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this,t=[],a=this.props.id,n=this.props.type,i=this.props.data,o="";if("tag"===this.props.badgeType?o="Tags":"source"===this.props.badgeType&&(o="Sources"),"guide"==this.props.type)return r.a.createElement("th",null);if(void 0!=i)for(var s=0;s<i.length;s++)t.push(r.a.createElement(gi,{data:i,badgeType:this.props.badgeType,dataOne:i[s],id:a,type:n,updated:this.props.updated,key:s,errorToggle:this.props.errorToggle}));return r.a.createElement("th",null,r.a.createElement("th",null,o,":"),r.a.createElement("td",null,t,this.state.source?r.a.createElement(yi,{data:i,type:n,id:a,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,this.state.tag?r.a.createElement(yi,{data:i,type:n,id:a,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,"tag"===this.props.badgeType?this.state.tag?r.a.createElement("span",{className:"add-tag-button"},r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):r.a.createElement("span",{className:"remove-tag-button"},r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):"source"===this.props.badgeType?this.state.source?r.a.createElement("span",{className:"add-source-button"},r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"danger",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):r.a.createElement("span",{className:"remove-source-button"},r.a.createElement(Ha.a,{bsSize:"xsmall",bsStyle:"success",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):null))}}]),a}(r.a.Component),gi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).badgeDelete=function(){for(var t=e.props.badgeType,a=e.props.data,n=[],r=0;r<a.length;r++)void 0!=a[r]&&("string"==typeof a[r]?a[r]!=e.props.dataOne&&n.push(a[r]):a[r].value!=e.props.dataOne.value&&n.push(a[r].value));var i={};i[t]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+e.props.type+"/"+e.props.id,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(e){console.log("deleted"+this.props.badgeType+" data")}.bind(Object(l.a)(e)),error:function(e){this.props.errorToggle("Failed to delete"+t+", data ")}.bind(Object(l.a)(e))})},e}return Object(C.a)(a,[{key:"render",value:function(){var e,t=this.props.dataOne;return"string"==typeof t?e=t:"object"==typeof t&&void 0!=t&&(e=t.value),"tag"===this.props.badgeType?r.a.createElement("span",{id:"event_tag",className:"tagButton"},e," ",r.a.createElement("span",{className:"tagButtonClose"},r.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):"source"===this.props.badgeType?r.a.createElement("span",{id:"event_source",className:"sourceButton"},e," ",r.a.createElement("span",{className:"sourceButtonClose"},r.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):null}}]),a}(r.a.Component),yi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleAddition=function(e){var t=n.props.badgeType,a=n.props.data;Array.isArray(a)&&a.length?console.log("data is ok"):(console.log("Null this.props.data!"),a=[]);var r=a.map((function(e){return"string"===typeof e?e:e.value}));if(r.includes(e.text))n.props.errorToggle(n.props.badgeType+" already exists");else{r.push(e.text);var i={};i[t]=r,ua("scot/api/v2/".concat(n.props.type,"/").concat(n.props.id),i).then(function(e){this.props.toggleBadgeEntry()}.bind(Object(l.a)(n))).catch(function(e){this.props.errorToggle("Failed to add "+this.props.badgeType+" data "),this.props.toggleBadgeEntry()}.bind(Object(l.a)(n)))}},n.handleSuggestionOrTagConversion=function(e){return e.map((function(e){var t={};return t.id=e,t.text=e,t}))},n.handleInputChange=function(e){if(e.length>0){var t=[],a=n.props.badgeType;ca("/scot/api/v2/ac/".concat(a,"/").concat(e),null).then(function(e){t=e.data.records.map((function(e){return e})),this.setState({suggestions:t})}.bind(Object(l.a)(n))).catch(function(e){this.props.errorToggle("Failed to get autocomplete data for tag",e)}.bind(Object(l.a)(n)))}},n.state={suggestions:[]},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this.state.suggestions;return e=this.handleSuggestionOrTagConversion(e),r.a.createElement("span",{className:"tag-new"},r.a.createElement(hi.WithContext,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,tags:[]}))}}]),a}(r.a.Component),fi=a(160),vi=a.n(fi);function bi(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;var a=e.toPrecision(2).split("e"),n=1===a.length?0:Math.floor(Math.min(a[1].slice(1),14)/3),r=n<1?e.toFixed(0+t):(e/Math.pow(10,3*n)).toFixed(1+t);return(r<0?r:Math.abs(r))+["","K","M","B","T"][n]}var Ei={entityUpdate:function(e,t,a,n,r,i){setTimeout(function(){var t={};for(var n in e)t[X()("<span />",{html:n}).html()]=e[n];"alertgroup"!==a?X()("iframe").each(function(e,a){a.contentWindow.requestAnimationFrame((function(){if(null!=a.contentDocument){var e=X()(a).contents();X()(a.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each((function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)})),e.find(".entity").each((function(e,a){if(null==X()(a).find(".extras")[0]){var n=X()("<span />",{html:X()(a).attr("data-entity-value")}).html();if(void 0!==n&&void 0!==t){var r=t;if(void 0!==(r=void 0!==r[n.toLowerCase()]?r[n.toLowerCase()]:r[n])){console.log("entity matched!");var i=r.id,o=bi(parseInt(r.count,10),0),s=r.data;console.log("entitydata for "+r.id),console.log(s);var l=r.entry,c=X()('<span class="noselect">');if(c.addClass("circleNumber"),c.addClass("extras"),c.text(o),X()(a).append(c),X()(a).attr("data-entity-id",i),X()(a).unbind("click"),void 0!==s){if(void 0!==s.scanner&&"true"===s.scanner.active&&X()(a).append(X()('<img class="extras" title="scanner">').attr("src","/images/flair/scanner.png")),void 0!==s.geoip&&void 0!==s.geoip.data){var d;if(s.geoip.data.isocode)if(null!==(d="Sandia National Laboratories"===s.geoip.data.isp?"sandia":s.geoip.data.isocode)){var p=X()('<img title="'+d.toLowerCase()+'">').attr("src","/images/flags/"+d.toLowerCase()+".png");p.addClass("extras"),X()(a).append(p)}if(s.geoip.data.is_anonymous){var u=X()('<img title="is_anonymous">').attr("src","/images/flair/anon.png");u.addClass("extras"),X()(a).append(u)}if(s.geoip.data.is_anonymous_vpn){var h=X()('<img title="is_anonymous_vpn">').attr("src","/images/flair/anonvpn.png");h.addClass("extras"),X()(a).append(h)}if(s.geoip.data.is_hosting_provider){var m=X()('<img title="is_hosting_provider">').attr("src","/images/flair/hosting.png");m.addClass("extras"),X()(a).append(m)}if(s.geoip.data.is_public_proxy){var g=X()('<img title="is_public_proxy">').attr("src","/images/flair/proxy.png");g.addClass("extras"),X()(a).append(g)}if(s.geoip.data.is_tor_exit_node){var y=X()('<img title="is_tor_exit_node">').attr("src","/images/flair/tor.png");y.addClass("extras"),X()(a).append(y)}}void 0!==s.sidd&&0!==Object.keys(s.sidd.data).length&&s.sidd.data.constructor===Object&&X()(a).append(X()('<img class="extras" title="sidd">').attr("src","/images/flair/sidd.png")),void 0!==s.blocklist3&&(0!==s.blocklist3.data.firewall&&X()(a).append(X()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),0!==s.blocklist3.data.watch&&X()(a).append(X()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),0!==s.blocklist3.data.whitelist&&X()(a).append(X()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),0!==s.blocklist3.data.blackhole&&X()(a).append(X()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),0!==s.blocklist3.data.proxy_block?(console.log("proxy block detected!"),X()(a).append(X()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png"))):console.log("proxy where art thou"+s.blocklist3.data))}if(void 0!==l&&0!==l){var f=r.entries[0].body_plain;X()(a).append(X()('<img class="extras" title="'+f+'">').attr("src","/images/flair/note.png"))}}}}}))}}))}.bind(this)):"alertgroup"===a&&X()(document.body).find(".alertTableHorizontal").find(".entity").each((function(e,a){if(null==X()(a).find(".extras")[0]){var n=X()(document.body).find(".alertTableHorizontal");n.find("a").attr("target","_blank"),n.find("a").find(".entity").wrap("<a href='about:blank' target='targ'></a>"),n.find("a").each((function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)}));var r=X()("<span />",{html:X()(a).attr("data-entity-value")}).html();if(void 0!==r&&void 0!==t){var i=t;if(void 0!==(i=void 0!==i[r.toLowerCase()]?i[r.toLowerCase()]:i[r])){var o=i.id,s=bi(i.count),l=i.data;console.log("entitydata for "+i.id),console.log(l);var c=i.entry,d=X()('<span class="noselect">');if(d.addClass("circleNumber"),d.addClass("extras"),d.text(s),X()(a).append(d),X()(a).attr("data-entity-id",o),X()(a).unbind("click"),void 0!==l){if(void 0!==l.scanner&&"true"===l.scanner.active&&X()(a).append(X()('<img class="extras" title="scanner">').attr("src","/images/flair/scanner.png")),void 0!==l.sidd&&0!==Object.keys(l.sidd.data).length&&l.sidd.data.constructor===Object&&X()(a).append(X()('<img class="extras" title="sidd">').attr("src","/images/flair/sidd.png")),void 0!==l.geoip&&l.geoip.data.isocode){var p;p="Sandia National Laboratories"===l.geoip.data.isp?"sandia":l.geoip.data.isocode;var u=X()('<img title="'+p.toLowerCase()+'">').attr("src","/images/flags/"+p.toLowerCase()+".png");u.addClass("extras"),X()(a).append(u)}void 0!==l.blocklist3&&(0!==l.blocklist3.data.firewall&&X()(a).append(X()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),0!==l.blocklist3.data.watch&&X()(a).append(X()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),0!==l.blocklist3.data.whitelist&&X()(a).append(X()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),0!==l.blocklist3.data.blackhole&&X()(a).append(X()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),0!==l.blocklist3.data.proxy_block?(console.log("proxy_block detected!"),X()(a).append(X()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png"))):console.log("Why no pblock? "+l.blocklist3.data))}if(void 0!==c&&0!==c){var h=i.entries[0].body_plain;X()(a).append(X()('<img class="extras" title="'+h+'">').attr("src","/images/flair/note.png"))}}}}})),void 0!==i&&null!==i&&i(),console.log("BOOMBAZ")}.bind(this),1e3)}},ki=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={data:[],allSelected:!1,loading:!1},n.getLinks=n.getLinks.bind(Object(l.a)(n)),n.handleTHeadCheckboxSelection=n.handleTHeadCheckboxSelection.bind(Object(l.a)(n)),n.handleRowSelection=n.handleRowSelection.bind(Object(l.a)(n)),n.handleCheckboxSelection=n.handleCheckboxSelection.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.getLinks(),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"links-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"links-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Context",accessor:"context",minWidth:100,maxWidth:800,sortable:!0},{Header:"Memo",accessor:"memo",minWidth:100,maxWidth:800,sortable:!0},{Header:"Link ID",accessor:"linkid",maxWidth:100,sortable:!0}];return r.a.createElement(q.a,{dialogClassName:"links-modal",show:this.props.modalActive,onHide:this.props.linksModalToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,this.state.data.length," items linked to ",this.props.type," ",this.props.id)),r.a.createElement(q.a.Body,null,r.a.createElement(qt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items Linked.",loading:this.state.loading,style:{maxHeight:"60vh"},filterable:!0})),r.a.createElement(q.a.Footer,null,r.a.createElement(wi,{data:this.state.data,id:this.props.id,type:this.props.type,getLinks:this.getLinks,errorToggle:this.props.errorToggle})))}},{key:"getLinks",value:function(){this.setState({loading:!0}),X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id+"/link",success:function(e){for(var t=[],a=0;a<e.records.length;a++){var n={};n.linkid=e.records[a].id,n.context=e.records[a].context;for(var r=0;r<e.records[a].vertices.length;r++)if(e.records[a].vertices[r].id===this.props.id){if(e.records[a].vertices[r].type===this.props.type)continue;n.id=e.records[a].vertices[r].id,n.type=e.records[a].vertices[r].type,n.memo=e.records[a].memo[r],t.push(n)}else n.id=e.records[a].vertices[r].id,n.type=e.records[a].vertices[r].type,n.memo=e.records[a].memo[r],t.push(n)}this.setState({data:t,loading:!1})}.bind(this),error:function(e){this.setState({loading:!1}),this.props.errorToggle("failed to get links",e)}.bind(this)})}},{key:"handleRowSelection",value:function(e,t,a){var n=this;return{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;t.row.id===o.id&&t.row.type===o.type?o.selected=!0:o.selected=!1}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}}},{key:"handleCheckboxSelection",value:function(e,t,a){var n=this;return"selected"===a.id?{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.row.id===o.id&&t.row.type===o.type){o.selected=!o.selected;break}}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:n.checkAllSelected(r)}),e.stopPropagation()}}:{}}},{key:"handleTHeadCheckboxSelection",value:function(e,t,a,n){var r=this;return"selected"===a.id?{onClick:function(t){var a,n=r.state.data,i=!r.state.allSelected,o=Object(w.a)(n);try{for(o.s();!(a=o.n()).done;){var s,l=a.value,c=Object(w.a)(e.pageRows);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(l.id===d.id&&l.type===d.type){l.selected=i;break}}}catch(p){c.e(p)}finally{c.f()}}}catch(p){o.e(p)}finally{o.f()}r.setState({data:n,allSelected:i})}}:{}}},{key:"checkAllSelected",value:function(e){var t,a=Object(w.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(n){a.e(n)}finally{a.f()}return!0}}]),a}(n.Component),wi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={entry:!1,thing:!1,actionSuccess:!1},n.RemoveLink=n.RemoveLink.bind(Object(l.a)(n)),n.RemoveLinkAjax=n.RemoveLinkAjax.bind(Object(l.a)(n)),n.ToggleActionSuccess=n.ToggleActionSuccess.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e,t=!1,a=!1,n=Object(w.a)(this.props.data);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.type&&i.selected&&("entry"===i.type?t=!0:a=!0)}}catch(o){n.e(o)}finally{n.f()}return r.a.createElement("div",null,this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement("span",{bsStyle:{color:"green"}},"Action Successful!")):null,r.a.createElement("div",null,a||t?r.a.createElement("h4",{style:{float:"left"}},"Actions"):r.a.createElement("div",null," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a link for options"):null," "),r.a.createElement(Yt.a,{style:{float:"right"}},a||t?r.a.createElement(H.a,{onClick:this.RemoveLink},"Remove Link"):null)))}},{key:"RemoveLink",value:function(){var e,t=Object(w.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&this.RemoveLinkAjax(parseInt(a.linkid))}}catch(n){t.e(n)}finally{t.f()}}},{key:"RemoveLinkAjax",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/link/"+e,success:function(e){console.log("successfully removed link"),this.ToggleActionSuccess()}.bind(this),error:function(e){this.props.errorToggle("failed to remove link",e)}.bind(this)})}},{key:"ToggleActionSuccess",value:function(){var e=!this.state.actionSuccess;this.props.getLinks(),this.setState({actionSuccess:e})}}]),a}(n.Component),Si=a(1111),Ti={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}},Ci=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleRowSelection=function(e,t,a){return{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;t.row.id===o.id&&t.row.type===o.type?o.selected=!0:o.selected=!1}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}},n.handleCheckboxSelection=function(e,t,a){return"selected"===a.id?{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.row.id===o.id&&t.row.type===o.type){o.selected=!o.selected;break}}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:n.checkAllSelected(r)}),e.stopPropagation()}}:{}},n.handleTHeadCheckboxSelection=function(e,t,a,r){return"selected"===a.id?{onClick:function(t){var a,r=n.state.data,i=!n.state.allSelected,o=Object(w.a)(r);try{for(o.s();!(a=o.n()).done;){var s,l=a.value,c=Object(w.a)(e.pageRows);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(l.id===d.id&&l.type===d.type){l.selected=i;break}}}catch(p){c.e(p)}finally{c.f()}}}catch(p){o.e(p)}finally{o.f()}n.setState({data:r,allSelected:i})}}:{}},n.checkAllSelected=function(e){var t,a=Object(w.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(n){a.e(n)}finally{a.f()}return!0},n.getMarkedItems=function(){var e=ce("marked"),t={id:n.props.id,type:n.props.type,subject:n.props.string};e&&((e=JSON.parse(e)).unshift(t),n.setState({data:e}))},n.state={data:[],allSelected:!1},n.handleTHeadCheckboxSelection=n.handleTHeadCheckboxSelection.bind(Object(l.a)(n)),n.handleRowSelection=n.handleRowSelection.bind(Object(l.a)(n)),n.handleCheckboxSelection=n.handleCheckboxSelection.bind(Object(l.a)(n)),n.getMarkedItems=n.getMarkedItems.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0,this.getMarkedItems()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"subject",maxWidth:"100%",sortable:!0}];return r.a.createElement(q.a,{dialogClassName:"mark-modal",show:this.props.modalActive,onHide:this.props.markModalToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Marked Objects")),r.a.createElement(q.a.Body,null,this.state.data.length>0?r.a.createElement(qt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items marked.",style:{maxHeight:"60vh"},filterable:!0}):r.a.createElement("h3",null,"No marked items detected.")),r.a.createElement(q.a.Footer,null,r.a.createElement(xi,{data:this.state.data,id:this.props.id,type:this.props.type,getMarkedItems:this.getMarkedItems,errorToggle:this.props.errorToggle})))}}]),a}(n.Component),xi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).deleteCallback=function(e){!0===e&&n.RemoveSelected(),n.setState({pendingDelete:!1})},n.LinkContextChange=function(e){n.setState({linkContextString:e.target.value})},n.ExpandLinkToggle=function(e){if(!0===e||!1===e)n.setState({linkPanel:e,linkContextString:""});else{var t=!n.state.linkPanel;n.setState({linkPanel:t,linkContextString:""})}},n.RemoveSelected=function(){var e,t=Object(w.a)(n.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&Ga(a.type,a.id)}}catch(r){t.e(r)}finally{t.f()}n.props.getMarkedItems(),n.state.actionSuccess&&n.setState({actionSuccess:!1})},n.StartDelete=function(){n.setState({pendingDelete:!0})},n.MoveEntry=function(){var e,t=Object(w.a)(n.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&"entry"===a.type&&n.EntryAjax(a.id,!0)}}catch(r){t.e(r)}finally{t.f()}},n.CopyEntry=function(){var e,t=Object(w.a)(n.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&"entry"===a.type&&n.EntryAjax(a.id,!1)}}catch(r){t.e(r)}finally{t.f()}},n.Link=function(){var e,t=Object(w.a)(n.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.selected){var r=[],i={},o={};i.id=parseInt(a.id),i.type=a.type,o.id=parseInt(n.props.id),o.type=n.props.type,r.push(i),r.push(o),n.LinkAjax(r)}}}catch(s){t.e(s)}finally{t.f()}},n.Reparse=function(){n.setState({reparseButton:Ti.LOADING}),X.a.when.apply(X.a,Object(T.a)(n.props.data.filter((function(e){return e.selected})).map((function(e){return n.ReparseAjax(e)})))).then((function(){n.setState({reparseButton:Ti.SUCCESS})}),(function(e){console.error(e),n.setState({reparseButton:Ti.ERROR}),n.props.errorToggle("error reparsing",e)})).always((function(){setTimeout((function(){n.setState({reparseButton:Ti.READY})}),2e3)}))},n.ReparseAjax=function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"})},n.Promote=function(){n.setState({promoteButton:Ti.LOADING});var e=!0;X.a.when.apply(X.a,Object(T.a)(n.props.data.filter((function(e){return e.selected})).map((function(e){return n.PromoteAjax(e)})))).then((function(){n.setState({promoteButton:Ti.SUCCESS})}),(function(t){e=!1,console.error(t),n.setState({promoteButton:Ti.ERROR}),n.props.errorToggle("error adding alerts to event",t)})).always((function(){setTimeout((function(){n.setState({promoteButton:Ti.READY}),e&&window.location.reload()}),2e3)}))},n.PromoteAjax=function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(n.props.id)}),contentType:"application/json; charset=UTF-8"})},n.LinkAjax=function(e){var t={weight:1};t.vertices=e,n.state.linkContextString&&(t.context=n.state.linkContextString),X.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to link",e)}.bind(Object(l.a)(n))})},n.EntryAjax=function(e,t){X.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){var n;n={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(Object(l.a)(n))})},n.RemoveEntryAfterMove=function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")},error:function(e){this.props.errorToggle("Failed to remove original entry",e)}})},n.ToggleActionSuccess=function(e){if(!0===e||!1===e)n.setState({actionSuccess:e});else{var t=!n.state.actionSuccess;n.setState({actionSuccess:t})}},n.state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:Ti.READY,deleteButton:Ti.READY,promoteButton:Ti.READY},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e,t=!1,a=!1,n=!0,i=0,o=Object(w.a)(this.props.data);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.type&&s.selected&&(i++,"entry"===s.type?t=!0:a=!0,"alert"!==s.type&&(n=!1))}}catch(g){o.e(g)}finally{o.f()}var l=0!==i&&n&&"event"===this.props.type,c=this.state,d=c.reparseButton,p=c.deleteButton,u=c.promoteButton,h=c.pendingDelete,m=null;return h&&(m=this.props.data.filter((function(e){return e.selected})).map((function(e){return{type:e.type,id:e.id}}))),r.a.createElement("div",null,this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement(H.a,{bsStyle:"success",onClick:this.RemoveSelected},"Action Successful! Remove Mark?"),r.a.createElement(H.a,{onClick:this.ToggleActionSuccess},"Keep Marked")):r.a.createElement("div",{style:{display:"grid"}},r.a.createElement("div",null,a||t?r.a.createElement("h4",{style:{float:"left"}},"Actions"):r.a.createElement("div",null," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a Marked Object"):null," "),r.a.createElement(Yt.a,{style:{float:"right"}},t&&!a&&"alertgroup"!==this.props.type?r.a.createElement(H.a,{onClick:this.MoveEntry},"Move to ",this.props.type," ",this.props.id):null,t&&!a&&"alertgroup"!==this.props.type?r.a.createElement(H.a,{onClick:this.CopyEntry},"Copy to ",this.props.type," ",this.props.id):null,a||t?r.a.createElement(H.a,{onClick:this.ExpandLinkToggle},"Link to ",this.props.type," ",this.props.id):null,l&&r.a.createElement(H.a,{bsStyle:u.style,onClick:this.Promote,disabled:u.disabled},u.text?u.text:"Add to ".concat(this.props.type," ").concat(this.props.id)),(a||t)&&r.a.createElement(H.a,{bsStyle:d.style,onClick:this.Reparse,disabled:d.disabled},d.text?d.text:"Reparse Flair"),(a||t)&&r.a.createElement(H.a,{bsStyle:"warning",onClick:this.RemoveSelected},"Unmark"),(a||t)&&r.a.createElement(H.a,{bsStyle:"danger",onClick:this.StartDelete,disabled:p.disabled},p.text?p.text:"Delete"))),this.state.linkPanel&&(a||t)?r.a.createElement(B.a,{collapsible:!0,expanded:this.state.linkPanel},r.a.createElement(Si.a,{horizontal:!0},r.a.createElement(D.a,{sm:2},"Provide context to this link:"),r.a.createElement(D.a,{sm:9},r.a.createElement(Br.a,{type:"text",value:this.state.linkContextString,placeholder:"optional",onChange:this.LinkContextChange})),r.a.createElement(D.a,{sm:1},r.a.createElement(H.a,{onClick:this.Link,bsStyle:"success"},"Submit")))):null,h&&r.a.createElement(vn,{things:m,errorToggle:this.props.errorToggle,callback:this.deleteCallback})))}}]),a}(n.Component);xi.defaultProps={data:{}},Ci.defaultProps={modalActive:!0};var ji,Oi,Di,Ni,_i,Ai=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onBlur=function(e){var t=e.target.value;if(""!==t){var a=t.split(/[ ,]+/);n.setState({emailField:a})}},n.getData=function(){X.a.ajax({type:"get",url:"/scot/api/v2/prepexport/"+n.props.type+"/"+n.props.id,success:function(e){this.setState({data:e}),this.setState({leaveCatch:!1,showEditor:!0})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to get export data from server!",e)}.bind(Object(l.a)(n))})},n.exportResponse=function(e){"success"===e&&n.setState({showEditor:!1,responseSuccess:!0})},n.state={showEditor:!1,data:null,responseSuccess:!1,emailField:[]},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.getData()}},{key:"render",value:function(){var e=!1;return this.state.responseSuccess&&(e=!0),r.a.createElement("div",null,r.a.createElement(q.a,{dialogClassName:"links-modal",show:!0,onHide:this.props.exportToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Export ",this.props.type," ",this.props.id)),r.a.createElement(q.a.Body,null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email addresses"),r.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",onBlur:this.onBlur,placeholder:"Enter emails (comma-separated)",disabled:e})),r.a.createElement("br",null),this.state.showEditor?r.a.createElement(or,{entryAction:"Export",exportResponse:this.exportResponse,type:this.props.type,targetid:this.props.id,id:"add_entry",recipients:this.state.emailField,addedentry:this.props.exportToggle,content:this.state.data,errorToggle:this.props.errorToggle}):null,!this.state.showEditor&&this.state.responseSuccess?r.a.createElement(Mi,null):null,this.state.showEditor||this.state.responseSuccess?null:r.a.createElement("i",{className:"fa fa-spinner fa-spin fa-2x","aria-hidden":"true"}))))}}]),a}(r.a.Component),Mi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("i",{className:"fa fa-check","aria-hidden":"true",style:{color:"green"}})," ","Export Successful!")}}]),a}(n.Component),Li={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Pi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={showAllPromotedDataToolbar:!1},n.showAllPromotedDataToggle=n.showAllPromotedDataToggle.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"showAllPromotedDataToggle",value:function(){!1===this.state.showAllPromotedDataToolbar?this.setState({showAllPromotedDataToolbar:!0}):this.setState({showAllPromotedDataToolbar:!1})}},{key:"render",value:function(){var e=null,t=[],a=[],n=3;"event"===this.props.type?e="alert":"incident"===this.props.type?e="event":"intel"===this.props.type?e="dispatch":"product"===this.props.type&&(e="intel");for(var i=0;i<this.props.data.length;i++){i>0&&t.push(r.a.createElement("span",null," , "));var o="/"+e+"/"+this.props.data[i];t.push(r.a.createElement("span",{key:this.props.data[i]},r.a.createElement(Ne.Link,{to:o},this.props.data[i])))}this.props.data.length<3&&(n=this.props.data.length);for(var s=0;s<n;s++){s>0&&a.push(r.a.createElement("div",null," , "));var l="/"+e+"/"+this.props.data[s];a.push(r.a.createElement("div",{key:this.props.data[s]},r.a.createElement(Ne.Link,{to:l},this.props.data[s])))}return this.props.data.length>3&&a.push(r.a.createElement("div",{onClick:this.showAllPromotedDataToggle},",",r.a.createElement("a",{href:"javascript:;"},"...more"))),r.a.createElement("td",null,r.a.createElement("span",{id:"promoted_from",style:{display:"flex"}},a),this.state.showAllPromotedDataToolbar?r.a.createElement(un.a,{isOpen:!0,onRequestClose:this.showAllPromotedDataToggle,style:Li},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:this.showAllPromotedDataToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Promoted From")),r.a.createElement("div",{className:"modal-body promoted-from-full"},t),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(H.a,{id:"cancel-modal",onClick:this.showAllPromotedDataToggle},"Close"))):null)}}]),a}(n.Component),Fi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).updated=function(e,t){n.setState({refreshing:!0,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1});var a="entry";"alertgroup"==n.props.type&&(a="alert"),X.a.ajax({type:"get",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,success:function(e){if(this.state.isMounted){var t=e;this.setState({headerData:t,showEventData:!0,eventLoaded:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),"alertgroup"==this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(Object(l.a)(n)),error:function(e){this.setState({showEventData:!0,eventLoaded:!0,isNotFound:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload detail data. Error message: "+e.responseText,e)}.bind(Object(l.a)(n))}),X.a.ajax({type:"get",url:"scot/api/v2/"+n.props.type+"/"+n.props.id+"/"+a,success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntryData:!0,entryLoaded:!0,entryData:t,runWatcher:!0}),this.Watcher(),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1})}}.bind(Object(l.a)(n)),error:function(e){this.setState({showEntryData:!0,entryLoaded:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entry data. Error message: "+e.responseText,e)}}),X.a.ajax({type:"get",url:"scot/api/v2/"+n.props.type+"/"+n.props.id+"/entity",success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntityData:!0,entityLoaded:!0,entityData:t});var a={waitEntry:function(){0==this.state.entryLoaded?setTimeout(a.waitEntry,50):(setTimeout(function(){Ei.entityUpdate(t,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(this)),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}))}.bind(this)};a.waitEntry()}}.bind(Object(l.a)(n)),error:function(e){this.setState({showEntityData:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entity data.",e)}.bind(Object(l.a)(n))}),void 0!=e&&void 0!=t&&n.props.errorToggle(t)},n.flairToolbarToggle=function(e,t,a,r,i){n.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:a,entityoffset:r,entityobj:i})},n.flairToolbarOff=function(){if(n.state.isMounted){var e=n.state.entityDetailKey+1;n.setState({flairToolbar:!1,entityDetailKey:e})}},n.linkWarningToggle=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===n.state.linkWarningToolbar?n.setState({linkWarningToolbar:!0,link:e,nopop:t}):n.setState({linkWarningToolbar:!1,nopop:t})},n.exportToggle=function(){!1===n.state.exportModal?n.setState({exportModal:!0}):n.setState({exportModal:!1})},n.viewedbyfunc=function(e){var t=[];if(null!==e)for(var a in e.view_history)t.push(a);return t},n.entryToggle=function(){!1===n.state.entryToolbar?n.setState({entryToolbar:!0}):n.setState({entryToolbar:!1})},n.deleteToggle=function(e,t){!1===n.state.deleteToolbar?n.setState({deleteToolbar:!0,deleteType:e}):n.setState({deleteToolbar:!1,deleteType:e}),t&&n.setState({isDeleted:!0})},n.changeHistoryToggle=function(){!1===n.state.changeHistoryToolbar?n.setState({changeHistoryToolbar:!0}):n.setState({changeHistoryToolbar:!1})},n.viewedByHistoryToggle=function(){!1===n.state.viewedByHistoryToolbar?n.setState({viewedByHistoryToolbar:!0}):n.setState({viewedByHistoryToolbar:!1})},n.permissionsToggle=function(){!1===n.state.permissionsToolbar?n.setState({permissionsToolbar:!0}):n.setState({permissionsToolbar:!1})},n.entitiesToggle=function(){!1===n.state.entitiesToolbar?n.setState({entitiesToolbar:!0}):n.setState({entitiesToolbar:!1,entryEntityData:null})},n.promoteToggle=function(){!1===n.state.promoteToolbar?n.setState({promoteToolbar:!0}):n.setState({promoteToolbar:!1})},n.fileUploadToggle=function(){!1===n.state.fileUploadToolbar?n.setState({fileUploadToolbar:!0}):n.setState({fileUploadToolbar:!1})},n.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n.Watcher=function(){X()("iframe").each(function(e,t){t.contentWindow.requestAnimationFrame(function(){if(null!==t.contentDocument){var e=[];e.push(this.checkFlairHover),e.push(this.checkHighlight),X()(t).off("mouseenter"),X()(t).off("mouseleave"),X()(t).on("mouseenter",function(e,a){var n=setInterval(this[0],50,t),r=setInterval(this[1],50,t);X()(t).data("intervalID",n),X()(t).data("intervalID1",r),console.log("Now watching iframe "+n)}.bind(e)),X()(t).on("mouseleave",(function(){var e=X()(t).data("intervalID"),a=X()(t).data("intervalID1");window.clearInterval(e),window.clearInterval(a),console.log("No longer watching iframe "+e)}))}}.bind(this))}.bind(Object(l.a)(n))),"alertgroup"==n.props.type&&X()("#detail-container").find("a, .entity").not(".not_selectable").each(function(e,t){X()(t).off("mousedown"),X()(t).on("mousedown",function(e){var t=e.target;if("extras"==X()(t)[0].className&&(t=X()(t)[0].parentNode),X()(t).attr("url")){var a=X()(t).attr("url");this.linkWarningToggle(a)}else{var n=X()(t).attr("data-entity-id"),r=X()(t).attr("data-entity-value"),i=X()(t).offset(),o=X()(t);this.flairToolbarToggle(n,r,"entity",i,o)}}.bind(this))}.bind(Object(l.a)(n)))},n.checkHighlight=function(e){var t;if(null!==e.contentWindow){if(t=e.contentWindow.getSelection().toString(),n.state.highlightedText==t)return;n.setState({highlightedText:t})}},n.checkFlairHover=function(e,t){null!=e.contentDocument&&(X()(e).contents().find(".entity").each(function(t,a){if("rgb(255, 0, 0)"==X()(a).css("background-color"))X()(a).data("state","down");else if("down"==X()(a).data("state")){X()(a).data("state","up");var n=X()(a).attr("data-entity-id"),r=X()(a).attr("data-entity-value"),i=X()(a),o=e,s={top:X()(a).offset().top+X()(o).offset().top,left:X()(a).offset().left+X()(o).offset().left};this.flairToolbarToggle(n,r,"entity",s,i)}}.bind(Object(l.a)(n))),X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==X()(t).css("color"))X()(t).data("state","down");else if("down"==X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.linkWarningToggle(a)}}.bind(Object(l.a)(n))))},n.summaryUpdate=function(){n.forceUpdate()},n.scrollTo=function(){void 0!==n.props.taskid&&X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#iframe_"+n.props.taskid).position().top-30)},n.guideRedirectToAlertListWithFilter=function(){RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},n.props.handleFilter(null,null,!0,"alertgroup"),n.props.handleFilter([{id:"subject",value:RegExp.escape(n.state.headerData.data.applies_to[0])}],null,!1,"alertgroup"),window.open("#/alertgroup/")},n.setEntryEntities=function(e){n.entitiesToggle(),n.setState({entryEntityData:e})},n.showSignatureOptionsToggle=function(){!1===n.state.showSignatureOptions?n.setState({showSignatureOptions:!0}):n.setState({showSignatureOptions:!1})},n.markModalToggle=function(){!1===n.state.showMarkModal?n.setState({showMarkModal:!0}):n.setState({showMarkModal:!1})},n.ToggleProcessingMessage=function(e){n.setState({processing:e}),n.props.togglePreventClick()},n.linksModalToggle=function(){var e=!n.state.showLinksModal;n.setState({showLinksModal:e})},n.toggleFlair=function(){n.state.flairOff?(n.setState({flairOff:!1,runWatcher:!0}),setTimeout(function(){Ei.entityUpdate(this.state.entityData,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(Object(l.a)(n)))):n.setState({flairOff:!0})},n.handleSelection=function(e){console.log("Got selection click!"),n.setState({alertsSelected:[e]})},n.handleMultiSelection=function(e){if(n.checkSelection(e.id))n.setState({alertsSelected:n.state.alertsSelected.filter((function(t){return t.id!==e.id}))});else{var t=[].concat(Object(T.a)(n.state.alertsSelected),[e]);n.setState({alertsSelected:t})}},n.handleSelectAll=function(e){var t=e.map((function(e){return e.id}));n.setState({alertsSelected:t})},n.handleShiftSelect=function(e,t,a){e>t&&(e=[t,t=e][0]);var r=[];a.forEach(function(a){a.id<=t&&a.id>=e&&(this.checkSelection(a)||r.push(a))}.bind(Object(l.a)(n))),n.setState({alertsSelected:[].concat(Object(T.a)(n.state.alertsSelected),r)})};var r=Math.floor(1e3*Math.random());return n.state={showEventData:!1,headerData:{},sourceData:"",tagData:"",permissionsToolbar:!1,entitiesToolbar:!1,changeHistoryToolbar:!1,viewedByHistoryToolbar:!1,entryToolbar:!1,deleteToolbar:!1,deleteType:null,promoteToolbar:!1,notificationType:null,notificationMessage:null,key:n.props.id,showEntryData:!1,entryData:"",showEntityData:!1,entityData:[],entryEntityData:null,entityid:null,entitytype:null,entityoffset:null,entityobj:null,flairToolbar:!1,linkWarningToolbar:!1,exportModal:!1,refreshing:!1,loading:!1,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1,guideID:null,fileUploadToolbar:!1,isNotFound:!1,runWatcher:!1,entityDetailKey:r,processing:!1,showSignatureOptions:!1,showMarkModal:!1,showLinksModal:!1,flairOff:!1,highlightedText:"",flairing:!1,isMounted:!1,alertsSelected:[],isDeleted:!1},n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.setState({loading:!0})}},{key:"componentDidMount",value:function(){this.setState({isMounted:!0});var e={delay:function(){var e="entry";"alertgroup"===this.props.type&&(e="alert"),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){if(this.state.isMounted){var t=e;this.setState({headerData:t,showEventData:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),"alertgroup"===this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(this),error:function(e){this.setState({showEventData:!0,isNotFound:!0}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load detail data. Error message: "+e.responseText,e)}.bind(this)}),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/"+e,success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntryData:!0,entryData:t,runWatcher:!0}),this.Watcher(),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1})}}.bind(this),error:function(e){this.setState({showEntryData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entry data. Error message: "+e.responseText,e)}}),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/entity",success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntityData:!0,entityData:t});var a={waitEntry:function(){0==this.state.showEntryData?setTimeout(a.waitEntry,50):(setTimeout(function(){Ei.entityUpdate(t,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id,this.scrollTo)}.bind(this)),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}))}.bind(this)};a.waitEntry()}}.bind(this),error:function(e){this.setState({showEntityData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entity data.",e)}.bind(this)}),"alertgroup"==this.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/guide",success:function(e){if(this.state.isMounted){for(var t=[],a=0;a<e.records.length;a++)t.push(e.records[a].id);0===t.length&&(t=null),this.setState({guideID:t})}}.bind(this),error:function(e){this.setState({guideID:null}),this.props.errorToggle("Error: Failed to load guide data. Error message:"+e.responseText,e)}.bind(this)}),this.props.createCallback(this.props.id,this.updated)}.bind(this)};ji=setTimeout(e.delay,400)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1}),clearTimeout(ji),"function"===this.state.entryData.forEach&&this.state.entryData.forEach(function(e){this.props.removeCallback(e.id)}.bind(this))}},{key:"componentDidUpdate",value:function(){!0===this.state.runWatcher&&this.Watcher()}},{key:"checkSelection",value:function(e){return!!this.state.alertsSelected.some((function(t){return e===t.id}))}},{key:"render",value:function(){var e=this.state.headerData,t=this.viewedbyfunc(e),a=this.props.type,n=this.titleCase(this.props.type),i=this.props.id,o="";return this.state.headerData.subject?o=this.state.headerData.subject:this.state.headerData.value?o=this.state.headerData.value:this.state.headerData.name?o=this.state.headerData.name:this.state.headerData.body&&(o=this.state.headerData.body),r.a.createElement("div",null," ",this.state.isNotFound?r.a.createElement("h1",null,"No record found."):r.a.createElement("div",null,r.a.createElement("div",{id:"header"},r.a.createElement("div",{id:"NewEventInfo",className:"entry-header-info-null"},r.a.createElement("div",{className:"details-subject",style:{display:"inline-flex",paddingLeft:"5px"}},this.state.showEventData?r.a.createElement(Ri,{data:this.state.headerData,subjectType:n,type:a,id:this.props.id,errorToggle:this.props.errorToggle}):null,this.state.refreshing?r.a.createElement("span",{style:{color:"lightblue"}},"Refreshing Data..."):null,this.state.loading?r.a.createElement("span",{style:{color:"lightblue"}},"Loading..."):null,this.state.processing?r.a.createElement("span",{style:{color:"lightblue"}},"Processing Actions..."):null,this.state.flairing?r.a.createElement("span",{style:{color:"lightblue"}},"Flairing..."):null),"entity"!==a?r.a.createElement("div",{className:"details-table toolbar",style:{display:"flex"}},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("td",null,r.a.createElement("div",{style:{marginLeft:"5px"}},this.state.showEventData?r.a.createElement(Pa,{data:this.state.headerData,status:this.state.headerData.status,id:i,type:a,errorToggle:this.props.errorToggle}):null)),"entity"!==a?r.a.createElement("th",null,"Owner: "):null,"entity"!==a?r.a.createElement("td",null,r.a.createElement("span",null,this.state.showEventData?r.a.createElement(Cn,{key:i,data:this.state.headerData.owner,type:a,id:i,updated:this.updated,errorToggle:this.props.errorToggle}):null)):null,"entity"!==a?r.a.createElement("th",null,"Updated: "):null,"entity"!==a?r.a.createElement("td",null,r.a.createElement("span",{id:"event_updated"},this.state.showEventData?r.a.createElement(Ii,{data:this.state.headerData.updated}):null)):null,("event"===a||"incident"===a||"intel"===a||"product"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?r.a.createElement("th",null,"Promoted From:"):null,("event"===a||"incident"===a||"intel"===a||"product"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?r.a.createElement(Pi,{data:this.state.headerData.promoted_from,type:a,id:i}):null,"entity"!==a&&this.state.showEventData?r.a.createElement(mi,{data:this.state.tagData,id:i,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"tag"}):null,"entity"!==a&&this.state.showEventData?r.a.createElement(mi,{data:this.state.sourceData,id:i,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"source"}):null)))):null),r.a.createElement(vi.a,{ref:"notificationSystem"}),this.state.exportModal?r.a.createElement(Ai,{type:a,errorToggle:this.props.errorToggle,exportToggle:this.exportToggle,id:i}):null,this.state.linkWarningToolbar?r.a.createElement(_r,{linkWarningToggle:this.linkWarningToggle,link:this.state.link,nopop:this.state.nopop}):null,this.state.viewedByHistoryToolbar?r.a.createElement(Rn,{viewedByHistoryToggle:this.viewedByHistoryToggle,id:i,type:a,subjectType:n,viewedby:t,errorToggle:this.props.errorToggle}):null,this.state.changeHistoryToolbar?r.a.createElement(Ln,{changeHistoryToggle:this.changeHistoryToggle,id:i,type:a,subjectType:n,errorToggle:this.props.errorToggle}):null,this.state.entitiesToolbar?r.a.createElement("span",null,null!==this.state.entryEntityData?r.a.createElement(Dn,{entitiesToggle:this.entitiesToggle,entityData:this.state.entryEntityData,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff}):r.a.createElement(Dn,{entitiesToggle:this.entitiesToggle,entityData:this.state.entityData,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff})):null,this.state.deleteToolbar?r.a.createElement("div",null,"alert"!==this.state.deleteType?r.a.createElement(bn,{deleteType:this.state.deleteType,subjectType:n,id:i,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,removeCallback:this.props.removeCallback}):r.a.createElement(bn,{deleteType:this.state.deleteType,type:a,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,alertsSelected:this.state.alertsSelected,removeCallback:this.props.removeCallback})):null,this.state.showMarkModal?r.a.createElement(Ci,{modalActive:!0,type:a,id:i,string:o,errorToggle:this.props.errorToggle,markModalToggle:this.markModalToggle}):null,this.state.showLinksModal?r.a.createElement(ki,{modalActive:!0,type:a,id:i,errorToggle:this.props.errorToggle,linksModalToggle:this.linksModalToggle}):null,this.state.showEventData?r.a.createElement(dn,{type:a,subjectType:n,id:i,entryData:this.state.entryData,headerData:this.state.headerData,status:this.state.headerData.status,promoteToggle:this.promoteToggle,permissionsToggle:this.permissionsToggle,entryToggle:this.entryToggle,entitiesToggle:this.entitiesToggle,changeHistoryToggle:this.changeHistoryToggle,viewedByHistoryToggle:this.viewedByHistoryToggle,exportToggle:this.exportToggle,deleteToggle:this.deleteToggle,updated:this.updated,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,sourceToggle:this.sourceToggle,subjectName:this.state.headerData.subject,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,guideRedirectToAlertListWithFilter:this.guideRedirectToAlertListWithFilter,showSignatureOptionsToggle:this.showSignatureOptionsToggle,markModalToggle:this.markModalToggle,linksModalToggle:this.linksModalToggle,ToggleProcessingMessage:this.ToggleProcessingMessage,errorToggle:this.props.errorToggle,toggleFlair:this.toggleFlair,alertsSelected:this.state.alertsSelected,guideID:this.state.guideID}):null,this.state.permissionsToolbar?r.a.createElement(Bn,{updateid:i,id:i,type:a,permissionData:this.state.headerData,permissionsToggle:this.permissionsToggle,updated:this.updated,errorToggle:this.props.errorToggle}):null),this.state.showEventData&&"entity"!==a?r.a.createElement(oi,{id:i,type:a,entryToggle:this.entryToggle,updated:this.updated,entryData:this.state.entryData,headerData:this.state.headerData,showEntryData:this.state.showEntryData,showEntityData:this.state.showEntityData,summaryUpdate:this.summaryUpdate,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entryToolbar:this.state.entryToolbar,alertPreSelectedId:this.props.alertPreSelectedId,errorToggle:this.props.errorToggle,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,showSignatureOptions:this.state.showSignatureOptions,flairOff:this.state.flairOff,highlightedText:this.state.highlightedText,form:this.props.form,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Ei.entityUpdate,handleSelection:this.handleSelection,handleShiftSelect:this.handleShiftSelect,handleMultiSelection:this.handleMultiSelection,handleSelectAll:this.handleSelectAll,alertsSelected:this.state.alertsSelected,setEntryEntities:this.setEntryEntities}):null,this.state.showEventData&&"entity"===a?r.a.createElement(ur,{entityid:i,form:this.props.form,entitytype:"entity",id:i,type:"entity",fullScreen:!0,errorToggle:this.props.errorToggle,linkWarningToggle:this.linkWarningToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Ei.entityUpdate}):null,this.state.flairToolbar?r.a.createElement(ur,{key:this.state.entityDetailKey,form:this.props.form,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entityid:parseInt(this.state.entityid,10),data:this.state.headerData,entityvalue:this.state.entityvalue,entitytype:this.state.entitytype,type:this.props.type,id:this.props.id,errorToggle:this.props.errorToggle,entityoffset:this.state.entityoffset,watcher:this.Watcher,entityobj:this.state.entityobj,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Ei.entityUpdate}):null))}}]),a}(r.a.Component),Ii=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.data;return r.a.createElement("div",null,r.a.createElement(Ia.a,{value:1e3*e,format:"MM/DD/YY hh:mm:ss a"}))}}]),a}(r.a.Component),Ri=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).handleChange=function(e){if(null!==e){var t={[n.state.keyName]:e.target.value},a=e.target.value;X.a.ajax({type:"put",url:"scot/api/v2/"+n.props.type+"/"+n.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.setState({value:a}),this.calculateWidth(a)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("error: Failed to update the subject/name",e)}.bind(Object(l.a)(n))})}},n.onChange=function(e){n.setState({value:e.target.value})},n.handleEnterKey=function(e){"Enter"===e.key&&n.handleChange(e)},n.calculateWidth=function(e){var t;X()("#invisible").html(X()("<span></span>").text(e)),t=X()("#invisible").width()+25+"px",n.setState({width:t})},n.componentWillReceiveProps=function(e){var t=e.data.subject;"signature"===e.type||"feed"===e.type?t=e.data.name:"entity"===e.type&&(t=e.data.value),n.setState({value:t}),n.calculateWidth(t)};var r="subject",i=n.props.data.subject;return"signature"===n.props.type||"feed"===n.props.type?(r="name",i=n.props.data.name):"entity"===n.props.type&&(r="value",i=n.props.data.value),n.state={value:i,width:"",keyName:r},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.calculateWidth(this.state.value)}},{key:"render",value:function(){var e=!1;return"entity"===this.props.type&&""!==this.state.value&&(e=!0),r.a.createElement("div",null,this.props.subjectType," ",this.props.id,":"," ",r.a.createElement("input",{type:"text",value:this.state.value,onKeyPress:this.handleEnterKey,onChange:this.onChange,onBlur:this.handleChange,style:{width:this.state.width,lineHeight:"normal"},className:"detail-header-input",disabled:e}))}}]),a}(r.a.Component),Ui=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=[];t.push(r.a.createElement(Fi,{key:e.props.id,id:e.props.id,type:e.props.type,toggleEventDisplay:e.props.viewEvent,taskid:e.props.taskid,alertPreSelectedId:e.props.alertPreSelectedId,handleFilter:e.props.handleFilter,errorToggle:e.props.errorToggle,history:e.props.history,form:e.props.form,createCallback:e.props.createCallback,removeCallback:e.props.removeCallback,togglePreventClick:e.props.togglePreventClick}));var a="100%";return void 0!==X()("#list-view")[0]&&(a="calc(100% - "+X()("#list-view").width()+"px)"),r.a.createElement("div",{id:"main-detail-container",className:"entry-container",style:{width:a,position:"relative"},tabIndex:"3"},t)},e}return a}(r.a.Component),Wi=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).componentWillMount=function(){void 0===n.props.viewMode||"default"===n.props.viewMode||"landscape"===n.props.viewMode?n.Landscape():"portrait"===n.props.viewMode&&n.Portrait(),n.props.id&&n.ConvertAlertIdToAlertgroupId(n.props.id),n.ConvertEntryIdToType(n.props.id),X.a.ajax({type:"get",url:"/scot/api/v2/form",success:function(e){this.setState({form:e})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("Failed to get form structure",e)}.bind(Object(l.a)(n))})},n.componentDidMount=function(){var e=n.state.scrollheight,t=n.state.sort,a=n.state.filter,r=n.state.activepage.limit,i=n.state.activepage.page,o=[];void 0!==n.props.id&&n.props.id.length>0&&(n.props.id,"landscape"===n.state.viewMode&&(e="30vh"));var s=[],c=n.props.type+":listview";n.props.createCallback(c,n.reloadactive);var d="/scot/api/v2/"+n.state.type;"alert"===n.props.type&&(d="/scot/api/v2/alertgroup");var p={limit:r,offset:i*r};if(void 0!==t||null===t){var u={};X.a.each(t,(function(e,t){var a=-1;t.desc||(a=1),u[t.id]=a})),p.sort=JSON.stringify(u)}void 0===t&&null!==t||X.a.each(a,(function(e,t){if("source"===t.id||"tag"===t.id){var a,n=[],r=Object(w.a)(t.value);try{for(r.s();!(a=r.n()).done;){var i=a.value;n.push(i.name)}}catch(s){r.e(s)}finally{r.f()}p[t.id]=JSON.stringify(n)}else if("created"===t.id||"updated"===t.id){var o=[];o.push(t.value.start),o.push(t.value.end),p[t.id]=JSON.stringify(o)}else p[t.id]=JSON.stringify(t.value)})),_i=X.a.ajax({type:"GET",url:d,data:p,traditional:!0,success:function(t){Oi=t,X.a.each(Oi.records,function(e,t){s[e]={},X.a.each(t,function(t,a){if("sources"===t||"source"===t){if(void 0!==a){var n=a.join(", ");s[e].source=n}}else if("tags"===t||"tag"===t){if(void 0!==a){var r=a.join(", ");s[e].tag=r}}else s[e][t]=a;"id"===t&&(this.props.createCallback(a,this.reloadactive),o.push(a))}.bind(this)),s[e].classname=e%2===0?"table-row roweven":"table-row rowodd"}.bind(this));var a=this.getPages(t.totalRecordCount);this.setState({scrollheight:e,objectarray:s,totalCount:t.totalRecordCount,loading:!1,idsarray:o,totalPages:a}),"alert"===this.props.type&&!1===this.state.showSelectedContainer||void 0===this.state.id||null===this.state.id?this.setState({showSelectedContainer:!1}):this.setState({showSelectedContainer:!0})}.bind(Object(l.a)(n)),error:function(e){"abort"===!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(Object(l.a)(n))}),X()("#list-view-container").keydown(n.keyNavigate),X()(document.body).keydown(function(e){X()("input").is(":focus")||X()("textarea").is(":focus")||70===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleView()}.bind(Object(l.a)(n)))},n.componentWillUnmount=function(){document.removeEventListener("keydown",n.keyNavigate)},n.togglePreventClick=function(){n.setState({preventClick:!n.state.preventClick})},n.keyNavigate=function(e){if("click"!==e.type){if(!["j","k","ArrowUp","ArrowDown"].includes(e.key))return;var t=(e.target||e.srcElement).tagName.toLowerCase();if("input"===t||"textarea"===t)return}var a=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected");if(a){var r=null;switch(e.key){case"j":case"ArrowDown":default:r=a.parentElement.nextElementSibling;break;case"k":case"ArrowUp":r=a.parentElement.previousElementSibling}if(r){var i=r.children[0].children[0].innerHTML;n.props.history.push("/".concat(n.state.type,"/").concat(i)),e.preventDefault(),e.stopPropagation()}}},n.reloadactive=function(){n.getNewData()},n.ToggleCreateEntity=function(){n.setState({showEntityCreateModal:!n.state.showEntityCreateModal})},n.render=function(){var e=!1,t=n.state.scrollheight;n.state.listViewContainerDisplay,null!=n.state.id&&null!=n.state.typeCapitalized&&(document.title=n.state.typeCapitalized.charAt(0)+"-"+n.state.id),null==xt("listViewFilter"+n.props.type)&&null==xt("listViewSort"+n.props.type)&&null==xt("listViewPage"+n.props.type)||(e=!0);var a=Ta(n.props.type,{},{},!1);return r.a.createElement("div",null,"entry"!==n.state.type?r.a.createElement("div",{key:n.state.listViewKey,className:"allComponents"},r.a.createElement("div",{className:"black-border-line"},r.a.createElement("div",{className:"mainview"},r.a.createElement("div",null,r.a.createElement("div",{className:"list-buttons"},"on"===n.props.notificationSetting?r.a.createElement(Ha.a,{eventkey:"1",onClick:n.props.notificationToggle,bsSize:"xsmall"},"Mute Notifications"):r.a.createElement(Ha.a,{eventkey:"2",onClick:n.props.notificationToggle,bsSize:"xsmall"},"Turn On Notifications"),"event"===n.props.type||"intel"===n.props.type||"incident"===n.props.type||"signature"===n.props.type||"guide"===n.props.type||"dispatch"===n.props.type||"feed"===n.props.type||"product"===n.props.type||"entity"===n.props.type?r.a.createElement(Ha.a,{onClick:n.createNewThing,eventkey:"6",bsSize:"xsmall"},"Create ",n.state.typeCapitalized):null,r.a.createElement(Ha.a,{eventkey:"5",bsSize:"xsmall",onClick:n.exportCSV},"Export to CSV"),r.a.createElement(Ha.a,{bsSize:"xsmall",onClick:n.toggleView},"Full Screen Toggle (f)"),e?r.a.createElement(Ha.a,{onClick:n.clearAll,eventkey:"3",bsSize:"xsmall",bsStyle:"info"},"Clear All Filters"):null),r.a.createElement("div",{id:"list-view-container",tabIndex:"1"},r.a.createElement("div",{id:"list-view",tabIndex:"2"},r.a.createElement(qt.a,{columns:a,data:n.state.objectarray,style:{maxHeight:t},page:n.state.activepage.page,pages:n.state.totalPages,defaultPageSize:50,onPageChange:n.handlePageChange,onPageSizeChange:n.handlePageSizeChange,pageSize:n.state.activepage.limit,onFilteredChange:n.handleFilter,filtered:n.state.filter,onSortedChange:n.handleSort,sorted:n.state.sort,manual:!0,sortable:!0,filterable:!0,resizable:!0,styleName:"styles.ReactTable",className:"-striped -highlight",minRows:0,LoadingComponent:n.CustomTableLoader,loading:n.state.loading,getTrProps:n.handleRowSelection}))),r.a.createElement("div",{onMouseDown:n.dragdiv,className:"splitter",style:{display:"block",height:"10px",backgroundColor:"black",borderTop:"1px solid #AAA",borderBottom:"1px solid #AAA",cursor:"row-resize",overflow:"hidden"}}),n.state.showSelectedContainer?r.a.createElement(Ui,{key:n.state.id,id:n.state.id,type:n.state.queryType,alertPreSelectedId:n.state.alertPreSelectedId,taskid:n.state.entryid,handleFilter:n.handleFilter,errorToggle:n.props.errorToggle,history:n.props.history,togglePreventClick:n.togglePreventClick,form:n.state.form,createCallback:n.props.createCallback,removeCallback:n.props.removeCallback,togglePreventClick:n.togglePreventClick}):null,n.state.showEntityCreateModal?r.a.createElement(Ur,{match:"",modalActive:n.state.showEntityCreateModal,ToggleCreateEntity:n.ToggleCreateEntity,errorToggle:n.props.errorToggle}):null)))):null)},n.CustomTableLoader=function(){return r.a.createElement("div",{className:"-loading"+(n.state.loading?" -active":"")},r.a.createElement(pt,{loading:n.state.loading}))},n.AutoScrollToId=function(){var e=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected"),t=document.querySelector(".ReactTable .rt-tbody");e?((t.scrollTop+t.offsetHeight-e.offsetHeight<e.offsetTop||e.offsetTop<t.scrollTop)&&(t.scrollTop=e.offsetTop-t.offsetHeight/2+e.offsetHeight/2),n.setState({initialAutoScrollToId:!0})):t.scrollTop=0},n.componentDidUpdate=function(e,t){for(var a=0;a<n.state.objectarray.length;a++){var r=n.state.objectarray[a].id;(null!=n.state.id&&n.state.id===r&&n.state.id!==t.id||null!=n.state.id&&n.state.id===r&&!1===t.initialAutoScrollToId)&&setTimeout(n.AutoScrollToId,300)}},n.componentWillReceiveProps=function(e){void 0===e.id?n.setState({type:e.type,id:null,showSelectedContainer:!1,scrollheight:X()(window).height()-170+"px"}):e.id!==n.props.id&&("alert"===n.props.type?(n.ConvertAlertIdToAlertgroupId(e.id),n.ConvertEntryIdToType(e.id),n.setState({type:e.type,alertPreSelectedId:e.id})):"task"===n.props.type?n.setState({type:e.type,queryType:e.queryType,id:e.id,entryid:e.id2}):n.setState({type:e.type,id:e.id}))},n.ConvertAlertIdToAlertgroupId=function(e){"alert"===n.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/alert/"+e,success:function(e){var t=e;this.setState({id:t.alertgroup,showSelectedContainer:!0})}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(Object(l.a)(n))})},n.ConvertEntryIdToType=function(e){"entry"===n.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/entry/"+e,async:!1,success:function(e){this.selected(e.target.type,e.target.id,this.props.id)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(Object(l.a)(n))})},n.startdrag=function(e){X()("iframe").each((function(e,t){X()(t).addClass("pointerEventsOff")})),n.setState({manualScrollHeight:Ni+e.clientY-Di+"px",scrollheight:Ni+e.clientY-Di+"px"})},n.stopdrag=function(e){X()("iframe").each((function(e,t){X()(t).removeClass("pointerEventsOff")})),document.onmousemove=null},n.dragdiv=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=document.getElementsByClassName("ReactTable");Di=e.clientY,Ni=parseInt(document.defaultView.getComputedStyle(t[0]).height,10),document.onmousemove=n.startdrag,document.onmouseup=n.stopdrag},n.toggleView=function(){0!==n.state.id.length&&!0===n.state.showSelectedContainer&&"none"!==n.state.listViewContainerDisplay?n.setState({listViewContainerDisplay:"none",scrollheight:"0px"}):n.setState({listViewContainerDisplay:null,scrollheight:"30vh"})},n.Landscape=function(){document.onmousemove=null,document.onmousedown=null,document.onmouseup=null,X()(".splitter").css("width","100%"),X()(".mainview").show(),n.setState({classname:[" "," "," "," "],splitter:!1,display:"block",maxheight:"",alldetail:!0,differentviews:"100%",scrollheight:null!=n.state.id?"300px":X()(window).height()-170+"px",maxwidth:"",minwidth:"",scrollwidth:"100%",resize:"vertical"}),n.setState({listViewOrientation:"landscape-list-view"}),Dt("viewMode","landscape",1e3)},n.clearAll=function(){var e=n.state.listViewKey+1;n.setState({listViewKey:e,activepage:{page:0,limit:n.state.activepage.limit},sort:[{id:"id",desc:!0}],filter:[]}),n.getNewData({page:0},[{id:"id",desc:!0}],{}),Ot("listViewFilter"+n.props.type),Ot("listViewSort"+n.props.type),Ot("listViewPage"+n.props.type)},n.selected=function(e,t,a,r){var i;null==r&&null==a?n.props.history.push("/"+e+"/"+t):null==r&&null!=a?n.props.history.push("/"+e+"/"+t+"/"+a):n.props.history.push("/"+e+"/"+r+"/"+t+"/"),"block"===n.state.display&&(i="30vh"),n.setState({alertPreSelectedId:0,scrollheight:i,showSelectedContainer:!0})},n.getNewData=function(e,t,a){n.setState({loading:!0});var r,i,o,s=t,c=a,d=(n.state.idsarray,[]);n.ConvertAlertIdToAlertgroupId(n.props.id),n.ConvertEntryIdToType(n.props.id),void 0==e?(i=n.state.activepage.page,r=n.state.activepage.limit):(i=void 0==e.page?n.state.activepage.page:e.page,r=void 0==e.limit?n.state.activepage.limit:e.limit),o=i*r,void 0==s&&(s=n.state.sort),void 0==c&&(c=n.state.filter);var p={limit:r,offset:o};if(void 0!=s){var u={};X.a.each(s,(function(e,t){var a=-1;t.desc||(a=1),u[t.id]=a})),p.sort=JSON.stringify(u)}void 0!=c&&X.a.each(c,(function(e,t){if("source"==t.id||"tag"==t.id){var a,n=[],r=Object(w.a)(t.value);try{for(r.s();!(a=r.n()).done;){var i=a.value;n.push(i.name)}}catch(s){r.e(s)}finally{r.f()}p[t.id]=JSON.stringify(n)}else if("created"==t.id||"updated"==t.id||"occurred"==t.id){var o=[];o.push(t.value.start),o.push(t.value.end),p[t.id]=JSON.stringify(o)}else p[t.id]=JSON.stringify(t.value)}));var h=[];1==n.state.loading&&_i.abort(),_i=X.a.ajax({type:"GET",url:"/scot/api/v2/"+n.state.type,data:p,traditional:!0,success:function(e){Oi=e,X.a.each(Oi.records,function(e,t){h[e]={},X.a.each(t,function(t,a){if("sources"==t||"source"==t){if(void 0!=a){var n=a.join(", ");h[e].source=n}}else if("tags"==t||"tag"==t){if(void 0!=a){var r=a.join(", ");h[e].tag=r}}else h[e][t]=a;"id"==t&&(this.props.createCallback(a,this.reloadactive),d.push(a))}.bind(this)),h[e].classname=e%2==0?"table-row roweven":"table-row rowodd"}.bind(this));var t=this.getPages(e.totalRecordCount);this.setState({totalCount:e.totalRecordCount,activepage:{page:i,limit:r},objectarray:h,loading:!1,idsarray:d,totalPages:t})}.bind(Object(l.a)(n)),error:function(e){"abort"==!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(Object(l.a)(n))})},n.exportCSV=function(){var e=[],t=n.state.columns;X.a.each(t,(function(t,a){e.push(a)}));var a="";X()(".rt-tbody").find(".rt-tr").each((function(e,t){var n=[];X()(t).find(".rt-td").each((function(e,t){var a=X()(t).text();a=a.replace(/,/g,"|"),n.push(a)})),a+=n.join()+"\n"}));var r=e.join()+"\n";a=r+a;var i="data:text/csv;charset=utf-8,"+encodeURIComponent(a);window.open(i)},n.handleSort=function(e,t){var a=[];if(!0===t)n.setState({sort:[{id:"id",desc:!0}]});else{var r,i=Object(w.a)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.id&&a.push(o)}}catch(l){i.e(l)}finally{i.f()}}n.setState({sort:a}),n.getNewData(null,a,null);var s="listViewSort"+n.props.type;Dt(s,JSON.stringify(a),1e3)},n.handleFilter=function(e,t,a,r){var i=[],o=n.props.type;if(void 0!==r&&(o=r),!0!==a){var s,l=Object(w.a)(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;c.id&&i.push(c)}}catch(d){l.e(d)}finally{l.f()}n.setState({filter:i}),r!==n.props.type&&void 0!==r||n.getNewData({page:0},null,i),Dt("listViewFilter"+o,JSON.stringify(i),1e3)}else n.setState({filter:i})},n.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n.createNewThing=function(){var e;if("signature"===n.props.type)e=JSON.stringify({name:"Name your Signature",status:"disabled"});else if("guide"===n.props.type)e=JSON.stringify({subject:"ENTER A GUIDE NAME",applies_to:["documentation"]});else{if("entity"===n.props.type)return void n.ToggleCreateEntity();e=JSON.stringify({subject:"No Subject"})}X.a.ajax({type:"POST",url:"/scot/api/v2/"+n.props.type,data:e,success:function(e){this.selected(this.props.type,e.id)}.bind(Object(l.a)(n)),error:function(e){this.props.errorToggle("failed to create new thing",e)}.bind(Object(l.a)(n))})},n.handlePageChange=function(e){n.getNewData({page:e});var t="listViewPage"+n.props.type;Dt(t,JSON.stringify({page:e,limit:n.state.activepage.limit}))},n.handlePageSizeChange=function(e,t){n.getNewData({limit:e,page:t});var a="listViewPage"+n.props.type;Dt(a,JSON.stringify({page:t,limit:e}))},n.getPages=function(e){return Math.ceil((e||1)/n.state.activepage.limit)};var i=n.props.type,o=n.props.id,c=n.props.type,d=null,p=X()(window).height()-170+"px",u=!1,h=[{id:"id",desc:!0}],m={page:0,limit:50},g=[];Oa.columnsDisplay[n.props.type],Oa.columns[n.props.type],Oa.columnsClassName[n.props.type];null!=n.props.listViewSort&&(h=JSON.parse(n.props.listViewSort)),null!=n.props.listViewPage&&(m=JSON.parse(n.props.listViewPage)),null!=n.props.listViewFilter&&(g=JSON.parse(n.props.listViewFilter)),"alert"===n.props.type&&(u=!1,y="Alertgroup",i="alertgroup",c="alertgroup",d=o),"task"===n.props.type&&(i="task",c=n.props.queryType);var y=n.titleCase(n.props.type);return n.state={togglePreventClick:!1,splitter:!0,selectedColor:"#AEDAFF",sourcetags:[],tags:[],startepoch:"",endepoch:"",idtext:"",totalCount:0,activepage:m,statustext:"",subjecttext:"",idsarray:[],classname:[" "," "," "," "],alldetail:!0,viewsarrow:[0,0],idarrow:[-1,-1],subjectarrow:[0,0],statusarrow:[0,0],resize:"horizontal",createdarrow:[0,0],sourcearrow:[0,0],tagsarrow:[0,0],viewstext:"",entriestext:"",scrollheight:p,display:"flex",differentviews:"",maxwidth:"915px",maxheight:p,minwidth:"650px",suggestiontags:[],suggestionssource:[],sourcetext:"",tagstext:"",scrollwidth:"650px",reload:!1,viewfilter:!1,viewevent:!1,showevent:!0,objectarray:[],csv:!0,fsearch:"",listViewOrientation:"landscape-list-view",columns:Oa.columns[n.props.type],columnsDisplay:Oa.columnsDisplay[n.props.type],columnsClassName:Oa.columnsClassName[n.props.type],typeCapitalized:y,type:i,queryType:c,id:o,showSelectedContainer:u,listViewContainerDisplay:null,viewMode:n.props.viewMode,offset:0,sort:h,filter:g,match:null,alertPreSelectedId:d,entryid:n.props.id2,listViewKey:1,loading:!0,initialAutoScrollToId:!1,manualScrollHeight:null,showEntityCreateModal:!1,form:[]},n.handleRowSelection=n.handleRowSelection.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"handleRowSelection",value:function(e,t,a,n){var r=this;return{onClick:function(e){if(!0!==r.state.preventClick){if(r.state.id===t.row.id)return;var a=r.state.scrollheight;return"block"==r.state.display&&(a="30vh"),"task"===r.state.type?r.props.history.push("/task/"+t.row.target_type+"/"+t.row.target_id+"/"+t.row.id):r.props.history.push("/"+r.state.type+"/"+t.row.id),void r.setState({alertPreSelectedId:0,scrollheight:a,showSelectedContainer:!0})}r.props.errorToggle("Currently processing action(s). Please wait.")},className:t.row.id===parseInt(this.props.id)?"selected":null}}}]),a}(r.a.Component),Hi=a(61),Bi=a.n(Hi),Vi=a(10),zi=a.n(Vi),qi=a(1118),Ki=a(1127),Gi=a(1119),Ji=a(156),Yi=a(1107),Qi=a(1114),Xi=a(1124),$i=a(1113),Zi=a(1112),eo=a(1133),to=function(e){return{textField:{marginLeft:"-8px",marginRight:e.spacing.unit},root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},textInput:{backgroundColor:"white",color:"black"}}},ao={username:"",fullname:"",password:"",description:"",name:"",id:null,suggestions:[],groups:[],active:0},no=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).formatGroups=function(){if(n.props.groups.length>0){var e=[];n.props.groups.forEach((function(t){var a={};a.id=t.name,a.text=t.name,e.push(a)})),n.setState({suggestions:e})}},n.resetState=function(){n.setState(ao)},n.checkBlankInputs=function(e){var t=!1;return"user"===e?""!==n.state.username&&""!==n.state.fullname&&""!==n.state.password&&(t=!0):""!==n.state.name&&""!==n.state.description&&(t=!0),t},n.buildDataObj=function(e){var t={};return"user"===e?(t.username=n.state.username,t.fullname=n.state.fullname,t.password=n.state.password,t.groups=n.state.groups,t.active=n.state.active?1:0):"group"===e&&(t.name=n.state.name,t.description=n.state.description),t},n.handleGroups=function(e){var t=n.props,a=t.enqueueSnackbar,r=t.type;if(e.length>0){var i=[];e.forEach((function(e){i.push(e.id)})),n.setState({groups:i})}else a("Error handling groups  ".concat(r),{variant:"error"})},n.handlePUT=function(){var e=n.props,t=e.enqueueSnackbar,a=e.type,r=n.buildDataObj(a);n.checkBlankInputs(a)&&Me.a.put("/scot/api/v2/".concat(a,"/").concat(n.state.id),r).then(function(e){t("Successfully updated ".concat(a,"."),{variant:"success"}),this.resetState(),this.props.fetchData(a),this.props.handleClose()}.bind(Object(l.a)(n))).catch((function(e){t("Failed updating ".concat(a),{variant:"error"})}))},n.handlePOST=function(){var e=n.props,t=e.enqueueSnackbar,a=e.type,r=n.buildDataObj(a);n.checkBlankInputs(a)&&Me.a.post("/scot/api/v2/".concat(a,"/"),r).then(function(e){console.log(e),t("Successfully added ".concat(a,"."),{variant:"success"}),this.resetState(),this.props.fetchData(a),this.props.handleClose()}.bind(Object(l.a)(n))).catch((function(e){t("Failed creating ".concat(a),{variant:"error"}),console.log(e)}))},n.handleChange=function(e,t){if("input"===e.nativeEvent.type){var a=e.target.value;n.setState({[e.target.id]:a})}else"click"===e.nativeEvent.type?"checkbox"===e.target.type&&n.setState({[e.target.value]:t}):n.setState({[e.target.name]:t.props.value})},n.state=ao,n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){this.formatGroups(),this.props.editObject&&("user"===this.props.type?this.setState({username:this.props.editObject.username,fullname:this.props.editObject.fullname,password:this.props.editObject.password,id:this.props.editObject.id,active:this.props.editObject.active,groups:this.props.editObject.groups}):"group"===this.props.type&&this.setState({name:this.props.editObject.name,description:this.props.editObject.description,id:this.props.editObject.id}))}},{key:"render",value:function(){var e=this.props,t=e.classes;e.onClose,e.selectedValue,e.type,Object(k.a)(e,["classes","onClose","selectedValue","type"]);return r.a.createElement("div",null,r.a.createElement($n.a,{className:t.card},r.a.createElement(Zn.a,null,this.props.editObject?r.a.createElement(Xn.a,{variant:"h5",component:"h2"},"Edit ",this.props.type," ",r.a.createElement("b",null,this.props.editObject.username," ")):r.a.createElement(Xn.a,{variant:"h5",component:"h2"},"Create ",this.props.type," "),"group"===this.props.type?r.a.createElement("div",null,r.a.createElement(Xi.a,{id:"name",label:"Group Name",value:this.state.name,onChange:this.handleChange,variant:"outlined",helperText:"Enter name of group",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(Xi.a,{id:"description",label:"Description",value:this.state.description,onChange:this.handleChange,variant:"outlined",helperText:"Enter description for group",InputLabelProps:{shrink:!0},fullWidth:!0,style:{marginTop:8,marginBottom:8}})):r.a.createElement("div",null,r.a.createElement(Xi.a,{id:"username",label:"Username",value:this.state.username,onChange:this.handleChange,variant:"outlined",helperText:"Enter a valid username",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(Xi.a,{id:"fullname",label:"Full Name",value:this.state.fullname,onChange:this.handleChange,variant:"outlined",helperText:"Provide your full name",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(Xi.a,{id:"password",label:"Password",type:"password",autoComplete:"current-password",margin:"normal",variant:"outlined",helperText:"Enter a valid password",value:this.state.password,onChange:this.handleChange,fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(Zi.a,{control:r.a.createElement(eo.a,{checked:this.state.active,onChange:this.handleChange,value:"active"}),label:"Active?"}),r.a.createElement("br",null),r.a.createElement("b",null,"Groups"),r.a.createElement(io,{editObject:this.props.editObject,handleGroups:this.handleGroups,id:this.state.id,suggestions:this.state.suggestions}),r.a.createElement("br",null)),r.a.createElement("br",null)),r.a.createElement($i.a,null,this.props.editObject?r.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},r.a.createElement(ia.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),r.a.createElement(ia.a,{variant:"contained",color:"secondary",onClick:this.handlePUT,className:t.button},"Submit")):r.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},r.a.createElement(ia.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),r.a.createElement(ia.a,{variant:"contained",color:"secondary",onClick:this.handlePOST,className:t.button},"Submit")))))}}]),a}(r.a.Component),ro=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).mapUsersGroupsToTags=function(){Me.a.get("/scot/api/v2/user?id=".concat(n.props.id)).then((function(e){var t=[];e.data.totalRecordCount>0&&(e.data.records.forEach((function(e){var a={};a.id=e.name,a.text=e.name,t.push(a)})),n.setState({groups:t}))}))},n.handleDelete=function(e){var t=n.state.groups;n.setState({groups:t.filter((function(t,a){return a!==e}))})},n.handleAddition=function(e){var t=n.props.enqueueSnackbar;if(n.checkValidGroup(e.id)){var a=n.state.groups;a.push(e),n.setState({groups:a}),n.props.handleGroups(n.state.groups)}else t("Invalid group. Please add an existing group")},n.state={groups:[]},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){if(this.props.editObject){var e=[];this.props.editObject.groups.forEach((function(t){var a={};a.id=t,a.text=t,e.push(a)})),this.setState({groups:e})}}},{key:"shouldComponentUpdate",value:function(e,t){return this.state!==t&&(this.props.handleGroups(t.groups),!0)}},{key:"checkValidGroup",value:function(e){return!!this.props.suggestions.some((function(t){return t.id===e}))}},{key:"render",value:function(){var e=this.state.groups,t=this.props.suggestions;this.props.classes;return r.a.createElement("div",null,r.a.createElement(hi.WithContext,{classNames:{tagInput:"tagInputClass",tagInputField:"tagInputFieldClass"},placeholder:"Add a new group",inline:!1,tags:e,suggestions:t,handleDelete:this.handleDelete,handleAddition:this.handleAddition}))}}]),a}(r.a.Component),io=Object(dt.a)(to)(ro),oo=Object(hn.withSnackbar)(Object(dt.a)(to)(no)),so=a(1115),lo=a(1117),co=a(332),po=a.n(co),uo=a(1116),ho=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleDelete=function(){var e=n.props,t=e.enqueueSnackbar,a=e.type,r=e.id,i="/scot/api/v2/".concat(a,"/").concat(r);Me.a.delete(i).then(function(){t("Successfully deleted ".concat(a,"."),{variant:"success"}),this.props.fetchData(a),this.props.handleClose()}.bind(Object(l.a)(n))).catch((function(e){console.log(e),t("Failed deleting ".concat(a,"."),{variant:"error"}),this.props.handleClose()}))},n.state={deletetext:""},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",null,r.a.createElement($n.a,{className:t.card},r.a.createElement(Zn.a,null,r.a.createElement(Xn.a,{variant:"h5",component:"h2"},"Are you sure you want to delete ",this.props.type," ",this.props.text,"?"),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(ia.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:function(){return e.handleDelete(e.props.id)},variant:"contained"},"Yes"),r.a.createElement(ia.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}]),a}(r.a.Component),mo=Object(hn.withSnackbar)(Object(dt.a)((function(e){return{card:{minWidth:400,marginBottom:20}}}))(ho)),go=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).edit=function(e,t){var a="/scot/api/v2/".concat(e,"?id=").concat(t);Me.a.get(a).then(function(t){this.setState({editObject:t.data.records[0],type:e,showModal:!0})}.bind(Object(l.a)(n))).catch((function(e){console.log(e)}))},n.showUserDialog=function(){n.setState({showModal:!0,type:"user"})},n.showGroupDialog=function(){n.setState({showModal:!0,type:"group"})},n.handleUserClose=function(){n.setState({showModal:!1})},n.handleClose=function(e){n.setState({showModal:!1,id:null,type:"",editObject:null})},n.handleListItemClick=function(e){n.props.onClose(e)},n.getColumns=function(e){var t=[];return"user"===e?t=[{Header:"ID",accessor:"id",width:50},{Header:"Full Name",accessor:"fullname",width:90},{Header:"Username",accessor:"username",width:70},{Header:"Active",id:"active",accessor:function(e){return r.a.createElement("center",null,(e.active,r.a.createElement("div",null,r.a.createElement(Zi.a,{control:r.a.createElement(eo.a,{onChange:function(){return n.handleActiveToggle(e.id)},checked:e.active,value:e.active})}))))},width:80},{Header:"Edit / Delete",id:"edit",accessor:function(t){return r.a.createElement("center",null,r.a.createElement(ia.a,{size:"small",style:{marginLeft:5},onClick:function(){return n.edit(e,t.id)},variant:"contained"},"Edit"),r.a.createElement(ia.a,{size:"small",style:{marginLeft:5},onClick:function(){return n.toggleAreYouSure(t.id,e)},color:"secondary",variant:"contained"},r.a.createElement(po.a,null)))},width:200}]:"group"===e&&(t=[{Header:"ID",accessor:"id",width:50},{Header:"Group Name",accessor:"name",width:100},{Header:"Group Description",accessor:"description",width:100},{Header:"Edit / Delete",id:"edit",accessor:function(t){return r.a.createElement("center",null,r.a.createElement(ia.a,{size:"small",style:{marginLeft:5},onClick:function(){return n.edit(e,t.id)},variant:"contained"},"Edit"),r.a.createElement(ia.a,{size:"small",style:{marginLeft:5},onClick:function(){return n.toggleAreYouSure(t.id,e)},color:"secondary",variant:"contained"},r.a.createElement(po.a,null)))},width:200}]),t},n.setUserGroupResults=function(e,t){"user"===e?n.setState({userdata:t.records}):"group"===e&&n.setState({groupdata:t.records})},n.toggleAreYouSure=function(e,t){n.setState({areYouSure:!0,id:e,type:t})},n.handleAreYouSureClose=function(){n.setState({areYouSure:!1})},n.fetchData=function(e){Me.a.get("/scot/api/v2/".concat(e,"?limit=0")).then((function(t){var a=t.data;return n.setUserGroupResults(e,a)}))},n.handleActiveToggle=function(e){var t=n.getUserObject(e);n.setState({userdata:n.state.userdata.map((function(t){return t.id===e?Object(S.a)(Object(S.a)({},t),{},{active:!t.active}):t})),updateId:t.id})},n.getUserObject=function(e){return n.state.userdata.filter((function(t){return e===t.id?t:null}))[0]},n.state={userdata:[],groupdata:[],showModal:!1,editObject:null,id:null,type:"",areYouSure:!1,updateId:null},n}return Object(C.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a=this.props.enqueueSnackbar;if(t.userdata!==this.state.userdata&&null!==this.state.updateId){var n=this.getUserObject(this.state.updateId);Me.a.put("/scot/api/v2/user/".concat(this.state.updateId),{active:n.active}).then(function(e){a("Successfully updated user.",{variant:"success"}),this.setState({updateId:null})}.bind(this)).catch((function(e){a("Failed updating user",{variant:"error"})}))}}},{key:"componentDidMount",value:function(){this.fetchData("user"),this.fetchData("group")}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=Object(k.a)(t,["classes"]),i=this.state,o=i.groupdata,s=i.userdata.length>10,l=o.length>10;return r.a.createElement("div",{className:a.root},r.a.createElement("br",null),r.a.createElement(pr.a,{className:a.paper,elevation:1},r.a.createElement(Xn.a,{variant:"h5",component:"h3"},"Please be advised"),r.a.createElement(Xn.a,{component:"p"},"In order to properly add a user, they must belong to a group. A user is added to a group at time of creatino or upon 'Edit'. Groups MUST include the string 'scot' in the name or they will be ignored by the system. You must activate a user in order to begin logging in as the user.")),r.a.createElement("br",null),r.a.createElement(Qi.a,{container:!0,spacing:8},r.a.createElement(Qi.a,{item:!0,xs:12,sm:6},r.a.createElement(Xn.a,{variant:"h4",gutterBottom:!0},"Users ",r.a.createElement(so.a,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(Xn.a,{variant:"h5",gutterBottom:!0},"Add User"),r.a.createElement(uo.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showUserDialog,color:"secondary","aria-label":"Add"},r.a.createElement(ya.a,null))),r.a.createElement(qt.a,{data:this.state.userdata,columns:this.getColumns("user"),pageSize:this.state.userdata.length,defaultPageSize:10,showPagination:s})),r.a.createElement(Qi.a,{item:!0,xs:12,sm:6},r.a.createElement(Xn.a,{variant:"h4",gutterBottom:!0},"Groups ",r.a.createElement(lo.a,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(Xn.a,{variant:"h5",gutterBottom:!0},"Add Group"),r.a.createElement(uo.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showGroupDialog,color:"secondary","aria-label":"Add"},r.a.createElement(ya.a,null))),r.a.createElement(qt.a,{data:this.state.groupdata,columns:this.getColumns("group"),pageSize:this.state.groupdata.length,defaultPageSize:10,showPagination:l}))),r.a.createElement(ar.a,{open:this.state.showModal,onClose:this.handleClose,"aria-labelledby":"simple-dialog-title"},r.a.createElement(oo,{id:this.state.id,groups:this.state.groupdata,type:this.state.type,editObject:this.state.editObject,handleClose:this.handleClose,fetchData:function(t){e.fetchData(t)}})),this.state.areYouSure?r.a.createElement(ar.a,Object.assign({open:this.state.areYouSure,onClose:this.handleAreYouSureClose,"aria-labelledby":"simple-dialog-title"},n),r.a.createElement(mo,{type:this.state.type,fetchData:function(t){e.fetchData(t)},handleClose:this.handleAreYouSureClose,id:this.state.id})):null)}}]),a}(r.a.Component),yo=Object(hn.withSnackbar)(Object(dt.a)((function(e){return{root:{flexGrow:1},paper:Object(S.a)(Object(S.a)({},e.mixins.gutters()),{},{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit})}}))(go)),fo=a(502),vo=a.n(fo),bo=a(199),Eo=a.n(bo),ko=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).GetKeys=n.GetKeys.bind(Object(l.a)(n)),n.GetAvailableGroups=n.GetAvailableGroups.bind(Object(l.a)(n)),n.CreateKey=n.CreateKey.bind(Object(l.a)(n)),n.DeleteKey=n.DeleteKey.bind(Object(l.a)(n)),n.GroupChange=n.GroupChange.bind(Object(l.a)(n)),n.ToggleActiveStatus=n.ToggleActiveStatus.bind(Object(l.a)(n)),n.state={Api:null,keys:null,availableGroups:null},n}return Object(C.a)(a,[{key:"GetKeys",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/apikey",success:function(e){this.setState({keys:e.records})}.bind(this),error:function(){this.setState({keys:"failed to get keys"})}.bind(this)})}},{key:"GetAvailableGroups",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/group?limit=0",success:function(e){this.setState({availableGroups:e.records})}.bind(this)})}},{key:"CreateKey",value:function(){X.a.ajax({type:"post",url:"/scot/api/v2/apikey",success:function(){this.GetKeys()}.bind(this)})}},{key:"DeleteKey",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/apikey/".concat(e.target.id),success:function(){this.GetKeys()}.bind(this)})}},{key:"GroupChange",value:function(e,t){X.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){this.GetKeys()}.bind(this)})}},{key:"ToggleActiveStatus",value:function(e,t){X.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),contentType:"application/json; charset=UTF-8",data:JSON.stringify({active:t}),success:function(){this.GetKeys()}.bind(this)})}},{key:"componentDidMount",value:function(){this.GetKeys(),this.GetAvailableGroups()}},{key:"render",value:function(){var e=[];if(void 0!=this.state.keys)for(var t=0;t<this.state.keys.length;t++){var a=void 0,n=[];if(a=1==this.state.keys[t].active?r.a.createElement("span",{style:{color:"green"}},"active"):r.a.createElement("span",{style:{color:"red"}},"not active"),void 0!=this.state.keys[t].groups)for(var i=0;i<this.state.keys[t].groups.length;i++)n.push(r.a.createElement("div",null,"this.state.keys[i].groups[j]"));e.push(r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",null,this.state.keys[t].apikey),r.a.createElement("div",null,this.state.keys[t].username),r.a.createElement("span",null,"Key is ",a),r.a.createElement("span",{className:"pull-right pointer"},r.a.createElement("i",{id:this.state.keys[t].id,className:"fa fa-trash","aria-hidden":"true",onClick:this.DeleteKey})),r.a.createElement("div",null,r.a.createElement(wo,{id:this.state.keys[t].id,currentGroups:this.state.keys[t].groups,allGroups:this.state.availableGroups,GroupChange:this.GroupChange,ToggleActiveStatus:this.ToggleActiveStatus,keyActiveStatus:this.state.keys[t].active,keyActiveStatusCss:void 0}))),r.a.createElement("hr",null)))}return r.a.createElement("div",{id:"api",className:"administration_api"},r.a.createElement("h1",null,"API"),r.a.createElement(vo.a,{bsStyle:"info",header:"Your api keys"},e),r.a.createElement(Ha.a,{bsStyle:"success",onClick:this.CreateKey},"Create API Key"))}}]),a}(r.a.Component),wo=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).Open=n.Open.bind(Object(l.a)(n)),n.Close=n.Close.bind(Object(l.a)(n)),n.DeleteGroup=n.DeleteGroup.bind(Object(l.a)(n)),n.ToggleActiveStatus=n.ToggleActiveStatus.bind(Object(l.a)(n)),n.state={showModal:!1},n}return Object(C.a)(a,[{key:"Open",value:function(){this.setState({showModal:!0})}},{key:"Close",value:function(){this.setState({showModal:!1})}},{key:"DeleteGroup",value:function(e){var t,a=[],n=Object(w.a)(this.props.currentGroups);try{for(n.s();!(t=n.n()).done;){var r=t.value;void 0!=r&&r!=e.target.parentNode.textContent&&a.push(r)}}catch(i){n.e(i)}finally{n.f()}this.props.GroupChange(this.props.id,a)}},{key:"ToggleActiveStatus",value:function(){var e;e=1==this.props.keyActiveStatus?0:1,this.props.ToggleActiveStatus(this.props.id,e)}},{key:"render",value:function(){var e=[],t=[];if(this.props.currentGroups){var a,n=Object(w.a)(this.props.currentGroups);try{for(n.s();!(a=n.n()).done;){var i=a.value;t.push(r.a.createElement("span",{className:"tagButton"},i,r.a.createElement("i",{id:this.props.id,onClick:this.DeleteGroup,className:"fa fa-times tagButtonClose"})))}}catch(d){n.e(d)}finally{n.f()}var o,s=Object(w.a)(this.props.currentGroups);try{for(s.s();!(o=s.n()).done;){var l=o.value;e.push(r.a.createElement("span",{className:"tagButton"},l))}}catch(d){s.e(d)}finally{s.f()}}var c=1===this.props.keyActiveStatus?"active":"not active";return r.a.createElement("div",null,"Current Groups: ",e,r.a.createElement("div",null,r.a.createElement(Ha.a,{onClick:this.Open,bsSize:"small"},"Edit API key settings")),r.a.createElement(Eo.a,{show:this.state.showModal,onHide:this.Close},r.a.createElement(Eo.a.Header,{closeButton:!0},r.a.createElement(Eo.a.Title,null,"Edit API key settings")),r.a.createElement(Eo.a.Body,null,r.a.createElement("div",null,r.a.createElement("h4",null,"Current Groups:"),t),r.a.createElement("hr",null),r.a.createElement("div",null,"Key is ",r.a.createElement("span",{className:this.props.keyActiveStatusCss},c),r.a.createElement(Ha.a,{onClick:this.ToggleActiveStatus,bsSize:"xsmall"},"Toggle Active Status")))))}}]),a}(r.a.Component),So={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}},To=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={data:[],allSelected:!1},n.handleTHeadCheckboxSelection=n.handleTHeadCheckboxSelection.bind(Object(l.a)(n)),n.handleRowSelection=n.handleRowSelection.bind(Object(l.a)(n)),n.handleCheckboxSelection=n.handleCheckboxSelection.bind(Object(l.a)(n)),n.getDeletedItems=n.getDeletedItems.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0,this.getDeletedItems()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"data.id",id:"data.id",column:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"data.subject",id:"data.subject",column:"subject",maxWidth:"100%",sortable:!0},{Header:"Body",accessor:"data.body",id:"data.body",column:"body",maxWidth:"100%",sortable:!0}],a=[];for(var n in this.state.data)a.push(this.state.data[n].data);return r.a.createElement("div",null,this.state.data.length>0?r.a.createElement(qt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No deleted items were found.",style:{maxHeight:"60vh"},filterable:!0}):r.a.createElement("h3",null,"No deleted items were found."),this.state.data.length>0?r.a.createElement(Co,{data:this.state.data,id:this.props.id,type:this.props.type,getDeletedItems:this.getDeletedItems,errorToggle:this.props.errorToggle}):null)}},{key:"handleRowSelection",value:function(e,t,a){var n=this;return{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;t.row["data.id"]==o.data.id&&t.row.type==o.type?o.selected=!0:o.selected=!1}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:!1})},style:{background:void 0!=t&&t.row.selected?"rgb(174, 218, 255)":null}}}},{key:"handleCheckboxSelection",value:function(e,t,a){var n=this;return"selected"==a.id?{onClick:function(e){var a,r=n.state.data,i=Object(w.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.row["data.id"]==o.data.id&&t.row.type==o.type){o.selected?o.selected=!o.selected:o.selected=!0;break}}}catch(s){i.e(s)}finally{i.f()}n.setState({data:r,allSelected:n.checkAllSelected(r)}),e.stopPropagation()}}:{}}},{key:"handleTHeadCheckboxSelection",value:function(e,t,a,n){var r=this;return"selected"===a.id?{onClick:function(t){var a,n=r.state.data,i=!r.state.allSelected,o=Object(w.a)(n);try{for(o.s();!(a=o.n()).done;){var s,l=a.value,c=Object(w.a)(e.pageRows);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(l.data.id==d["data.id"]&&l.data.type==d["data.type"]){l.selected=i;break}}}catch(p){c.e(p)}finally{c.f()}}}catch(p){o.e(p)}finally{o.f()}r.setState({data:n,allSelected:i})}}:{}}},{key:"checkAllSelected",value:function(e){var t,a=Object(w.a)(e);try{for(a.s();!(t=a.n()).done;){if(!t.value.selected)return!1}}catch(n){a.e(n)}finally{a.f()}return!0}},{key:"getDeletedItems",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/deleted/?limit=0",success:function(e){this.setState({data:e.records})}.bind(this),error:function(e){console.log("unable to get deleted items")}.bind(this)})}}]),a}(n.Component),Co=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:So.READY,deleteButton:So.READY,promoteButton:So.READY},n.RemoveSelected=n.RemoveSelected.bind(Object(l.a)(n)),n.MoveEntry=n.MoveEntry.bind(Object(l.a)(n)),n.CopyEntry=n.CopyEntry.bind(Object(l.a)(n)),n.EntryAjax=n.EntryAjax.bind(Object(l.a)(n)),n.Link=n.Link.bind(Object(l.a)(n)),n.LinkAjax=n.LinkAjax.bind(Object(l.a)(n)),n.Reparse=n.Reparse.bind(Object(l.a)(n)),n.ReparseAjax=n.ReparseAjax.bind(Object(l.a)(n)),n.Promote=n.Promote.bind(Object(l.a)(n)),n.PromoteAjax=n.PromoteAjax.bind(Object(l.a)(n)),n.ToggleActionSuccess=n.ToggleActionSuccess.bind(Object(l.a)(n)),n.ExpandLinkToggle=n.ExpandLinkToggle.bind(Object(l.a)(n)),n.LinkContextChange=n.LinkContextChange.bind(Object(l.a)(n)),n.deleteCallback=n.deleteCallback.bind(Object(l.a)(n)),n.StartDelete=n.StartDelete.bind(Object(l.a)(n)),n.Restore=n.Restore.bind(Object(l.a)(n)),n.Purge=n.Purge.bind(Object(l.a)(n)),n}return Object(C.a)(a,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"deleteCallback",value:function(e){!0===e&&this.RemoveSelected(),this.setState({pendingDelete:!1})}},{key:"render",value:function(){var e,t=!0,a=0,n=Object(w.a)(this.props.data);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.type&&i.selected&&(a++,"entry"===i.type?!0:!0,"alert"!==i.type&&(t=!1))}}catch(s){n.e(s)}finally{n.f()}0!=a&&t&&this.props.type;var o=this.state;o.reparseButton,o.deleteButton,o.promoteButton;return o.pendingDelete&&this.props.data.filter((function(e){return e.selected})).map((function(e){return{type:e.type,id:e.id}})),r.a.createElement("div",null,r.a.createElement(vi.a,{ref:"notificationSystem"}),this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement(H.a,{bsStyle:"success",onClick:this.props.getDeletedItems},"Action Successful! Click to reload data.")):r.a.createElement("div",{style:{display:"grid"}},r.a.createElement("div",null,r.a.createElement("h4",{style:{float:"left"}})," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a Deleted Object"):null,r.a.createElement(Yt.a,{style:{float:"right"}},r.a.createElement(H.a,{bsStyle:"success",onClick:this.Restore},"Restore"),r.a.createElement(H.a,{bsStyle:"danger",onClick:this.Purge},"Purge")))))}},{key:"Restore",value:function(e){var t,a=Object(w.a)(this.props.data);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.selected&&X.a.ajax({type:"put",url:"/scot/api/v2/deleted/"+n.id,data:JSON.stringify({status:"undelete"}),success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Restored",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to restore items")}.bind(this)})}}catch(r){a.e(r)}finally{a.f()}}},{key:"Purge",value:function(e){var t,a=Object(w.a)(this.props.data);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.selected&&X.a.ajax({type:"delete",url:"/scot/api/v2/deleted/"+n.id,success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Purged",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to purge items")}.bind(this)})}}catch(r){a.e(r)}finally{a.f()}}},{key:"LinkContextChange",value:function(e){this.setState({linkContextString:e.target.value})}},{key:"ExpandLinkToggle",value:function(e){if(1==e||0==e)this.setState({linkPanel:e,linkContextString:""});else{var t=!this.state.linkPanel;this.setState({linkPanel:t,linkContextString:""})}}},{key:"RemoveSelected",value:function(){var e,t=Object(w.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&Ga(a.type,a.id)}}catch(n){t.e(n)}finally{t.f()}this.props.getDeletedItems(),this.state.actionSuccess&&this.setState({actionSuccess:!1})}},{key:"StartDelete",value:function(){this.setState({pendingDelete:!0})}},{key:"MoveEntry",value:function(){var e,t=Object(w.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&"entry"==a.type&&this.EntryAjax(a.id,!0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"CopyEntry",value:function(){var e,t=Object(w.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&"entry"==a.type&&this.EntryAjax(a.id,!1)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Link",value:function(){var e,t=Object(w.a)(this.props.data);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.selected){var n=[],r={},i={};r.id=parseInt(a.id),r.type=a.type,i.id=parseInt(this.props.id),i.type=this.props.type,n.push(r),n.push(i),this.LinkAjax(n)}}}catch(o){t.e(o)}finally{t.f()}}},{key:"Reparse",value:function(){var e=this;this.setState({reparseButton:So.LOADING}),X.a.when.apply(X.a,Object(T.a)(this.props.data.filter((function(e){return e.selected})).map((function(t){return e.ReparseAjax(t)})))).then((function(){e.setState({reparseButton:So.SUCCESS})}),(function(t){console.error(t),e.setState({reparseButton:So.ERROR}),e.props.errorToggle("error reparsing",t)})).always((function(){setTimeout((function(){e.setState({reparseButton:So.READY})}),2e3)}))}},{key:"ReparseAjax",value:function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"})}},{key:"Promote",value:function(){var e=this;this.setState({promoteButton:So.LOADING});var t=!0;X.a.when.apply(X.a,Object(T.a)(this.props.data.filter((function(e){return e.selected})).map((function(t){return e.PromoteAjax(t)})))).then((function(){e.setState({promoteButton:So.SUCCESS})}),(function(a){t=!1,console.error(a),e.setState({promoteButton:So.ERROR}),e.props.errorToggle("error adding alerts to event",a)})).always((function(){setTimeout((function(){e.setState({promoteButton:So.READY}),t&&window.location.reload()}),2e3)}))}},{key:"PromoteAjax",value:function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(this.props.id)}),contentType:"application/json; charset=UTF-8"})}},{key:"LinkAjax",value:function(e){var t={weight:1};t.vertices=e,this.state.linkContextString&&(t.context=this.state.linkContextString),X.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to link",e)}.bind(this)})}},{key:"EntryAjax",value:function(e,t){X.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){var n;n={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(this),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(this)})}},{key:"RemoveEntryAfterMove",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")}.bind(this),error:function(e){this.props.errorToggle("Failed to remove original entry",e)}.bind(this)})}},{key:"ToggleActionSuccess",value:function(e){if(1==e||0==e)this.setState({actionSuccess:e});else{var t=!this.state.actionSuccess;this.setState({actionSuccess:t})}}}]),a}(n.Component);function xo(e){return r.a.createElement(Xn.a,{component:"div",style:{padding:24}},e.children)}Co.defaultProps={data:{}},To.defaultProps={modalActive:!0};var jo=Object(Ji.a)({typography:{fontSize:20}}),Oo=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={value:0},e.handleChange=function(t,a){e.setState({value:a})},e}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.classes,t=this.state.value;return r.a.createElement(Yi.a,{theme:jo},r.a.createElement("div",{className:e.root},r.a.createElement(qi.a,{className:zi()(e.appBar,e.typography),position:"static"},r.a.createElement(Ki.a,{value:t,indicatorColor:"primary",centered:!0,onChange:this.handleChange},r.a.createElement(Gi.a,{label:"Users / Groups"}),r.a.createElement(Gi.a,{label:"API"}),r.a.createElement(Gi.a,{label:"Undelete"}))),0===t&&r.a.createElement(xo,null,r.a.createElement(yo,null)),1===t&&r.a.createElement(xo,null,r.a.createElement(ko,null)),2===t&&r.a.createElement(xo,null,r.a.createElement(To,null))))}}]),a}(r.a.Component),Do=Object(dt.a)((function(e){return{root:{flexGrow:1},appBar:{backgroundColor:"#2196f3"},typography:{fontSize:20}}}))(Oo),No=function(){function e(){var t=this;Object(s.a)(this,e),this.s4=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},this.get_guid=function(){return t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()},this.register_client=function(e){t.client=t.get_guid(),t.whoami=de("whoami"),X.a.ajax({type:"POST",url:"/scotaq/amq",data:{message:"chat",type:"listen",clientId:t.client,destination:"topic://scot"},success:function(t){console.log("Registered client as "+this.client),e||setTimeout(function(){this.get_data()}.bind(this),1e3)}.bind(t),error:function(e){console.log("Error: failed to register client, retry in 1 sec"),setTimeout((function(){this.register_client()}),1e3)}})},this.get_data=function(){var e=new Date;X.a.ajax({type:"GET",url:"/scotaq/amq",data:{clientId:t.client,timeout:2e4,d:e.getTime(),r:Math.random(),json:"true",username:t.whoami},success:function(e){console.log("Received Message"),setTimeout(function(){this.get_data()}.bind(this),40),X()(e).text().split("\n").forEach(function(e,t){if(""!==e){var a=JSON.parse(e);return console.log(a),this.process_message(a),this.handle_update(a),!0}}.bind(this))}.bind(t),error:function(){setTimeout(function(){this.getData(this.client)}.bind(this),1e3),console.log("AMQ not detected, retrying in 1 second.")}})},this.create_callback_object=function(e,a){var n=e;if(t.checkNumber(n)&&(n=parseInt(n,10)),t.cb_map.has(n))t.cb_map.get(n).add(a);else{var r=new Set;r.add(a),t.cb_map.set(n,r)}},this.remove_callback_object=function(e){t.cb_map.delete(e)},this.process_message=function(e){"wall"===e.action?(t.activemqwho=e.data.who,t.activemqmessage=e.data.message,t.activemqwhen=e.data.when,t.activemqwall=!0):(t.activemqaction=e.action,t.activemqid=e.data.id,t.activemqtype=e.data.type,t.activemqwho=e.data.who,t.activemqguid=e.guid,t.activemqhostname=e.hostname,t.activemqpid=e.pid)},this.execute_callback_function=function(e){try{var a=t.cb_map.get(e);void 0!==a&&a.forEach((function(e){e()}));var n=t.cb_map.get("notification");void 0!==n&&n.forEach((function(e){e()}))}catch(r){throw r}},this.handle_update=function(e){var a="";"wall"===e.action?a="wall":"created"===e.action?a="".concat(e.data.type,":listview"):("updated"===e.action||"deleted"===e.action)&&(a=e.data.id),t.execute_callback_function(a)},this.client="",this.whoami="",this.amqdebug="",this.activemqaction="",this.activemqaction="",this.activemqid="",this.activemqwho="",this.activemqtype="",this.activemqguid="",this.activemqhostname="",this.activemqpid="",this.activemqwhen="",this.activemqwall="",this.cb_map=new Map}return Object(C.a)(e,[{key:"checkNumber",value:function(e){var t=parseInt(e,10);return!isNaN(t)}}]),e}(),_o=(r.a.Component,{padding:"5px",width:"100%"}),Ao=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.nodeInfo;return r.a.createElement("div",null,r.a.createElement("table",{style:_o},r.a.createElement("tr",null,r.a.createElement("th",null,"Entity Info"),r.a.createElement("td",null,"id: ",e.id),r.a.createElement("td",null,"Entity: ",e.value),r.a.createElement("td",null,"Type: ",e.type),r.a.createElement("td",null,"Entries: ",e.entry_count))))}}]),a}(r.a.Component),Mo={width:"100%",padding:"5px"},Lo=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.nodeInfo,t=e.tags;return"undefined"===typeof t&&(t=[]),r.a.createElement("div",null,r.a.createElement("table",{style:Mo},r.a.createElement("tr",null,r.a.createElement("th",null,e.sourcetype),r.a.createElement("td",null,"id: ",e.id),r.a.createElement("td",null,"subject: ",e.subject),r.a.createElement("td",null,"status: ",e.status),r.a.createElement("td",null,"Tags:",t.length>0&&t.map((function(e){return{tag:e}}))),r.a.createElement("td",null,"Entries: ",e.entry_count))))}}]),a}(r.a.Component),Po=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(C.a)(a,[{key:"render",value:function(){console.log("Render NodeInfo"),console.log(this.props);var e=this.props.nodeInfo,t=e.sourcetype;return r.a.createElement("div",null,"entity"===t?r.a.createElement(Ao,{nodeInfo:e}):r.a.createElement(Lo,{nodeInfo:e}))}}]),a}(r.a.Component),Fo=a(196);function Io(e,t,a){return e.filter((function(e){return!t.find((function(t){return e[a]===t[a]}))})).concat(t)}var Ro=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).loadGraph=function(e,t,a){console.log("loading graph");var r="/scot/api/v2/graph/".concat(e,"/").concat(t,"/").concat(a);Me.a.get(r).then((function(e){console.log(e),console.log(n.state.graph),n.setState({graph:e.data})}))},n.add_to_graph=function(e,t,a){var r="/scot/api/v2/graph/".concat(e,"/").concat(t,"/").concat(a);console.log("Adding ".concat(r," to graph"));var i=JSON.parse(JSON.stringify(n.state.graph));Me.a.get(r).then((function(e){var t=e.data.nodes,a=e.data.links,r=i.nodes,o=i.links,s={nodes:Io(t,r),links:Io(a,o)};n.setState({graph:s})}))},n.draw_to_canvas=function(e,t,a){var n=e.id,r=12/a;t.font="".concat(r,"px Sans-Serif");var i=[t.measureText(n).width,r].map((function(e){return e+.2*r}));e.id.match(/entity/)?(t.fillStyle="rgba(255,80,80,0.8)",t.beginPath(),t.arc(e.x,e.y,8,0,2*Math.PI,!1),t.fill()):(e.id.match(/intel/)?t.fillStyle="rgba(30,30,200,0.6)":e.id.match(/event/)?t.fillStyle="rgba(0,255,0,0.6)":t.fillStyle="rgba(255,255,255,0.8)",t.fillRect.apply(t,[e.x-i[0]/2,e.y-i[1]/2].concat(Object(T.a)(i)))),t.textAlign="center",t.textBaseline="middle",t.fillStyle="black",t.fillText(n,e.x,e.y),e.__bckgDimensions=i},n.node_paint=function(e,t,a){a.fillStyle=t;var n=e.__bckgDimensions;n&&a.fillRect.apply(a,[e.x-n[0]/2,e.y-n[1]/2].concat(Object(T.a)(n)))},n.handleNodeHover=function(e){if(e){var t=e.target_type,a=e.target_id,r="/scot/api/v2/".concat(t,"/").concat(a);console.log("requesting info about ".concat(t," ").concat(a)),Me.a.get(r).then((function(e){var a=e.data;console.log("got data"),console.log(a),a.sourcetype=t,n.setState({nodeinfo:a})}))}},n.handle_node_add=function(e){e.preventDefault(),console.log("event.target.elements"),console.log(e.target.elements),n.add_to_graph(e.target.elements.thingtype.value,e.target.elements.thingid.value,e.target.elements.depth.value)},n.state={graph:{nodes:[],links:[]},nodeinfo:""},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){console.log("componentDidMount")}},{key:"handleNodeAddition",value:function(e){e.preventDefault(),console.log("event is"),console.log(e);var t=new FormData(e.target);console.log("node addition"),console.log(t),this.add_to_graph(t.thingtype,t.thingid,t.depth)}},{key:"render",value:function(){var e=this;console.log("render");"".concat(this.state.nodeinfo);return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{id:"infocontrols",style:{minWidth:300}},r.a.createElement("div",{id:"controls"},r.a.createElement("h3",null,"Graph Control"),r.a.createElement("form",{onSubmit:this.handle_node_add},r.a.createElement("label",{htmlFor:"thingtype"},"Enter Type:"),r.a.createElement("input",{id:"thingtype",name:"thingtype",type:"text"}),r.a.createElement("label",{htmlFor:"thingid"},"Enter ID:"),r.a.createElement("input",{id:"thingid",name:"thingid",type:"text"}),r.a.createElement("label",{htmlFor:"depth"},"Enter Depth:"),r.a.createElement("input",{id:"depth",name:"depth",type:"text"}),r.a.createElement("button",null,"Go!"))),r.a.createElement("div",{id:"info"},r.a.createElement(Po,{nodeInfo:this.state.nodeinfo}))),r.a.createElement(Fo.a,{graphData:this.state.graph,nodeCanvasObject:function(t,a,n){e.draw_to_canvas(t,a,n)},nodePointerAreaPaint:function(t,a,n){e.node_paint(t,a,n)},onNodeHover:this.handleNodeHover}))}}]),a}(r.a.Component),Uo=Object(hn.withSnackbar)(Object(dt.a)((function(e){return{card:{minWidth:800,marginBottom:20},ScotForceGraphDisplay:{display:"flex","flex-direction":"row"}}}))(Ro)),Wo=a(11),Ho=(a(1034),{backgroundColor:"white",color:"black"}),Bo={display:"flex",flexDirection:"row"},Vo=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).add_to_graph=function(e,t,a){var r="/scot/api/v2/graph/".concat(e,"/").concat(t,"/").concat(a),i=JSON.parse(JSON.stringify(n.state.graph));Me.a.get(r).then((function(e){n.update_graph(e,i)}))},n.update_graph=function(e,t){var a=e.data,r={nodes:n.merge_arrays(a.nodes,t.nodes),links:n.merge_arrays(a.links,t.links)};n.setState({graph:r})},n.merge_arrays=function(e,t,a){return e.filter((function(e){return!t.find((function(t){return e[a]===t[a]}))})).concat(t)},n.handle_node_add=function(e){e.preventDefault(),n.add_to_graph(e.target.elements.thingtype.value,e.target.elements.thingid.value,e.target.elements.depth.value)},n.handleNodeHover=function(e){if(console.log("Node Hover"),console.log(e),e){var t="/scot/api/v2/".concat(e.target_type,"/").concat(e.target_id);Me.a.get(t).then((function(t){var a=t.data;a.sourcetype=e.target_type,n.setState({nodeinfo:a})}))}},n.handleNodeClick=function(e){if(console.log("Node Clicked"),console.log(e),e){var t="/#/".concat(e.target_type,"/").concat(e.target_id);window.open(t)}},n.handleClearGraph=function(){n.setState({graph:{}})},n.handleToggleGraph=function(){"2D"===n.state.graphtype?n.setState({graphtype:"3D"}):n.setState({graphtype:"2D"})},n.draw_to_canvas=function(e,t,a){n.node_paint(e,e.color,t)},n.node_paint=function(e,t,a){a.fillStyle=t,a.beginPath(),a.arc(e.x,e.y,5,0,2*Math.PI,!1),a.fill()},n.paint_highlight=function(e,t){t.beginPath(),t.arc(e.x,e.y,7,0,2*Math.PI,!1),t.fillStyle=e===n.state.hoverNode?"red":"yellow",t.fill()},n.state={graph:{nodes:[],links:[]},nodeinfo:{},graphtype:"2D",highlightNodes:[],highlightLinks:[],hoverNode:""},n}return Object(C.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"GraphControl",style:Ho},r.a.createElement("div",{style:Bo},r.a.createElement("button",{onClick:this.handleToggleGraph},"Toggle Graph Mode"),r.a.createElement("form",{onSubmit:this.handle_node_add},r.a.createElement("label",{htmlFor:"thingtype"},"Enter Type:"),r.a.createElement("select",{id:"thingtype",name:"thingtype"},r.a.createElement("option",null,"event"),r.a.createElement("option",null,"intel"),r.a.createElement("option",null,"incident"),r.a.createElement("option",null,"dispatch"),r.a.createElement("option",null,"entity")),r.a.createElement("label",{htmlFor:"thingid"},"Enter ID:"),r.a.createElement("input",{id:"thingid",name:"thingid",type:"text"}),r.a.createElement("label",{htmlFor:"depth"},"Enter Depth:"),r.a.createElement("input",{id:"depth",name:"depth",type:"text"}),r.a.createElement("button",null,"Go!")))),r.a.createElement("div",{className:"NodeInfo",style:Ho},r.a.createElement(Po,{nodeInfo:this.state.nodeinfo})),r.a.createElement("div",{className:"GraphView"},"2D"===this.state.graphtype?r.a.createElement(Fo.a,{graphData:this.state.graph,onNodeClick:this.handleNodeClick,onNodeHover:this.handleNodeHover,nodeAutoColorBy:"target_type",nodeCanvasObject:function(t,a,n){e.draw_to_canvas(t,a,n)},nodePointerAreaPaint:function(t,a,n){e.node_paint(t,a,n)}}):r.a.createElement(Fo.b,{graphData:this.state.graph,nodeAutoColorBy:"target_type",nodeThreeObject:function(e){return new Wo.s(new Wo.G(2,16,16),new Wo.t({color:e.color}))},onNodeClick:this.handleNodeClick,onNodeHover:this.handleNodeHover})))}}]),a}(r.a.Component),zo=Object(hn.withSnackbar)(Object(dt.a)((function(e){return{card:{minWidth:800,marginBottom:10}}}))(Vo));var qo=Object(Ji.a)({typography:{fontSize:20}}),Ko=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={value:0,threed:1},e.handleChange=function(t,a){e.setState({value:a})},e}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props.classes;this.state.value;return r.a.createElement(Yi.a,{theme:qo},r.a.createElement("div",{className:e.root},1===this.state.threed?r.a.createElement(zo,null):r.a.createElement(Uo,null)))}}]),a}(r.a.Component),Go=Object(dt.a)((function(e){return{root:{flexGrow:1},appBar:{backgroundColor:"#2196f3"},typography:{fontSize:20}}}))(Ko),Jo=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentWillReceiveProps=function(e){var t=xt("viewMode"),a=xt("notification");if(e.match.params.value)var r=xt("listViewFilter"+e.match.params.value.toLowerCase()),i=xt("listViewSort"+e.match.params.value.toLowerCase()),o=xt("listViewPage"+e.match.params.value.toLowerCase());void 0===a&&(a="on"),n.state.handler||n.GetHandler(),n.state.whoami||n.WhoAmIQuery(),n.setState({viewMode:t,notificationSetting:a,listViewFilter:r,listViewSort:i,listViewPage:o})},n.componentDidMount=function(){n.GetHandler(),n.WhoAmIQuery(),n.AMQ.register_client(),n.AMQ.create_callback_object("wall",n.wall),n.AMQ.create_callback_object("notification",n.notification),"/"===n.props.match.url&&X()(document.body).keydown(function(e){this.ee(e)}.bind(Object(l.a)(n)))},n.eedraw=function(){X()("#content").css("transform","rotateX(20deg)"),X()(document.body).prepend('<span id="ee">Lbh sbhaq gur rtt. Cbfg gb gur jnyy "V sbhaq gur rtt, pna lbh?"</span>')},n.eeremove=function(){X()("#content").css("transform","rotateX(0deg)"),X()("#ee").remove()},n.componentWillUnmount=function(){var e;e="whoami",localStorage.removeItem(e)},n.componentWillMount=function(){var e=xt("notification");void 0==e&&(e="on"),n.setState({notificationSetting:e})},n.ee=function(e){var t="837279877769847269697171";if(t.includes(n.state.eestring))if(n.state.eestring+e.keyCode===t)n.eedraw(),setTimeout(n.eeremove,2e3);else{if(X()("input").is(":focus"))return;if(!0!==e.ctrlKey&&!0!==e.metaKey){var a=n.state.eestring+e.keyCode;n.setState({eestring:a})}}else n.setState({eestring:""})},n.notification=function(){if("/"!==n.props.match.path||!n.props.match.isExact||!Se.includes(n.props.stateProps.activemqstate)){var e=n.refs.notificationSystem;if("scot-alerts"!==n.AMQ.activemqwho&&"scot-admin"!==n.AMQ.activemqwho&&"scot-flair"!==n.AMQ.activemqwho&&void 0!==e&&n.AMQ.activemqwho!==n.state.whoami&&""!==n.AMQ.activemqwho&&"api"!==n.AMQ.activemqwho&&!0!==n.AMQ.activemqwall&&"entity"!==n.AMQ.activemqtype&&"on"===n.state.notificationSetting){var t="".concat(n.AMQ.activemqwho," ").concat(n.AMQ.activemqaction," ").concat(n.AMQ.activemqtype," : ").concat(n.AMQ.activemqid),a=n.AMQ.activemqtype,r=n.AMQ.activemqstate,i=n.AMQ.activemqid;e.addNotification({message:t,level:"info",autoDismiss:5,action:"delete"!==r?{label:"View",callback:function(){window.open("/#/"+a+"/"+i)}}:null})}}},n.wall=function(e){if("/"!==n.props.match.path||!n.props.match.isExact){var t=n.refs.notificationSystem,a=new Date(1e3*n.AMQ.activemqwhen);a=a.toLocaleString(),!0===n.AMQ.activemqwall&&t.addNotification({message:a+" "+n.AMQ.activemqwho+": "+n.AMQ.activemqmessage,level:"warning",autoDismiss:0})}},n.errorToggle=function(e,t){var a=e;if(t)if(t.responseJSON){if("Authentication Required"===t.responseJSON.error)return n.setState({csrf:t.responseJSON.csrf}),void n.loginToggle(t.responseJSON.csrf)}else"Service Unavailable"===t.statusText&&(a=t.statusText);n.refs.notificationSystem.addNotification({message:a,level:"error",autoDismiss:0})},n.notificationToggle=function(){"off"===n.state.notificationSetting?(n.setState({notificationSetting:"on"}),Dt("notification","on",1e3)):(n.setState({notificationSetting:"off"}),Dt("notification","off",1e3))},n.loginToggle=function(e,t){if(n.state.login||!0===t)n.state.login&&!0===t&&(n.setState({login:!1}),n.props.history.push(n.state.origurl));else{var a=n.props.location.pathname;n.props.history.push("/"),n.setState({login:!0,origurl:a})}},n.LogOut=function(){X.a.ajax({type:"get",url:"/logout",success:function(e){this.setState({login:!0}),console.log("Successfully logged out"),this.WhoAmIQuery()}.bind(Object(l.a)(n)),error:function(e){this.error("Failed to log out",e)}.bind(Object(l.a)(n))})},n.WhoAmIQuery=function(){X.a.ajax({type:"get",url:"scot/api/v2/whoami",success:function(e){var t,a;t="whoami",a=e.user,localStorage.setItem(t,a),e.data&&this.setState({sensitivity:e.data.sensitivity,whoami:e.user})}.bind(Object(l.a)(n)),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(Object(l.a)(n))})},n.GetHandler=function(){X.a.ajax({type:"get",url:"/scot/api/v2/handler?current=1",success:function(e){this.setState({handler:e.records[0].username})}.bind(Object(l.a)(n)),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(Object(l.a)(n))})},n.render=function(){var e,t="Incident Handler: "+n.state.handler;return n.props.match.params.value&&(e=n.props.match.params.value.toLowerCase()),r.a.createElement(I,null,r.a.createElement(u.a,{inverse:!0,fixedTop:!0,fluid:!0},r.a.createElement(u.a.Header,null,r.a.createElement(u.a.Brand,null,r.a.createElement(Ne.Link,{to:"/",style:{margin:"0",padding:"0"}},r.a.createElement("img",{src:"/images/scot-600h.png",alt:"",style:{width:"50px"}}))),r.a.createElement(u.a.Toggle,null)),r.a.createElement(u.a.Collapse,null,r.a.createElement(m.a,null,r.a.createElement(Bi.a,{to:"/alertgroup",activeClassName:"active"},r.a.createElement(y.a,null,"Alert")),r.a.createElement(Bi.a,{to:"/event",activeClassName:"active"},r.a.createElement(y.a,null,"Event")),r.a.createElement(Bi.a,{to:"/incident",activeClassName:"active"},r.a.createElement(y.a,null,"Incident")),r.a.createElement(v.a,{id:"nav-dropdown",title:"ThreatIntel"},r.a.createElement(Bi.a,{to:"/dispatch",activeClassName:"active"},r.a.createElement(E.a,null,"Dispatch")),r.a.createElement(Bi.a,{to:"/intel",activeClassName:"active"},r.a.createElement(E.a,null,"Intel")),r.a.createElement(Bi.a,{to:"/product",activeClassName:"active"},r.a.createElement(E.a,null,"Product"))),r.a.createElement(v.a,{id:"nav-dropdown",title:"More"},r.a.createElement(Bi.a,{to:"/task",activeClassName:"active"},r.a.createElement(E.a,null,"Task")),r.a.createElement(Bi.a,{to:"/guide",activeClassName:"active"},r.a.createElement(E.a,null,"Guide")),r.a.createElement(Bi.a,{to:"/signature",activeClassName:"active"},r.a.createElement(E.a,null,"Signature")),r.a.createElement(Bi.a,{to:"/entity",activeClassName:"active"},r.a.createElement(E.a,null,"Entity")),r.a.createElement(Bi.a,{to:"/reports",activeClassName:"active"},r.a.createElement(E.a,null,"Reports")),r.a.createElement(Bi.a,{to:"/feed",activeClassName:"active"},r.a.createElement(E.a,null,"Feeds")),r.a.createElement(Bi.a,{to:"/sfgraph",activeClassName:"active"},r.a.createElement(E.a,null,"ScotForceGraph")),r.a.createElement(E.a,{divider:!0}),r.a.createElement(Bi.a,{to:"/admin",activeClassName:"active"},r.a.createElement(E.a,null,"Administration")),r.a.createElement(E.a,{href:"/docs/index.html"},"Documentation"),r.a.createElement(E.a,{divider:!0}),r.a.createElement(E.a,{href:"https://cybertools-cc.sandia.gov/"},"Cyber Chef"),r.a.createElement(E.a,{divider:!0}),r.a.createElement(E.a,{href:"/#/",onClick:n.LogOut},"Log Out")),r.a.createElement(y.a,{href:"/incident_handler.html"},t)),r.a.createElement("span",{id:"ouo_warning",className:"ouo-warning"},n.state.sensitivity),r.a.createElement("span",{id:"scot_version",style:{float:"right",marginTop:"3px",padding:"10px 10px",position:"relative",color:"white"},className:"scot_version"},"V3.7"),r.a.createElement(Lt,{errorToggle:n.errorToggle}))),r.a.createElement("div",{className:"mainNavPadding"},r.a.createElement(Vt,{csrf:n.state.csrf,modalActive:n.state.login,loginToggle:n.loginToggle,WhoAmIQuery:n.WhoAmIQuery,GetHandler:n.GetHandler,errorToggle:n.errorToggle,origurl:n.state.origurl}),r.a.createElement(vi.a,{ref:"notificationSystem"}),r.a.createElement(zt.d,{exact:!0,path:"/",render:function(e){return r.a.createElement(Ct,{loggedIn:!n.state.login,sensitivity:n.state.sensitivity,errorToggle:n.errorToggle,clientId:n.state.clientId,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object})}}),"admin"===e?r.a.createElement(zt.d,{exact:!0,path:"/admin"},r.a.createElement(Do,null)):null,"sfgraph"===e?r.a.createElement(zt.d,{exact:!0,path:"/sfgraph"},r.a.createElement(Go,null)):null,"alert"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"alertgroup"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"entry"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"event"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"incident"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"task"===e?r.a.createElement(Wi,{isTask:!0,queryType:n.props.match.params.type,viewMode:n.state.viewMode,type:n.props.match.params.value,id:n.props.match.params.id,id2:n.props.match.params.id2,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"guide"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"dispatch"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"intel"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"product"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"feed"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"signature"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"entity"===e?r.a.createElement(Wi,{id:n.props.match.params.id,id2:n.props.match.params.id2,viewMode:n.state.viewMode,type:e,notificationToggle:n.notificationToggle,notificationSetting:n.state.notificationSetting,listViewFilter:n.state.listViewFilter,listViewSort:n.state.listViewSort,listViewPage:n.state.listViewPage,errorToggle:n.errorToggle,history:n.props.history,createCallback:n.AMQ.create_callback_object,removeCallback:n.AMQ.remove_callback_object}):null,"reports"===e&&!n.props.match.params.id&&r.a.createElement(ot,null),"reports"===e&&n.props.match.params.id&&r.a.createElement(st,{reportType:n.props.match.params.id}),"wall"===e?r.a.createElement(Ut,{errorToggle:n.errorToggle}):null))},n.state={open:!1,notificationSetting:"on",login:!1,csrf:"",origurl:"",sensitivity:"",whoami:void 0,handler:void 0,eestring:"",clientId:null},n.notification=n.notification.bind(Object(l.a)(n)),n.loginToggle=n.loginToggle.bind(Object(l.a)(n)),n.errorToggle=n.errorToggle.bind(Object(l.a)(n)),n.AMQ=new No,n}return a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Yo=a(508),Qo=a(171),Xo=a(507),$o=a(71).createBrowserHistory;o.a.render(r.a.createElement(Xo.a,{history:$o()},r.a.createElement(hn.SnackbarProvider,null,r.a.createElement(Yo.a,null,r.a.createElement(Qo.a,{exact:!0,path:"/",component:Jo}),r.a.createElement(Qo.a,{exact:!0,path:"/:value",component:Jo}),r.a.createElement(Qo.a,{exact:!0,path:"/:value/:id",component:Jo}),r.a.createElement(Qo.a,{exact:!0,path:"/:value/:id/:id2",component:Jo}),r.a.createElement(Qo.a,{path:"/:value/:type/:id/:id2",component:Jo})))),document.getElementById("root"))},328:function(e,t,a){},490:function(e,t,a){e.exports=a.p+"static/media/scot_logo_473x473.981c5c79.png"},591:function(e,t,a){e.exports=a(1040)}},[[591,1,2]]]);
//# sourceMappingURL=main.0aa597fd.chunk.js.map